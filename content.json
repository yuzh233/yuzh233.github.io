{"pages":[{"title":"About Me","text":"ä¸»é¢˜é…ç½®ç›¸å…³Brand æ ‡è¯†hexo æ ¹ç›®å½• _config.yml é…ç½® title ç”Ÿæˆ categories å’Œ tags é¡µé¢å°† themes/icarus/_source ä¸‹çš„ categories å’Œ tags ç›®å½•æ‹·è´åˆ° hexo/source ç›®å½• Profileä¸»é¢˜çš„ _config.yml é…ç½® RECENT ç•¥ç¼©å›¾è®¾ç½®æ¯ä¸€ç¯‡æ–‡ç« æ·»åŠ æ ‡ç­¾ï¼šthumbnail: /img/random/14.jpg, img æ–‡ä»¶å¤¹æ˜¯å±äº hexo æ ¹ç›®å½•çš„ã€‚ é¦–é¡µæ˜¾ç¤ºæ–‡ç« æ‘˜è¦ä¾µå…¥æ€§è¾ƒå¼ºï¼Œåœ¨æ–‡ç« çš„æŒ‡å®šéƒ¨åˆ†æ·»åŠ æ ‡ç­¾ï¼š&lt;!-- more --&gt;ï¼Œè¯¥æ ‡ç­¾ä¹‹å‰çš„å†…å®¹è¢«ä½œä¸ºæ‘˜è¦ã€‚ æ›´æ”¹ä¸»é¢˜å†…å®¹æ¨¡å—é¡µé¢å®½åº¦../hexo/themes/icarus/source/css/_variables.styl 123456789// Layoutblock-margin = 40pxarticle-padding = 20pxmobile-nav-width = 280px# è‡ªå®šä¹‰å®½åº¦ï¼Œé»˜è®¤ 7main-column = 10sidebar-column = 3profile-column = 3sidebar-column-tablet = 4 æ›´æ”¹ä»£ç æ ·å¼æ ·å¼å­˜åœ¨äºï¼š/opt/hexo/themes/icarus/source/css/_highlight æ–‡ä»¶å¤¹ï¼Œ60ä½™ç§ã€‚ ä¿®æ”¹ä¸»é¢˜ _config.yml çš„ highlightï¼š Valine è¯„è®º12345678valine: # Valine Comment System https://github.com/xCss/Valine on: true # enter true to enable appId: IaNb4n1EqHakKzNDh6jR1qYJ-gzGzoHsz # enter the leancloud application appId here appKey: Hg7CxatEfuCfhqOsl7XYtEOv # enter the leancloud application appKey here notify: true # enter true to enable &lt;Mail notifier&gt; https://github.com/xCss/Valine/wiki/Valine-%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E9%82%AE%E4%BB%B6%E6%8F%90%E9%86%92%E8%AE%BE%E7%BD%AE # éœ€è¦è®¾ç½®trueï¼Œå¦åˆ™æ’ä»¶ä¸ç”Ÿæ•ˆã€‚ verify: true # enter true to enable &lt;Validation code&gt; placeholder: Just Do It... # enter the comment box placeholder TOC æ”¯æŒæ¯ç¯‡æ–‡ä»¶æ·»åŠ æ ‡ç­¾ï¼štoc: true å³å¯ã€‚","link":"/about/index.html"}],"posts":[{"title":"Docker è¡¥æ•‘æŒ‡å—ï¼ˆå››ï¼‰â€”â€” dockerfile-maven-plugin","text":"dockerfile-maven-plugin æ’ä»¶ä»‹ç»è¯¥æ’ä»¶å¸®åŠ© Maven é›†æˆ Docker ä¸éœ€è¦ä»»ä½•èŠ±é‡Œèƒ¡å“¨çš„æ“ä½œğŸ¤ªã€‚è¿™ä¸ªæ’ä»¶ä½¿ç”¨ Dockerfile æ„å»ºé•œåƒï¼Œå¹¶ä¸”æ˜¯å¼ºåˆ¶æ€§çš„ã€‚ ä½¿ Docker çš„æ„å»º\bè¿‡ç¨‹é›†æˆ Maven çš„æ„å»ºè¿‡ç¨‹ï¼Œå¦‚æœç»‘å®šäº†\bé»˜è®¤ã€Œé˜¶æ®µï¼ˆphasesï¼‰ã€ï¼Œå½“è¾“å…¥ mvn package æ—¶ï¼Œå°†ä¼šæ„å»º\bä¸€ä¸ªé•œåƒï¼›å½“è¾“å…¥ mvn deploy æ—¶ï¼Œè¯¥é•œåƒå°†ä¼šè¢«æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚ è®©ç›®æ ‡ã€Œgoalsã€è®°ä½ä½ è¦åšä»€ä¹ˆï¼ˆé€šè¿‡ goals æ ‡ç­¾å®šåˆ¶å¤„ç†è¿‡ç¨‹ï¼‰ã€‚å¯ä»¥é€šè¿‡è¾“å…¥ mvn dockerfile:tagã€mvn dockerfile:buildã€mvn dockerfile:push æ¥æ„å»ºå¹¶æ¨é€ä¸€ä¸ªé•œåƒï¼Œä½œä¸ºæ›¿ä»£çš„å¯ä»¥ä½¿ç”¨ï¼šmvn dockerfile:build dockerfile:pushã€‚ referenceï¼šhttps://github.com/spotify/dockerfile-maven ä»¥ä¸‹æ˜¯ç®€å•çš„å®ä¾‹é…ç½®ï¼Œåœ¨æ­¤é…ç½®ä¸­ï¼Œæ‰§è¡Œ mvn package å°†æ„å»ºä¸€ä¸ªé•œåƒï¼Œæ‰§è¡Œ mvn deploy å°†æ¨é€é•œåƒã€‚å½“ç„¶å¯ä»¥\bé€šè¿‡æ‰§è¡Œ mvn dockerfile:build æ˜ç¡®çš„è¯´æ˜æ„å»º\bã€‚ 1234567891011121314151617181920212223&lt;plugin&gt; &lt;groupId&gt;com.spotify&lt;/groupId&gt; &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt; &lt;version&gt;${dockerfile-maven-version}&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;default&lt;/id&gt; &lt;!-- è¿™é‡Œæ²¡æœ‰æŒ‡å®š phase å°±æ˜¯é»˜è®¤ mvn package æ—¶æ‰§è¡Œ build æ“ä½œï¼Œmvn deploy æ—¶æ‰§è¡Œ pushæ“ä½œ --&gt; &lt;goals&gt; &lt;goal&gt;build&lt;/goal&gt; &lt;goal&gt;push&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;configuration&gt; &lt;repository&gt;spotify/foobar&lt;/repository&gt; &lt;tag&gt;${project.version}&lt;/tag&gt; &lt;buildArgs&gt; &lt;JAR_FILE&gt;${project.build.finalName}.jar&lt;/JAR_FILE&gt; &lt;/buildArgs&gt; &lt;/configuration&gt;&lt;/plugin&gt; è¯¥æ’ä»¶çš„æ‰€æœ‰å¯ç”¨çš„æ„å»ºç›®æ ‡ï¼ˆgoalsï¼‰ Goal Description Default Phased docker:build ä» Dockerfile æ„å»ºä¸€ä¸ª\bé•œåƒ package docker:tag ä¸ºé•œåƒè®¾ç½®ä¸€ä¸ªæ ‡ç­¾ package docker:push æ¨é€é•œåƒåˆ°è¿œç¨‹ä»“åº“ deploy ä½¿ maven çš„æŸä¸ªæ„å»ºè¿‡ç¨‹è·³è¿‡ dockerfile-plugin çš„æŸä¸ªç›®æ ‡ Maven Option What Does it Do? Default Value dockerfile.skip å…³é—­å…¨éƒ¨ dockerfile æ’ä»¶ fals dockerfile.build.skip å…³é—­ build ç›®æ ‡ false dockerfile.tag.skip å…³é—­ tag ç›®æ ‡ false dockerfile.push.skip å…³é—­ push ç›®æ ‡ false é»˜è®¤ mvn package ä¼šæ‰§è¡Œ dockerfile:build æ“ä½œï¼ˆGoalï¼‰ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ‰§è¡Œ mvn package æ—¶æŒ‡å®šå‚æ•°ï¼šmvn package -Ddockerfile.build.skip é‚£ä¹ˆè¯¥è¿‡ç¨‹ä¸ä¼šæ‰§è¡Œé•œåƒçš„æ„å»ºã€‚ reference: https://github.com/spotify/dockerfile-maven/blob/master/docs/usage.md \bè®¤è¯ See authentication docs. referenceï¼šhttps://github.com/spotify/dockerfile-maven/blob/master/docs/authentication.md æˆ‘çš„ç¿»è¯‘ ä¾é  Dockerfile æ’ä»¶çš„å…¶ä»– Docker å·¥å…· TODO \bä½¿ç”¨ dockerfile-maven-plugin æ’ä»¶é‡åˆ°çš„ä¸€äº›é—®é¢˜å®Œæ•´é…ç½®ï¼š 123456789101112131415161718192021222324252627282930313233&lt;plugin&gt; &lt;groupId&gt;com.spotify&lt;/groupId&gt; &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.4.3&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;default&lt;/id&gt; &lt;!-- å¦‚æœä¸æŒ‡å®š phase åˆ™ä¼šä½¿ç”¨é»˜è®¤çš„ goalsï¼Œå³ï¼špackage -&gt; build, deploy -&gt; push --&gt; &lt;phase&gt;install&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;build&lt;/goal&gt; &lt;goal&gt;push&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;configuration&gt; &lt;repository&gt;registry.cn-shanghai.aliyuncs.com/yuzh/microservice-userservice&lt;/repository&gt; &lt;!-- å¦‚æœä¸æƒ³åœ¨ pom ä¸­æŒ‡å®š username password å¯ä»¥åœ¨ setting.xml ä¸­\bæ·»åŠ  server èŠ‚ç‚¹ã€‚ æ³¨æ„ï¼šserver èŠ‚ç‚¹ä¸­çš„ id å€¼å¿…é¡»å’Œ è¿™é‡Œçš„ repository ä»“åº“å‰ç¼€åœ°å€\bä¿æŒä¸€è‡´ï¼å¦‚ &lt;server&gt; &lt;id&gt;registry.cn-shanghai.aliyuncs.com&lt;/id&gt; &lt;username&gt;&lt;/username&gt; &lt;password&gt;&lt;/password&gt; &lt;/server&gt; --&gt; &lt;username&gt;${username}&lt;/username&gt; &lt;password&gt;${password}&lt;/password&gt; &lt;tag&gt;${project.version}&lt;/tag&gt; &lt;useMavenSettingsForAuth&gt;true&lt;/useMavenSettingsForAuth&gt; &lt;/configuration&gt;&lt;/plugin&gt; 0ï¼‰å¦‚æœä¸æƒ³æŒ‡å®š push åˆ°è¿œç¨‹ä»“åº“çš„ç”¨æˆ·åå’Œå¯†ç çš„è¯ï¼Œå¯ä»¥å…ˆç™»é™†è¿œç¨‹ä»“åº“ã€‚ï¼ˆå¦åˆ™ï¼Œéœ€è¦åœ¨ pom ä¸­æˆ– setting.xml ä¸­é…ç½®è¿œç¨‹ä»“åº“ç”¨æˆ·åå’Œå¯†ç ï¼‰ 1e.g: docker login --username=yuzh233 registry.cn-shanghai.aliyuncs.com 1ï¼‰ ä½¿ç”¨æœ€æ–°çš„ 1.4.10 ç‰ˆæœ¬ push ä¼šæœ‰ç‚¹é—®é¢˜ï¼Œå¯èƒ½ç¼ºå°‘ä»€ä¹ˆé…ç½®ï¼Œä»å®˜æ–¹ github æ²¡æœ‰æ‰¾å‡ºé—®é¢˜å‡ºæ¥ã€‚ç›®å‰ä½¿ç”¨ 1.4.3 æ²¡é—®é¢˜ã€‚ 2ï¼‰ éœ€è¦æ³¨æ„å‘½ä»¤è¡Œæ‰§è¡Œ mvn å‘½ä»¤å’Œ \bIDE å›¾å½¢åŒ–æ“ä½œ mvn æ—¶æ‰€ä½¿ç”¨çš„ setting.xml æ–‡ä»¶ä¸æ˜¯ä¸€è‡´çš„ã€‚ terminal é»˜è®¤åŠ è½½çš„é…ç½®æ–‡ä»¶æ˜¯å…¨å±€çš„ï¼š${MAVEN_HOME/conf/setting.xmlï¼Œå¦‚æœ‰éœ€è¦å¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œæºå¸¦å‚æ•°è®¾ç½®\bå¤‡ç”¨åŠ è½½è·¯å¾„ï¼š--settings=/User/xxxx/settings.xml 3ï¼‰å¦‚æœä¸æŒ‡å®š phase æ ‡ç­¾ï¼Œdockerfile-plugin å°†ä¼šåœ¨ deploy æ—¶\b push Docker é•œåƒï¼Œéœ€è¦\bæ³¨æ„çš„æ˜¯ï¼š\bå¾€å¾€è¿™ä¸ªæ—¶å€™ä¼šæŠ¥é”™ï¼Œæç¤º\bğŸ‘‡ 1Deployment failed: repository element was not specified in the POM inside distributionManagement element æ£€æŸ¥åå‘ç°ï¼Œdocker è¿œç¨‹ä»“åº“çš„é…ç½®çœ‹èµ·æ¥æ²¡é—®é¢˜ï¼ˆåœ¨ setting.xml ä¸­é…ç½®äº†ç§æœ‰ä»“åº“ç”¨æˆ·åå’Œå¯†ç æˆ–è€…åœ¨ pom ä¸­æŒ‡æ˜äº†ä»“åº“åœ°å€å’Œç”¨æˆ·åå¯†ç ï¼‰ï¼Œä½†æ˜¯å°±æ˜¯ä¸€ç›´æŠ¥é”™ï¼Ÿï¼ æ‰‹åŠ¨æ‰§è¡Œ mvn dockerfile:push å‘ç°æˆåŠŸæ¨é€åˆ°äº†è¿œç¨‹ä»“åº“ï¼Œæ‰€ä»¥å¯ä»¥ç¡®å®šçš„æ˜¯ è¿™é‡ŒæŠ¥é”™æ˜¯ jar åŒ…æ¨é€åˆ° maven çš„è¿œç¨‹ä»“åº“æ—¶æ²¡æœ‰\bé…ç½®å¥½ç¯å¢ƒå¯¼è‡´çš„ï¼Œè€Œä¸æ˜¯ docker ä»“åº“çš„é…ç½®é—®é¢˜ã€‚æ‰€ä»¥è¦ä¹ˆé…ç½®å¥½mavenè¿œç¨‹ä»“åº“ï¼Œè¦ä¹ˆæŒ‡å®š phase ä¸ç­‰äº deployã€‚ maven æ‰“åŒ…åˆ°è¿œç¨‹ä»“åº“ç›¸å…³ç»†èŠ‚ï¼Œå…ˆæ™¾ç€å§\bğŸ™„ã€‚","link":"/2019/05/30/\bDocker è¡¥æ•‘æŒ‡å—ï¼ˆå››ï¼‰â€”â€” dockerfile-maven-plugin/"},{"title":"Docker è¡¥æ•‘æŒ‡å—ï¼ˆä¸‰ï¼‰â€”â€” Docker Swarm","text":"æ˜¯ä»€ä¹ˆDocker Swarm æ˜¯ä¸€ä¸ªåˆ›å»ºå’Œç®¡ç† Docker é›†ç¾¤çš„å·¥å…·ï¼Œè¯¥å·¥å…·ä¸»è¦ç”¨äº Docker çš„\bé›†ç¾¤ç®¡ç†å’Œå®¹å™¨ç¼–æ’ã€‚å…¶ç‰¹ç‚¹æœ‰ä¸‹ï¼š æ–¹ä¾¿åˆ›å»ºå’Œç®¡ç†é›†ç¾¤ å¯æ‹“å±• å¯å®ç°æœŸæœ›çš„çŠ¶æ€è°ƒèŠ‚ é›†ç¾¤ä¸­å¤šä¸»æœºç½‘ç»œè‡ªåŠ¨æ‹“å±•ç®¡ç† æä¾›æœåŠ¡å‘ç°åŠŸèƒ½ å¯å®ç°è´Ÿè½½å‡è¡¡ å®‰å…¨æ€§\bå¼º æ”¯æŒå»¶è¿Ÿæ›´æ–°å’ŒæœåŠ¡å›æ»š Docker Swarm æ˜¯ Docker å®˜æ–¹åœ¨ Docker1.12 åè‡ªå¸¦æ”¯æŒçš„æ–°å‹å®¹å™¨é›†ç¾¤ç®¡ç†å·¥å…·ã€‚åœ¨æ­¤ä¹‹å‰æ¯”è¾ƒæˆç†Ÿçš„å®¹å™¨é›†ç¾¤ç®¡ç†å·¥å…·æœ‰ Google çš„ Kubernetes å’Œ Apache çš„åˆ†å¸ƒå¼ç®¡ç†æ¡†æ¶ Mesos ç­‰ã€‚ æ ¸å¿ƒæ¦‚å¿µï¼šèŠ‚ç‚¹ã€æœåŠ¡ã€ä»»åŠ¡çš„æè¿° æ­å»º Swarm é›†ç¾¤ç¯å¢ƒå‡†å¤‡ ä¸‰å°è£…æœ‰ Docker çš„ä¸»æœºï¼Œç‰ˆæœ¬è¦æ±‚æ˜¯ 1.12 ä»¥ä¸Šã€‚ é›†ç¾¤ç®¡ç†èŠ‚ç‚¹çš„ IP å¿…é¡»å›ºå®šï¼Œä¿è¯å…¶ä»–å·¥ä½œèŠ‚ç‚¹\bèƒ½å¤Ÿè®¿é—®è¯¥ç®¡ç†èŠ‚ç‚¹ã€‚ é›†ç¾¤èŠ‚ç‚¹ä¹‹é—´å¿…é¡»ä½¿ç”¨ç›¸åŒçš„åè®®å¹¶ä¿è¯ä»¥ä¸‹ç«¯å£å¯ç”¨ï¼š \bç”¨äºé›†ç¾¤ç®¡ç†é€šä¿¡çš„ TCP æ¥å£ 2377 ç”¨äº\bèŠ‚ç‚¹é—´é€šä¿¡çš„ TCP/UDP ç«¯å£ 7946 ç”¨äºè¦†ç›–ç½‘ç»œæµé‡çš„ UDP \bç«¯å£ 4789 ç”±äºä¸»æœºæœ‰é™ï¼Œè¿™é‡Œä½¿ç”¨æœ¬åœ° Mac ä¸»æœºå’Œäº‘ç«¯ ECS ä¸»æœºï¼Œå‡ºå£ IP åˆ†åˆ«ä¸ºï¼š 12æœ¬åœ°ï¼ˆworkerï¼‰ï¼š113.246.94.216è¿œç¨‹ï¼ˆmanagerï¼‰ï¼š120.78.69.82 å¸¸ç”¨å‘½ä»¤ï¼š123456789101112131415Usage: docker swarm COMMANDManage SwarmCommands: ca Display and rotate the root CA init Initialize a swarm join Join a swarm as a node and/or manager join-token Manage join tokens leave Leave the swarm unlock Unlock swarm unlock-key Manage the unlock key update Update the swarmRun 'docker swarm COMMAND --help' for more information on a command. åˆ›å»º Docker Swarm é›†ç¾¤åœ¨ manager \båˆ›å»ºä¸€ä¸ªé›†ç¾¤ï¼šdocker swarm init â€“advertise-addr 120.78.69.82 é›†ç¾¤åˆ›å»ºæˆåŠŸï¼Œå½“å‰èŠ‚ç‚¹é»˜è®¤æˆä¸ºäº†ç®¡ç†èŠ‚ç‚¹ã€‚æŸ¥çœ‹é›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ï¼šdocker node ls æ¥ä¸‹æ¥ï¼Œè®©å·¥ä½œèŠ‚ç‚¹åŠ å…¥ Swarm é›†ç¾¤ï¼Œä½¿ç”¨ï¼šdocker swarm join123456789101112[root@izwz90qcppq4b8dajq7j3uz ~]# docker swarm join --helpUsage: docker swarm join [OPTIONS] HOST:PORTJoin a swarm as a node and/or managerOptions: --advertise-addr string Advertised address (format: &lt;ip|interface&gt;[:port]) --availability string Availability of the node (\"active\"|\"pause\"|\"drain\") (default \"active\") --data-path-addr string Address or interface to use for data path traffic (format: &lt;ip|interface&gt;) --listen-addr node-addr Listen address (format: &lt;ip|interface&gt;[:port]) (default 0.0.0.0:2377) --token string Token for entry into the swarm æœ‰å¾ˆå¤šç§æ–¹å¼åŠ å…¥é›†ç¾¤ï¼Œè¿™é‡Œ\bä½¿ç”¨åˆ›å»ºé›†ç¾¤æˆåŠŸä¹‹åçš„æç¤ºå‘½ä»¤å°±å¯ä»¥äº†ã€‚å¦‚æœå¿˜è®°äº†åŠ å…¥é›†ç¾¤çš„æŒ‡ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ docker swarm join-tokens [worker / manager] æŸ¥çœ‹\båŠ å…¥é›†ç¾¤çš„ token ä¿¡æ¯ï¼š å·¥ä½œèŠ‚ç‚¹åŠ å…¥é›†ç¾¤ï¼Œåœ¨å·¥ä½œèŠ‚ç‚¹ç»ˆç«¯æ‰§è¡Œï¼š æ­¤æ—¶åœ¨å·¥ä½œèŠ‚ç‚¹ä¸Šå¯ä»¥çœ‹åˆ°è¯¥é›†ç¾¤ä¸­æœ‰ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œæ³¨æ„ï¼šå·¥ä½œèŠ‚ç‚¹ä¸èƒ½æ‰§è¡Œ docker swarm çš„å…¶ä»–å‘½ä»¤ï¼Œåªèƒ½æ‰§è¡Œ docker \bswarm leave ç¦»å¼€æ­¤é›†ç¾¤ã€‚ å‘ Docker Swarm éƒ¨ç½²æœåŠ¡ä½¿ç”¨ docker service æ¥ç®¡ç† Swarm é›†ç¾¤ä¸­çš„æœåŠ¡ï¼Œæ­¤å‘½ä»¤åªèƒ½åœ¨ç®¡ç†èŠ‚ç‚¹æ‰§è¡Œã€‚ 123456789101112131415161718[root@izwz90qcppq4b8dajq7j3uz ~]# docker service --helpUsage: docker service COMMANDManage servicesCommands: create Create a new service inspect Display detailed information on one or more services logs Fetch the logs of a service or task ls List services ps List the tasks of one or more services rm Remove one or more services rollback Revert changes to a service's configuration scale Scale one or multiple replicated services update Update a serviceRun 'docker service COMMAND --help' for more information on a command. åœ¨ Docker Swarm é›†ç¾¤ä¸­è¿è¡Œä¸€ä¸ª nginx çš„æœåŠ¡ï¼šdocker service create â€“replicas 1 -p 8086:80 â€“name swarm-nginx nginx --replicas 1 æŒ‡å®šè¯¥æœåŠ¡çš„å‰¯æœ¬æ•°é‡ --name ä¸åˆ›å»ºå®¹å™¨ä¸€æ · -p ä¸åˆ›å»ºå®¹å™¨ä¸€æ · 1PS: Docker æœåŠ¡ç®¡ç†çš„å‘½ä»¤\bä¸å®¹å™¨ç®¡ç†ç±»ä¼¼ï¼Œåªä¸è¿‡ä¸€ä¸ªæ˜¯ docker serviceï¼Œä¸€ä¸ªæ˜¯ docker contianerã€‚ä½†æœ‰ä¸ªåˆ«æœåŠ¡çš„ç‰¹ä¾‹å‘½ä»¤å¦‚ï¼š--replicas æ¥ä¸‹æ¥å¯ä»¥æŸ¥çœ‹é›†ç¾¤ä¸­çš„æœåŠ¡åˆ—è¡¨ï¼šdocker service ls æŸ¥çœ‹æœåŠ¡åœ¨é›†ç¾¤ä¸Šçš„åˆ†é…å’Œè¿è¡Œæƒ…å†µï¼šdocker service ps swarm-nginx \bç”±å‰é¢çŸ¥é“ï¼šä¸€ä¸ªæœåŠ¡æ˜¯å¤šä¸ªä»»åŠ¡çš„é›†åˆï¼Œä»»åŠ¡æ˜¯ Swarm ä¸­çš„æœ€å°è°ƒåº¦å•å…ƒï¼Œä¸€ä¸ªä»»åŠ¡å¯ä»¥çœ‹ä½œæ˜¯å•ä¸ªå®¹å™¨ã€‚æˆ‘ä»¬è¿è¡Œä¸€ä¸ªæœåŠ¡ä¹‹åï¼ŒSwarm åˆ†é…ä»»åŠ¡åˆ°ä¸åŒçš„å‰¯æœ¬æ‰§è¡Œï¼Œåœ¨ä¸åŒå‰¯æœ¬ä¸­çš„ä½“ç°\bå¯ä»¥æŸ¥çœ‹å®¹å™¨è¿è¡Œ\bæƒ…å†µã€‚ ä»»åŠ¡è¢«åˆ†é…åˆ°äº†å·¥ä½œèŠ‚ç‚¹ï¼Œé€šè¿‡æŸ¥çœ‹\u001då®¹å™¨è¿›ç¨‹å¯ä»¥çœ‹åˆ°ï¼š åœ¨é›†ç¾¤ä¸­éƒ¨ç½²çš„æœåŠ¡ï¼Œå¦‚æœåªè¿è¡Œä¸€ä¸ªå‰¯æœ¬ï¼Œå°±æ— æ³•ä½“ç°é›†ç¾¤çš„ä¼˜åŠ¿ã€‚ä¸€æ—¦è¯¥æœºå™¨æˆ–å‰¯æœ¬å¥”æºƒï¼Œè¯¥æœåŠ¡å°±æ— æ³•è®¿é—®ï¼Œæ‰€ä»¥é€šå¸¸ä¸€ä¸ªæœåŠ¡ä¼šåˆ›å»ºå¤šä¸ªå‰¯æœ¬ã€‚ æ·»åŠ å‰¯æœ¬çš„\bå‘½ä»¤æ˜¯ï¼šdocker service scale æœåŠ¡å=æ•°é‡ æ·»åŠ å‰¯æœ¬ä¹‹åå†æŸ¥çœ‹æœåŠ¡è¿è¡Œæƒ…å†µï¼š 1PSï¼šDocker Swarm éƒ¨ç½²æœåŠ¡ä¸‹çš„å®¹å™¨ï¼Œé»˜è®¤ç½‘ç»œæ–¹å¼éƒ½æ˜¯ä½¿ç”¨ overlay é©±åŠ¨çš„ ingress ç½‘ç»œï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¼šè‡ªå®šä¹‰ä¸€ä¸ªåŸºäº overlay è¦†ç›–ç½‘ç»œé©±åŠ¨çš„ç½‘ç»œã€‚ä½¿ç”¨æ–¹å¼ä¸åˆ›å»ºå®¹å™¨ä¸€æ ·ï¼Œéƒ½æ˜¯æŒ‡å®š `--network ç½‘ç»œå` æœ€ç»ˆï¼Œä¸¤ä¸ª\bèŠ‚ç‚¹éƒ½è¿è¡Œç€æˆ‘ä»¬çš„ nginx æœåŠ¡ï¼Œ\bæ‰“å¼€æµè§ˆå™¨åˆ†åˆ«è®¿é—®ï¼š æ•…æ„ down æ‰ä¸€ä¸ªå®¹å™¨ï¼ˆæœ¬åœ°å®¹å™¨ï¼‰ï¼ŒæŸ¥çœ‹æ˜¯å¦åŠ¨æ€åˆ†é…äº†èŠ‚ç‚¹ï¼Ÿ down æ‰ä¸€ä¸ªå®¹å™¨ä¹‹åï¼Œè¿‡ä¸äº†å¤šä¹…åˆå¼€å¯äº†ä¸€ä¸ªå®¹å™¨ã€‚Docker Swarm å§‹ç»ˆä¿æŒ swarm-nginx æœåŠ¡æœ‰ä¸¤ä¸ªèŠ‚ç‚¹è¿è¡Œã€‚ åˆ é™¤æœåŠ¡ï¼šdocker service rm æœåŠ¡å æ€»ç»“é›†ç¾¤ç®¡ç†å‘½ä»¤ï¼š docker swarm init â€“advertise-addr [IP] docker node ls docker swarm join docker swarm join-tokens [worker / manager] docker swarm leave \bé›†ç¾¤æœåŠ¡å‘½ä»¤ï¼š docker service create -p [port:port] â€“replicas n [é•œåƒå:TAG/ID] docker service ls [æœåŠ¡å/ID] docker service inspect [æœåŠ¡å/ID] docker service ps [æœåŠ¡å/ID] docker service scale=[n] [æœåŠ¡å/ID] docker service rm [æœåŠ¡å/ID]","link":"/2019/05/18/Docker è¡¥æ•‘æŒ‡å—ï¼ˆä¸‰ï¼‰â€”â€” Docker Swarm/"},{"title":"Docker è¡¥æ•‘æŒ‡å—ï¼ˆäºŒï¼‰â€”â€” ç½‘ç»œç®¡ç†","text":"ç½‘ç»œç®¡ç†Docker é»˜è®¤ä½¿ç”¨ bridgeï¼ˆå•ä¸»æœºäº’è”ï¼‰å’Œ overlayï¼ˆå¯è·¨ä¸»æœºäº’è”ï¼‰ä¸¤ç§ç½‘ç»œé©±åŠ¨æ¥è¿›è¡Œå®¹å™¨çš„ç½‘ç»œç®¡ç†ã€‚å¦‚æœéœ€è¦ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ç½‘ç»œé©±åŠ¨æ’ä»¶è¿›è¡Œ Docker çš„ç½‘ç»œç®¡ç†ã€‚ä»¥ä¸‹å†…å®¹é’ˆå¯¹ Docker é»˜è®¤çš„ç½‘ç»œç®¡ç†å’Œè‡ªå®šä¹‰ç½‘ç»œç®¡ç†è¿›è¡Œæ¼”ç¤ºå­¦ä¹ ã€‚ æŸ¥çœ‹æŒ‡ä»¤ä¸ç®¡å…¶ä»–ç»†èŠ‚ï¼Œå…ˆçœ‹æœ‰å“ªäº›å¸¸ç”¨å‘½ä»¤ï¼š 1234567891011Usage: docker network COMMANDManage networksCommands: connect Connect a container to a network create Create a network disconnect Disconnect a container from a network inspect Display detailed information on one or more networks ls List networks prune Remove all unused networks rm Remove one or more networksRun 'docker network COMMAND --help' for more information on a command. å¯ä»¥çœ‹åˆ°å¯¹äºç½‘ç»œçš„æ“ä½œå¤§æ¦‚éƒ½æœ‰è¿™äº›æ“ä½œï¼šè¿æ¥ã€åˆ›å»ºã€å–æ¶ˆè¿æ¥ã€æŸ¥çœ‹ç»†èŠ‚ã€æŸ¥çœ‹åˆ—è¡¨ã€ç§»é™¤ã€‚ Docker é»˜è®¤ç½‘ç»œç®¡ç†Docker å®‰è£…æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºä¸‰ç§ç½‘ç»œã€‚æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæŒ‡ä»¤ï¼šdocker netwok ls å¯ä»¥çœ‹åˆ°ä¸‰ç§ç½‘ç»œåˆ†åˆ«æ˜¯ bridgeã€hostã€noneã€‚bridgeç½‘ç»œæ˜¯é»˜è®¤çš„ bridge é©±åŠ¨ç½‘ç»œï¼Œä¹Ÿæ˜¯å®¹å™¨åˆ›å»ºæ—¶é»˜è®¤çš„ç½‘ç»œç®¡ç†æ–¹å¼ï¼Œé…ç½®åå¯ä»¥ä¸å®¿ä¸»æœºé€šä¿¡ä»è€Œå®ç°ä¸äº’è”ç½‘é€šä¿¡çš„åŠŸèƒ½ã€‚hostã€å’Œnoneå±äºæ— çº¿ç½‘ç»œï¼Œå®¹å™¨æ·»åŠ åˆ°è¿™ä¸¤ä¸ªç½‘ç»œä¸èƒ½ä¸å¤–ç•Œç½‘è·¯é€šä¿¡ã€‚ ã€Œæ¼”ç¤ºé»˜è®¤çš„ç½‘ç»œç®¡ç†æ–¹å¼ã€ 1ï¼‰å¯åŠ¨ä¸€ä¸ªä»¥é»˜è®¤ç½‘ç»œç®¡ç†çš„å®¹å™¨ docker run -it â€“name=network-test centos 2ï¼‰ä½¿ç”¨ç½‘ç»œæŒ‡ä»¤æŸ¥çœ‹ç½‘ç»œè¯¦æƒ… docker network inspect bridge æ‰§è¡Œå‘½ä»¤åå¯ä»¥çœ‹åˆ° birdge ç½‘ç»œçš„è¯¦ç»†ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬äº†åˆšåˆšä»¥é»˜è®¤çš„ bridge ç½‘ç»œç®¡ç†æ–¹å¼å¯åŠ¨çš„ network-test å®¹å™¨ã€‚ 1PSï¼šè¿™é‡Œçš„ä¸‰ç§ç½‘ç»œæ–¹å¼ bridgeã€hostã€noneéƒ½æ˜¯éé›†ç¾¤ç¯å¢ƒä¸‹ Docker æä¾›çš„é»˜è®¤ç½‘ç»œã€‚è€Œåœ¨ Docker Swarm é›†ç¾¤ç¯å¢ƒä¸‹ï¼Œé™¤äº†è¿™ä¸‰ç§æ–¹å¼å¤–ï¼ŒDocker è¿˜æä¾›äº† docker_gwbridge å’Œ ingress ä¸¤ç§é»˜è®¤ç½‘ç»œã€‚ è‡ªå®šä¹‰ç½‘ç»œä»‹ç»åœ¨ Docker ä¸­ï¼Œå¯ä»¥è‡ªå®šä¹‰ bridge ç½‘ç»œï¼ˆæ¡¥æ¥ç½‘ç»œï¼‰ã€overlay ç½‘ç»œï¼ˆè¦†ç›–ç½‘ç»œï¼‰ï¼Œä¹Ÿå¯ä»¥åˆ›å»º network pluginæˆ–è€…è¿œç¨‹ç½‘ç»œä»¥å®ç°å®¹å™¨ç½‘ç»œçš„å®Œå…¨å®šåˆ¶å’Œæ§åˆ¶ï¼Œä»¥ä¸‹æ˜¯ç®€è¦ä»‹ç»ã€‚ 1ï¼‰Bridge Network ä¸ºäº†å®¹å™¨çš„å®‰å…¨æ€§ï¼Œå¯ä»¥ä½¿ç”¨åŸºäº bridge çš„é©±åŠ¨åˆ›å»ºæ–°çš„ bridge ç½‘ç»œï¼Œè¿™ç§åŸºäº bridge é©±åŠ¨çš„è‡ªå®šä¹‰ç½‘ç»œå¯ä»¥è¾ƒå¥½çš„å®ç°å®¹å™¨éš”ç¦»ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§ç”¨æˆ·è‡ªå®šä¹‰çš„åŸºäº bridge é©±åŠ¨çš„ç½‘ç»œå¯¹äºå•ä¸»æœºçš„å°å‹ç½‘ç»œç®¡ç†ç¯å¢ƒæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä½†æ˜¯å¯¹äºå¤§å‹çš„ç½‘ç»œç¯å¢ƒç®¡ç†ï¼ˆå¦‚é›†ç¾¤ï¼‰å°±éœ€è¦è€ƒè™‘ä½¿ç”¨è‡ªå®šä¹‰çš„ overlay é›†ç¾¤ç½‘ç»œã€‚ 2ï¼‰Overlay network in swarm mode åœ¨ Docker Swram é›†ç¾¤ç¯å¢ƒä¸‹å¯ä»¥åˆ›å»ºåŸºäº Overlay é©±åŠ¨çš„è‡ªå®šä¹‰ç½‘ç»œã€‚ä¸ºäº†ä¿è¯å®‰å…¨æ€§ï¼ŒSwarmé›†ç¾¤ä½¿è‡ªå®šä¹‰çš„ overlay ç½‘ç»œåªé€‚ç”¨äºéœ€è¦æœåŠ¡çš„é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ï¼Œè€Œä¸ä¼šå¯¹å¤–éƒ¨å…¶ä»–æœåŠ¡æˆ–è€… Docker ä¸»æœºå¼€æ”¾ã€‚ mark 3ï¼‰Custome network plugins äº†è§£å³å¯ è‡ªå®šä¹‰ bridge ç½‘ç»œå¹¶å¯åŠ¨å®¹å™¨åˆ›å»ºç½‘ç»œï¼šdocker network create â€“driver é©±åŠ¨å ç½‘ç»œå --driverï¼šå¯çœç•¥ä¸º -dï¼Œç”¨äºæŒ‡å®šç½‘ç»œé©±åŠ¨ç±»å‹ã€‚ åˆ›å»ºä¸€ä¸ªåŸºäº bridge é©±åŠ¨çš„åä¸º isolated_nw çš„ç½‘ç»œï¼š1docker network create --driver bridge isolated_nw æŸ¥çœ‹æ˜¯å¦åˆ›å»ºæˆåŠŸï¼šdocker network ls æŸ¥çœ‹ç½‘ç»œè¯¦æƒ…ï¼šdocker network inspect ç½‘ç»œID è‡ªå®šä¹‰ç½‘ç»œåˆ›å»ºæˆåŠŸä¹‹åï¼Œä½¿ç”¨è¯¥ç½‘ç»œå¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼šdocker run -d â€“network=isolated_nw centos æŸ¥çœ‹å®¹å™¨ç½‘ç»œç»†èŠ‚ï¼šdocker inspect bb68248d7f847b7302 ç»™æ­£åœ¨è¿è¡Œçš„å®¹å™¨æ–°å¢ç½‘ç»œï¼šdocker network connect ç½‘ç»œå å®¹å™¨IDç»™åˆšåˆšä»¥ isolated_nw è¿æ¥çš„å®¹å™¨å†è¿æ¥ä¸€ä¸ªé»˜è®¤ç½‘ç»œï¼š 1docker network connect birdge bb68248d7f847b7302 æ­¤æ—¶ centos å®¹å™¨å·²è¿æ¥åˆ°ä¸¤ä¸ªç½‘ç»œç¯å¢ƒï¼š æ–­å¼€å®¹å™¨ç½‘ç»œè¿æ¥ï¼šdocker disconnect ç½‘ç»œå å®¹å™¨ID åˆ é™¤è‡ªå®šä¹‰ç½‘ç»œï¼šdocker network rm ç½‘ç»œå PSï¼šåˆ é™¤ä¹‹å‰ï¼Œéœ€è¦æ–­å¼€æ‰€æœ‰ä¸è¯¥ç½‘ç»œè¿æ¥çš„å®¹å™¨ å®¹å™¨ä¹‹é—´çš„ç½‘ç»œé€šä¿¡æ­¥éª¤ï¼š åˆ›å»ºä¸¤ä¸ªå®¹å™¨ï¼Œå‡è¿æ¥è‡³é»˜è®¤ç½‘ç»œ åˆ›å»ºç¬¬ä¸‰ä¸ªå®¹å™¨ï¼Œè¿æ¥æ–°å»ºç½‘ç»œï¼šisolated_nw ç»™ç¬¬äºŒä¸ªå®¹å™¨å¢åŠ ä¸€ä¸ªç½‘ç»œç¯å¢ƒï¼šisolated_nw æµ‹è¯•å®¹å™¨1èƒ½å¦ ping é€šå®¹å™¨2ã€3 æµ‹è¯•å®¹å™¨2èƒ½å¦ ping é€šå®¹å™¨1ã€3 æµ‹è¯•å®¹å™¨3èƒ½å¦ ping é€šå®¹å™¨1ã€2 12345678910# docker run -itd --name=container1 centos# docker run -itd --name=container2 centos# docker run -itd --name=container3 --network=isolated_nw centos# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES803165d19df0 centos \"/bin/bash\" 3 seconds ago Up 2 seconds container3fc4210dba15c centos \"/bin/bash\" About a minute ago Up About a minute container1d465908beb23 centos \"/bin/bash\" About a minute ago Up About a minute container2------------------------------------------------------------# docker network connect isolated_nw container2 åˆ†åˆ«æŸ¥çœ‹ä¸‰ä¸ªå®¹å™¨è¯¦æƒ…ï¼š container1 container2 container3 åˆ†åˆ«è¿›å…¥ä¸‰ä¸ªå®¹å™¨æŸ¥çœ‹IPï¼š container1 container2 container3 å¯ä»¥çœ‹åˆ°ï¼Œå®¹å™¨2ç”±äºè¿æ¥äº†ä¸¤ä¸ªç½‘ç»œå†…éƒ¨æœ‰ä¸¤ä¸ªç½‘å¡ï¼Œipåˆ†åˆ«å¯¹åº”ä¸º 172.17.0.2 å’Œ 172.18.0.3 æµ‹è¯•è¿é€šæ€§ container1 ping container2ã€container3: container2 ping container1ã€container3: container3 ping container1ã€container2: é€šè¿‡ä¸Šé¢çš„æµ‹è¯•å¾—å‡ºç»“è®ºï¼š ä¸åŒçš„å®¹å™¨ä¹‹é—´æƒ³è¦äº’ç›¸é€šä¿¡å¿…é¡»åœ¨åŒä¸€ä¸ªç½‘ç»œç¯å¢ƒä¸‹ã€‚ ä½¿ç”¨é»˜è®¤çš„ bridge ç½‘ç»œçš„å®¹å™¨å¯ä»¥äº’ç›¸ä¹‹é—´ä½¿ç”¨å®¹å™¨IPé€šä¿¡ï¼Œä½†æ˜¯æ— æ³•é€šè¿‡å®¹å™¨åç§°äº’ç›¸é€šä¿¡ã€‚ ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œç®¡ç†çš„å®¹å™¨å¯ä»¥åŒæ—¶ä½¿ç”¨å®¹å™¨IPå’Œå®¹å™¨åç§°è¿›è¡Œäº’è”ã€‚ TIPSï¼šä½¿ç”¨å‘½ä»¤è¡Œå‚æ•° â€“link é€šè¿‡å®¹å™¨åç§°è¿›è¡Œé€šä¿¡å¦‚ï¼šdocker run -it â€“name=container4 â€“link container1:c1 centosä»¥ä¸Šå‘½ä»¤æ„æ€ä¸ºä¸å®¹å™¨1é€šä¿¡å¹¶ç»™å®¹å™¨1åˆ†é…ä¸€ä¸ªåˆ«åc1 ä¸å»ºè®®ä½¿ç”¨ â€“link å‚æ•°ï¼Œåœ¨æœªæ¥å¯èƒ½ä¼šåºŸå¼ƒæ­¤å‚æ•°ã€‚ä½†æ˜¯å¯¹äºé»˜è®¤ç½‘ç»œè¿æ¥æ–¹å¼çš„å®¹å™¨ä¹‹é—´åªèƒ½é€šè¿‡ â€“link æŒ‡å®šå®¹å™¨åè¿æ¥åˆ°å…¶ä»–å®¹å™¨ã€‚è™½ç„¶é»˜è®¤ç½‘ç»œæ–¹å¼ä¸‹å¯ä»¥é€šè¿‡å®¹å™¨IPè¿æ¥ï¼Œä½†æ˜¯å®¹å™¨IPæ˜¯å¯å˜çš„ã€‚æœ€å¥½çš„æ–¹å¼æ˜¯è‡ªå®šä¹‰ç½‘ç»œè¿æ¥ï¼Œæ—¢å¯ä»¥é€šè¿‡å®¹å™¨IPã€å®¹å™¨åäº’è”ï¼Œåˆä¿è¯äº†å®‰å…¨æ€§ã€‚","link":"/2019/05/12/Docker è¡¥æ•‘æŒ‡å—ï¼ˆäºŒï¼‰â€”â€” ç½‘ç»œç®¡ç†/"},{"title":"First Post","text":"ç¬¬ä¸€ç¯‡ï¼Œå¿ƒæƒ…å´ä¸æ˜¯å¾ˆå¥½ã€‚ &emsp;&emsp;èµ·åˆåªæ˜¯å®¤å‹ä¸ç»æ„é—´çš„ä¸€å¥è¯ï¼Œè¯´ï¼šæŸæŸäººç°åœ¨åœ¨è‡ªå­¦ï¼Œè¿˜å‚åŠ äº†å­¦æ ¡çš„è½¯ä»¶æ¯æ¯”èµ›ï¼Œè¿˜æŠ¥åäº†åŸ¹è®­ç­ï¼Œè¯´åº”è¯¥å­¦çš„æ¯”æˆ‘è¿˜è¦å¥½çš„å¤šäº†ã€‚å½“æ—¶å¬å®Œå¿ƒé‡ŒæŒºä¸èˆ’æœçš„ï¼Œæƒ³è¯´ç‚¹ä»€ä¹ˆè¯æ˜è‡ªå·±æ¥æ€¼ä»–ï¼Œä¸è¿‡è¿˜æ˜¯ç®—äº†ï¼Œæ¯•ç«Ÿæˆ‘ä»¬å…³ç³»è¿˜ä¸é”™ï¼Œæ²¡å¿…è¦ä¸ºäº†è¿™ç‚¹å°äº‹ä¼¤äº†å’Œæ°”æ˜¾å¾—è‡ªå·±å¤šå°æ°”çš„æ ·å­ï¼Œæˆ‘çŸ¥é“å’Œä»–è¾©è§£æ²¡æœ‰ç”¨ï¼Œæˆ‘ä¹Ÿä¸æƒ³æ€ªä»–ä»€ä¹ˆï¼Œæ¯•ç«Ÿè½¯ä»¶è¿™ä¸ªä¸“ä¸šåªæœ‰è‡ªå·±çœŸå¿ƒæŠ•å…¥äº†æ‰çŸ¥é“è¿‡ç¨‹çš„è‰°è¾›ã€‚å¯æ˜¯ä»Šå¤©è¿™ç§æƒ…å†µè®©æˆ‘æœ‰ç‚¹è«åçš„å¿ƒé…¸â€¦ &emsp; &emsp;å’Œå¾€å¸¸ä¸€æ ·ä¸€èµ·åƒå®Œä¸­åˆé¥­å›æ¥ï¼Œè·¯ä¸Šçœ‹åˆ°ä»–çš„è®¸å¤šåŒå­¦å»ä¸Šè¯¾ã€‚è¯´ç‚¹é¢˜å¤–çš„ï¼šå¤§äºŒäº†ï¼Œè¿™åƒåœ¾å­¦æ ¡çŸ¥é“è‡ªå·±æ•™å­¦æ°´å¹³ä¸è¡Œå’ŒåŸ¹è®­æœºæ„åˆä½œæ€‚æ¿åŒå­¦ä»¬å»åŸ¹è®­ï¼ŒåŸ¹è®­è¿˜å¾—è‡ªå·±å‡ºé’±ã€‚åŸ¹è®­è€å¸ˆæŠ“ä½å¤§å¤šæ•°äººçš„æ™®éå¿ƒç†è®©ä»–ä»¬é†’æ‚Ÿè¿‡æ¥è§‰å¾—ç°åœ¨å¼€å§‹å­¦ä¹ ï¼Œå››ä¸ªæœˆåè½»è½»æ¾æ¾å°±å¯ä»¥å­¦åˆ°æ‰€æœ‰æŠ€æœ¯ç‚¹ï¼Œç„¶ååç€åŠå…¬å®¤æ‹¿é«˜è–ªï¼Œæ•²ç€å°ä»£ç ï¼Œå–ç€ä¸‹åˆèŒ¶ï¼Œè¿‡ç€è½»è½»æ¾æ¾çš„ç”Ÿæ´»ï¼Œå¥½ä¸æƒ¬æ„â€¦ ä¸€ä¸ªä¸ªç§¯æçš„æŠ¥åå»åŸ¹è®­ä¸Šè¯¾ã€‚æˆ‘ä¸æƒ³è¯´åŸ¹è®­æœºæ„æœ‰ä»€ä¹ˆä¸å¥½ï¼Œæˆ‘è‡ªå·±è¿™ä¸¤å¹´å­¦ä¹ è¿‡æ¥çš„èµ„æ–™å¤§å¤šæ•°éƒ½æ˜¯åŸ¹è®­æœºæ„çš„ï¼Œè®ºå¸ˆèµ„åŠ›é‡è¿™åƒåœ¾å­¦æ ¡æ˜¯æ²¡å¾—æ¯”çš„ã€‚ &emsp; &emsp;å›æ¥çš„è·¯ä¸Šè‡ªç„¶çš„èŠèµ·åŸ¹è®­çš„äº‹ï¼Œè¯´ä»€ä¹ˆè®°ä¸å¤ªæ¸…ï¼Œåæ­£å­—é‡Œè¡Œé—´æ„æ€å°±æ˜¯è¯´ä»–ä»¬å¤šåŠªåŠ›ï¼Œå¤šè‡ªè§‰çš„æ ·å­ï¼Œå‘¨æœ«è¿˜ä¸€ä¸ªä¸ªå»ä¸Šè¯¾ï¼Œè¿™å°±ç®—äº†ï¼Œæ‹¿æˆ‘æ¯”è¾ƒå¹²ä»€ä¹ˆï¼å¿ƒé‡Œå‹æŠ‘çš„æƒ…ç»ªé¡¿æ—¶å¿ä¸ä½äº†ï¼Œæˆ‘è¯´æ²¡ä»€ä¹ˆäº†ä¸èµ·çš„ï¼Œä»–ä»¬è¦æ˜¯è‡ªè§‰æƒ³å­¦çš„è¯ä¹Ÿä¸ä¼šæƒ³åˆ°ç°åœ¨å»æŠ¥ç­ï¼Œå¦‚æœä¸æ˜¯å¤§äºŒåŸ¹è®­æœºæ„éš”ä¸‰å²”äº”çš„æ¥æ´—è„‘ä¼šæœ‰è¿™ä¹ˆå¤š ç„•ç„¶å¤§æ‚Ÿã€æ€ä¹ˆå°±è¦æ¯•ä¸šäº†ã€å†ä¸å­¦ä¹ æ¥ä¸åŠäº†ã€æˆ‘è¿˜ä»€ä¹ˆéƒ½æ²¡å­¦åˆ°æ€ä¹ˆæ‰¾å·¥ä½œçš„åŒå¿—ä»¬å›å¤´èµç½ªçš„å—ï¼Ÿ â€œæˆ‘è¯´æˆ‘å¤§ä¸€å…¥å­¦å°±è‡ªå­¦ Cè¯­è¨€ ä»–ä»¬åœ¨å¹²ä»€ä¹ˆâ€ï¼› â€œå¤§ä¸€ç¬¬ä¸€ä¸ªå­¦æœŸåçš„å¯’å‡è‡ªå­¦ Java ä»–ä»¬åˆåœ¨åšä»€ä¹ˆâ€ï¼› â€œå¤§ä¸€æ¯•ä¸šåçš„æš‘å‡è‡ªå­¦ WebåŸºç¡€ ä»–ä»¬åˆåœ¨å¹²ä»€ä¹ˆâ€ï¼› â€œå¤§äºŒç¬¬ä¸€ä¸ªå­¦æœŸæ¯•ä¸šçš„å¯’å‡è‡ªå­¦ J2EEæ¡†æ¶ï¼Œç»ƒä¹ é¡¹ç›®ä»–ä»¬åˆåœ¨æƒ³äº›ä»€ä¹ˆï¼â€ï¼› â€œç°åœ¨å¤§äºŒä¸‹å­¦æœŸäº†ï¼Œå¤§ä¸‰åœ¨æ ¡ä¸€ä¸ªæœˆå­¦æ ¡å°±è¦æ±‚å¿…é¡»å‡ºå»å®ä¹ äº†ï¼Œæˆ‘åœ¨å­¦ä¹ çƒ­é—¨ å¼€æºæ¡†æ¶ å·©å›ºåŸºç¡€å‚åŠ  ä¸­å›½è½¯ä»¶æ¯ æ¯”èµ›å†™é¡¹ç›®è€Œä»–ä»¬ï¼Œæ‰æƒ³èµ·æ¥çŸ¥é“è¦å­¦ä¹ äº†å—ï¼Ÿï¼â€ï¼ˆå½“ç„¶å¹¶ä¸æ˜¯è¯´æš‘å‡åªèƒ½å­¦ä¹ ï¼Œæˆ‘å¼ºè°ƒçš„æ˜¯è‡ªä¸»å­¦ä¹ çš„æ€åº¦ã€‚ï¼‰ &emsp; &emsp;â€œâ€”â€” ä»–ä»¬åœ¨å­¦ä¹ å•Šâ€ã€‚ &emsp; &emsp;å›å‘³æ·±é•¿çš„ä¸€å¥è¯ï¼Œæˆ‘ç¬‘ç¬‘ï¼Œæ²¡ä»˜å‡ºè¿‡çœŸçš„ä¸çŸ¥é“è¿‡ç¨‹çš„è‰°è¾›ï¼Œä»˜å‡ºäº†è¢«äººä¸€å¥è¯å¦å®šçš„æ„Ÿè§‰ä¹ŸçœŸæ˜¯æŒºä¸å¥½å—çš„ã€‚ç®—äº†ç®—äº†ï¼Œå®¤å‹çš„æ€§æ ¼æˆ‘çŸ¥é“ï¼Œä¸èƒ½æ€ªä»–ã€‚ &emsp; &emsp;æ˜¨å¤©é«˜è€ƒç»“æŸäº†ï¼Œæœ‰äººæ¬¢å–œæœ‰äººæ„ï¼Œä¸ç®¡æ€ä¹ˆè¯´ï¼Œä»–ä»¬éƒ½è§£æ”¾äº†ï¼Œå¿ƒä¸­çš„çŸ³å¤´ä¹Ÿç®—æ”¾ä¸‹äº†ï¼Œè¯¥æƒ³ä»€ä¹ˆåšä»€ä¹ˆï¼Œæ¯•ä¸šå‰æƒ³åšä¸èƒ½åšçš„ç°åœ¨å¯ä»¥éšç€è‡ªå·±äº†ï¼Œæ¥ä¸‹æ¥çš„å°±æ˜¯å°½äººäº‹å¬å¤©å‘½å§ã€‚çªç„¶ä¹‹é—´æ„Ÿè§‰ä¸¤å¹´è¿‡çš„å¥½å¿«ï¼Œä»¿ä½›æˆ‘çš„é«˜è€ƒå°±åœ¨æ˜¨å¤©ï¼Œè¿˜è®°å¾—é‚£å¤©æ™šä¸Šå’Œç€ç­ä¸Šçš„å‡ ä¸ªç”·ç”·å¥³å¥³å«ç€è‚–å“¥ä¸€èµ·å»å”±Kï¼Œå›æ¥åœ¨å®¾é¦†ä¸€èµ·æ‰“ç€æ‰‘å…‹ï¼Œæœ€ä¸»è¦çš„æ˜¯é‚£æ™šé¼“èµ·å‹‡æ°”è·Ÿèµ–ç€åäº†ä¸€å¹´çš„ åŒæ¡Œorå‰åæ’orå·¦å³æ–œå¯¹é¢ å¯¹çš„åŒä¸€ä¸ªå¥³ç”Ÿè¯´äº†è‡ªå·±çš„æƒ³æ³•ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘å”¯ä¸€æ²¡æœ‰æ„Ÿåˆ°é—æ†¾çš„äº‹äº†ã€‚ &emsp; &emsp;ä¸¤ä¸ªæœˆåä¸æƒ…æ„¿çš„æ¥åˆ°äº†è¿™ä¸ªåœ°æ–¹ï¼Œå’Œæˆ‘ä¸€èµ·çš„æœ‰é«˜ä¸­åŒä¸€ä¸ªç­ä¸Šå¾ˆåŠªåŠ›æå­¦ä¹ çš„è¢«è€å¸ˆçœ‹å¥½ä¹–ä¹–ç”·å­©ï¼Œä»–åŠ±å¿—è¦è€ƒä¸ŠäºŒæœ¬ï¼ˆå¯¹äºæˆ‘ä»¬å°å­¦å¼€å§‹å°±åœ¨è¿™ç§æ•™å­¦è´¨é‡ä¸é«˜ä¸€ç±»çš„å­¦æ ¡è¯»åˆ°é«˜ä¸­çš„å¹¶ä¸”å¹³è¡Œç­çš„äººæ¥è¯´ï¼Œèƒ½è€ƒä¸ŠäºŒæœ¬å·²ç»å¾ˆä¸é”™äº†ï¼‰ã€‚è™½ç„¶è€ƒçš„ä¸å¥½ï¼Œä½†æˆ‘ä»¬éƒ½æ²¡æœ‰é€‰æ‹©å¤è¯»ï¼Œå¯¹äºæˆ‘æ¥è¯´é«˜ä¸­é‚£å‡ å¹´æƒ³è¯»å´ä¸çŸ¥é“å¦‚ä½•å‘åŠ›ï¼Œä»…ä»…é ç€è€ƒä¸Šå¤§å­¦å°±è½»æ¾äº†çš„æƒ³æ³•è¯»ä¹¦é€¼è¿«è‡ªå·±å­¦ä¹ çš„é‚£ç§è¿·èŒ«ï¼Œçœ‹ä¸æ¸…é“è·¯æ„Ÿè§‰çœŸçš„éš¾ä»¥è¨€è¡¨ã€‚è¯åˆè¯´å›æ¥ï¼Œæˆ‘è¿™ä¸ªé«˜ä¸­æœ‹å‹åˆ°äº†æ–°å­¦æ ¡æˆ‘ä¸çŸ¥é“ä»–å“ªæ¥çš„ä¹è§‚å¿ƒæ€ï¼Œè®¡åˆ’ç€å¾€åçš„ä¸‰å¹´â€œå¤§å­¦ç”Ÿæ´»â€å¦‚ä½•è¿‡çš„å¤šå§¿å¤šå½©ï¼Œæä¸æ‡‚è¿™ç ´åœ°æ–¹æœ‰ä»€ä¹ˆå¥½æ†§æ†¬çš„ï¼Œæœ‰æ—¶å€™ä¹Ÿè›®æ¬£èµä»–ä»¬è¿™ç§å¿ƒæ€çš„ã€‚å¯æ˜¯æˆ‘æ»¡è„‘å­é‡Œæƒ³çš„æ˜¯ï¼Œé«˜ä¸­é˜¶æ®µä¸çŸ¥æ‰€æªçš„é‚£å‡ å¹´æˆ‘ç°åœ¨è¦ä»¥è¿™ç§æ–¹å¼è¡¥å›æ¥ï¼Œæˆ‘æ˜¯æ¥èµç½ªçš„ï¼Œæˆ‘æ„§å¯¹è‡ªå·±ï¼Œä¹Ÿæ„§å¯¹å®¶äººã€‚ &emsp; &emsp;å†›è®­åä¸Šçš„ç¬¬ä¸€é—¨ä¸“ä¸šè¯¾å« Cè¯­è¨€ç¨‹åºè®¾è®¡ ï¼Œç»™æˆ‘ä»¬ä¸Šè¯¾çš„è€å¸ˆæ˜¯ä¸€ä¸ªå®ä¹ ç”Ÿï¼ŒæIOSå¼€å‘çš„ï¼Œå…¼èŒæ¥ç»™æˆ‘ä»¬ä¸Šè¯¾ã€‚ä¸€ä¸ªç¤¼æ‹œä¸€èŠ‚ä¸“ä¸šè¯¾ï¼Œå¥½å……å®çš„å‘¢ï¼ŒMDã€‚å­¦æ ¡çš„åˆè¡·æ˜¯è®©æˆ‘ä»¬æ¥è§¦è®¡ç®—æœºè¯­è¨€çš„æ€æƒ³ï¼Œå­—èŠ‚å•Šã€å˜é‡å¸¸é‡å•Šã€è¯­å¥å•Šã€åŸºæœ¬æ•°æ®ç»“æ„å•Šï¼ˆè™½ç„¶åªç²—ç•¥çš„æåˆ°äº†æ•°ç»„ï¼Œä»…æ­¤è€Œå·²ï¼‰ã€‚è¿™å°±ç®—äº†ï¼Œç”±äºæ˜¯ç¬¬ä¸€æ¬¡ä¸Šè¿™ç§ä¸“ä¸šè¯¾ï¼Œè§‰å¾—è€å¸ˆè®²çš„è¿˜å¯ä»¥ï¼Œä½†æ˜¯çœ‹ä¹¦çš„ç›®å½•æ€»è§‰å¾—è®²çš„å°‘äº†å¤ªå¤šå¤ªå¤šï¼Œè€å¸ˆä¹Ÿè¯´äº†æ²¡æƒ³è¿‡ç»™æˆ‘ä»¬è®²å¤ªå¤šï¼Œå½“æ—¶æˆ‘å°±ä¸ä¹æ„äº†ï¼Œæˆ‘TMæ˜¯æ¥èµç½ªçš„ä½ ç»™æˆ‘è®²è¿™ä¹ˆç‚¹æˆ‘æ€ä¹ˆå­¦ä¹ çŸ¥è¯†ï¼äºæ˜¯æˆ‘å¼€å§‹æ¥è§¦ç½‘ç»œå­¦ä¹ ï¼Œæœ€å¼€å§‹ä¸‹è½½äº† ç½‘æ˜“äº‘è¯¾å ‚ åœ¨é‡Œé¢çœ‹åˆ°é‚µå‘è€å¸ˆçš„ C/C++å­¦ä¹ æŒ‡å—ï¼Œçœ‹äº†æœ‰170å¤šä¸ªè¯¾æ—¶ï¼Œå¼€å§‹å¬äº†å‡ èŠ‚ï¼Œè§‰å¾—è¿™ä¸ªè€å¸ˆå¾ˆæœ‰é£æ ¼ï¼Œç”±æµ…å…¥æ·±å¹¶ä¸”è®²çš„å¾ˆå¥½å¾ˆå¥½ï¼Œå½“æ—¶ä¸çŸ¥é“å“ªæ¥çš„æ¯…åŠ›å†³å®šäº†æŠŠè¿™ä¸ªè¯¾ç¨‹å…¨éƒ¨æå®Œã€‚æ¯å¤©çœ‹è§†é¢‘å½“è¿ç»­å‰§ä¸€æ ·çœ‹ï¼Œç¡è§‰ä¹‹å‰é†’æ¥ä¹‹åéƒ½æ˜¯è§†é¢‘ï¼Œä¹°äº†ä½œè€…çš„ä¹¦ç±ï¼Œåœ¨çº¿ç»ƒä¹ é¢˜ä¹Ÿå…¨éƒ¨è‡ªå·±è®¤çœŸç»ƒä¹ å¹¶ä¸”æ•´ç†æˆé”™é¢˜ï¼ˆé«˜ä¸­å…»æ¥çš„ä¹ æƒ¯ï¼‰ã€‚å°±ä¸çŸ¥ä¸è§‰åŸ¹å…»äº†æˆ‘å¯¹ç¼–ç¨‹çš„å…´è¶£ã€‚ç°åœ¨æƒ³æƒ³è¿™éƒ½æ˜¯ç¼˜åˆ†ï¼Œå¦‚æœä¸æ˜¯è¿™ä¸ªè¯¾ç¨‹å¯¹æˆ‘çš„å½±å“æˆ–è®¸æˆ‘å’Œå¤§å¤šæ•°åœ¨æ ¡ç”Ÿä¸€æ ·è¿·èŒ«æŠŠï¼ &emsp; &emsp;åæ¥çš„å­¦ä¹ è¿‡ç¨‹å°±ä¸è¯´äº†ï¼Œæ— æ•°æ¬¡é‡åˆ°å›°éš¾ï¼Œç”±äºè¿›åº¦æ¯”å­¦æ ¡éƒ½è¦å¿«ï¼Œæ²¡äººå¸®æˆ‘ï¼Œåªèƒ½è‡ªå·±ç™¾åº¦æŸ¥èµ„æ–™ç¿»åšå®¢ï¼Œä¹…è€Œä¹…ä¹‹æˆ‘è§‰å¾—ç½‘ä¸Šçš„èµ„æºæ¯”åœ¨æ ¡è€å¸ˆå®ç”¨çš„å¤šï¼Œé‡åˆ°è¿‡æ‰‹è´±ã€ç¯å¢ƒã€è¯­æ³•ã€é€»è¾‘ç­‰å„ç§æ— å˜å¤´çš„é”™è¯¯ï¼Œä½†æ˜¯ä»æ¥æ²¡æƒ³åˆ°è¿‡æ”¾å¼ƒã€‚æœ€è¿‘æ—¥å¸¸è§£å†³bugçœ‹åˆ°ç½‘ä¸Šä¸€ä¸ªå¦¹å­çš„åšå®¢ç®€ä»‹æ˜¯ï¼šä»å“ªé‡Œè·Œå€’ï¼Œå°±åœ¨é‚£é‡Œè¶´ä¸‹ï¼Œèµ·æ¥ä¹‹åä½ ä¼šå‘ç°æ–°å¤§é™†çš„ã€‚ è¿™å¥è¯å†™çš„çœŸçš„ä¸é”™ï¼Œæ·±æœ‰ä½“ä¼šï¼Œbug fix ä¹‹åçš„å–œæ‚¦æ„ŸçœŸçš„åªæœ‰è‡ªå·±ç»å†è¿‡æ‰çŸ¥é“ã€‚ &emsp; &emsp;å°±è¿™æ ·æˆ‘å¸¦ç€ä¸ç”˜å¿ƒçš„æƒ…ç»ªå­¦ä¹ åˆ°äº†ç°åœ¨ï¼Œè®°å¾—å…¥å­¦åæˆ‘å‘çš„ç¬¬ä¸€æ¡æœ‹å‹åœˆæ˜¯ æ—¢ç„¶å½“ä¸äº†é¸¡å¤´ï¼Œå°±äº‰å–åšåˆ°å‡¤å°¾ã€‚ è¯­æ–‡æ°´å¹³ä¸å¥½åªèƒ½è¯´æˆè¿™æ ·äº†ï¼Œä¸è¿‡æˆ‘ç¡®å®ä¹Ÿåšåˆ°äº†ï¼Œæœ€èµ·ç åœ¨ç­ä¸Šä¸“ä¸šä¸Šæ¥è¯´ï¼Œæˆ‘è§‰å¾—è‡ªå·±æ°´å¹³ç¬¬äºŒæ²¡äººæœ‰è‡ªä¿¡è¯´ç¬¬ä¸€ï¼Œä¸è¿‡å’Œä»–ä»¬æ¯”ä¸“ä¸šè¿™æ¯«æ— æ„ä¹‰ã€‚å½“ç„¶ä¸èƒ½è‡ªå¤§ï¼Œé™¤äº†å­¦ä¹ æ–¹é¢æˆ‘è¿˜æœ‰å¾ˆå¤šæ–¹é¢éœ€è¦å‘ä»–ä»¬å­¦ä¹ ã€‚ &emsp; &emsp;ä¸¤å¹´è¿‡æ¥ï¼Œç»“è¯†äº†å…¶ä»–ç­ä¸Šå¾ˆå¤šå¿—åŒé“åˆçš„æœ‹å‹ï¼Œå­¦ä¹ åˆ°äº†å¾ˆå¤šï¼Œè®¤è¯†åˆ°è‡ªå·±çš„ä¸è¶³ï¼Œå³å°†æ­¥å…¥æ‰¾å·¥ä½œçš„æµªæ½®ï¼Œå‹åŠ›å¾ˆå¤§ï¼Œä»»åŠ¡å¾ˆé‡ï¼Œè¦å­¦çš„å¾ˆå¤šï¼Œæˆ‘ä¼šç»§ç»­åŠªåŠ›ã€‚ &emsp; &emsp;è¯´äº†è¿™ä¹ˆå¤šï¼Œæ°”ä¹Ÿæ¶ˆäº†ï¼Œæƒ³æƒ³ä¹Ÿæ²¡å¿…è¦ï¼Œåšå¥½è‡ªå·±å°±è¡Œäº†ä½•å¿…åœ¨æ„åˆ«äººæ€ä¹ˆçœ‹å‘¢ã€‚æ›¾ç»æ˜¯æ–‡ç§‘ç”Ÿï¼Œä½†æ˜¯æœ¬èº«å¾ˆæ¶å¿ƒé¸¡æ±¤ï¼Œä»æ¥ä¸æƒ³è®°å½•ä»€ä¹ˆï¼Œç”Ÿæ´»é‡è¦çš„æ˜¯è¿‡ç¨‹ï¼Œä¹Ÿæ²¡ä»€ä¹ˆæ–‡é‡‡ï¼Œå†™ç»™è‡ªå·±çœ‹çš„ã€‚ &emsp; &emsp;â€”â€” å°±è¿™æ ·ã€‚ &emsp; &emsp; &emsp; &emsp; &emsp; &emsp; &emsp; &emsp; &emsp; &emsp;","link":"/2018/06/09/First Post/"},{"title":"Hexoè¿ç§»è‡³Docker","text":"ä¸€ã€æœ¬åœ°è¿ç§»ä¸€ï¼‰å°†ä¹‹å‰çš„åšå®¢åœ°å€æ ¹æ–‡ä»¶å¤¹æ‹·è´ä¸€ä»½å¤åˆ¶åˆ°æŒ‡å®šä½ç½®ï¼Œç”¨ä½œ\bä¸å®¹å™¨å…±äº«çš„æ•°æ®å·ã€‚ 1234567~/Workspace/docker-hexo $ pwd/Users/harry/Workspace/docker-hexo~/Workspace/docker-hexo $ lltotal 8-rw-r--r--@ 1 harry staff 482B Jun 17 17:10 Dockerfiledrwxr-xr-x@ 15 harry staff 480B Jun 17 17:19 harrys-blog # æ ¹ç›®å½•~/Workspace/docker-hexo $ äºŒï¼‰\bç¼–å†™ Dockerfile è„šæœ¬ï¼Œæ„å»ºé•œåƒã€‚ docker build -f Dockerfile -t harrys-blog:latest . 12345678910111213141516171819202122FROM centosMAINTAINER harry&lt;yuzh233@gmail&gt;EXPOSE 4000RUN cd / &amp;&amp; mkdir docker-hexo &amp;&amp; cd docker-hexoWORKDIR /docker-hexo# install latest nodeRUN yum install -y gcc-c++ make \\&amp;&amp; curl -sL https://rpm.nodesource.com/setup_12.x | bash - \\&amp;&amp; yum -y install nodejs \\&amp;&amp; node -v# install gitRUN yum -y install git \\&amp;&amp; git --version# install hexoRUN npm install -g hexo-cli# CMD [\"sh\",\"-c\",\"hexo g &amp;&amp; hexo s\"]ENTRYPOINT [\"sh\",\"-c\",\"cd /harrys-blog &amp;&amp; hexo g &amp;&amp; hexo s\"] ä¸‰ï¼‰è¿è¡Œå®¹å™¨ï¼ŒæŒ‡å®šæ•°æ®å·æ–‡ä»¶è·¯å¾„ docker run -d -p 4000:4000 -v ~/Workspace/docker-hexo/harrys-blog/:/harrys-blog harrys-blog:latest äºŒã€è¿ç§»åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸€ï¼‰åˆ›å»ºé˜¿é‡Œäº‘ç§æœ‰ä»“åº“å¹¶æ¨é€é•œåƒ 123$ sudo docker login --username=yuzh233 registry.cn-hangzhou.aliyuncs.com$ sudo docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/yuzh/harrys-blog:[é•œåƒç‰ˆæœ¬å·]$ sudo docker push registry.cn-hangzhou.aliyuncs.com/yuzh/harrys-blog:[é•œåƒç‰ˆæœ¬å·] äºŒï¼‰ä½¿ç”¨ source copy ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨\b 1scp hexo.gz root@120.78.69.82:/hexo.gz ä¸‰ï¼‰è¿è¡Œå®¹å™¨ï¼ŒæŒ‡å®šæ•°æ®å·æ–‡ä»¶è·¯å¾„ docker run -d -v ~/harrys-blog:/harrys-blog -p 4000:4000 registry.cn-hangzhou.aliyuncs.com/yuzh/harrys-blog å››ï¼‰è¿è¡Œ nginx å®¹å™¨ï¼Œå°†å…¶ä¸­ /etc/nginx ç›®å½•æ‹·è´åˆ°å®¿ä¸»æœºï¼Œåœæ­¢å®¹å™¨ äº”ï¼‰è¿è¡Œä¸€ä¸ªæ–°çš„å®¹å™¨ï¼ŒæŒ‚è½½æœ¬åœ° nginx é…ç½®åˆ°å®¹å™¨ä¸­ docker run -d -p 80:80 -v ~/nginx-container-config/:/etc/nginx nginx nginx.conf: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859user nginx;worker_processes 1;error_log /var/log/nginx/error.log warn;pid /var/run/nginx.pid;events { worker_connections 1024;}http { include /etc/nginx/mime.types; default_type application/octet-stream; log_format main '$remote_addr - $remote_user [$time_local] \"$request\" ' '$status $body_bytes_sent \"$http_referer\" ' '\"$http_user_agent\" \"$http_x_forwarded_for\"'; access_log /var/log/nginx/access.log main; sendfile on; #tcp_nopush on; keepalive_timeout 65; #gzip on; include /etc/nginx/conf.d/*.conf; upstream hexo { server 120.78.69.82:4000; } server { # é»˜è®¤ç›‘å¬80ç«¯å£ï¼Œè¿™æ ·å°±ä¸éœ€è¦æŒ‡å®šç«¯å£è®¿é—®ã€‚ listen 80;# listen 443; # ç”¨æˆ·è®¿é—®æ—¶çš„åŸŸåã€‚ server_name yuzh.xyz;# ssl on;listen 443 ssl; ssl_certificate cert/yuzh.xyz.pem; ssl_certificate_key cert/yuzh.xyz.key; ssl_session_timeout 5m; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4; #ä½¿ç”¨æ­¤åŠ å¯†å¥—ä»¶ã€‚ ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #ä½¿ç”¨è¯¥åè®®è¿›è¡Œé…ç½®ã€‚ ssl_prefer_server_ciphers on; location / { # nginxé€šè¿‡å‰é¢çš„ hexo è½¬å‘åˆ°æŒ‡å®šçš„ç½‘ç«™ï¼Œè®¿é—® hexo å°±æ˜¯è®¿é—® 120.78.69.82:4000 proxy_pass http://hexo; index index.html index.htm; } }}","link":"/2019/06/18/Hexoè¿ç§»è‡³Docker/"},{"title":"IDEA+Maven+Tomcatæ’ä»¶å®ç°çƒ­éƒ¨ç½²","text":"å‚»äº†å§å”§çš„å…¶å®ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ï¼Œä½†æ˜¯è¿™å‡ å¤©è„‘å­æœ‰ç‚¹æ··ä¹±ï¼Œæƒ…ç»ªå¾ˆä½è¿·ï¼Œæå¾—è‡ªå·±å¾ˆéƒé—·ã€‚ğŸ˜”åˆ‡è®°æˆ’éª„æˆ’èºï¼Œé‡åˆ°é—®é¢˜ä¸è¦å¿ƒæ€¥ï¼Œé™ä¸‹å¿ƒæ¥ï¼Œä½›ç³»è°ƒbug~~ğŸ˜µ ä¸€ç›´éƒ½æŠŠçƒ­éƒ¨ç½²çš„æ¦‚å¿µæé”™äº†ï¼Œçƒ­éƒ¨ç½²æ˜¯æŒ‡é¡¹ç›®å‘å¸ƒåˆ°æœåŠ¡å™¨ä¹‹åï¼Œä»¥ä¸é‡å¯æœåŠ¡å™¨ä¸ºå‰ææœ¬åœ°é‡æ–°æ‰“åŒ…å‘å¸ƒåˆ°æœåŠ¡å™¨ä¸Šé¢è¿è¡Œã€‚ è¯´èµ·æ¥å¾ˆå¥½ç†è§£ï¼Œä½†æ˜¯æœ¬åœ°tomcatçƒ­éƒ¨ç½²å’ŒMavençš„Tomcatæ’ä»¶çƒ­éƒ¨ç½²è¿˜æ˜¯æœ‰äº›åŒºåˆ«çš„ï¼Œä¸€ç›´æ²¡èµ°å‡ºè¿™ä¸ªè¯¯åŒºï¼Œé™ä¸‹å¿ƒæ¥æƒ³ä¸‹çœŸå‚»ğŸ˜” Tomcatæœ¬åœ°çƒ­éƒ¨ç½²æœ¬åœ°å¯åŠ¨æœåŠ¡å™¨ï¼Œæœ¬åœ°é‡æ–°æ‰“åŒ…å‘å¸ƒï¼Œrunå’Œredeployæ˜¯åŒä¸€ä¸ªå·¥å…·æœ¬åœ°å¯åŠ¨tomcatæœåŠ¡ï¼Œä¸é‡å¯æœåŠ¡å™¨çš„å‰æä¸‹æ›´æ–°waråŒ…èµ„æºã€‚é…ç½®å¾ˆç®€å•å½“éœ€è¦æ›´æ–°èµ„æºæ—¶ç‚¹å‡»å³ä¸Šè§’é€‰æ‹©redeployé‡æ–°å‘å¸ƒå³å¯ã€‚ Maven+Tomcatæ’ä»¶çƒ­éƒ¨ç½²ä¸ä¸€å®šæ˜¯æœ¬åœ°å¯åŠ¨æœåŠ¡å™¨ï¼Œæœ¬åœ°é‡æ–°æ‰“åŒ…å‘å¸ƒï¼Œrunå’Œredeployä¸æ˜¯åŒä¸€ä¸ªå·¥å…· ææ¸…åŸç†ï¼Œçƒ­éƒ¨ç½²ä¸»è¦çš„ä½œç”¨æ˜¯åœ¨ä¸å…³é—­æœåŠ¡å™¨çš„æ—¶å€™æ·»åŠ æˆ–ä¿®æ”¹é¡¹ç›®ï¼Œtomcatå¿…é¡»è¦å¼€ç€ï¼Œå¹¶ä¸”ä¿è¯èƒ½è®¿é—®manageræ‰‹åŠ¨ç®¡ç†é‡Œé¢çš„é¡¹ç›®ã€‚ å°±æ˜¯è¯´æ’ä»¶çƒ­éƒ¨ç½²æœ‰ä¸€ä¸ªå‰æï¼Œå°±æ˜¯æœåŠ¡å™¨å·²ç»åœ¨è¿è¡Œï¼Œmavençš„tomcatæ’ä»¶ä¸è´Ÿè´£å¯åŠ¨æœåŠ¡å™¨ï¼Œåªæ˜¯è´Ÿè´£é‡æ–°å‘å¸ƒåˆ°æŒ‡å®šçš„æœåŠ¡å™¨èµ„æºä¸­ï¼ˆè¿œç¨‹æœåŠ¡å™¨ï¼‰ã€‚ ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹tomcatçš„conf/tomcat-users.xmlé…ç½®æ–‡ä»¶ã€‚æ³¨æ„ï¼šè¯¥tomcatæ˜¯åœ¨æœ¬åœ°è™šæ‹Ÿæœºä¸­çš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æœ¬åœ°winå¼€ä¸€ä¸ªæ·»åŠ ç”¨æˆ·åã€å¯†ç ã€æƒé™ã€‚ 123&lt;role rolename=\"manager-gui\" /&gt;&lt;role rolename=\"manager-script\" /&gt;&lt;user username=\"admin\" password=\"admin\" roles=\"manager-gui, manager-script\"/&gt; ç„¶å å¯åŠ¨Tomcat ï¼Œé€šè¿‡CMDæˆ–æ‰¹å¤„ç†å‘½ä»¤æˆ–å…¶ä»–å·¥å…·å¯åŠ¨ï¼Œä¸è¦ç”¨Tomcatæ’ä»¶å¯åŠ¨å°±è¡Œã€‚æ­¤æ—¶å·²ç»å¯ä»¥é€šè¿‡è®¿é—® http://192.168.184.130:8080/manager/text è¿›å…¥tomcatçš„ç®¡ç†é¡µé¢å‘å¸ƒéƒ¨ç½²é¡¹ç›®äº†ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸ä¼šè¿™ä¹ˆåšï¼Œæˆ‘ä»¬ä½¿ç”¨tomcatæ’ä»¶è¿›è¡Œçƒ­éƒ¨ç½²ã€‚ ç¬¬äºŒæ­¥ï¼šé…ç½®mavenå’Œtomcatå…³è”å…³ç³»mavenå½“ç„¶æ˜¯åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒäº†è´¦å·å¯†ç åŒä¸Šé…ç½®ï¼Œåœ¨mavenå®‰è£…ç›®å½•ä¸­çš„settings.xmlä¸­é…ç½®ã€‚ 1234567&lt;!-- åœ¨&lt;servers&gt;èŠ‚ç‚¹ä¸‹æ·»åŠ  --&gt;&lt;server&gt; &lt;!-- é…ç½®æœåŠ¡å™¨åï¼Œmavenæ’ä»¶éœ€è¦å¼•ç”¨è¯¥æ’ä»¶å --&gt; &lt;id&gt;tomcat7&lt;/id&gt; &lt;username&gt;admin&lt;/username&gt; &lt;password&gt;admin&lt;/password&gt;&lt;/server&gt; ç¬¬ä¸‰æ­¥ï¼špomå¼•å…¥æ’ä»¶1234567891011121314151617181920&lt;build&gt; &lt;plugins&gt; &lt;!-- é…ç½®Tomcatæ’ä»¶ --&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt; &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.2&lt;/version&gt; &lt;configuration&gt; &lt;path&gt;/hotDeploy&lt;/path&gt; &lt;port&gt;8080&lt;/port&gt; &lt;!-- ç”¨äºé…ç½®çƒ­éƒ¨ç½² --&gt; &lt;url&gt;http://192.168.184.130:8080/manager/text&lt;/url&gt; &lt;server&gt;tomcat7&lt;/server&gt; &lt;username&gt;admin&lt;/username&gt; &lt;password&gt;admin&lt;/password&gt; &lt;update&gt;true&lt;/update&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; ç¬¬å››æ­¥ï¼šé…ç½®å¥½å¼•ç”¨æœ¬åœ°mavençš„settingæ–‡ä»¶ ç¬¬äº”æ­¥ï¼šé‡æ–°æ‰“åŒ…å‘å¸ƒï¼Œå®ç°çƒ­éƒ¨ç½²tomcatå·²ç»å¯åŠ¨äº†ï¼Œè¿™é‡Œåªé‡æ–°æ‰“åŒ…å‘å¸ƒ.å‘½ä»¤ï¼štomcat7:deploy å‘å¸ƒæˆåŠŸï¼š å¯ç®—æŠŠè¿™ä¸ªææ¸…æ¥šäº†~","link":"/2018/07/29/IDEA-Maven-Tomcatæ’ä»¶å®ç°çƒ­éƒ¨ç½²/"},{"title":"Linuxä¸‹æ­å»ºHexoåšå®¢ç¯å¢ƒ","text":"Linuxä¸‹æ­å»ºHexoåšå®¢ç¯å¢ƒ å‰ä¸ä¹…åœ¨è‡ªå·±ç”µè„‘ä¸Šæ­å»ºäº†åŸºäº Github+Hexo çš„ä¸ªäººåšå®¢ï¼Œä»Šå¤©è¯•ç€åœ¨Linuxä¸‹æ­å»ºhexoç¯å¢ƒå¹¶é€šè¿‡åŸŸåè§£ææœ¬åœ°IPè¿è¡Œèµ·æ¥ã€‚åˆšå¥½å‰å‡ å¤©åœ¨é˜¿é‡Œäº‘ä¹°äº†ECSäº‘æœåŠ¡å™¨å’ŒåŸŸåï¼Œè¿˜ä¸æ˜¯å¾ˆç†Ÿç»ƒï¼Œä¸ç”¨ç™½ä¸ç”¨ã€‚ğŸ˜„ Steps 1 ï¼šå®‰è£…Git å®‰è£…gitä¾èµ–åŒ… 1 yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel gcc perl-ExtUtils-MakeMaker åˆ é™¤å·²æœ‰çš„git 1 yum remove git ä¸‹è½½gitæºç  åˆ‡æ¢åˆ°åŒ…æ–‡ä»¶ç›®å½•ï¼š 1 cd /usr/src ä¸‹è½½gitå®‰è£…åŒ… 1 wget https://www.kernel.org/pub/software/scm/git/git-2.8.3.tar.gz è§£å‹gitå®‰è£…åŒ… 12 tar -zxvf git-2.8.3.tar.gz cd git-2.8.3 é…ç½®gitå®‰è£…è·¯å¾„ï¼Œusrç›®å½•ä¸€èˆ¬ç”¨äºå­˜æ”¾å…±äº«çš„ç³»ç»Ÿèµ„æº 1 ./configure prefix=/usr/local/git/ ç¼–è¯‘å¹¶ä¸”å®‰è£… 1 make &amp;&amp; make install å°†gitæŒ‡ä»¤æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ 1 vi /etc/profile åœ¨æœ€åä¸€è¡ŒåŠ å…¥ 1 export PATH=$PATH:/usr/local/git/bin åˆ·æ–°é…ç½®æ–‡ä»¶ 1 source /etc/profile ç„¶åï¼ŒæŸ¥çœ‹gitç‰ˆæœ¬å· 1 git --version nextâ€¦ Steps 2 ï¼šå®‰è£…Node.jsç¯å¢ƒ å®‰è£…Node.jsä¾èµ–åŒ… 1yum -y install gcc-c++ openssl-devel æ£€æŸ¥Pythonç‰ˆæœ¬ 1python --version æ£€æŸ¥Pythonçš„ç‰ˆæœ¬ï¼Œå¿…é¡»åœ¨2.6åŠä»¥ä¸Šæ‰å¯ä»¥ï¼Œå¦‚æœä½äºè¿™ä¸ªç‰ˆæœ¬è¿˜éœ€è¦å®‰è£…Pythonï¼Œå½“å‰Centos6ç³»ç»Ÿï¼Œé»˜è®¤æ”¯æŒ2.6ã€‚ ä¸‹è½½å’Œå®‰è£…Node.jsï¼Œæ³¨æ„å…ˆåˆ°optç›®å½•ä¸‹ 12345wget http://nodejs.org/dist/node-latest.tar.gztar -zxvf node-latest.tar.gzcd node-v0.12.7./configuremake &amp;&amp; make install æˆ‘ä»¥ä¸ºæºç ç¼–è¯‘å®‰è£…åå‡ åˆ†é’Ÿå°±è¡Œäº†ï¼Œç„¶è€Œè¶³è¶³å®‰è£…äº†ä¸€ä¸ªå¤šå°æ—¶ã€‚ã€‚ã€‚ğŸ˜­ä¸è¿‡è¿˜å¥½æˆåŠŸäº†ã€‚ æ¥ä¸‹æ¥çš„æ‰æ˜¯ä¸»è§’ Steps 3ï¼š å®‰è£…Hexoç¯å¢ƒ é‡‡ç”¨npmæ–¹å¼æ¥éƒ¨ç½²hexoé™æ€åšå®¢ 1npm install -g hexo å®‰è£…æœŸé—´å‡ºç°äº†è­¦å‘Šï¼Œæœ‰ç‚¹å°ç´§å¼ ï¼Œå®‰è£…äº†è¿™ä¹ˆä¹…ä¸ä¼šå‰åŠŸå°½å¼ƒæŠŠï¼è¿˜å¥½æœ€åæˆåŠŸäº†ï¼Œè­¦å‘Šæ— æ‰€è°“äº†åªè¦ä¸æ˜¯é”™è¯¯~~ æŸ¥çœ‹hexoç‰ˆæœ¬ä¿¡æ¯ åˆ›å»ºhexoéƒ¨ç½²çš„æ–‡ä»¶å¤¹ï¼Œåˆå§‹åŒ–hexoåœ¨è¯¥ç›®å½• æˆåŠŸ å®‰è£…ä¾èµ–åŒ… 1npm install ç”Ÿæˆhexoé™æ€é¡µé¢ 1hexo generate / æˆ–è€… hexo g &nbsp;&nbsp;&nbsp;è‡³æ­¤ï¼Œhexoå·²æ­å»ºæˆåŠŸå¹¶ä¸”èƒ½å¤Ÿåœ¨æœ¬æœºï¼ˆlinuxï¼‰è®¿é—®äº†ï¼›ç„¶è€Œï¼Œè¿™é‡Œæ˜¯è¿œç¨‹è¿æ¥é˜¿é‡Œäº‘çš„ECSå®ä¾‹ï¼Œæ²¡æœ‰å›¾å½¢åŒ–ç•Œé¢æ— æ³•ä»æµè§ˆå™¨ç›´è§‚çš„çœ‹åˆ°æœåŠ¡è·‘èµ·æ¥ä¹‹åçš„é¡µé¢ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨è‡ªå·±çš„ç”µè„‘ä»å…¬ç½‘è®¿é—® http://39.106.15.140:4000 å—¯çœ‹èµ·æ¥æ˜¯è¿™æ ·å­çš„ï¼Œè¯•è¯•æŠŠâ€¦ æ— æ³•è¿æ¥æœåŠ¡å™¨ï¼Œä¸å¯¹å•Šï¼Œæˆ‘ä¸æ˜¯å¼€äº†æœåŠ¡äº†å˜›ï¼æœ‰æ¯’æŠŠ~(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†) Steps 4 ï¼š é˜¿é‡Œäº‘ECSäº‘æœåŠ¡å™¨å®‰å…¨ç»„è®¾ç½®å‘µå‘µå¤©çœŸï¼Œå¤©çœŸçš„ä»¥ä¸ºå¼€äº†æœåŠ¡å°±å¯ä»¥ä»å…¬ç½‘è®¿é—®äº†ï¼Œçœ‹çœ‹è¿™ä¸ªã€‚ ä»€ä¹ˆé¬¼ï¼Ÿè¿™æ˜¯é˜¿é‡Œäº‘å®‰å…¨ç»„è§„åˆ™åˆ—è¡¨ï¼Œç›¸å½“äºé˜²ç«å¢™ã€‚ä»åˆ—è¡¨çœ‹å‡ºå¹¶æ²¡æœ‰å¼€æ”¾hexoé»˜è®¤çš„4000ï¼Œæ‰€ä»¥å¤–ç½‘æ˜¯è®¿é—®ä¸åˆ°çš„ã€‚ æ —å­ï¼š22/22 ä»£è¡¨å¼€æ”¾ç«¯å£çš„èŒƒå›´æ˜¯22-22ï¼Œåªå¼€æ”¾22å·ç«¯å£çš„æ„æ€ï¼Œlinuxé»˜è®¤å¼€æ”¾22ç«¯å£ç”¨äºsshè¿œç¨‹ç™»é™†ï¼Œè¿™ä¹Ÿæ˜¯å¯ä»¥è¿œç¨‹XShell6ç™»é™†æˆåŠŸçš„åŸå› ã€‚ çŸ¥é“äº†åŸå› ä¸‹é¢æ·»åŠ ä¸€æ¡å®‰å…¨ç»„è§„åˆ™ æ·»åŠ ä¹‹åè®°å¾—åˆ·æ–°ï¼ ç„¶åå†æ¬¡è®¿é—®ï¼Œä¼šå‡ºç°hexoé»˜è®¤åšå®¢ç•Œé¢äº† over~ 0ç‚¹17äº†ï¼Œå¥½æ€•çŒğŸ˜µï¿½ğŸ˜µï¼Œç¡äº†ç¡äº†ã€‚ã€‚ã€‚","link":"/2018/06/15/Linuxä¸‹æ­å»ºHexoåšå®¢ç¯å¢ƒ/"},{"title":"Linuxä¸‹éƒ¨ç½²ä¸ªäººç«™ç‚¹åçš„è¿è¡Œé—®é¢˜","text":"Linuxä¸‹éƒ¨ç½²ä¸ªäººç«™ç‚¹åçš„è¿è¡Œé—®é¢˜ &nbsp;&nbsp;æ˜¨å¤©å·²ç»æŠŠä¸ªäººç«™ç‚¹éƒ¨ç½²åœ¨linuxæˆåŠŸå¹¶å¯ä»¥å‘å¸ƒè¿è¡Œï¼Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“é€€å‡ºè¿œç¨‹ç™»é™†SSHä¹‹åï¼Œhexoçš„è¿›ç¨‹ä¼šè¢«æ€æ­»å¯¼è‡´æ— æ³•è®¿é—®ï¼Œä»Šå¤©æ—©ä¸Šçœ‹äº†å‡ ç¯‡åšå®¢ä¹‹åçŸ¥é“æ€ä¹ˆå›äº‹äº†ï¼Œåšä¸€ä¸‹è®°å½•ã€‚ 1ã€è¿›ç¨‹æ€æ­»åŸå› 1.1ã€è¿›ç¨‹ä¸ä¼šè¯ è¿›ç¨‹ç»„ï¼š ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹çš„é›†åˆï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹ç»„éƒ½æœ‰å”¯ä¸€ä¸€ä¸ªè¿›ç¨‹ç»„IDï¼Œå³è¿›ç¨‹ç»„ ä¼šè¯æœŸï¼š ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ç»„çš„é›†åˆï¼Œæœ‰å”¯ä¸€ä¸€ä¸ªä¼šè¯æœŸé¦–è¿›ç¨‹ï¼ˆsession leaderï¼‰ã€‚ä¼šè¯æœŸIDä¸ºé¦–è¿›ç¨‹çš„IDã€‚ æ§åˆ¶è¿›ç¨‹: ä¸æ§åˆ¶ç»ˆç«¯ï¼ˆå¦‚sshï¼‰è¿æ¥çš„ä¼šè¯æœŸé¦–è¿›ç¨‹å«åšæ§åˆ¶è¿›ç¨‹ã€‚å½“å‰ä¸ç»ˆç«¯äº¤äº’çš„è¿›ç¨‹ç§°ä¸ºå‰å°è¿›ç¨‹ç»„ï¼Œ å…¶ä½™è¿›ç¨‹ç»„ç§°ä¸ºåå°è¿›ç¨‹ç»„ã€‚ PID = è¿›ç¨‹ID ï¼ˆç”±å†…æ ¸æ ¹æ®å»¶è¿Ÿé‡ç”¨ç®—æ³•ç”Ÿæˆï¼‰PPID = çˆ¶è¿›ç¨‹IDï¼ˆåªèƒ½ç”±å†…æ ¸ä¿®æ”¹ï¼‰PGID = è¿›ç¨‹ç»„IDï¼ˆå­è¿›ç¨‹ã€çˆ¶è¿›ç¨‹éƒ½èƒ½ä¿®æ”¹ï¼‰SID = ä¼šè¯IDï¼ˆè¿›ç¨‹è‡ªèº«å¯ä»¥ä¿®æ”¹ï¼Œä½†æœ‰é™åˆ¶ï¼Œè¯¦è§ä¸‹æ–‡ï¼‰TPGID= æ§åˆ¶ç»ˆç«¯è¿›ç¨‹ç»„IDï¼ˆç”±æ§åˆ¶ç»ˆç«¯ä¿®æ”¹ï¼Œç”¨äºæŒ‡ç¤ºå½“å‰å‰å°è¿›ç¨‹ç»„ï¼‰ å…³é”®ç‚¹ï¼šæ¯æ¬¡ç”¨æˆ·ç™»é™†ç»ˆç«¯ä¼šäº§ç”Ÿä¸€ä¸ªä¼šè¯sessionï¼Œsessionä»ç™»é™†å¼€å§‹åˆ°ç»“æŸä¸ºæ­¢ï¼Œè€Œè¿™ä¸€æ®µæ—¶é—´å†…åœ¨è¯¥ä¼šè¯ä¸­æ‰§è¡Œçš„æ‰€æœ‰è¿›ç¨‹éƒ½å±äºæœ¬ä¼šè¯ã€‚ 1.2ã€æŒ‚æ–­ä¿¡å·SIGHUPæŒ‚æ–­ä¿¡å·é»˜è®¤æ“ä½œæ˜¯ç»ˆæ­¢è¿›ç¨‹ å½“ç»ˆç«¯æ¥å£æ£€æµ‹åˆ°ç½‘ç»œè¿æ¥æ–­å¼€ï¼Œå°†æŒ‚æ–­ä¿¡å·å‘é€ç»™æ§åˆ¶è¿›ç¨‹ï¼ˆä¼šè¯æœŸé¦–è¿›ç¨‹ï¼‰ å¦‚æœä¼šè¯æœŸé¦–è¿›ç¨‹ç»ˆæ­¢ï¼Œåˆ™è¯¥æŒ‚æ–­ä¿¡å·å‘é€åˆ°è¯¥ä¼šè¯æœŸå‰å°è¿›ç¨‹ç»„. ä¸€ä¸ªè¿›ç¨‹é€€å‡ºå¯¼è‡´ä¸€ä¸ªå­¤å„¿è¿›ç¨‹ç»„ä¸­äº§ç”Ÿæ—¶ï¼Œå¦‚æœä»»æ„ä¸€ä¸ªå­¤å„¿è¿›ç¨‹ç»„è¿›ç¨‹å¤„äºSTOPçŠ¶æ€ï¼Œå‘é€SIGHUPå’ŒSIGCONTä¿¡å·åˆ°è¯¥è¿›ç¨‹ç»„ä¸­æ‰€æœ‰è¿›ç¨‹. 1.3ã€hexo è¿›ç¨‹ä¸­æ–­åŸå› ï¼š SSHé€€å‡ºè¿æ¥æˆ–å› ç½‘ç»œé—®é¢˜ä¸­æ–­è¿æ¥ï¼Œsshç»ˆç«¯æ£€æµ‹åˆ°è¿æ¥ä¸­æ–­ä¼šå°†æŒ‚æ–­ä¿¡å·SIGHUPå‘é€åˆ°ä¸ç»ˆç«¯è¿æ¥çš„æ§åˆ¶è¿›ç¨‹ã€‚ æ§åˆ¶è¿›ç¨‹è¢«ç»ˆæ­¢äº†ï¼Œå±äºåŒä¸€ä¸ªä¼šè¯æœŸçš„å…¶ä»–è¿›ç¨‹ä¹Ÿè¢«ç»ˆæ­¢äº†ã€‚ 2ã€è§£å†³åŠæ³•è¯´äº†é‚£ä¹ˆå¤šï¼Œæ„æ€å°±æ˜¯è¯´ssh æ‰“å¼€ä»¥åï¼Œbashç­‰éƒ½æ˜¯ä»–çš„å­ç¨‹åºï¼Œä¸€æ—¦sshå…³é—­ï¼Œç³»ç»Ÿå°†æ‰€æœ‰ç›¸å…³è¿›ç¨‹æ€æ‰ï¼ï¼ å¯¼è‡´ä¸€æ—¦sshå…³é—­ï¼Œæ‰§è¡Œä¸­çš„ä»»åŠ¡å°±å–æ¶ˆäº†ã€‚ 2.1ã€nohubå‘½ä»¤ä¸&amp;å‘½ä»¤ä½œç”¨ï¼šåå°æ‰§è¡Œ å½“å¹³æ—¶åœ¨ç»ˆç«¯æ“ä½œæ—¶ï¼Œä¸å¸Œæœ›è¿è¡Œä¸€ä¸ªç¨‹åºå æ»¡äº†å±å¹•å¯¼è‡´æ— æ³•è¿›è¡Œå…¶ä»–æ“ä½œæ—¶ï¼Œè¿™æ—¶å€™å°±éœ€è¦åå°è¿è¡Œäº†ã€‚æœ¬æƒ…å½¢ä¸‹ï¼šé€€å‡ºsshåå¸Œæœ›hexoä¾ç„¶ç»§ç»­å·¥ä½œï¼Œä¹Ÿéœ€è¦åå°è¿è¡Œäº†ã€‚ &amp; å‘½ä»¤æ¯”å¦‚ 1hexo s &amp; è™½ç„¶å‰å°æœ‰æ‰“å°ï¼Œä½†æ˜¯ctrl+cä¹‹åç¨‹åºå¹¶æ²¡æœ‰é€€å‡ºï¼Œä¾ç„¶å¯ä»¥ä»å…¬ç½‘è®¿é—®ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªå¼Šç«¯å°±æ˜¯ï¼šå½“é€€å‡ºæ§åˆ¶è¿›ç¨‹ä¹‹åè¯¥åå°è¿›ç¨‹ä¼šè¢«æ€æ­»ï¼Œæ‰€ä»¥å¸Œæœ›é€€å‡ºä¹‹åç»§ç»­è¿è¡Œéœ€è¦ä½¿ç”¨ nohup nohup å‘½ä»¤1nohup hexo s &amp; æ­¤æ—¶hexoè¿›ç¨‹å·²ç»åå°è¿è¡Œäº†ï¼Œå¯ä»¥çœ‹åˆ°ä¸€å¥è¯â€œå¿½ç•¥è¾“å…¥å¹¶å°†è¾“å‡ºè¿½åŠ åˆ°â€™nohup.outâ€™â€ï¼Œå°±æ˜¯è¯´æŠŠå½“å‰ hexo s å‘½ä»¤çš„è¾“å‡ºæ–‡ä»¶è¿½åŠ åˆ°å½“å‰ç›®å½•çš„ nohup.out æ–‡ä»¶ä¸­å»äº†ï¼Œvimçœ‹ä¸€ä¸‹ã€‚ å¯ä»¥è®©ç¨‹åºè¾“å…¥åˆ°æŒ‡å®šä½ç½® 1nohup hexo s &gt;/opt/output/out.file 2&gt;&amp;1 &amp; ä»€ä¹ˆæ„æ€ä¸è®°å½•äº†ã€‚ åå°è¿è¡Œä¹‹åå¯ä»¥é€šè¿‡ jobs æŸ¥çœ‹å½“å‰åå°è¿›ç¨‹ï¼Œæ³¨æ„ï¼šjobsåªæ˜¾ç¤ºå½“å‰ä¼šè¯æœŸçš„åå°è¿›ç¨‹ï¼Œå¦‚æœé€€å‡ºä¹‹åæ˜¯æŸ¥çœ‹ä¸åˆ° hexoçš„åå°è¿›ç¨‹çš„ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡ ps -aux è¿›ç¨‹å‘½ä»¤æŸ¥çœ‹åˆ°ã€‚ 1ps -aux | grep hexo å½“ä¸éœ€è¦åå°è¿è¡Œæ—¶ 1kill PID å¯ä»¥å‘ç°é€€å‡ºä¹‹åjobsæ˜¯çœ‹ä¸åˆ°åå°è¿›ç¨‹çš„. 3ã€å°†ipåœ°å€æ˜ å°„åˆ°åŸŸå &nbsp;&nbsp;è¿™é‡Œå°±éœ€è¦ç”¨åˆ°åŸŸåçš„DNSè§£æäº†ï¼Œç”±äºå‰é¢å·²ç»æ­å»ºäº†æ”¾åœ¨Githubçš„Hexoç¯å¢ƒï¼Œè‡ªå·±çš„ yuzh.xyz åŸŸåDNSè§£æä¸­ Aè®°å½• å’Œ @è®°å½• å‡æŒ‡å‘åˆ°äº†githubåšå®¢ä»“åº“åœ°å€ https://github.com/yuzh233/yuzh233.github.io æ‰€å¯¹åº”çš„ipã€‚æ‰€ä»¥é€šè¿‡ www.yuzh.xyz å’Œ yuzh.xyz æ˜¯ä¸èƒ½å¤Ÿè®¿é—® linuxä¸‹çš„hexoçš„ã€‚ 3.1ã€ GitHubä»“åº“ä½œä¸ºæœåŠ¡å™¨éƒ¨ç½²åŠæ³• ä¿®æ”¹hexoæ ¹ç›®å½•é…ç½®æ–‡ä»¶ _config.yml 1234567# Deployment## Docs: https://hexo.io/zh-cn/docs/deployment.htmldeploy: type: git # ä»“åº“åœ°å€ï¼Œä¸æ˜¯urlåœ°å€ï¼Œæ˜¯æ‹·è´ä»“åº“æ—¶çš„åœ°å€ã€‚ repo: https://github.com/yuzh233/yuzh233.github.io.git branch: master hexoæ˜¯ä¾æ®è¿™ä¸ªéƒ¨ç½²åˆ°gitä»“åº“çš„ã€‚ ä¸Šä¼ åˆ°gitä»“åº“ å…ˆå®‰è£…ä¸Šä¼ çš„æ’ä»¶ 1npm install hexo-deployer-git --save ä¸Šä¼ å‘½ä»¤ï¼Œæ¯æ¬¡æœ‰æ›´æ–°éƒ½éœ€è¦ â€œç”Ÿæˆ -&gt; éƒ¨ç½²â€ 123hexo cleanhexo generatehexo deploy ç»‘å®šåŸŸå è¯¥æ­¥å¯ä»¥è·³è¿‡ï¼Œä¸è¿‡æˆ‘å°±æ˜¯è¦ç»‘å®šã€‚ åœ¨sourceæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªåä¸ºCNAMEçš„æ–‡ä»¶ï¼Œé‡Œé¢å†™æŒ‡å®šçš„åŸŸå æ¯”å¦‚ www.yuzh.xyz æ·»åŠ ä¸€æ¡ DNS è§£æã€‚æ·»åŠ ä¸€æ¡ A è®°å½•å’Œ @ è®°å½•ï¼ŒIPåœ°å€å¡«å†™hexoéƒ¨ç½²åˆ°gitçš„ä»“åº“çš„åœ°å€ï¼Œæ€ä¹ˆè·å–ä»“åº“åœ°å€å¯¹åº”çš„ipï¼Ÿ ping yuzh233.github.io å¯ä»¥å¾—åˆ°ipï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œä»…ä»…é€šè¿‡è¿™ä¸ªipå°±è®¿é—®åˆ°äº†æˆ‘çš„ä»“åº“å—ï¼Ÿä¸ºä»€ä¹ˆä¸éœ€è¦è®¾ç½®ç«¯å£å·å•Š(ãƒ»âˆ€ãƒ»(ãƒ»âˆ€ãƒ» ) ï¼Œä¸ç®¡äº†ï¼Œåæ­£å°±æ˜¯è®¿é—®åˆ°äº†ã€‚ ç„¶åè®¿é—®çš„æ—¶å€™è¾“å…¥ www.yuzh.xyz æˆ– yuzh.xyz å°±åˆ°äº†æˆ‘çš„ä»“åº“äº†ï¼ˆè®¾ç½®äº†è§£æçš„ç»“æœï¼‰ï¼Œæˆ‘çš„ä»“åº“ç”±äºæ·»åŠ äº†CNAMEè®°å½•ï¼Œå°†ä»“åº“çš„åŸŸåæŒ‡å‘äº†æ–‡æœ¬ä¸­çš„åŸŸåäº†ã€‚ 3.2ã€ äº‘ECS linuxç¯å¢ƒæœåŠ¡å™¨éƒ¨ç½²åŠæ³• é¦–å…ˆå½“ç„¶æ˜¯ linuxåå°è¿è¡Œhexo sè¿›ç¨‹äº†ã€‚ ç„¶å ECS å®‰å…¨ç»„ä¸èƒ½æŠŠé»˜è®¤4000ç«¯å£æ‹¦æˆªäº†ã€‚ ç»‘å®šåŸŸå ç”±äºä¸€çº§åŸŸåå·²ç»è¢«gitä¸­çš„ä»“åº“ç»‘å®šäº†ï¼Œè¿™é‡Œå¯ä»¥æ›´æ¢DNSè§£æé‡æ–°ç»‘å®šåˆ°æˆ‘çš„linuxä¸»æœºä¸­ï¼Œè®¿é—®æ–¹å¼ï¼šwww.yuzh.xyz:4000 ä¸ºä»€ä¹ˆè¿™é‡Œè¦åŠ ç«¯å£è€Œç»‘å®šåˆ°gitä»“åº“æ—¶å´ä¸éœ€è¦ç«¯å£å‘¢ï¼Ÿé¬¼çŸ¥é“ä¸ºä»€ä¹ˆ~ éƒ¨ç½²åˆ°gitçš„æ—¶å€™é€šè¿‡ä¸€ä¸ªipç›´æ¥è®¿é—®åˆ°äº†ä»“åº“åœ°å€ã€‚ä½†æ˜¯è®¿é—®linuxä¸»æœºä¸­çš„åº”ç”¨æœ¬æ¥å°±æ˜¯è¦åŠ ç«¯å£çš„ã€‚ è¿™é‡Œä¸æƒ³æ›´æ”¹DNSè§£æï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨äºŒçº§åŸŸåè§£æå“¦~ äºŒçº§åŸŸåæ˜¯å…è´¹çš„ å¯ä»¥è®¾ç½®å¤šä¸ªäºŒçº§åŸŸåï¼ŒæŒ‡å‘åˆ°ä¸åŒçš„ä¸»æœºåœ°å€ å¦‚ï¼š è¿™æ ·é€šè¿‡ blog.yuzh.xyz:4000å¯ä»¥è®¿é—®åˆ°linuxä¸‹çš„hexoç¯å¢ƒäº†ã€‚ ç„¶è€Œï¼Œè¿˜æ˜¯è¦åŠ ä¸ªç«¯å£å·ï¼Œä¸æƒ³æ˜¾å¼åŠ ç«¯å£ï¼Œæ€ä¹ˆåŠï¼Ÿâ€”â€” ä½¿ç”¨éšå½¢URLä½œä¸ºè§£æè®°å½• å¦‚æ­¤ï¼Œé€šè¿‡è®¿é—® bg.yuzh.xyz è½¬å‘åˆ°äº† blog.yuzh.xyz:4000 å†è®¿é—®åˆ°äº†hexoåº”ç”¨äº†ã€‚ æ³¨æ„ï¼šä½¿ç”¨éšå½¢URLæˆ–æ˜¾æ€§URLè·³è½¬éœ€è¦å¤‡æ¡ˆã€‚å¤‡æ¡ˆæ¡ä»¶ï¼š1.ä¸»æœºåœ¨å›½å†… 2.ECSç§Ÿç”¨3ä¸ªæœˆä»¥ä¸Š 3.åŸŸåå·²ç»å®åéªŒè¯","link":"/2018/06/16/Linuxä¸‹éƒ¨ç½²ä¸ªäººç«™ç‚¹åçš„è¿è¡Œé—®é¢˜/"},{"title":"SpringAopä¸­JoinPointå¯¹è±¡ä½¿ç”¨æ—¶å‡ºç°çš„é—®é¢˜","text":"ä»‹ç»ä¸å†™äº†ï¼ŒAPIä¹Ÿä¸å†™äº†ï¼Œè®°å½•é—®é¢˜è§£å†³ã€‚ åˆ‡é¢ç±»ï¼š 123456789101112131415161718192021222324252627282930313233package xyz.yuzh.aspect;import org.aspectj.lang.JoinPoint;import org.aspectj.lang.annotation.AfterReturning;import org.aspectj.lang.annotation.Aspect;import org.springframework.stereotype.Component;/** * æ—¥å¿—åˆ‡é¢ * * @Author: z.yu * @Date: 2018/06/19 20:35 */@Aspect@Componentpublic class LogAspect { /** * å¦‚æœä»£ç†Handlerï¼Œè¯¥Handlerä¸èƒ½ç»§æ‰¿ç±»ã€‚ */ @AfterReturning(pointcut = \"execution(* xyz.yuzh.service.*.*(..))\") public void log(JoinPoint point) { Object[] args = point.getArgs(); for (Object a : args) { System.out.println(\"å…¥å‚æ•° -&gt; \" + a + \",\"); } System.out.println(\"æ–¹æ³•ç­¾åï¼š\" + point.getSignature()); System.out.println(\"ç›®æ ‡å¯¹è±¡ï¼š\" + point.getTarget()); System.out.println(\"ä»£ç†å¯¹è±¡ï¼š\" + point.getThis()); System.out.println(\"-----------------------\"); }} 1ã€ è‡ªåŠ¨ä»£ç†aopçš„é…ç½®éœ€è¦å†™åœ¨ spring.xml ä¸­ï¼Œå› ä¸º spring-mvc.xml é…ç½®æˆåªæ‰«æçš„åˆ° handlerï¼Œspring.xmlæ‰èƒ½æ‰«æåˆ°å…¶ä»–Componentï¼ˆå¦‚åˆ‡é¢ç±»ï¼šLogAspectï¼‰ã€‚ trueä»£è¡¨CGLIBåŠ¨æ€ä»£ç† falseä»£è¡¨JDKåŠ¨æ€ä»£ç†ï¼ˆé»˜è®¤ï¼‰ 1&lt;aop:aspectj-autoproxy proxy-target-class=\"false\"&gt;&lt;/aop:aspectj-autoproxy&gt; 2ã€ ä½¿ç”¨ @AfterReturningæ—¶ï¼Œå¦‚æœæŒ‡å®šäº†è¿”å›å€¼ï¼Œé‚£ä¹ˆç›®æ ‡æ–¹æ³•æœ‰è¿”å›å€¼çš„æ‰ä¼šåŒ¹é…çš„åˆ°1234@AfterReturning(pointcut = \"execution(* xyz.yuzh.service.*.*(..))\",returning = \"returnValue\")public void log2(JoinPoint point,Object returnValue) { //...} 3ã€ç›®æ ‡æ–¹æ³•å¦‚æœæ˜¯ç»§æ‰¿æˆ–å®ç°å¾—åˆ°çš„ï¼Œæ˜¯ä»£ç†ä¸åˆ°çš„ï¼Œé™¤éè¦†ç›–å…¶çˆ¶çº§æ–¹æ³•ã€‚4ã€å¦‚æœç›®æ ‡æ–¹æ³•æ˜¯ Handlerä¸­çš„æ–¹æ³•ï¼Œæ²¡æœ‰è¢«ä»£ç†åˆ°ï¼Ÿ webå®¹å™¨åŠ è½½é¡ºåºï¼šServletContext -&gt; context-param -&gt; listener-&gt; filter -&gt; servlet é¦–å…ˆä¸€ç‚¹ï¼šspringçš„Beanå’ŒspringMVCçš„Beanæ‰€åœ¨çš„ä¸Šä¸‹æ–‡æ˜¯ä¸åŒçš„ å‰é¢åˆ‡å…¥ç‚¹åœ¨serviceå±‚æ—¶ï¼Œè‡ªåŠ¨ä»£ç† &lt;aop:aspectj-autoproxy/&gt; é…ç½®åˆ°spring.xmlï¼Œå³è¿™é‡Œçš„beanæ˜¯å¯ä»¥è¢«ä»£ç†åˆ°çš„ã€‚serviceBeanè¢«spring.xmlæ‰«æåˆ°ï¼ŒLogAspectä½œä¸ºåˆ‡é¢æ‰ä¼šç”Ÿæ•ˆã€‚ @Component ä½œä¸ºspringå®¹å™¨ä¸­çš„beanè¢«åŠ è½½åˆ°äº†ã€‚ @Aspect æ–½åŠ äº†è¯¥æ³¨è§£çš„springå®¹å™¨çš„beançš„åˆ‡é¢åº”ç”¨æˆåŠŸã€‚ ä»£ç†handlerä¸­çš„æ–¹æ³•æ­¥éª¤ï¼š &lt;aop:aspectj-autoproxy/&gt; æ”¾åˆ°spring-mvc.xml ï¼Œè¯¥é…ç½®æ–‡ä»¶æ‰æ˜¯æ‰«æhandlerçš„ã€‚ æ‰‹åŠ¨åˆ›å»ºbean -&gt; &lt;bean id=&quot;logAspect&quot; class=&quot;xyz.yuzh.aspect.LogAspect&quot;&gt;&lt;/bean&gt;ï¼Œå› ä¸ºæ‰«æä¸åˆ°ã€‚ ç§»é™¤LogAspectçš„@Componentæ³¨è§£ï¼Œå› ä¸ºå·²ç»æ‰‹åŠ¨åˆ›å»ºäº†ï¼Œé‡å¤åˆ›å»ºå¯èƒ½ä¼šå‡ºç°é”™è¯¯ã€‚ good night(ï¿£oï¿£) . z Z","link":"/2018/06/19/SpringAopä¸­JoinPointå¯¹è±¡ä½¿ç”¨æ—¶å‡ºç°çš„é—®é¢˜/"},{"title":"dubboç›‘æ§ä¸­å¿ƒ-dubbo-admin.warçš„æ‰“åŒ…å’Œéƒ¨ç½²","text":"dubboç›‘æ§ä¸­å¿ƒ-dubbo-admin.warçš„æ‰“åŒ…å’Œéƒ¨ç½² ä¸€ä¸ª dubbo-admin.war çš„æ‰“åŒ…ä»æ˜¨æ™šæåˆ°ä»Šå¤©ä¸­åˆï¼Œå·®ç‚¹æ²¡åå‡ºä¸€å£è€è¡€ğŸ¤®é”™è¯¯çš„è¿‡ç¨‹ä¸è®°å½•äº†ï¼Œéƒ½æ˜¯æ³ªã€‚ Sept 1å…‹éš†dubboæºç ï¼Œåœ°å€ï¼šhttps://github.com/apache/incubator-dubbo/tree/dubbo-2.5.4å…‹éš†ä¹‹åçœ‹åˆ°çš„ï¼š Sept 2æ¥ä¸‹æ¥ï¼Œå®‰è£…æ‰€æœ‰å·¥ç¨‹ã€‚æ³¨æ„ï¼šå¦‚æœæ˜¯ç”¨IDEå…‹éš†ä¸‹æ¥çš„ï¼Œä¸è¦ç›´æ¥installï¼Œç›´æ¥å®‰è£…ä¼šè¿›è¡Œæµ‹è¯•ï¼Œè¿™é‡Œä¸éœ€è¦æµ‹è¯•ï¼Œç›´æ¥ä½¿ç”¨cmdæ–¹å¼ã€‚ 12å°†dubboçš„jarå®‰è£…åˆ°æœ¬åœ°mavenä»“åº“mvn install -Dmaven.test.skip=true ç„¶åï¼Œè¿›å…¥åˆ°dubbo-adminç›®å½•ï¼Œç»™dubbo-adminæ‰“åŒ… 1mvn package -Dmaven.test.skip ç„¶åä¼šåœ¨ç¼–è¯‘åçš„ç›®å½•targetä¸­çœ‹åˆ°æ‰“åŒ…æ–‡ä»¶ï¼š Sept 3ç†æ‰€å½“ç„¶çš„æŠŠ dubbo-admin-2.5.4-SNAPSHOT.war æ”¾åœ¨webappsä¸‹è·‘ä¸€ä¸‹è¯•è¯•ï¼Œè¿˜æ²¡è·‘èµ·æ¥å¯åŠ¨å°±æŠ¥é”™ï¼šä¿¡æ¯æ˜¯â€œæ‰¾ä¸åˆ°applicationContext.xmlâ€æŒ‰é“ç†ç›´æ¥æ‹·è´ä¸‹æ¥çš„åº”è¯¥ä¸ä¼šæœ‰é—®é¢˜å•Šï¼ ç‰ˆæœ¬æœ‰å†²çªï¼Œåªå¥½æ”¹äº†ï¼Œæ³¨æ„ï¼šç‰ˆæœ¬æ§åˆ¶çš„æ¨¡å—æ˜¯ dubbo-parent ï¼Œä½†æ˜¯åœ¨æ²¡æœ‰å‘ç°è¿™ä¸ªå·¥ç¨‹ç›®å½•ï¼Œæ€ä¹ˆæ”¹ï¼Ÿå°†æ ¹ç›®å½•å¯¼å…¥åˆ°IDEAï¼Œå…¨éƒ¨çš„å·¥ç¨‹å°±éƒ½å¯¼å…¥è¿›æ¥äº†ã€‚ ç„¶åä¿®æ”¹springç‰ˆæœ¬ä¸º 1&lt;spring_version&gt;3.2.9.RELEASE&lt;/spring_version&gt; æŒ‡å®šæ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼š Sept 4cmdé‡æ–°ç¼–è¯‘å®‰è£…ï¼Œå‘å¸ƒåˆ°æœ¬åœ°tomcatåšæµ‹è¯• å¯ä»¥çœ‹åˆ°å·²ç»æ˜¯ä¿®æ”¹åçš„ç‰ˆæœ¬äº†ï¼Œå¯åŠ¨tomcatã€‚ æ³¨æ„ï¼šå¾—å…ˆå¼€å¯zookepperæ³¨å†Œä¸­å¿ƒã€‚ Sept 5éƒ¨ç½²ç›‘æ§ä¸­å¿ƒåˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œè¿™é‡Œä»¥æœ¬åœ°linuxä¸ºä¾‹ã€‚ä¸Šä¼ waråŒ…ï¼š å¤åˆ¶åˆ°webappsï¼š è¿›å…¥åˆ°tomcat/binï¼Œå¯åŠ¨tomcatï¼š æ³¨æ„ï¼šå¾—å…ˆå¼€å¯zookepperæ³¨å†Œä¸­å¿ƒã€‚ é»˜è®¤rootç™»é™†å¯†ç æ˜¯rootï¼Œguestç™»é™†å¯†ç æ˜¯guest è¿™é‡Œå°†ç»ƒä¹ çš„ä¸€ä¸ªé¡¹ç›®å‘å¸ƒåˆ°äº†zookeeperï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç›‘æ§ä¿¡æ¯ï¼š å‘å®‰è£…duboo-admin.warçš„ç¯å¢ƒå’Œéƒ¨ç½²dubbo-admin.warçš„ç¯å¢ƒæœ€å¥½ä¿æŒä¸€è‡´ï¼Œå¦åˆ™å„ç§é—®é¢˜ã€‚æœ¬æœºwindows:jdk1.8.0_172+apache-tomcat-8.5.32linuxä¿æŒä¸€è‡´ å‚è€ƒåšå®¢ï¼šhttps://blog.csdn.net/qq_32349641/article/details/52488003","link":"/2018/07/06/dubboç›‘æ§ä¸­å¿ƒ-dubbo-admin-warçš„æ‰“åŒ…å’Œéƒ¨ç½²/"},{"title":"springä¸aspectJç‰ˆæœ¬å†²çªé—®é¢˜","text":"ç‰ˆæœ¬å†²çªçœŸæ˜¯è®©äººè„‘é˜”ç–¼ã€‚ç”¨è¿™ä¸ª 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt; &lt;version&gt;4.2.7&lt;/version&gt;&lt;/dependency&gt; ä»£æ›¿è¿™ä¸ª 12345678910&lt;dependency&gt; &lt;groupId&gt;org.aspectj&lt;/groupId&gt; &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt; &lt;version&gt;1.8.7&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.aspectj&lt;/groupId&gt; &lt;artifactId&gt;aspectjrt&lt;/artifactId&gt; &lt;version&gt;1.8.7&lt;/version&gt;&lt;/dependency&gt; mavenä¼šè‡ªåŠ¨å¤„ç†springä¸aspectçš„ä¾èµ–å…³ç³»ã€‚ä¾èµ–äº† aspectwearer.jarï¼Œæ²¡æœ‰å¼•ç”¨ aspectjrt.jar ä½†æ˜¯ä¹Ÿå¯ä»¥ç”¨ï¼Œä¸»è¦æ˜¯å¯ä»¥çœ‹åˆ°aspectçš„ç‰ˆæœ¬å·ï¼Œä»¥ä¾¿äºæ‰‹åŠ¨åŠ å…¥æƒ³è¦çš„aspectåŒ…ã€‚","link":"/2018/06/19/springä¸aspectJç‰ˆæœ¬å†²çªé—®é¢˜/"},{"title":"åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆäº”ï¼‰","text":"13.ç½‘é¡µé™æ€åŒ–ä¹‹FreeMarker14.åå‘ä»£ç†/è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼šNginx ç½‘é¡µé™æ€åŒ– ä»€ä¹ˆæ˜¯é™æ€åŒ–ï¼Ÿé€šè¿‡ä¸€äº›æŠ€æœ¯æ‰‹æ®µï¼ˆFreemarker/valocityï¼‰å°†åŠ¨æ€çš„é¡µé¢ï¼ˆjsp,asp.net,php) è½¬æ¢æˆé™æ€çš„é¡µé¢ï¼Œé€šè¿‡æµè§ˆå™¨ç›´æ¥è®¿é—®é™æ€é¡µé¢ã€‚ä¸ºä»€ä¹ˆè¦é™æ€åŒ–ï¼Ÿ é€šè¿‡æµè§ˆå™¨ç›´æ¥è®¿é—®é™æ€çš„é¡µé¢,ä¸éœ€è¦ç»è¿‡ç¨‹åºå¤„ç†ï¼Œå®ƒçš„è®¿é—®é€Ÿåº¦é«˜ã€‚ç¨³å®šæ€§å¥½ã€‚ æ›´æœ‰æ•ˆçš„é˜²æ­¢å®‰å…¨æ¼æ´é—®é¢˜ï¼Œæ¯”å¦‚ä¸æ˜“é­å—é»‘å®¢æ”»å‡»ã€‚ é™æ€çš„é¡µé¢æ›´å®¹æ˜“è¢«æœç´¢å¼•æ“æ”¶å½•ã€‚ æ›´å¤šæ¦‚å¿µè§ç¬”è®°æ–‡æ¡£ï¼Œå¿«é€Ÿå…¥é—¨åŠæ•´åˆSpringè®¿é—®é¡¹ç›®å­¦ä¹ ä»“åº“åœ°å€ï¼šhttps://github.com/yuzh233/FreeMarker åå‘ä»£ç†/è´Ÿè½½å‡è¡¡Nginxåº”ç”¨åœºæ™¯ httpæœåŠ¡å™¨Nginxæ˜¯ä¸€ä¸ªhttpæœåŠ¡å¯ä»¥ç‹¬ç«‹æä¾›httpæœåŠ¡ã€‚å¯ä»¥åšç½‘é¡µé™æ€æœåŠ¡å™¨ã€‚è™šæ‹Ÿä¸»æœºå¯ä»¥å®ç°åœ¨ä¸€å°æœåŠ¡å™¨è™šæ‹Ÿå‡ºå¤šä¸ªç½‘ç«™ã€‚ä¾‹å¦‚ä¸ªäººç½‘ç«™ä½¿ç”¨çš„è™šæ‹Ÿä¸»æœºã€‚åå‘ä»£ç†ï¼Œè´Ÿè½½å‡è¡¡å½“ç½‘ç«™çš„è®¿é—®é‡è¾¾åˆ°ä¸€å®šç¨‹åº¦åï¼Œå•å°æœåŠ¡å™¨ä¸èƒ½æ»¡è¶³ç”¨æˆ·çš„è¯·æ±‚æ—¶ï¼Œéœ€è¦ç”¨å¤šå°æœåŠ¡å™¨é›†ç¾¤æ—¶å¯ä»¥ä½¿ç”¨nginxåšåå‘ä»£ç†ã€‚å¹¶ä¸”å¤šå°æœåŠ¡å™¨å¯ä»¥å¹³å‡åˆ†æ‹…è´Ÿè½½ï¼Œä¸ä¼šå› ä¸ºæŸå°æœåŠ¡å™¨è´Ÿè½½é«˜å®•æœºè€ŒæŸå°æœåŠ¡å™¨é—²ç½®çš„æƒ…å†µã€‚ å®‰è£…åŠç¼–è¯‘æ­¥éª¤è§ç¬”è®°æ–‡æ¡£ Nginxé…ç½®è™šæ‹Ÿä¸»æœºé€šè¿‡ç«¯å£åŒºåˆ†â€¦/nginx/conf/nginx.confä¸­é…ç½®ä»¥ä¸‹èŠ‚ç‚¹ 123456789101112131415161718192021222324252627# ä¸€ä¸ªserverèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿä¸»æœºserver { # ç¬¬ä¸€ä¸ªwebåº”ç”¨çš„ç«¯å£ listen 80; # æ‰€åœ¨åœ°å€ server_name localhost; #charset koi8-r; #access_log logs/host.access.log main; location / { # Htmlæ˜¯nginxå®‰è£…ç›®å½•ä¸‹çš„htmlç›®å½•ï¼Œä¹Ÿæ˜¯è¯¥åº”ç”¨çš„é™æ€èµ„æºæ–‡ä»¶å­˜æ”¾çš„æ ¹ç›®å½• / root html; index index.html index.htm; }}# ç¬¬äºŒå°è™šæ‹Ÿä¸»æœºserver { # ç¬¬äºŒä¸ªwebåº”ç”¨çš„ç«¯å£ listen 81; server_name localhost; #charset koi8-r; #access_log logs/host.access.log main; location / { # ç¬¬äºŒä¸ªwebåº”ç”¨çš„èµ„æºæ–‡ä»¶æ”¾åœ¨html-81ä¸­ï¼Œè®¿é—®çš„æ—¶å€™ / ä»£è¡¨è¯¥ç›®å½• root html-81; index index.html index.htm; }} ä¿®æ”¹é…ç½®é‡æ–°åŠ è½½ ./nginx -s reload ï¼Œæ— éœ€é‡å¯ã€‚è®¿é—®ç¬¬ä¸€ä¸ªwebæœåŠ¡ï¼šhttp://localhost:80è®¿é—®ç¬¬äºŒä¸ªwebæœåŠ¡ï¼šhttp://localhost:81å…¶å®å°±æ˜¯å……å½“äº†tomcat. é€šè¿‡åŸŸååŒºåˆ†åŸŸåæ¦‚å¿µï¼šç•¥ç•¥ç•¥åŸŸåè®¿é—®æµç¨‹ï¼šç•¥ç•¥ç•¥é…ç½®æ–¹å¼ï¼šâ€¦/nginx/conf/nginx.conf ä¸­ 123456789101112131415161718192021222324# å‰é¢å·²ç»æœ‰ä¸€ä¸ªè™šæ‹Ÿä¸»æœºç”¨äº†è¿™ä¸ªç«¯å£ï¼Œåˆ äº†ã€‚è¿™æ˜¯ç¬¬ä¸€ä¸ªè™šæ‹Ÿä¸»æœºserver { listen 80; # åŸŸå server_name www.taobao.com; #charset koi8-r; #access_log logs/host.access.log main; location / { root html-taobao; index index.html index.htm; }}# ç¬¬äºŒä¸ªè™šæ‹Ÿä¸»æœºserver { listen 80; # åŸŸå server_name www.baidu.com; #charset koi8-r; #access_log logs/host.access.log main; location / { root html-baidu; index index.html index.htm; }} ä¿®æ”¹æœ¬æœºhostæ–‡ä»¶æ‰èƒ½è®¿é—®ä¼ªåŸŸå nginxæœåŠ¡å™¨IPï¼šwww.taobao.com nginxæœåŠ¡å™¨IPï¼šwww.baidu.com å…¶å®è®¿é—®çš„éƒ½æ˜¯åŒä¸€ä¸ªåº”ç”¨ã€‚ Nginxé…ç½®åå‘ä»£ç†æ­£å‘ä»£ç†ï¼šåå‘ä»£ç† åå‘ä»£ç†æœåŠ¡å™¨å†³å®šå“ªå°æœåŠ¡å™¨æä¾›æœåŠ¡ã€‚ åå‘ä»£ç†æœåŠ¡å™¨ä¸æä¾›æœåŠ¡å™¨ã€‚ä¹Ÿåªæ˜¯è¯·æ±‚çš„è½¬å‘ã€‚ å®ç°åå‘ä»£ç†ä¸¤ä¸ªåŸŸåæŒ‡å‘åŒä¸€å°nginxæœåŠ¡å™¨ï¼Œç”¨æˆ·è®¿é—®ä¸åŒçš„åŸŸåæ˜¾ç¤ºä¸åŒçš„ç½‘é¡µå†…å®¹ã€‚é…ç½®ï¼šä¸¤åªçŒ«ã€ä¸¤ä¸ªåŸŸåã€ä¸€ä¸ªnginxæœåŠ¡å™¨ã€‚ 12345678910111213141516171819202122232425262728293031323334# åå‘ä»£ç†æœåŠ¡å™¨ä¸‹çš„ç¬¬ä¸€ä¸ªæœåŠ¡å™¨upstream tomcat1 { # è®¿é—®è¯¥æœåŠ¡å™¨çš„ipåŠç«¯å£ server 192.168.184.130:8080;}server { # é»˜è®¤ç›‘å¬80ç«¯å£ï¼Œè¿™æ ·å°±ä¸éœ€è¦æŒ‡å®šç«¯å£è®¿é—®ã€‚ listen 80; # ç”¨æˆ·è®¿é—®æ—¶çš„åŸŸåã€‚ server_name www.sina.com.cn; #charset koi8-r; #access_log logs/host.access.log main; location / { # nginxé€šè¿‡å‰é¢çš„tomcat1è½¬å‘åˆ°æŒ‡å®šçš„ç½‘ç«™ï¼Œè®¿é—®tomcat1å°±æ˜¯è®¿é—®192.168.25.148:8080 proxy_pass http://tomcat1; index index.html index.htm; }}# åå‘ä»£ç†æœåŠ¡å™¨ä¸‹çš„ç¬¬äºŒä¸ªæœåŠ¡å™¨upstream tomcat2 { # è®¿é—®è¯¥æœåŠ¡å™¨çš„ipåŠç«¯å£ server 192.168.184.130:8081;}server { listen 80; server_name www.sohu.com; #charset koi8-r; #access_log logs/host.access.log main; location / { proxy_pass http://tomcat2; index index.html index.htm; }} Nginxé…ç½®è´Ÿè½½å‡è¡¡ä¸€ä¸ªæœåŠ¡ç”±å¤šå°æœåŠ¡å™¨æä¾›ï¼Œéœ€è¦æŠŠè´Ÿè½½åˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨å¤„ç†ã€‚è´Ÿè½½å‡è¡¡çš„ç­–ç•¥: é»˜è®¤è½®è¯¢ï¼Œå³ä¸€ä¸ªä¸€ä¸ªè½®ç€æ¥ åˆ†é…æƒé‡ server 192.168.25.148:8082 weight=2; ,weightä»£è¡¨æƒé‡ é€šè¿‡IPåœ°å€çš„hashå€¼ åšæ˜ å°„ é€šè¿‡URLçš„æ–¹å¼è®¡ç®—å‡ºHashå€¼ éšæœºç­–ç•¥ æœ€å°‘å¹¶å‘é‡ã€‚ 12345678910111213141516171819# åå‘ä»£ç†æœåŠ¡å™¨ä¸‹çš„ç¬¬ä¸‰ä¸ªæœåŠ¡å™¨ï¼Œç”¨äºæµ‹è¯•Nginxè´Ÿè½½å‡è¡¡upstream tomcat3 { # å‡å¦‚è¯¥WEBæœåŠ¡ä¸‹æœ‰å¤šä¸ªæœåŠ¡å™¨æä¾› server 192.168.184.130:8080; server 192.168.184.130:8081;}server { # é»˜è®¤ç›‘å¬80ç«¯å£ï¼Œè¿™æ ·å°±ä¸éœ€è¦æŒ‡å®šç«¯å£è®¿é—®ã€‚ listen 80; # ç”¨æˆ·è®¿é—®æ—¶çš„åŸŸåã€‚ server_name www.yuzhtest.xyz; #charset koi8-r; #access_log logs/host.access.log main; location / { # nginxé€šè¿‡å‰é¢çš„tomcat1è½¬å‘åˆ°æŒ‡å®šçš„ç½‘ç«™ï¼Œè®¿é—®tomcat1å°±æ˜¯è®¿é—®192.168.25.148:8080 proxy_pass http://tomcat3; index index.html index.htm; }}","link":"/2018/07/26/åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆäº”ï¼‰/"},{"title":"åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆå…­ï¼‰","text":"15. SSOå•ç‚¹ç™»é™†ç³»ç»Ÿæ­å»ºæ¨¡å—åˆ’åˆ†ï¼š sso.taotao.interface sso.taotao.service sso.taotao.web ä¸¤ä¸ªé—®é¢˜ï¼š ä¸åŒåŸŸåä¹‹é—´Cookieæ˜¯ä¸èƒ½å…±äº«çš„ï¼Œè¿™ä¹Ÿæ„å‘³ç€ç”¨æˆ·åœ¨ sso.taotao.com ç³»ç»Ÿç™»é™†ä¹‹åï¼Œè·³è½¬åˆ° taotao.com åè®°å½•ç”¨æˆ·ç™»é™†å‡­è¯(token)çš„Cookieä¸å­˜åœ¨ï¼Œè®¿é—®æŸäº›ä¸ªäººä¿¡æ¯æ—¶æç¤ºé‡æ–°ç™»é™†ã€‚ ä¸åŒåŸŸåä¹‹é—´çš„è·¨åŸŸè¯·æ±‚æ˜¯ä¸ä¼šè¿”å›æ•°æ®çš„ï¼Œæ¯”å¦‚ item.taotao.com ä¸‹ä¸€ä¸ªè®¢å•éœ€è¦å‘é€ä¸€ä¸ªè¯·æ±‚åˆ° sso.taotao.com æ ¡éªŒå½“å‰ç”¨æˆ·æ˜¯å¦ç™»é™†ï¼Œè¯·æ±‚å‘é€æˆåŠŸå¹¶ä¸”ä¼šè¢«å¤„ç†ï¼Œä½†æ˜¯æ•°æ®æ˜¯è¿”å›ä¸åˆ° item.taotao.com ç³»ç»Ÿçš„ã€‚ è§£å†³åŠæ³•ï¼š è®¾ç½®Cookieçš„doMainå±æ€§ ä»¥JSONPçš„æ–¹å¼è¯·æ±‚è·å¾—æ•°æ® Cookieè·¨åŸŸå­¦ä¹ cookieçš„ä¸¤ä¸ªå±æ€§ï¼š pathpathå±æ€§æ˜¯è®¾ç½®cookieå­˜åœ¨çš„è·¯å¾„çš„ï¼Œæ¯”å¦‚åœ¨å½“å‰ç›®å½•ä¸‹å­˜å…¥äº†ä¸€ä¸ªcookieï¼Œé‚£ä¹ˆè¯¥ç›®å½•åŠå­ç›®å½•ä¸‹çš„æ‰€æœ‰èµ„æºè¯·æ±‚éƒ½èƒ½æŸ¥çœ‹åˆ°è¿™ä¸ªcookieï¼Œä½†æ˜¯çˆ¶çº§ç›®å½•æ˜¯çœ‹ä¸åˆ°çš„ã€‚ * è®¾ç½® path=â€œ/â€ ,å³cookieå¯è¢«ç«™ç‚¹æ ¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶è®¿é—®åˆ°ã€‚ * è®¾ç½® path=â€œ/AAA/â€ ,å³cookieå¯è¢«ç«™ç‚¹æ ¹ç›®å½•ä¸‹çš„AAAç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶è®¿é—®åˆ°ã€‚ domainå‰é¢å®ç°äº†cookieåŒåŸŸä¹‹é—´çš„è®¿é—®ï¼Œä½†åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œè·¨åŸŸè®¿é—®é¢‘ç¹ï¼Œæ€ä¹ˆåšåˆ°è·¨åŸŸè®¿é—®cookieä¸ä¸¢å¤±å‘¢ï¼Ÿæ¯”å¦‚åœ¨ sso.taotao ç™»é™†ä¹‹åç”¨æˆ·çš„tokenå­˜å…¥æµè§ˆå™¨ï¼Œæƒ³è¦åœ¨ order.taotao.com ç³»ç»Ÿä¸­è·å–è¿™ä¸ªtokenï¼Œéœ€è¦å­˜æ”¾cookieçš„æ—¶å€™è®¾ç½®domainå±æ€§ï¼š domain=â€œtaotao.comâ€ è·¨åŸŸè®¿é—®å‰ææ˜¯åŸŸåä¹‹é—´å…·æœ‰ç›¸åŒéƒ¨åˆ†ï¼Œä¸€èˆ¬æ˜¯äºŒçº§åŸŸåä¹‹é—´çš„è®¿é—®ã€‚ å‚è€ƒåšå®¢ï¼šhttps://www.cnblogs.com/st-leslie/p/5720460.html JSONP JSONPä¸JSONä¸æ˜¯ä¸€å›äº‹JSONæ˜¯ä¸€ç§æ•°æ®äº¤æ¢æ ¼å¼ï¼Œè€ŒJSONPæ˜¯ä¸€ç§éå®˜æ–¹è·¨åŸŸæ•°æ®äº¤äº’åè®® Ajaxï¼š 123456789101112131415161718192021&lt;html&gt;&lt;head&gt; &lt;meta charset=\"utf-8\"&gt; &lt;title&gt;jsonp&lt;/title&gt; &lt;script type=\"text/javascript\" src=\"jquery-1.6.4.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\"&gt; $(document).ready(function(){ $.ajax({ type:\"get\", url:\"local.js\", // url:\"http://192.168.184.130:82/remote.js\", dataType:\"json\", success:function(json){ alert(json.data); } }); }); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt; local.js 1{data:\"local\"} ç»“æœæ˜¯å¯ä»¥è¯·æ±‚åˆ°æœ¬åœ°jsonæ•°æ®ï¼Œä½†æ˜¯å½“è®¿é—®è¿œç¨‹çš„remote.jsæ—¶èµ„æºæ— æ³•è®¿é—®ğŸ˜” å€¼å¾—åº†å¹¸çš„æ˜¯ï¼šåœ¨Webé¡µé¢è°ƒç”¨Jsæ–‡ä»¶å´ä¸å—è·¨åŸŸçš„å½±å“ï¼Œæ³¨æ„ï¼šä¸æ˜¯ajaxè¯·æ±‚ï¼Œå‡¡æ˜¯é€šè¿‡æœ‰srcå±æ€§çš„æ ‡ç­¾è°ƒç”¨è·¨åŸŸèµ„æºéƒ½æ˜¯ä¸å—å½±å“çš„ï¼Œæ¯”å¦‚&lt;script&gt;æ ‡ç­¾ æ—¢ç„¶èƒ½å¤Ÿè¿œç¨‹è°ƒç”¨jsæ–‡ä»¶ï¼Œé‚£ä¹ˆæ€ä¹ˆè·å–æ–‡ä»¶ä¸­çš„æ•°æ®ä¸ºæˆ‘æ‰€ç”¨å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ã€‚ æµ‹è¯•ï¼šæœ¬åœ°ä¸€ä¸ªæ–¹æ³•è¦è·å¾—è¿œç¨‹çš„jsonæ•°æ®ï¼š 1234567&lt;script type=\"text/javascript\"&gt; //å›è°ƒæ–¹æ³• function method(json){ alert(json.data); }&lt;/script&gt;&lt;script type=\"text/javascript\" src=\"http://192.168.184.130:82/remote.js\"&gt;&lt;/script&gt; remote.js 12/*è¿œç¨‹jsä¸­è°ƒç”¨*/method({data:\"remote\"}) å…¶å®å°±æ˜¯è¿œç¨‹çš„jsä¸­è°ƒç”¨äº†æœ¬åœ°æ‰€éœ€è¦æ•°æ®çš„å›è°ƒæ–¹æ³•ã€‚ åŒæ ·çš„é“ç†ï¼Œåœ¨Ajaxè¯·æ±‚ä¸­ï¼Œè·¨åŸŸè¯·æ±‚ä¸€ä¸ªurlï¼Œæˆ‘ä»¬è¦æ±‚æ§åˆ¶å™¨è¿”å›çš„æ•°æ®æ ¼å¼ä¸ºï¼šcallbackMethod(jsonStr)ï¼Œä¹Ÿå°±æ˜¯å¯¹è¿”å›çš„jsonåŒ…è£¹ä¸€ä¸ªå‰å°jsçš„å›è°ƒæ–¹æ³•åç§°ã€‚æˆ‘ä»¬éœ€è¦åšçš„ï¼š1. å‘Šè¯‰æ§åˆ¶å™¨å›è°ƒæ–¹æ³•å«ä»€ä¹ˆï¼› 2.åœ¨å›è°ƒæ–¹æ³•å†™è·å¾—æ•°æ®åçš„é€»è¾‘ï¼Œè€Œæ§åˆ¶å™¨è¿”å›jsonçš„åŒæ—¶å›è°ƒäº†è¯¥æ–¹æ³•ã€‚ çŸ¥é“åŸç†ï¼Œå¼‚æ­¥è¯·æ±‚è·¨åŸŸæ•°æ®çš„æ–¹æ³•åº”è¯¥è¿™ä¹ˆå†™ï¼š 12345678910111213141516171819&lt;html&gt;&lt;head&gt; &lt;meta charset=\"utf-8\"&gt; &lt;title&gt;jsonp&lt;/title&gt; &lt;script type=\"text/javascript\" src=\"jquery-1.6.4.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\"&gt; //å›è°ƒæ–¹æ³• function callbackMethod(json){ alert(json.data); } //é€šè¿‡æ ‡ç­¾è°ƒç”¨jsonæ•°æ® var url = \"http://192.168.184.130:82/remote.js\"; var script = document.createElement('script'); script.setAttribute('src', url); document.getElementsByTagName('head')[0].appendChild(script); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt; Jqueryå¯¹JSONPå®ç°äº†å°è£…ï¼Œè‡ªåŠ¨ç”Ÿæˆäº†å›è°ƒå‡½æ•°å¹¶å–å‡ºæ•°æ®ç»™successæ–¹æ³•è°ƒç”¨ï¼š 1234567891011121314151617181920212223&lt;html&gt;&lt;head&gt; &lt;meta charset=\"utf-8\"&gt; &lt;title&gt;jsonp&lt;/title&gt; &lt;script type=\"text/javascript\" src=\"jquery-1.6.4.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\"&gt; $(document).ready(function(){ $.ajax({ type:\"get\", url:\"http://192.168.184.130:82/remote.js\", dataType:\"jsonp\", //ä¸‹é¢ä¸¤è¡Œå¯ä¸å†™ï¼Œæ„æ€å°±æ˜¯ http://192.168.184.130:82/remote.js?callback=callbackMethodï¼Œä¸å†™ä¼šè‡ªåŠ¨ç”Ÿæˆã€‚ jsonp: \"callback\", jsonpCallback:\"callbackMethod\", success:function(json){ alert(json.data); } }); }); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt; å‚è€ƒåšæ–‡ï¼šhttps://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.htmlhttps://www.cnblogs.com/JinQuanLi/p/6551415.html æ³¨å†Œç™»é™†ä¸šåŠ¡å®ç°sso-interfaceå®šä¹‰æ³¨å†Œç™»é™†çš„æ¥å£ æ ¹æ®å‚æ•°å’Œç±»å‹æ¥æ ¡éªŒå‚æ•°ï¼› æ³¨å†Œç”¨æˆ·ï¼› æ ¹æ®ç”¨æˆ·åå’Œå¯†ç ç™»å½•ï¼› æ ¹æ®tokenè·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼› ç”¨æˆ·ç™»å‡º sso-serviceç™»é™†é€»è¾‘ï¼š æ ¡éªŒæ•°æ®ï¼› ä¸æ•°æ®åº“å¯¹æ¯”ï¼Œå¦‚æœæˆåŠŸå°†å¯†ç è®¾ä¸ºnullï¼Œè¦æ±‚å­˜å…¥redisä¸­çš„ç”¨æˆ·å¯¹è±¡ä¸ä¿å­˜å¯†ç ï¼› éšæœºç”Ÿæˆç”¨æˆ·Tokenï¼Œä¼ ç»™controllerï¼Œç”¨äºåˆ›å»ºcookieï¼› æ¨¡æ‹ŸSessionã€‚ä»¥key=XXX:Tokenï¼Œvalue=ç”¨æˆ·å¯¹è±¡Jsonå­—ç¬¦ä¸²å­˜å…¥Redisï¼Œè®¾ç½®Redisä¸­çš„keyè¿‡æœŸæ—¶é—´ æ ¡éªŒç”¨æˆ·çš„Tokenæ˜¯å¦å­˜åœ¨ï¼š æ ¹æ®tokenæ‹¼æ¥Redisä¸­çš„Keyï¼ŒæŸ¥æ‰¾Redisä¸­æ˜¯å¦å­˜åœ¨å¯¹åº”çš„valueï¼› å¦‚æœæŸ¥åˆ°ï¼Œè¿”å›ç”¨æˆ·å¯¹è±¡ï¼Œé‡æ–°è®¾ç½®Redisä¸­keyçš„è¿‡æœŸæ—¶é—´ï¼› æœªæŸ¥åˆ°ï¼Œè¿”å›é”™è¯¯ å‘å¸ƒæœåŠ¡ï¼Œä»¥ä¾¿å…¶ä»–ç³»ç»Ÿè°ƒç”¨ sso-webç™»é™†é€»è¾‘ï¼š è°ƒç”¨æœåŠ¡ï¼Œæ¥æ”¶ç”¨æˆ·ç™»é™†åçš„Token åˆ›å»ºCookieï¼ˆè·¨åŸŸï¼‰ï¼Œkeyä¸ºæŒ‡å®šæ ‡è¯†ç¬¦ï¼Œvalue=tokenï¼Œè®¾ç½®cookieçš„è¿‡æœŸæ—¶é—´ï¼ˆæ¨¡æ‹Ÿsessionï¼‰ æ ¡éªŒç”¨æˆ·çš„Tokenæ˜¯å¦å­˜åœ¨ï¼šå¯èƒ½ä¼šå­˜åœ¨å…¶ä»–ç³»ç»Ÿè·¨åŸŸè°ƒç”¨æœ¬æ§åˆ¶å™¨æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»é™†ï¼Œæœ¬ç³»ç»Ÿä¸­è·¨åŸŸè¯·æ±‚ä½¿ç”¨JSONPçš„æ–¹å¼ï¼Œå› æ­¤æ–¹æ³•ç­¾ååº”æä¾›ä¸€ä¸ªcallbackçš„å‚æ•°ï¼Œç”¨æ¥ä»¥æ–¹æ³•ååŒ…è£¹è¿”å›Jsonçš„æ•°æ®ã€‚ åˆ¤æ–­æ˜¯å¦æ˜¯JONSPè¯·æ±‚ï¼Œå¦‚æœæ˜¯ï¼šè°ƒç”¨æœåŠ¡æ£€æµ‹Redisæ˜¯å¦å­˜åœ¨tokenè¿”å›æ£€æµ‹ç»“æœï¼Œå¹¶ç”¨å‡½æ•°ååŒ…è£¹jsonæ•°æ®ï¼› å¦‚æœä¸æ˜¯ï¼Œè°ƒç”¨æœåŠ¡æ­£å¸¸è¿”å›jsonæ•°æ® è®¿é—®è®¤è¯ä»¥æ‹¦æˆªå™¨å½¢å¼å®ç° ä¾èµ–sso-serviceã€sso-webå·¥ç¨‹ ä»cookieä¸­å–tokenã€‚ æ²¡æœ‰tokenï¼Œéœ€è¦è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚ æœ‰tokenã€‚è°ƒç”¨ssoç³»ç»Ÿçš„æœåŠ¡ï¼Œæ ¹æ®tokenæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚ å¦‚æœæŸ¥ä¸åˆ°ç”¨æˆ·ä¿¡æ¯ã€‚ç”¨æˆ·ç™»å½•å·²ç»è¿‡æœŸã€‚éœ€è¦è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚ æŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯ã€‚æ”¾è¡Œã€‚ æ–¹æ¡ˆä¸€ï¼šæ‹¦æˆªå™¨å†™åœ¨sso-webä¸­ï¼Œå…¶ä»–ç³»ç»Ÿä¾èµ–sso-webå·¥ç¨‹ï¼Œmvcé…ç½®æ–‡ä»¶é…ç½®Interceptorçš„ç±»åœ¨sso-webå·¥ç¨‹ä¸­ï¼Œä¼˜ç‚¹æ˜¯ä¸éœ€è¦æ¯ä¸ªç³»ç»Ÿéƒ½å†™æ‹¦æˆªå™¨ï¼Œåªéœ€è¦é…ç½®ï¼Œç¼ºç‚¹æ˜¯æ‹¦æˆªæ¡ä»¶ä¸æ–¹ä¾¿å®šåˆ¶ã€‚ æ–¹æ¡ˆä¸€ï¼šæ¯ä¸ªç³»ç»Ÿå®ç°è‡ªå·±çš„æ‹¦æˆªå™¨ï¼Œè°ƒç”¨sso-serviceæœåŠ¡è¿›è¡Œæ ¡éªŒç”¨æˆ·tokenã€‚ å¯æŠŠæˆ‘ç´¯åäº†ğŸ¤®","link":"/2018/07/27/åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆå…­ï¼‰/"},{"title":"å•ä¾‹è®¾è®¡æ¨¡å¼","text":"å•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œå³æŸä¸ªç±»åœ¨æ•´ä¸ªç³»ç»Ÿä¸­åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹å¯¹è±¡å¯è¢«è·å–å’Œä½¿ç”¨çš„ä»£ç æ¨¡å¼ã€‚ä¾‹å¦‚ï¼šä»£è¡¨JVMè¿è¡Œç¯å¢ƒçš„Runtimeç±» è¦ç‚¹ï¼š æŸä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ï¼› æ„é€ å™¨ç§æœ‰åŒ– æ˜¯å®ƒå¿…é¡»è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹ï¼› å«æœ‰ä¸€ä¸ªè¯¥ç±»çš„é™æ€å˜é‡æ¥ä¿å­˜è¿™ä¸ªå”¯ä¸€çš„å®ä¾‹ æ˜¯å®ƒå¿…é¡»è‡ªè¡Œå‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹; å¯¹å¤–æä¾›è·å–è¯¥å®ä¾‹å¯¹è±¡çš„æ–¹å¼ï¼šï¼ˆ1ï¼‰ç›´æ¥æš´éœ²ï¼ˆ2ï¼‰ç”¨é™æ€å˜é‡çš„getæ–¹æ³•è·å– é¥¿æ±‰å¼ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼Œä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ ç¼ºç‚¹ï¼šä¸ç®¡æ˜¯å¦éœ€è¦è¿™ä¸ªå¯¹è±¡ï¼Œéƒ½ä¼šåˆ›å»ºã€‚ æ–¹å¼1ï¼šç›´æ¥å®ä¾‹åŒ–é¥¿æ±‰å¼å¥½å¤„ï¼šç®€æ´ç›´è§‚ï¼Œå¤–éƒ¨å¯ä»¥ç›´æ¥è·å–è¿™ä¸ªå®ä¾‹ã€‚ 1234567public class Singleton1 { public static final Singleton1 SINGLETON = new Singleton1(); private Singleton1(){ }} æ–¹å¼2ï¼šæšä¸¾å¼æœ€ç®€æ´çš„æ–¹å¼ï¼šæšä¸¾ç±»å‹ï¼Œè¡¨ç¤ºè¯¥ç±»å‹çš„å¯¹è±¡æ˜¯æœ‰é™çš„å‡ ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥é™å®šä¸ºä¸€ä¸ªï¼Œå°±æˆäº†å•ä¾‹ã€‚ 123public enum Singleton2 { SINGLETON} æ–¹å¼3ï¼šé™æ€ä»£ç å—é¥¿æ±‰å¼é€‚åˆåœ¨å®ä¾‹åŒ–æ—¶éœ€è¦è¿›è¡Œå¤æ‚çš„åˆå§‹åŒ–æ“ä½œæ—¶ä½¿ç”¨ï¼Œæ¯”å¦‚åˆå§‹åŒ–å®ä¾‹æ—¶éœ€è¦åŠ è½½é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°ä½œä¸ºå®ä¾‹å˜é‡ã€‚ 12345678910111213141516171819202122232425262728293031public class Singleton3 { private static Singleton3 SINGLETON; private String info; static{ Properties properties = new Properties(); try { // é…ç½®æ–‡ä»¶åŠ è½½ä¹‹åä¼šåœ¨ç¼–è¯‘ç›®å½•é‡Œé¢ï¼Œé€šè¿‡è·å–å­—èŠ‚ç åŠ è½½å™¨å¯¹è±¡å–åˆ°ç¼–è¯‘ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚ properties.load(Singleton3.class.getClassLoader().getResourceAsStream(\"xyz/yuzh/interview/singleton/info.properties\")); } catch (IOException e) { } SINGLETON = new Singleton3(properties.getProperty(\"info\")); } private Singleton3(String info){ this.info = info; } public static Singleton3 getInstance(){ return SINGLETON; } @Override public String toString() { return \"Singleton3{\" + \"info='\" + info + '\\'' + '}'; }} æ‡’æ±‰å¼å»¶è¿Ÿåˆ›å»ºå¯¹è±¡ æ–¹å¼1ï¼šçº¿ç¨‹ä¸å®‰å…¨å•çº¿ç¨‹ä¸‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯å¤šçº¿ç¨‹ä¸‹æ˜¯ä¸å®‰å…¨çš„ã€‚ 123456789101112public class Singleton4 { private static Singleton4 singleton; private Singleton4() { } public static Singleton4 getInstance() { if (singleton == null) { singleton = new Singleton4(); } return singleton; }} ç”¨ä¾‹ï¼š 123456789101112131415161718192021222324public class Singleton4Test { public static void main(String[] args) throws ExecutionException, InterruptedException { /*Callable&lt;Singleton4&gt; callable = new Callable&lt;Singleton4&gt;() { @Override public Singleton4 call() throws Exception { return Singleton4.getInstance(); } };*/ Callable&lt;Singleton4&gt; callable = () -&gt; { return Singleton4.getInstance(); }; ExecutorService es = Executors.newFixedThreadPool(5); Future&lt;Singleton4&gt; future1 = es.submit(callable); // æäº¤ä¸€ä¸ªä»»åŠ¡ Future&lt;Singleton4&gt; future2 = es.submit(callable); // å†æäº¤ä¸€ä¸ªä»»åŠ¡ es.shutdown(); Singleton4 s1 = future1.get(); Singleton4 s2 = future2.get(); System.out.println(s1 == s2); }} ç»“æœï¼š false æ–¹å¼2ï¼šçº¿ç¨‹å®‰å…¨123456789101112131415161718public class Singleton5 { private static Singleton5 singleton; private Singleton5() { } public static Singleton5 getInstance() { if (singleton == null) { synchronized (Singleton5.class) { if (singleton == null) { singleton = new Singleton5(); } } } return singleton; }} æ–¹å¼3ï¼šé™æ€å†…éƒ¨ç±»å½¢å¼ï¼Œçº¿ç¨‹å®‰å…¨æœ€ç®€æ´çš„æ–¹å¼ï¼Œåœ¨å†…éƒ¨ç±»è¢«åŠ è½½å’Œåˆå§‹åŒ–æ—¶ï¼Œæ‰åˆ›å»º SINGLETON å®ä¾‹å¯¹è±¡ã€‚é™æ€å†…éƒ¨ç±»ä¸ä¼šè‡ªåŠ¨éšç€å¤–éƒ¨ç±»çš„åŠ è½½å’Œåˆå§‹åŒ–è€Œåˆå§‹åŒ–ï¼Œå®ƒæ˜¯è¦å•ç‹¬å»åŠ è½½å’Œåˆå§‹åŒ–çš„ã€‚å› ä¸ºæ˜¯åœ¨å†…éƒ¨ç±»åŠ è½½å’Œåˆå§‹åŒ–æ—¶ï¼Œåˆ›å»ºçš„ï¼Œå› æ­¤æ˜¯çº¿ç¨‹å®‰å…¨çš„ 12345678910111213public class Singleton6{ private Singleton6() { } public static class Inner{ private static final Singleton6 SINGLETON = new Singleton6(); } public static Singleton6 getInstance(){ return Inner.singleton; }}","link":"/2018/10/30/å•ä¾‹è®¾è®¡æ¨¡å¼/"},{"title":"å¦‚ä½•ç»™é€šè¿‡è„šæœ¬æ·»åŠ çš„å…ƒç´ æ³¨å†Œäº‹ä»¶","text":"å‰ç«¯å¼±æ¸£ï¼Œè®°å½•ä¸€ä¸‹é—®é¢˜è§£å†³ï¼š 1234// äº‹ä»¶å†’æ³¡ï¼šç»™åŠ¨æ€æ·»åŠ çš„ html å…ƒç´ æ³¨å†Œäº‹ä»¶$(\"body\").on(\"click\", \".blog-edit-user\", function () { // .blog-edit-user æ˜¯éœ€è¦è¢«æ³¨å†Œäº‹ä»¶çš„å…ƒç´ æ ‡ç­¾} å‚è€ƒï¼šhttps://www.jb51.net/article/120018.htm","link":"/2018/10/13/å¦‚ä½•ç»™é€šè¿‡è„šæœ¬æ·»åŠ çš„ å…ƒç´ æ³¨å†Œäº‹ä»¶/"},{"title":"æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡","text":"12345678910111213141516171819202122232425public class Demo1 { static int s; int i; int j; { int i = 1; i++; j++; s++; } public void test(int j) { j++; i++; s++; } public static void main(String[] args) { Demo1 obj1 = new Demo1(); Demo1 obj2 = new Demo1(); obj1.test(10); obj1.test(20); obj2.test(30); System.out.println(obj1.i + \",\" + obj1.j + \",\" + obj1.s); System.out.println(obj2.i + \",\" + obj2.j + \",\" + obj2.s); }} æ‰§è¡Œç»“æœï¼š 2,1,5 1,1,5 è€ƒç‚¹ï¼š å°±è¿‘åŸåˆ™ å˜é‡çš„åˆ†ç±» æˆå‘˜å˜é‡ï¼šç±»å˜é‡ã€å®ä¾‹å˜é‡ å±€éƒ¨å˜é‡ éé™æ€ä»£ç å—çš„æ‰§è¡Œï¼šæ¯æ¬¡åˆ›å»ºå®ä¾‹å¯¹è±¡éƒ½ä¼šæ‰§è¡Œ æ–¹æ³•çš„è°ƒç”¨è§„åˆ™ï¼šè°ƒç”¨ä¸€æ¬¡æ‰§è¡Œä¸€æ¬¡ å±€éƒ¨å˜é‡ä¸æˆå‘˜å˜é‡çš„åŒºåˆ«ï¼š å€¼å­˜å‚¨çš„ä½ç½® å±€éƒ¨å˜é‡ï¼šæ ˆ å®ä¾‹å˜é‡ï¼šå † ç±»å˜é‡ï¼šæ–¹æ³•åŒºï¼Œä¸ç±»ç›¸å…³è”ï¼Œä»…å­˜ä¸€ä»½ ä½œç”¨åŸŸ å±€éƒ¨å˜é‡ï¼šä»å£°æ˜å¤„å¼€å§‹ï¼Œåˆ°æ‰€å±çš„ } ç»“æŸ å®ä¾‹å˜é‡ï¼šåœ¨å½“å‰ç±»ä¸­â€œthis.â€(æœ‰æ—¶this.å¯ä»¥ç¼ºçœ)ï¼Œåœ¨å…¶ä»–ç±»ä¸­â€œå¯¹è±¡å.â€è®¿é—® ç±»å˜é‡ï¼šåœ¨å½“å‰ç±»ä¸­â€œç±»å.â€(æœ‰æ—¶ç±»å.å¯ä»¥çœç•¥)ï¼Œåœ¨å…¶ä»–ç±»ä¸­â€œç±»å.â€æˆ–â€œå¯¹è±¡å.â€è®¿é—® ç”Ÿå‘½å‘¨æœŸ å±€éƒ¨å˜é‡ï¼šæ¯ä¸€ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸€æ¬¡è°ƒç”¨æ‰§è¡Œéƒ½æ˜¯æ–°çš„ç”Ÿå‘½å‘¨æœŸ å®ä¾‹å˜é‡ï¼šéšç€å¯¹è±¡çš„åˆ›å»ºè€Œåˆå§‹åŒ–ï¼Œéšç€å¯¹è±¡çš„è¢«å›æ”¶è€Œæ¶ˆäº¡ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹å˜é‡æ˜¯ç‹¬ç«‹çš„ ç±»å˜é‡ï¼šéšç€ç±»çš„åˆå§‹åŒ–è€Œåˆå§‹åŒ–ï¼Œéšç€ç±»çš„å¸è½½è€Œæ¶ˆäº¡ï¼Œè¯¥ç±»çš„æ‰€æœ‰å¯¹è±¡çš„ç±»å˜é‡æ˜¯å…±äº«çš„ åˆ†æï¼š ä¸€ã€è¿è¡Œ main æ–¹æ³•ï¼Œå¼€å§‹æ‰§è¡Œç±»åˆå§‹åŒ–æ–¹æ³•&lt;clinit&gt;()ï¼Œè¯¥æ–¹æ³•ç”±é™æ€ç±»å˜é‡æ˜¾ç¤ºèµ‹å€¼ä»£ç ã€é™æ€ä»£ç å—ç»„æˆï¼Œåœ¨æ­¤ç”¨ä¾‹ä¸­ï¼Œåªæœ‰é™æ€å˜é‡èµ‹å€¼è¯­å¥ï¼šstatic int s; ç±»å˜é‡ s å­˜åœ¨äºæ–¹æ³•åŒºä¸­ï¼Œè¯¥ç±»çš„æ‰€æœ‰å®ä¾‹å…±äº«è¿™ä¸€ä»½å˜é‡ æ­¤æ—¶ s = 0 äºŒã€line1ï¼š Demo1 obj1 = new Demo1(); åˆ›å»ºå®ä¾‹ï¼Œæ‰§è¡Œ &lt;init&gt;()ï¼Œè¯¥æ–¹æ³•ç”±éé™æ€å˜é‡æ˜¾ç¤ºèµ‹å€¼ä»£ç ã€éé™æ€ä»£ç å—ã€æ„é€ å™¨ç»„æˆï¼Œæ­¤ç”¨ä¾‹ä¸­æ ¹æ®é¡ºåºå…ˆæ‰§è¡Œéé™æ€å˜é‡æ˜¾ç¤ºèµ‹å€¼ä»£ç ï¼Œç„¶åæ‰§è¡Œéé™æ€ä»£ç å—ï¼Œæ„é€ å™¨æ— èµ‹å€¼è¯­å¥å¯å¿½ç•¥ã€‚åˆ›å»º obj1 å¯¹è±¡ï¼Œåœ¨å †ä¸­å¼€è¾Ÿäº†ä¸€ä»½ obj1 å®ä¾‹çš„å†…å­˜ç©ºé—´ï¼Œä¿å­˜ç€ iã€j ä¸¤ä¸ªå®ä¾‹å˜é‡ éé™æ€å˜é‡æ˜¾ç¤ºèµ‹å€¼ä»£ç æ‰§è¡Œåï¼š obj1.i = 0 obj1.j = 0 -------------------------- éé™æ€ä»£ç å—æ‰§è¡Œåï¼š // i è¿˜æ˜¯ä¸º0ï¼Œæ ¹æ®å°±è¿‘åŸåˆ™ï¼Œéé™æ€ä»£ç å—ä¸­çš„è‡ªå¢çš„å˜é‡ i ä¸æ˜¯å®ä¾‹å˜é‡iï¼Œè€Œæ˜¯å±€éƒ¨å˜é‡iï¼Œä»£ç å—ç»“æŸä¹‹åè¯¥å˜é‡æ¶ˆäº¡ obj1.i = 0 obj1.j = 1 Demo.s = 1 // å…±äº«å˜é‡ï¼Œç±»å˜é‡ ä¸‰ã€line2ï¼š Demo1 obj2 = new Demo1(); åˆ›å»ºå®ä¾‹ï¼Œæ‰§è¡Œ &lt;init&gt;() å,å®ä¾‹å˜é‡å’Œ obj1 ä¸€æ ·ï¼Œä½†æ˜¯ç±»å˜é‡å‘ç”Ÿå˜åŒ– obj2.i = 0 obj2.j = 1 Demo.s = 2 // ç”±äºæ˜¯å…±äº«å˜é‡ï¼Œæ­¤æ—¶ç±»å˜é‡é€’å¢ä¸º2 å››ã€line3ï¼š obj1.test(10); main æ–¹æ³•ä¼ äº†å½¢å‚ 10 çš„å€¼ç»™ test æ–¹æ³•ï¼ŒJVM ä¸º test() åœ¨æ ˆä¸­å¼€è¾Ÿäº†ä¸€ä¸ªç©ºé—´å­˜å‚¨å±€éƒ¨å˜é‡ j ,ç”±äºæœªæŒ‡æ˜è‡ªå¢çš„ j æ˜¯å“ªä¸ªå˜é‡ï¼Œæ ¹æ®å°±è¿‘åŸåˆ™ï¼Œç»™å±€éƒ¨å˜é‡ j è‡ªå¢ä¸º 11ï¼Œç„¶åå†ç»™obj1çš„å…¶ä»–å®ä¾‹å˜é‡èµ‹å€¼ obj1.i = 1 // è‡ªå¢1 obj1.j = 1 // è‡ªå¢çš„å±€éƒ¨å˜é‡jï¼Œè¦æƒ³æŒ‡å®šè‡ªå¢å®ä¾‹å˜é‡ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®š this.j++ Demo.s = 3 // ç»§ç»­è‡ªå¢ äº”ã€line4ï¼š obj1.test(20); obj1.i = 2 obj1.j = 1 Demo.s = 4 å…­ã€line5ï¼š obj2.test(30); obj2.i = 1 obj2.j = 1 Demo.s = 5 æ¯åˆ›å»ºä¸€ä¸ªDemoçš„å®ä¾‹ï¼Œå°±ä¼šåœ¨å †ä¸­å¼€è¾Ÿæ–°çš„è¿™ä¸ªè¯¥å¯¹è±¡å®ä¾‹çš„å˜é‡ç©ºé—´ï¼Œä¸åŒå®ä¾‹å˜é‡ä¹‹é—´äº’ä¸å½±å“ï¼Œéšç€å®ä¾‹çš„å›æ”¶è€Œæ¶ˆäº¡ï¼Œä½†æ˜¯ç±»å˜é‡æ˜¯ç‹¬æœ‰ä¸€ä»½çš„ï¼Œæ¯ä¸ªå®ä¾‹æ“ä½œçš„æ˜¯åŒä¸€ä»½ã€‚æ•…æ­¤æ—¶ obj1 å’Œ obj2 çš„è¾“å‡ºï¼š obj1.i = 2 obj1.j = 1 obj1.s = 5 // ç±»å˜é‡ä¹Ÿå¯ä»¥é€šè¿‡å®ä¾‹å¼•ç”¨è°ƒç”¨ obj2.i = 1 obj2.j = 1 obj2.s = 5","link":"/2018/11/03/æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡/"},{"title":"æ•°æ®åº“å¸¸ç”¨äº‹åŠ¡ä¼ æ’­è¡Œä¸ºä¸éš”ç¦»çº§åˆ«","text":"äº‹åŠ¡ä¼ æ’­è¡Œä¸ºå½“äº‹åŠ¡æ–¹æ³•è¢«å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨æ—¶ï¼Œå¿…é¡»æŒ‡å®šäº‹åŠ¡åº”è¯¥å¦‚ä½•ä¼ æ’­ã€‚ä¾‹å¦‚ï¼šæ–¹æ³•å¯èƒ½ç»§ç»­åœ¨ç°æœ‰äº‹åŠ¡ä¸­è¿è¡Œï¼Œä¹Ÿå¯èƒ½å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¹¶åœ¨è‡ªå·±çš„äº‹åŠ¡ä¸­è¿è¡Œã€‚ äº‹åŠ¡ä¼ æ’­è¡Œä¸ºç”±äº‹åŠ¡ä¼ æ’­å±æ€§æŒ‡å®šï¼Œä»¥ä¸‹æ˜¯ Spring æ”¯æŒçš„ 7 ç§ä¼ æ’­è¡Œä¸ºï¼š ä¼ æ’­å±æ€§ æè¿° REQUIRED* å¦‚æœç”±äº‹åŠ¡åœ¨è¿è¡Œï¼Œå½“å‰çš„æ–¹æ³•å°±åœ¨è¿™ä¸ªäº‹åŠ¡å†…è¿è¡Œã€‚å¦åˆ™ï¼Œå°±å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¹¶åœ¨è‡ªå·±çš„äº‹åŠ¡ä¸­è¿è¡Œã€‚ REQUIRES_NEW* å½“å‰æ–¹æ³•å¿…é¡»å¯åŠ¨æ–°äº‹åŠ¡ï¼Œå¹¶åœ¨è‡ªå·±çš„äº‹åŠ¡ä¸­è¿è¡Œã€‚å¦‚æœæœ‰äº‹åŠ¡æ­£åœ¨è¿è¡Œï¼Œå°†è¯¥äº‹åŠ¡æŒ‚èµ·ã€‚ SUPPORTS å¦‚æœæœ‰äº‹åŠ¡åœ¨è¿è¡Œï¼Œå½“å‰çš„æ–¹æ³•å°±åœ¨è¿™ä¸ªäº‹åŠ¡ä¸­è¿è¡Œã€‚å¦åˆ™å®ƒå¯ä»¥ä¸è¿è¡Œåœ¨äº‹åŠ¡ä¸­ã€‚ï¼ˆæœ‰äº‹åŠ¡ç¯å¢ƒå¯ä»¥è¿è¡Œåœ¨äº‹åŠ¡ï¼Œæ²¡æœ‰ä¹Ÿè¡Œï¼‰ NOT_SUPPORT å½“å‰çš„æ–¹æ³•ä¸åº”è¯¥è¿è¡Œåœ¨äº‹åŠ¡ä¸­ï¼Œå¦‚æœæœ‰è¿è¡Œçš„äº‹åŠ¡ï¼Œå°†å®ƒæŒ‚èµ·ã€‚ MANDATORY å½“å‰æ–¹æ³•å¿…é¡»è¿è¡Œåœ¨äº‹åŠ¡å†…éƒ¨ï¼Œå¦‚æœæ²¡æœ‰æ­£åœ¨è¿è¡Œçš„äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚ NERVER å½“å‰çš„æ–¹æ³•ä¸åº”è¯¥è¿è¡Œåœ¨äº‹åŠ¡ä¸­ï¼Œå¦‚æœæœ‰è¿è¡Œçš„äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚ NESTED å¦‚æœæœ‰äº‹åŠ¡åœ¨è¿è¡Œï¼Œå½“å‰çš„æ–¹æ³•å°±åº”è¯¥åœ¨è¿™ä¸ªäº‹åŠ¡çš„åµŒå¥—äº‹åŠ¡ä¸­è¿è¡Œã€‚å¦åˆ™ï¼Œå°±å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¹¶åœ¨å®ƒè‡ªå·±çš„äº‹åŠ¡å†…è¿è¡Œã€‚ [ æ¨¡æ‹Ÿä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³• ] 123456789101112131415161718192021222324@Service(\"userService\")public class UserServiceImpl{ @Autowired BookService bookService; @Transactional(propagation = Propagation.REQUIRED) // é»˜è®¤å€¼ public void buyBooks(int userId, int[] booksId){ for(int bookId : booksId){ bookService.pay(userId, bookId); } }}@Service(\"bookService\")public class BookServiceImpl{ @Transactional public void pay(int userId, int bookId){ // TODO æŸ¥è¯¢å›¾ä¹¦å®ä½“ // TODO æŸ¥è¯¢ç”¨æˆ·å®ä½“ // TODO å‡å°‘åº“å­˜ // TODO å‡å°‘è´¦æˆ·ä½™é¢ }} ä¸Šé¢çš„ä¼ªä»£ç æ„æ€æ˜¯ç”¨æˆ·è°ƒç”¨äº‹åŠ¡æ–¹æ³•ï¼šbuyBooks() è´­ä¹°å¤šæœ¬å›¾ä¹¦ï¼ŒbuyBooks() å¤šæ¬¡è°ƒç”¨äº‹åŠ¡æ–¹æ³•ï¼špay()ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªæ–¹æ³•çš„ä¼ æ’­è¡Œä¸ºéƒ½æ˜¯ REQUIRED,å³ï¼š è™½ç„¶pay()è‡ªå¸¦äº‹åŠ¡ï¼Œä½†æ˜¯ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºè°ƒç”¨æ–¹buyBooks()æœ¬èº«æ˜¯äº‹åŠ¡æ–¹æ³•ï¼Œæ‰€ä»¥å…±ç”¨ä¸€ä¸ªäº‹åŠ¡ã€‚ è€ƒè™‘è¿™æ ·ä¸€ç§æƒ…å†µï¼šå‡å¦‚ç”¨æˆ·éœ€è¦è´­ä¹°ä¸¤æœ¬ä¹¦ï¼Œå½“ buyBooks() ç¬¬ä¸€æ¬¡æ­£å¸¸è°ƒç”¨ pay() åï¼Œåº“å­˜å‡å°‘ä¸€æœ¬ä¹¦ï¼Œç”¨æˆ·ä½™é¢å‡å°‘å¯¹åº”çš„ä¹¦çš„ä»·æ ¼ã€‚ä½†æ˜¯ç¬¬äºŒæ¬¡è°ƒç”¨ buyBooks() æ—¶å‘ç”Ÿå¼‚å¸¸ï¼šç”¨æˆ·ä½™é¢ä¸è¶³ä»¥è´­ä¹°ç¬¬äºŒæœ¬ä¹¦ï¼Œæ•°æ®åº“å›æ»šã€‚æ­¤æ—¶ç”¨æˆ·æ˜¯è´­ä¹°äº†ä¸€æœ¬ä¹¦æˆåŠŸï¼Ÿè¿˜æ˜¯ä¸¤æœ¬ä¹¦è´­ä¹°éƒ½æ²¡æˆåŠŸï¼Ÿ å½“ä¼ æ’­è¡Œä¸ºæ˜¯ REQUIRED æ—¶ï¼šä¸¤æœ¬ä¹¦éƒ½è´­ä¹°å¤±è´¥ã€‚å°½ç®¡ç¬¬ä¸€æœ¬ä¹¦è´­ä¹°æˆåŠŸäº†ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡è´­ä¹°è¿˜æ˜¯åœ¨ buyBooks() æ–¹æ³•å‘ç”Ÿçš„ï¼Œpay() å¹¶æ²¡æœ‰èµ·ä½œç”¨ï¼Œæ‰€ä»¥äº‹åŠ¡ä¸€èµ·å¤±è´¥ã€‚ å½“ä¼ æ’­è¡Œä¸ºæ˜¯ REQUIREDS_NEW æ—¶ï¼šç¬¬ä¸€æœ¬ä¹¦è´­ä¹°æˆåŠŸï¼Œç¬¬äºŒæœ¬ä¹¦è´­ä¹°å¤±è´¥ã€‚buyBooks() æ–¹æ³•å¤„åœ¨ä¸€ä¸ªäº‹åŠ¡ç¯å¢ƒä¸­ï¼Œpay() ä¹Ÿå¤„åœ¨è‡ªå·±çš„äº‹åŠ¡ç¯å¢ƒä¸­ï¼Œå½“ buyBooks() æ‰§è¡Œåˆ°è°ƒç”¨ pay() æ—¶ï¼Œå½“å‰çš„äº‹åŠ¡ä¼šæŒ‚èµ·ï¼Œå»æ‰§è¡Œå®Œæ¯• pay() çš„äº‹åŠ¡ä¹‹åå†ç»§ç»­æ‰§è¡Œè‡ªå·±çš„äº‹åŠ¡ã€‚æ³¨æ„ï¼šbuyBooks() æ–¹æ³•ä¸­é™¤äº† pay() ä¸å—è‡ªå·±çš„äº‹åŠ¡æ§åˆ¶ä¹‹å¤–ï¼Œå…¶ä»–ä»£ç ä»å¤„äºè‡ªå·±çš„äº‹åŠ¡ç¯å¢ƒä¹‹ä¸­ã€‚ äº‹åŠ¡éš”ç¦»çº§åˆ«äº‹åŠ¡éš”ç¦»æ§åˆ¶ä¸€èˆ¬åº”ç”¨åœ¨å¤šçº¿ç¨‹å¹¶å‘è®¿é—®æ“ä½œæ•°æ®åº“çš„æ—¶å‡ºç°çš„å¹¶å‘é—®é¢˜ä¸Š æ•°æ®åº“å¹¶å‘é—®é¢˜å‡è®¾ç°æœ‰ä¸¤ä¸ªäº‹åŠ¡ï¼šTransactional-1 å’Œ Transactional-2 å¹¶å‘æ‰§è¡Œã€‚ è„è¯» Transactional-1 å°†æŸæ¡è®°å½•çš„ age å€¼ä» 20 ä¿®æ”¹ä¸º 30ã€‚ï¼ˆæœªæäº¤ï¼‰ Transactional-2 è¯»å–äº† Transactional-1 æ›´æ–°åçš„å€¼ï¼š30ã€‚ Transactional-1 å›æ»šï¼Œage å€¼å›åˆ°äº† 20ã€‚ Transactional-2 è¯»åˆ°çš„ 30 å°±æ˜¯ä¸€ä¸ªæ— æ•ˆçš„å€¼ã€‚ï¼ˆè¯»åˆ°äº†å…¶ä»–äº‹åŠ¡æ›´æ–°ä½†æœªæäº¤çš„å€¼ï¼‰ ä¸å¯é‡å¤è¯» Transactional-1 è¯»å–äº† age çš„å€¼ä¸º 20ã€‚ï¼ˆè¯»å–æ— éœ€äº‹åŠ¡ï¼‰ Transactional-2 å°† age çš„å€¼ä¿®æ”¹ä¸º 30ã€‚ï¼ˆå·²æäº¤ï¼‰ Transactional-1 å†æ¬¡è¯»å– age çš„å€¼ä¸º 30ï¼Œå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ä¸ä¸€è‡´ã€‚ å¹»è¯» Transactional-1 è¯»å–äº† student è¡¨ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®ã€‚ Transactional-2 å‘ student è¡¨ä¸­æ’å…¥äº†æ–°çš„è¡Œã€‚ Transactional-1 è¯»å– student è¡¨æ—¶ï¼Œå¤šå‡ºäº†æ–°çš„è¡Œã€‚ éš”ç¦»çº§åˆ«éš”ç¦»çº§åˆ«è¶Šé«˜ï¼Œæ•°æ®ä¸€è‡´æ€§è¶Šå¥½ã€‚å¹¶å‘æ€§èƒ½è¶Šå¼±ã€‚ è¯»æœªæäº¤ï¼šREAD UNCOMMITTED å…è®¸ Transactional-1 è¯»å– Transactional-2 æœªæäº¤çš„ä¿®æ”¹ã€‚ è¯»å·²æäº¤ï¼šREAD COMMITTED ä¸€èˆ¬è®¾ç½®è¿™ä¸ªçº§åˆ« è¦æ±‚ Transactional-1 åªèƒ½è¯»å– Transactional-2 å·²æäº¤çš„ä¿®æ”¹ å¯é‡å¤åº¦ï¼šREPEATABLE READ ç¡®ä¿ Transactional-1 å¯ä»¥å¤šæ¬¡ä»ä¸€ä¸ªå­—æ®µä¸­è¯»å–ç›¸åŒçš„å€¼ï¼Œå³ï¼šTransactional-1 æ‰§è¡ŒæœŸé—´ç¦æ­¢å…¶ä»–äº‹åŠ¡å¯¹è¿™ä¸ªå­—æ®µæ›´æ–°ã€‚ï¼ˆå¯ç†è§£ä¸ºè¡Œé”ï¼‰ ä¸²è¡ŒåŒ–ï¼šSERIALIZABLE ç¡®ä¿ Transactional-1 å¯ä»¥å¤šæ¬¡ä»ä¸€ä¸ªè¡¨è¯»å–åˆ°ç›¸åŒçš„è¡Œï¼Œåœ¨ Transactional-1 æ‰§è¡ŒæœŸé—´ç¦æ­¢å…¶ä»–äº‹åŠ¡å¯¹è¿™ä¸ªè¡¨è¿›è¡Œæ·»åŠ ã€æ›´æ–°ã€åˆ é™¤æ“ä½œã€‚å¯ä»¥é¿å…ä»»åŠ¡å¹¶å‘é—®é¢˜ï¼Œä½†æ€§èƒ½ä¸‹é™ã€‚ï¼ˆå¯ç†è§£ä¸ºè¡¨é”ï¼‰","link":"/2018/11/04/æ•°æ®åº“å¸¸ç”¨äº‹åŠ¡ä¼ æ’­è¡Œä¸ºä¸éš”ç¦»çº§åˆ«/"},{"title":"Linux - æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½","text":"scpå‘½ä»¤ scp æ˜¯ source copy çš„ç¼©å†™ï¼Œèœé¸Ÿæ•™ç¨‹ ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°å¦‚\bï¼šå°†æœåŠ¡å™¨ä¸­ hexo.tar.gz å¤åˆ¶åˆ°æœ¬åœ°å½“å‰è·¯å¾„ scp root@120.78.69.82:/opt/hexo.tar.gz . 1\bnoteï¼šè¿œç¨‹æœåŠ¡å™¨æ–‡ä»¶è·¯å¾„éœ€è¦æ˜¯\bç»å¯¹è·¯å¾„ ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨\bä¸Šä¼ æœ¬åœ°å½“å‰è·¯å¾„ä¸‹çš„ \bnginx.conf åˆ°è¿œç¨‹æœåŠ¡å™¨æ ¹ç›®å½•ä¸‹\b\b\bscp nginx.conf root@120.78.69.82:~/ noteï¼šä¸æ”¯æŒä¸Šä¼ æ–‡ä»¶å¤¹ï¼Œä½†æ˜¯å¯ä»¥ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Œå¦‚ï¼š 123scp ./* root@120.78.69.82:~/nginx-container-config/cert2190670_yuzh.xyz.key 100% 1675 40.0KB/s 00:002190670_yuzh.xyz.pem 100% 3651 116.9KB/s 00:00","link":"/2019/06/21/æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½/"},{"title":"æ–¹æ³•çš„å‚æ•°ä¼ é€’æœºåˆ¶","text":"1234567891011121314151617181920212223242526272829public class Demo1 { public static void main(String[] args) { int i = 1; String str = \"hello\"; Integer num = 200; int[] arr = {1, 2, 3, 4, 5}; MyData my = new MyData(); change(i, str, num, arr, my); System.out.println(\"i = \" + i); System.out.println(\"str = \" + str); System.out.println(\"num = \" + num); System.out.println(\"arr = \" + Arrays.toString(arr)); System.out.println(\"my.a = \" + my.a); } public static void change(int j, String s, Integer n, int[] a, MyData m) { j += 1; s += \"world\"; n += 1; a[0] += 1; m.a += 1; }}class MyData { int a = 10;} è¿è¡Œç»“æœ i = 1 str = hello num = 200 arr = [2,2,3,4,5] my.a = 11 è€ƒç‚¹ï¼š æ–¹æ³•çš„å‚æ•°ä¼ é€’æœºåˆ¶ Stringã€Integer ç­‰åŒ…è£…ç±»çš„ä¸å¯å˜æ€§ æ–¹æ³•ä¼ é€’æœºåˆ¶ï¼š åŸºæœ¬æ•°æ®ç±»å‹æ˜¯å€¼ä¼ é€’ å¼•ç”¨ç±»å‹æ˜¯åœ°å€å€¼ä¼ é€’ ç‰¹æ®Šç±»å‹å¦‚ Stringã€åŒ…è£…ç±»ç­‰å¯¹è±¡ä¸å¯å˜ åˆ†æï¼š æ–¹æ³•ä¸­çš„å˜é‡ç§°ä¸ºå±€éƒ¨å˜é‡ï¼Œæ¯ä¸ªæ–¹æ³•åœ¨æ ˆä¸­æœ‰å±äºè‡ªå·±çš„æ–¹æ³•åŒºï¼Œå±€éƒ¨å˜é‡å­˜åœ¨è‡ªå·±çš„æ–¹æ³•åŒºã€‚change() æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œå†…å­˜ç»“æ„ç®€å•å¦‚ä¸‹ï¼š æ‰§è¡Œ change() æ–¹æ³•ï¼Œå‚æ•°ä¼ é€’ä»£ç æ‰§è¡Œä¹‹å‰ï¼š change() æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼š change() æ‰§è¡Œä¹‹åï¼Œchange æ–¹æ³•åŒºè¢«é‡Šæ”¾ï¼Œè§‚å¯Ÿ main æ–¹æ³•åŒºçš„ç®­å¤´æŒ‡å‘ï¼š i åªæ˜¯å°†å€¼å¤åˆ¶äº†ä¸€ä»½ç»™ jï¼Œæœ¬èº«çš„å€¼æ²¡å˜ str ä»£è¡¨çš„ â€œhelloâ€ è¿™ä¸€ä»½å¸¸é‡ï¼Œç”±äº String ä¸å¯å˜æ€§ï¼Œchange å¯¹è¿™ä¸ªå¸¸é‡æ‹¼æ¥å½¢æˆäº†æ–°çš„å¸¸é‡ï¼Œä½†æ˜¯ str æŒ‡å‘çš„è¿˜æ˜¯åŸæ¥çš„ â€œhelloâ€ num æ˜¯ Integer ä¸å¯å˜ç±»å‹ï¼Œåœ¨å †ä¸­ä¹Ÿåˆ›å»ºäº†å¦å¤–ä¸€ä»½å˜é‡ï¼Œæœ¬èº«æ²¡å˜ arr æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå€¼è¢«æ”¹å˜ m æ˜¯å¼•ç”¨ç±»å‹ï¼Œchange ä¸­ä¿å­˜äº†è¿™ä¸ªå¼•ç”¨ï¼Œå¹¶å°†å®ä¾‹å˜é‡ a æ”¹å˜äº†","link":"/2018/10/30/æ–¹æ³•çš„å‚æ•°ä¼ é€’æœºåˆ¶/"},{"title":"Linux - æ— å¯†ç è®¿é—® linux æœåŠ¡å™¨","text":"æœ¬åœ°ç”Ÿæˆ SSKEY \bcommandï¼š ssh-keygen thenï¼š 123-rw-------@ 1 harry staff 1.8K Apr 6 09:38 id_rsa å¯†é’¥-rw-r--r--@ 1 harry staff 399B Apr 6 09:38 id_rsa.pub å…¬é’¥-rw-r--r-- 1 harry staff 4.5K May 28 11:43 known_hosts å°†å…¬é’¥å¤åˆ¶åˆ°è¿œç¨‹æœåŠ¡å™¨çš„ ./ssh/authorized_keys ä¸­","link":"/2019/06/21/æ— å¯†ç è®¿é—® linux æœåŠ¡å™¨/"},{"title":"Linux - æŸ¥çœ‹ç«¯å£å ç”¨åŠç½‘ç»œæƒ…å†µ","text":"netstatå¸¸ç”¨å‚æ•° -a æ‰€æœ‰ä¿¡æ¯ -u æ˜¾ç¤º UDP åè®®çš„è¿æ¥çŠ¶å†µ -t æ˜¾ç¤º TCP åè®®çš„è¿æ¥çŠ¶å†µ -l listeningï¼Œ\bæ˜¾ç¤ºç›‘æ§ä¸­çš„é€šä¿¡ -n numericï¼Œç›´æ¥æ˜¾ç¤º IP -p programsï¼Œä¸æ­¤é€šä¿¡ç»‘å®šçš„ç¨‹åº å¦‚ä½•è§£å†³ç«¯å£å ç”¨ï¼Ÿ netstat -tulnp æ ¹æ®ç«¯å£å·æ‰¾åˆ°PID kill -9 PID","link":"/2019/06/21/æŸ¥çœ‹ç«¯å£å ç”¨åŠç½‘ç»œæƒ…å†µ/"},{"title":"æ ‘çš„ä¸‰ç§éå†æ–¹å¼","text":"ä»¥ä¸Šæ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‰ç§ä¸åŒçš„æ–¹å¼éå†å®ƒï¼Œå…ˆåˆ›å»ºæ ‘çš„èŠ‚ç‚¹å¯¹è±¡ï¼š 12345678910111213141516171819/** * æ ‘èŠ‚ç‚¹ * * @author yu.zh [yuzh233@gmail.com] * @date 2018/11/08 */public class TreeNode { private String value; private TreeNode leftNode; private TreeNode rightNode; public TreeNode(String value) { this.value = value; this.leftNode = null; this.rightNode = null; } // getter and setter} å†æ„å»ºä¸€æ£µæ ‘ï¼š 1234567891011121314151617181920212223242526272829303132/** * åˆ›å»ºä¸€ä¸ªæ ‘ç»“æ„ * * @author yu.zh [yuzh233@gmail.com] * @date 2018/11/08 */public class TreeCreator { private TreeCreator() { } public static TreeNode getInstance() { return TreeCreatorFactory.root; } public static class TreeCreatorFactory { private static TreeNode root; static{ root = new TreeNode(\"A\"); // ä¸€çº§èŠ‚ç‚¹ root.setLeftNode(new TreeNode(\"B\")); root.setRightNode(new TreeNode(\"C\")); // äºŒçº§èŠ‚ç‚¹ root.getLeftNode().setLeftNode(new TreeNode(\"D\")); root.getLeftNode().setRightNode(new TreeNode(\"E\")); root.getRightNode().setRightNode(new TreeNode(\"F\")); // ä¸‰çº§èŠ‚ç‚¹ root.getLeftNode().getRightNode().setLeftNode(new TreeNode(\"G\")); } }} å‰åºéå†å‰åºéå†æ€æƒ³æ˜¯å…ˆéå†çˆ¶èŠ‚ç‚¹ï¼Œå†éå†å·¦å­èŠ‚ç‚¹ï¼Œæœ€åéå†å³å­èŠ‚ç‚¹ã€‚åˆ†æä¸Šé¢çš„æ ‘ç»“æ„ï¼š å…ˆæ‰“å° Aï¼› Aæœ‰å·¦å­èŠ‚ç‚¹å’Œå³å­èŠ‚ç‚¹ï¼Œå…ˆæ‰“å°å·¦å­èŠ‚ç‚¹ Bï¼›ï¼ˆå‰åºéå†å…ˆæ±‚çˆ¶èŠ‚ç‚¹ï¼Œä¸ç®¡Bæœ‰æ²¡æœ‰å­èŠ‚ç‚¹éƒ½ä¼šå…ˆéå†è‡ªå·±ï¼‰ Bæœ‰å·¦å­èŠ‚ç‚¹å’Œå³å­èŠ‚ç‚¹ï¼Œå…ˆæ‰“å°å·¦å­èŠ‚ç‚¹ Dï¼› Dæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œçœ‹çˆ¶èŠ‚ç‚¹Bçš„å³å­èŠ‚ç‚¹ï¼Œæ‰“å° Eã€‚ èŠ‚ç‚¹Eæœ‰å·¦å­èŠ‚ç‚¹ï¼Œæ‰“å° G Açš„å·¦å­èŠ‚ç‚¹æ‰§è¡Œå®Œæ¯•ï¼Œæ‰§è¡Œå³å­èŠ‚ç‚¹Cï¼Œæ‰“å° C Cæ²¡æœ‰å·¦å­èŠ‚ç‚¹ï¼Œæœ‰å³å­èŠ‚ç‚¹ï¼Œæ‰“å° F ä¸­åºéå†ä¸­åºéå†æ€æƒ³æ˜¯å…ˆéå†å·¦å­èŠ‚ç‚¹ï¼Œå†éå†çˆ¶èŠ‚ç‚¹ï¼Œæœ€åéå†å³å­èŠ‚ç‚¹ã€‚åˆ†æä¸Šé¢çš„æ ‘ç»“æ„ï¼š Aæœ‰å·¦å­èŠ‚ç‚¹Bï¼ŒBæœ‰å­èŠ‚ç‚¹Dï¼ŒDæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œæ‰“å° D ï¼ˆä¸­åºéå†å…ˆéå†å·¦å­èŠ‚ç‚¹å†éå†çˆ¶èŠ‚ç‚¹ï¼Œæ‰€ä»¥éœ€è¦å¾€ä¸‹é€’å½’ç›´åˆ°æ²¡æœ‰å­èŠ‚ç‚¹ä¸ºæ­¢ã€‚ï¼‰ DèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯Bï¼Œæ‰“å° B Bçš„å³å­èŠ‚ç‚¹æ˜¯Eï¼ŒEæœ‰å­èŠ‚ç‚¹Gï¼Œæ ¹æ®ä¸­åºè§„åˆ™ï¼Œå…ˆæ‰“å° G å†æ‰“å° E Bçš„çˆ¶èŠ‚ç‚¹æ˜¯Aï¼Œæ‰“å° A Aå³èŠ‚ç‚¹æ˜¯Cï¼ŒCæ²¡æœ‰å·¦å­èŠ‚ç‚¹ï¼Œäºæ˜¯æ‰“å°è‡ªå·± C Cçš„å³å­èŠ‚ç‚¹æ˜¯Fï¼Œæ‰“å° F ååºéå†ä¸­åºéå†æ€æƒ³æ˜¯å…ˆéå†å·¦å­èŠ‚ç‚¹ï¼Œå†éå†å³å­èŠ‚ç‚¹ï¼Œæœ€åéå†çˆ¶èŠ‚ç‚¹ã€‚åˆ†æä¸Šé¢çš„æ ‘ç»“æ„ï¼š Aæœ‰å·¦å­èŠ‚ç‚¹Bï¼ŒBæœ‰å­èŠ‚ç‚¹Dï¼ŒDæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œæ‰“å° D ï¼ˆååºéå†æœ€åæ‰éå†çˆ¶èŠ‚ç‚¹ï¼Œæœ‰å­èŠ‚ç‚¹éœ€è¦ä¸€ç›´é€’å½’ä¸‹å»ç›´åˆ°æ²¡æœ‰å­èŠ‚ç‚¹ã€‚ï¼‰ Dæœ‰å…„å¼ŸèŠ‚ç‚¹Eï¼Œä½†æ˜¯Eä¹Ÿæœ‰å­èŠ‚ç‚¹ï¼Œå…ˆæ‰“å°Eçš„å­èŠ‚ç‚¹ G Gæ‰“å°å®Œäº†ï¼Œæ²¡æœ‰å…„å¼ŸèŠ‚ç‚¹ï¼Œæ‰“å°çˆ¶èŠ‚ç‚¹ E Då’ŒEéƒ½æ‰§è¡Œå®Œäº†ï¼Œæ‰“å°ä»–ä»¬çš„çˆ¶èŠ‚ç‚¹ B Bæœ‰å…„å¼ŸèŠ‚ç‚¹Cï¼ŒCæœ‰å­èŠ‚ç‚¹Fï¼Œæ‰“å° F Cçš„å­èŠ‚ç‚¹éƒ½æ‰“å°å®Œäº†ï¼Œæ‰“å°è‡ªå·± C Açš„Bå’ŒCéƒ½æ‰“å°å®Œäº†ï¼Œæ‰“å°è‡ªå·± A ååºéå†æ–¹å¼å¸¸ç”¨ä½œç®€æ˜“çš„è®¡ç®—å™¨å¤„ç†ï¼Œå¦‚æˆ‘çš„ç®—æ³•ç¬”è®°ï¼š è¡¥å…¨è¡¨è¾¾å¼è½¬ä¸ºä¸­åºè¡¨è¾¾å¼ ä¸­åºè¡¨è¾¾å¼è½¬ååºè¡¨è¾¾å¼ ååºè¡¨è¾¾å¼æ±‚å€¼å®ç°ç®€å•è®¡ç®—å™¨","link":"/2018/11/08/æ ‘çš„ä¸‰ç§éå†æ–¹å¼/"},{"title":"æ ¹æ®æ ‘çš„å‰åºå’Œååºè¡¨è¾¾å¼æ„é€ å”¯ä¸€æ ‘","text":"åŸé¢˜æ˜¯â€œæ ¹æ®æ ‘çš„å‰åºå’Œååºè¡¨è¾¾å¼æ±‚ä¸­åºè¡¨è¾¾å¼â€ï¼Œæ„é€ å‡ºäº†æ ‘æ±‚ä¸­åºè¡¨è¾¾å¼è¿˜æ˜¯é—®é¢˜å—ï¼Ÿ æ„é€ æ ‘æ˜¯éœ€è¦ä¸€å®šæŠ€å·§çš„ï¼Œéœ€è¦ä¸æ–­çš„é€’å½’åˆ†æã€‚å°†å¤§è§„æ¨¡åˆ†ä¸ºå°è§„æ¨¡ï¼Œå°†æ¯ä¸ªå°è§„æ¨¡å†ç»†åˆ†ï¼Œç›´åˆ°ä¸å¯å†åˆ†ï¼Œæ ‘ä¹Ÿå°±æ„å»ºå¥½äº†ã€‚å°±è·Ÿ å½’å¹¶æ’åº ä¸€æ · å‰åºå’Œä¸­åºåˆ†åˆ«æ˜¯ï¼š pre: A B D E G C F on: D B G E A C F åˆ†æï¼ˆé€‰æ‹©é¢˜ï¼‰ä»å‰åºè¡¨è¾¾å¼å…¥æ‰‹ï¼šæˆ‘ä»¬çŸ¥é“å‰åºéå†çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯æ ¹èŠ‚ç‚¹ï¼Œç”±æ­¤ç¡®å®š A å°±æ˜¯æ ¹èŠ‚ç‚¹ å†æ¥çœ‹ä¸­åºè¡¨è¾¾å¼ï¼Œæ ¹æ®ä¸­åºè¡¨è¾¾å¼è§„åˆ™ï¼Œå…ˆéå†å·¦å­èŠ‚ç‚¹ï¼Œå†éå†çˆ¶èŠ‚ç‚¹ï¼Œå†éå†å³å­èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®š A å·¦è¾¹çš„éƒ½æ˜¯å·¦å­æ ‘ï¼Œå³è¾¹çš„éƒ½æ˜¯å³å­æ ‘ã€‚ åœ¨ on ä¸­çœ‹å¾—å‡º A çš„å·¦å­æ ‘ä¸ªæ•°æ˜¯ 4ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨ pre ä¸­å®šä½ A çš„å·¦å­æ ‘å’Œå³å­æ ‘ï¼š A çš„å·¦å­æ ‘å‰åºåºåˆ—æ˜¯ B D E Gï¼Œå³å­æ ‘å‰åºåºåˆ—æ˜¯ C Fï¼Œæ ¹æ®å‰åºè¡¨è¾¾å¼è§„åˆ™ï¼Œæ¯ä¸€ä¸ªåºåˆ—çš„ç¬¬ä¸€ä¸ªæ˜¯æ•´ä¸ªåºåˆ—çš„æ ¹èŠ‚ç‚¹ï¼Œäºæ˜¯å¯ä»¥æ¨æ–­å‡º A çš„å·¦å­æ ‘çš„æ ¹èŠ‚ç‚¹å’Œå³å­æ ‘çš„æ ¹èŠ‚ç‚¹åˆ†åˆ«æ˜¯ Bã€C å¾ªç¯ä¸Šé¢çš„çš„æ–¹æ³•ï¼Œåˆ†æ B çš„å·¦å­æ ‘ã€‚ï¼ˆå³å­æ ‘æš‚æ—¶ä¸ç®¡ï¼Œç­‰å·¦å­æ ‘åˆ†æå®Œæ¯•ä¹‹åå†åˆ†æã€‚ï¼‰ pre: B D E G on: D B G E ç”± B çš„å·¦è¾¹åªæœ‰ D å¯æ¨å¯¼å‡º D æ˜¯ B çš„å·¦å­æ ‘ï¼Œå¹¶ä¸”æ˜¯å”¯ä¸€èŠ‚ç‚¹ã€‚E æ˜¯ B çš„å³å­æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚ ç„¶åæ¨æ–­ B çš„å³å­æ ‘ pre: E G â€”â€”&gt; ï¼ˆåºåˆ—çš„ç¬¬ä¸€ä¸ªæ˜¯å¤´ï¼Œå› ä¸ºæ€»æ˜¯ä»å¤´å…ˆéå†ï¼‰E æ˜¯ G çš„çˆ¶èŠ‚ç‚¹ on: G E â€”â€”&gt; â€œå·¦ã€çˆ¶ã€å³â€ æ¨å¯¼å‡º G æ˜¯ E çš„å·¦å­èŠ‚ç‚¹ è‡³æ­¤ï¼Œæ ¹èŠ‚ç‚¹ A çš„å·¦å­æ ‘æœ‰äº†å½’å®¿ï¼Œç°åœ¨åˆ†æå³å­æ ‘ï¼š pre: C F â€”â€”&gt; C æ˜¯ F çš„å¤´èŠ‚ç‚¹ on: C F â€”â€”&gt; â€œå…ˆå·¦å†å¤´å†å³â€ æ¨å¯¼å‡º F æ˜¯ C çš„å³å­èŠ‚ç‚¹ æ‰€ä»¥å®ƒçš„ååºè¡¨è¾¾å¼æ˜¯ï¼šDGEBFCA å½’çº³ å¯¹äºä¸€ä¸²å‰åºè¡¨è¾¾å¼å’Œä¸­åºè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬æ€»æ˜¯å…ˆå–å‰åºè¡¨è¾¾å¼çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒæ˜¯å¤´ã€‚ å†æ ¹æ®è¿™ä¸ªå¤´åœ¨ä¸­åºä¸­çš„ä½ç½®æ¥ åˆ’åˆ† å¤´çš„å·¦å­æ ‘å’Œå³å­æ ‘ï¼Œæ ¹æ®ä¸­åºä¸­çš„å·¦å­æ ‘å’Œå³å­æ ‘çš„ä¸ªæ•°åœ¨å‰åºä¸­ç¡®å®šå·¦å­æ ‘èŒƒå›´å’Œå³å­æ ‘èŒƒå›´ã€‚ æ¯ä¸€ä¸ªèŒƒå›´çš„åºåˆ—éƒ½æœ‰å‰åºè¡¨è¾¾å¼å’Œä¸­åºè¡¨è¾¾å¼ï¼Œå¾ªç¯è°ƒç”¨æ­¥éª¤ 1 ï¼Œç›´åˆ°åºåˆ—åªæœ‰ä¸€ä¸ªã€‚ ä»£ç å®ç°ï¼ˆç¼–ç¨‹é¢˜ï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051public class TreeTraversal { /** * æ ¹æ®å‰åºå’Œä¸­åºè¡¨è¾¾å¼æ„å»ºæ ‘ */ public static TreeNode createTreeByPreOrderAndInOrder(String preOrder, String inOrder) { if (preOrder.isEmpty()) { return null; } char root = preOrder.charAt(0); // è·å–å‰åºçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ int rootIndex = inOrder.indexOf(root); // è·å–æ ¹èŠ‚ç‚¹åœ¨ä¸­åºä¸­çš„ä½ç½® TreeNode rootNode = new TreeNode(preOrder.substring(0, 1)); // åˆ›å»ºæ ¹èŠ‚ç‚¹ int leftCount = rootIndex; // æ ¹èŠ‚ç‚¹çš„å·¦å­æ ‘çš„ä¸­åºè¡¨è¾¾å¼å­—ç¬¦æ•°é‡ // é€’å½’æ„å»ºå·¦å­æ ‘ rootNode.setLeftNode(createTreeByPreOrderAndInOrder( preOrder.substring(1, leftCount + 1), // æˆªå–å‰åºè¡¨è¾¾å¼ä¸­ æ ¹èŠ‚ç‚¹ å·¦è¾¹çš„å­—ç¬¦ä¸² inOrder.substring(0, leftCount)) // æˆªå–ä¸­åºè¡¨è¾¾å¼ä¸­ æ ¹èŠ‚ç‚¹ å·¦è¾¹çš„å­—ç¬¦ä¸² ); // é€’å½’æ„å»ºå³å­æ ‘ rootNode.setRightNode(createTreeByPreOrderAndInOrder( preOrder.substring(leftCount + 1), // æˆªå–å‰åºè¡¨è¾¾å¼ä¸­ æ ¹èŠ‚ç‚¹ å³è¾¹çš„å­—ç¬¦ä¸² inOrder.substring(leftCount + 1) // æˆªå–å‰åºè¡¨è¾¾å¼ä¸­ æ ¹èŠ‚ç‚¹ å³è¾¹çš„å­—ç¬¦ä¸² )); return rootNode; } public static void main(String[] args) { // æ„é€ æ ‘ TreeNode root = TreeCreator.getInstance(); System.out.print(\"pre: \\t\"); preOrder(root); System.out.println(); System.out.print(\"in: \\t\"); inOrder(root); System.out.println(); System.out.print(\"post: \\t\"); postOrder(root); // æ ¹æ®å‰åºå’Œä¸­åºæ±‚ååº System.out.println(\"\\n---------- createTreeByPreOrderAndInOrder ----------\"); TreeNode rootNode = createTreeByPreOrderAndInOrder(\"ABDEGCF\", \"DBGEACF\"); postOrder(rootNode); }}","link":"/2018/11/08/æ ¹æ®æ ‘çš„å‰åºå’Œååºè¡¨è¾¾å¼æ„é€ å”¯ä¸€æ ‘/"},{"title":"Linux - ç£ç›˜ç®¡ç†","text":"æŸ¥çœ‹ç³»ç»Ÿç£ç›˜å ç”¨æƒ…å†µï¼šdf -h 12345678[root@jstuvn95c6ed5x /]# df -hFilesystem Size Used Avail Use% Mounted on/dev/vda1 40G 36G 2.0G 95% /devtmpfs 1.9G 0 1.9G 0% /devtmpfs 1.9G 0 1.9G 0% /dev/shmtmpfs 1.9G 2.5M 1.9G 1% /runtmpfs 1.9G 0 1.9G 0% /sys/fs/cgrouptmpfs 380M 0 380M 0% /run/user/0 æŸ¥çœ‹æ–‡ä»¶å ç”¨å¤§å°ï¼šdu -sh * 123456789101112131415161718192021222324252627[root@jstuvn95c6ed5x /]# du -sh *401M acs0 bin138M boot4.0K data0 dev37M etc90M home0 lib0 lib6416K lost+found4.0K media501M mnt4.0K optdu: cannot access â€˜proc/1743/task/1743/fd/4â€™: No such file or directorydu: cannot access â€˜proc/1743/task/1743/fdinfo/4â€™: No such file or directorydu: cannot access â€˜proc/1743/fd/4â€™: No such file or directorydu: cannot access â€˜proc/1743/fdinfo/4â€™: No such file or directory0 proc660M root2.5M run0 sbin4.0K srv0 sys152K tmp1.9G usr17G var åˆ é™¤ docker é•œåƒç¼“è§£ç£ç›˜å‹åŠ›docker rmi -f $(docker image | grep â€˜erpâ€™ | awk â€˜{print $3}â€™) awk æ˜¯è¡Œå¤„ç†å™¨å‘½ä»¤ï¼Œé€šå¸¸ç”¨æ¥æ ¼å¼åŒ–æ–‡æœ¬ä¿¡æ¯ï¼Œ ä¾æ¬¡å¯¹æ¯ä¸€è¡Œè¿›è¡Œå¤„ç†ï¼Œç„¶åè¾“å‡ºã€‚ awk '{print $3}' çš„æ„æ€æ˜¯æå–å½“å‰æ–‡æœ¬ä¸­çš„ç¬¬ä¸‰è¡Œï¼Œ$0 ä»£è¡¨å…¨éƒ¨ï¼Œä¸æ˜¯ç¬¬ä¸€è¡Œã€‚ 123å…¶å®ç›´æ¥ä½¿ç”¨ docker å†…ç½®å‘½ä»¤ä¹Ÿå¯ä»¥docker rmi $(docker image ls -qa)PSï¼šä¸è¦åŠ  `-f` å‚æ•°ï¼Œçº¿ä¸Šæœ‰å®¹å™¨æ­£åœ¨ä½¿ç”¨é•œåƒè¿è¡Œï¼Œä¸æ˜¯å¼€ç©ç¬‘çš„ğŸ˜‚ã€‚","link":"/2019/06/21/ç£ç›˜ç®¡ç†/"},{"title":"æºç è§’åº¦åˆ†æ CharacterEncodingFilter è§£å†³ Post è¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜","text":"Post ä¹±ç Spring MVC æä¾› CharacterEncodingFilter æ‹¦æˆªè¯·æ±‚å¤„ç†ç¼–ç æ ¼å¼é—®é¢˜12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485package org.springframework.web.filter;public class CharacterEncodingFilter extends OncePerRequestFilter { private String encoding; // æŒ‡å®šçš„ç¼–ç æ ¼å¼ private boolean forceRequestEncoding = false; // æ˜¯å¦è®¾ç½®è¯·æ±‚ç¼–ç æ ¼å¼ private boolean forceResponseEncoding = false; // æ˜¯å¦è®¾ç½®å“åº”ç¼–ç æ ¼å¼ public CharacterEncodingFilter() { } /** * xmlé…ç½®ï¼šä¸€èˆ¬åªéœ€è¦è®¾ç½®ç¼–ç æ ¼å¼å³å¯ï¼Œé»˜è®¤æ”¯æŒè¯·æ±‚ç¼–ç è½¬æ¢ */ public CharacterEncodingFilter(String encoding) { this(encoding, false); } /** * ä¹Ÿå¯ä»¥è®¾ç½®æŒ‡å®šç¼–ç  and æ˜¯å¦è®¾ç½®è¯·æ±‚å’Œå“åº”çš„ç¼–ç è½¬æ¢ */ public CharacterEncodingFilter(String encoding, boolean forceEncoding) { this(encoding, forceEncoding, forceEncoding); } /** * è®¾ç½®æŒ‡å®šç¼–ç  and å•ç‹¬è®¾ç½®æ˜¯å¦è¿›è¡Œè¯·æ±‚ç¼–ç è½¬æ¢ æˆ– å“åº”çš„ç¼–ç è½¬æ¢ */ public CharacterEncodingFilter(String encoding, boolean forceRequestEncoding, boolean forceResponseEncoding) { Assert.hasLength(encoding, \"Encoding must not be empty\"); this.encoding = encoding; this.forceRequestEncoding = forceRequestEncoding; this.forceResponseEncoding = forceResponseEncoding; } public void setEncoding(String encoding) { this.encoding = encoding; } public String getEncoding() { return this.encoding; } public void setForceEncoding(boolean forceEncoding) { this.forceRequestEncoding = forceEncoding; this.forceResponseEncoding = forceEncoding; } public void setForceRequestEncoding(boolean forceRequestEncoding) { this.forceRequestEncoding = forceRequestEncoding; } public boolean isForceRequestEncoding() { return this.forceRequestEncoding; } public void setForceResponseEncoding(boolean forceResponseEncoding) { this.forceResponseEncoding = forceResponseEncoding; } public boolean isForceResponseEncoding() { return this.forceResponseEncoding; } @Override protected void doFilterInternal( HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException { String encoding = getEncoding(); if (encoding != null) { // è‹¥ foreceRequestEncoding å‚æ•°ä¸º true åˆ™è¿›è¡Œè¯·æ±‚å‚æ•°ç¼–ç è½¬æ¢ï¼Œæ²¡æœ‰è®¾ç½®å­—ç¬¦ç¼–ç æ—¶é»˜è®¤è®¾ç½®è¯·æ±‚å­—ç¬¦ç¼–ç ã€‚ if (isForceRequestEncoding() || request.getCharacterEncoding() == null) { request.setCharacterEncoding(encoding); } // è‹¥ foreceResponseEncoding å‚æ•°ä¸º true åˆ™è¿›è¡Œå“åº”å‚æ•°ç¼–ç è½¬æ¢ if (isForceResponseEncoding()) { response.setCharacterEncoding(encoding); } } filterChain.doFilter(request, response); }} æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨xmlæ–‡ä»¶ä¸­é…ç½®åŠ è½½ CharacterEncodingFilterï¼Œé€šè¿‡é…ç½®ä¸åŒçš„æ„é€ å™¨å‚æ•°å†³å®šæ˜¯å¦å°†è¯·æ±‚å’Œå“åº”çš„å­—ç¬¦ç¼–ç è½¬æ¢è¿˜æ˜¯å•ç‹¬è®¾ç½®è¯·æ±‚å’Œå“åº”ã€‚ æ³¨æ„ï¼šå­—ç¬¦ç¼–ç è¿‡æ»¤å™¨éœ€è¦æ”¾åœ¨æœ€å‰é¢ã€‚ 123456789101112131415161718192021222324252627&lt;filter&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;!-- å¿…é¡»æŒ‡å®šã€‚è‹¥åªé…ç½®ä¸€ä¸ª encoding å‚æ•°ï¼Œå°†å¤„ç†è¯·æ±‚çš„å­—ç¬¦ç¼–ç ï¼Œä¸å¤„ç†å“åº”çš„å­—ç¬¦ç¼–ç  --&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;UTF-8&lt;/param-value&gt; &lt;/init-param&gt; &lt;!-- è‹¥è®¾ç½® encoding å’Œ forceEncoding å‚æ•°ï¼Œè¯·æ±‚å’Œå“åº”éƒ½å¤„ç†å­—ç¬¦ç¼–ç  --&gt; &lt;!-- &lt;init-param&gt; &lt;param-name&gt;forceEncoding&lt;/param-name&gt; &lt;param-value&gt;true&lt;/param-value&gt; &lt;/init-param&gt; --&gt; &lt;!-- åˆ†åˆ«æŒ‡å®šæ˜¯å¦å¤„ç†è¯·æ±‚å­—ç¬¦ç¼–ç å’Œå“åº”å­—ç¬¦ç¼–ç  --&gt; &lt;init-param&gt; &lt;param-name&gt;forceRequestEncoding&lt;/param-name&gt; &lt;param-value&gt;true&lt;/param-value&gt; &lt;/init-param&gt; &lt;init-param&gt; &lt;param-name&gt;forceResponseEncoding&lt;/param-name&gt; &lt;param-value&gt;false&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; Get ä¹±ç è‹¥æœåŠ¡å™¨æ˜¯ tomcatï¼Œä¿®æ”¹ tomcat çš„é…ç½®æ–‡ä»¶ server.xmlã€‚åœ¨ç¬¬ä¸€ä¸ª Connerctor èŠ‚ç‚¹æ·»åŠ  URIEncoding æ ‡ç­¾ï¼š 1&lt;Connector URIEncoding=\"UTF-8\" port=\"8080\" protocol=\"HTTP/1.1\" connectionTimeout=\"20000\" redirectPort=\"8443\" /&gt;","link":"/2018/11/06/æºç è§’åº¦åˆ†æ CharacterEncodingFilter è§£å†³ Post è¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜/"},{"title":"ç±»åˆå§‹åŒ–å’Œå®ä¾‹åˆå§‹åŒ–","text":"è¿è¡Œç»“æœï¼š (5)(1)(10)(6)(9)(3)(2)(9)(8)(7) (9)(3)(2)(9)(8)(7) ä»¥ä¸Šä»£ç è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹æœ‰ä¸‰ä¸ªï¼š ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹ å®ä¾‹åˆå§‹åŒ–è¿‡ç¨‹ æ–¹æ³•çš„é‡å†™ ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹ä¸€ä¸ªç±»è¦åˆ›å»ºå®ä¾‹éœ€è¦å…ˆåŠ è½½å¹¶åˆå§‹åŒ–è¯¥ç±» main æ–¹æ³•æ‰€åœ¨çš„ç±»éœ€è¦å…ˆåŠ è½½å’Œåˆå§‹åŒ–ï¼Œä¸ç®¡mainæ–¹æ³•æ˜¯å¦æœ‰å…¶ä»–æ“ä½œã€‚ ä¸€ä¸ªå­ç±»è¦åˆå§‹åŒ–éœ€è¦å…ˆåˆå§‹åŒ–çˆ¶ç±» ä¸€ä¸ªç±»çš„åˆå§‹åŒ–å°±æ˜¯æ‰§è¡Œ &lt;clinit&gt;() æ–¹æ³• &lt;clinit&gt;() æ–¹æ³•ç”±é™æ€ç±»å˜é‡æ˜¾ç¤ºèµ‹å€¼ä»£ç  å’Œ é™æ€ä»£ç å—ç»„æˆ ç±»å˜é‡æ˜¾ç¤ºèµ‹å€¼ä»£ç å’Œé™æ€ä»£ç å—ä»ä¸Šåˆ°ä¸‹é¡ºåºæ‰§è¡Œ &lt;clinit&gt;() æ–¹æ³•åªæ‰§è¡Œä¸€æ¬¡ ç»“åˆç”¨ä¾‹åˆ†æè¿è¡Œå­ç±»çš„mainæ–¹æ³•ï¼Œå…ˆä¸ç®¡æ‰§è¡Œäº†ä»€ä¹ˆï¼Œé¦–å…ˆä¼šåŠ è½½è¯¥ç±»ï¼Œè¯¥ç±»å¦‚æœ‰çˆ¶ç±»ä¼šå…ˆåŠ è½½çˆ¶ç±»ã€‚ æ‰§è¡Œçˆ¶ç±»çš„&lt;clinit&gt;() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æ‰§è¡Œä¸€æ¬¡ï¼Œè¯¥æ–¹æ³•çš„å†…å®¹ç”±é™æ€ç±»å˜é‡å’Œé™æ€ä»£ç å—ç»„æˆï¼š é™æ€å®ä¾‹å˜é‡èµ‹å€¼ä»£ç åœ¨å‰ï¼Œè¢«å…ˆæ‰§è¡Œï¼Œè°ƒç”¨äº† method() æ–¹æ³•ï¼Œæ‰“å° (5) å…¶æ¬¡æ˜¯é™æ€ä»£ç å—è¢«æ‰§è¡Œï¼Œæ‰“å° (1) çˆ¶ç±»åŠ è½½å®Œæ¯•ï¼ŒåŠ è½½å­ç±»çš„&lt;clinit&gt;() æ–¹æ³•ï¼š é™æ€å®ä¾‹å˜é‡èµ‹å€¼ä»£ç åœ¨å‰ï¼Œè¢«å…ˆæ‰§è¡Œï¼Œæ‰“å° (10) æ¥ç€é™æ€ä»£ç å—ï¼Œæ‰“å° (6) ç»“æœå°±æ˜¯ï¼š(5)(1)(10)(6) å®ä¾‹åˆå§‹åŒ–è¿‡ç¨‹å®ä¾‹åŒ–åˆå§‹åŒ–å°±æ˜¯æ‰§è¡Œ&lt;init&gt;()æ–¹æ³• &lt;init&gt;() æ–¹æ³•å¯èƒ½é‡è½½æœ‰å¤šä¸ªï¼Œç”±å‡ ä¸ªæ„é€ å™¨å°±æœ‰å‡ ä¸ª &lt;init&gt; æ–¹æ³• &lt;init&gt;() æ–¹æ³•ç”±éé™æ€å®ä¾‹å˜é‡èµ‹å€¼ä»£ç ã€éé™æ€ä»£ç å—ã€å¯¹åº”æ„é€ å™¨ä»£ç ç»„æˆ éé™æ€å®ä¾‹å˜é‡èµ‹å€¼ä»£ç å’Œéé™æ€ä»£ç å—ä»£ç æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¯¹åº”çš„æ„é€ å™¨æ€»æ˜¯æœ€åæ‰§è¡Œ æ¯æ¬¡åˆ›å»ºå®ä¾‹å¯¹è±¡ï¼Œè°ƒç”¨å¯¹åº”æ„é€ å™¨ï¼Œæ‰§è¡Œçš„å°±æ˜¯å¯¹åº”çš„ &lt;init&gt; æ–¹æ³• &lt;init&gt;() æ–¹æ³•é¦–è¡Œæ˜¯super()æˆ–super(å‚æ•°åˆ—è¡¨)ï¼Œå³å¯¹åº”çˆ¶ç±»çš„&lt;init&gt;() æ–¹æ³• æ–¹æ³•çš„é‡å†™finalã€é™æ€æ–¹æ³•ã€privateä¿®é¥°çš„æ–¹æ³•ä¸å¯è¢«é‡å†™ å¯¹è±¡çš„å¤šæ€æ€§ï¼š å­ç±»å¦‚æœé‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œé€šè¿‡å­ç±»å¯¹è±¡è°ƒç”¨çš„ä¸€å®šæ˜¯å­ç±»é‡å†™è¿‡çš„ä»£ç  éé™æ€æ–¹æ³•é»˜è®¤çš„è°ƒç”¨å¯¹è±¡æ˜¯this thiså¯¹è±¡åœ¨æ„é€ å™¨æˆ–è€…è¯´&lt;init&gt;æ–¹æ³•ä¸­å°±æ˜¯æ­£åœ¨åˆ›å»ºçš„å¯¹è±¡ ç»“åˆç”¨ä¾‹åˆ†æmain æ–¹æ³•çš„ Son s1 = new Son(); è¢«æ‰§è¡Œï¼Œç±»åŠ è½½å™¨å¼€å§‹æ‰§è¡Œ &lt;init&gt;() &lt;init&gt;() é¦–è¡Œæ˜¯ super()ï¼Œäºæ˜¯æ‰§è¡Œçˆ¶ç±»çš„ &lt;init&gt;()ï¼Œè¯¥æ–¹æ³•ç”±éé™æ€å®ä¾‹å˜é‡èµ‹å€¼ä»£ç ã€éé™æ€ä»£ç å—ã€æ„é€ å™¨ç»„æˆ éé™æ€å®ä¾‹å˜é‡èµ‹å€¼ä»£ç  test() åœ¨å‰å…ˆè¢«æ‰§è¡Œï¼Œåº”è¯¥æ˜¯æ‰“å° (4)ï¼Œä½†æ˜¯å› ä¸ºå¤šæ€çš„ç‰¹æ€§ï¼Œå­ç±»é‡å†™äº†test()ï¼Œinit() åˆå§‹åŒ–æ–¹æ³•ä¸­thisæŒ‡å‘çš„æ˜¯æ­£åœ¨åˆ›å»ºçš„å­ç±»å¯¹è±¡ Sonï¼Œè°ƒç”¨çš„æ­£æ˜¯å­ç±»çš„test()ã€‚æ‰€ä»¥æ‰“å° (9) ç„¶åæ˜¯çˆ¶ç±»çš„éé™æ€ä»£ç å—è¢«æ‰§è¡Œï¼Œæ‰“å° (3) æœ€åæ˜¯çˆ¶ç±»çš„æŒ‡å®šæ„é€ å™¨ï¼Œå­ç±»è°ƒç”¨çš„æ˜¯æ— å‚æ„é€ å™¨ï¼Œæ‰€ä»¥çˆ¶ç±»çš„æ— å‚æ„é€ å™¨å…ˆè¢«è°ƒç”¨ï¼Œæ‰“å° (2) çˆ¶ç±»çš„ &lt;init&gt;() æ‰§è¡Œå®Œæ¯•ï¼Œå†æ‰§è¡Œå­ç±»çš„ &lt;init&gt;()ï¼š å­ç±» test() åˆè¢«æ‰§è¡Œäº†ä¸€æ¬¡ï¼Œæ‰“å° (9) å­ç±»çš„éé™æ€ä»£ç å—æ‰§è¡Œï¼Œæ‰“å° (8) æœ€åæ„é€ å™¨æ‰§è¡Œï¼Œæ‰“å° (7) è‡³æ­¤ï¼Œç¬¬ä¸€è¡Œæ‰“å°ï¼ˆç©ºæ ¼ä¸ºäº†åŒºåˆ†ç±»åˆå§‹åŒ–å’Œå®ä¾‹åˆå§‹åŒ–ï¼‰ï¼š(5)(1)(10)(6) (9)(3)(2)(9)(8)(7) main æ–¹æ³•åˆæ‰§è¡Œäº†ä¸€æ¬¡å­ç±»å¯¹è±¡ï¼Œç”±äºç±»çš„åˆå§‹åŒ–&lt;clinit&gt;()åªåˆ›å»ºä¸€æ¬¡ï¼Œæ‰€ä»¥(5)(1)(10)(6)ä¸è¢«æ‰“å°ï¼Œè€Œ(9)(3)(2)(9)(8)(7)åˆè¢«æ‰§è¡Œäº†ä¸€æ¬¡ã€‚ é¢ å€’ä½ç½®ï¼Œå†æµ‹è¯•ä¸€é æ‰§è¡Œçˆ¶ç±» &lt;clinit&gt;()ï¼Œä¾æ¬¡æ‰“å°ï¼šç±»é™æ€å˜é‡ (5)ã€ç±»é™æ€ä»£ç å— (1) æ‰§è¡Œå­ç±» &lt;clinit&gt;()ï¼Œä¾æ¬¡æ‰“å°ï¼šç±»é™æ€ä»£ç å— (6)ã€ç±»é™æ€å˜é‡ (10) æ‰§è¡Œçˆ¶ç±» &lt;init&gt;()ï¼Œä¾æ¬¡æ‰“å°ï¼šéé™æ€ä»£ç å— (3)ã€éé™æ€å®ä¾‹å˜é‡ï¼ˆå¤šæ€æœºåˆ¶ï¼‰ (9)ã€æ„é€ å™¨ (2) æ‰§è¡Œå­ç±» &lt;init&gt;()ï¼Œä¾æ¬¡æ‰“å°ï¼šéé™æ€ä»£ç å— (8)ã€éé™æ€å®ä¾‹å˜é‡ (9)ã€æ„é€ å™¨ (7) æœ€ç»ˆç»“æœï¼š -- ç©ºæ ¼ä¸ºäº†åŒºåˆ†ç±»åˆå§‹åŒ–å’Œå®ä¾‹åˆå§‹åŒ– -- (5)(1)(6)(10) (3)(9)(2)(8)(9)(7) (3)(9)(2)(8)(9)(7)","link":"/2018/10/30/ç±»åˆå§‹åŒ–å’Œå®ä¾‹åˆå§‹åŒ–/"},{"title":"è‡ªå¢å˜é‡","text":"å…ˆçœ‹ä¸€æ®µä»£ç ï¼š 1234567891011public class Demo1 { public static void main(String[] args) { int i = 1; // i = 1 i = i++; // i = 1 int j = i++; // j = 1 int k = i + ++i * i++; // k = 11 System.out.println(\"i = \" + i); System.out.println(\"j = \" + j); System.out.println(\"k = \" + k); }} ç»“æœï¼š i = 4 j = 1 k = 11 åˆ†æï¼š ä¹‹å‰åœ¨ç®—æ³•ä¸­å­¦åˆ°ï¼Œè¿ç®—æ“ä½œéƒ½æ˜¯é€šè¿‡æ ˆæ¥å®Œæˆçš„ï¼Œæœ€å…¸å‹çš„æ¯”å¦‚åŒæ ˆè¡¨è¾¾å¼å–å€¼ï¼Œä¸€ä¸ªæ“ä½œç¬¦æ ˆã€ä¸€ä¸ªæ“ä½œæ•°æ ˆã€‚è¿è¡Œä¸€ä¸²è¡¨è¾¾å¼ï¼Œé‡åˆ°æ•°å€¼å…¥æ“ä½œæ•°æ ˆï¼Œé‡åˆ°ç¬¦å·å…¥æ“ä½œç¬¦æ ˆï¼Œæ‰§è¡Œæ“ä½œæ—¶ä¾æ¬¡å¼¹å‡ºã€‚ é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼šè‡ªå¢æ“ä½œæ˜¯ä¸å…¥æ ˆçš„ï¼Œç›´æ¥ä¿®æ”¹å˜é‡çš„å€¼ã€‚ æ‰§è¡Œæµç¨‹ï¼š int i = 1; é¦–å…ˆ å¸¸é‡ 1 å…¥æ ˆï¼Œé‡åˆ° = å·ï¼Œå¼¹å‡º 1 èµ‹å€¼ç»™å˜é‡ iï¼Œæ­¤æ—¶ i = 1 i = i++; i = 1 å…¥æ ˆï¼Œi å˜é‡è‡ªå¢ï¼ši = 2ï¼Œä½†æ˜¯æ­¤æ—¶æ“ä½œæ•°æ ˆä¸­çš„ i ä¾ç„¶æ˜¯ 1ï¼Œå†å°†æ“ä½œæ•°æ ˆä¸­çš„ 1 èµ‹å€¼ç»™å˜é‡ iï¼Œè¿™ä¸€æ“ä½œå°±åŸæœ¬çš„ i = 2 è¦†ç›–æ‰äº†å˜æˆäº† 1ã€‚æ­¤æ—¶ i = 1 j = i++; i = 1 å…¥æ ˆï¼Œi å˜é‡è‡ªå¢ä¸º2ï¼Œé‡åˆ° = å°† i = 1èµ‹å€¼ç»™ j ,j = 1 k = i + ++i * i++; i = 2 å…¥æ ˆ i è‡ªå¢ä¹‹åå…¥æ ˆï¼Œi = 3 i å…¥æ ˆ ï¼Œi = 3ï¼Œå˜é‡è‡ªå¢ä¸º 4ï¼Œä½†æ˜¯æ“ä½œæ•°ä¸­çš„ i ä¾æ—§ä¸º 3 æ ˆè¿ç®—ï¼š2 + 3 * 3 = 11","link":"/2018/10/30/è‡ªå¢å˜é‡/"},{"title":"è§£å†³ä½¿ç”¨ bootstrap æ›´æ–°æ“ä½œæ—¶-æ¨¡æ€æ¡†å›æ˜¾ä¼ å€¼é—®é¢˜","text":"å›é¡¾ ModelAndViewä¹‹å‰çš„å°è±¡ä¸­ï¼Œæˆ‘ä½¿ç”¨ ModelAndView çš„åœºæ™¯æ˜¯åœ¨éœ€è¦é‡å®šå‘é¡µé¢æ—¶å¸¦ä¸Šå‚æ•°ã€‚æœ€è¿‘åœ¨åšåšå®¢ç³»ç»Ÿå¼€å‘æ—¶å­¦åˆ°äº†æ–°çš„ä¸€æ‹›ï¼Œå°±æ˜¯ ModelAndView ä¸ä»…å¯ä»¥è·³è½¬é¡µé¢ï¼Œè¿˜å¯ä»¥â€è·³è½¬â€é¡µé¢çš„éƒ¨åˆ†å†…å®¹ï¼æ¯”å¦‚è¿™æ ·ï¼šnew ModelAndView(&quot;users/list :: #user_div&quot;,map); â€”â€” è¿™å¥è¯çš„æ„æ€æ˜¯æ‰¾åˆ° user/list.html å°†å…¶ä¸­çš„æŒ‡å®š div çš„ html ä»£ç ä½œä¸ºå­—ç¬¦ä¸²è¿”å›å€¼è¾“å‡ºå‡ºå»ï¼ˆå¦‚æœè¿™ä¸ª div æœ‰å–å€¼æ ‡ç­¾å°†ä¼šè¢«èµ‹å€¼ï¼‰ã€‚å¦‚æœæ˜¯åŒæ­¥è¯·æ±‚å°†ä¼šè¾“å‡ºåˆ°æµè§ˆå™¨å®ç°åˆ·æ–°ï¼Œå¦‚æœæ˜¯å¼‚æ­¥åˆ™ä¼šä½œä¸º data çš„å­—ç¬¦ä¸²æ–‡æœ¬æ•°æ®ï¼ˆhtmlä»£ç ï¼‰ è§£å†³æ¨¡æ€æ¡†å›æ˜¾ä¼ å€¼é—®é¢˜å¾ˆå¤šæƒ…å†µä¸‹æœ‰è¿™æ ·çš„éœ€æ±‚ï¼šç‚¹å‡»ç¼–è¾‘æŒ‰é’®å¼¹å‡ºä¸€ä¸ªå›ºå®š html å†…å®¹çš„æ¨¡æ€æ¡†ï¼Œæ€ä¹ˆåœ¨å¼¹å‡ºå‰æ ¹æ® id å…ˆè·å–æ•°æ®å†å±•ç¤ºç»™ç”¨æˆ·çœ‹å‘¢ï¼Ÿ é¦–å…ˆç‚¹å‡»ç¼–è¾‘æŒ‰é’®è§¦å‘äº‹ä»¶å‘èµ·å¼‚æ­¥è¯·æ±‚æŸ¥æ‰¾ä¸€ä¸ªå®ä½“å¯¹è±¡ï¼› æ§åˆ¶å±‚è¿”å›çš„ä¸æ˜¯ jsonï¼Œè€Œæ˜¯ ModelAndView å¯¹è±¡ï¼Œå¹¶ä¸”åªè¿”å›éœ€è¦è¢«å¡«å……çš„æ¨¡æ€æ¡†çš„éƒ¨åˆ†é¡µé¢ä»£ç ï¼ˆhtmlï¼‰æ¯”å¦‚ï¼šnew ModelAndView(&quot;users/list :: #æ¨¡æ€æ¡†è¡¨å•id&quot;,map); è¿™æ ·å°±å°†è¿™éƒ¨åˆ†çš„é¡µé¢çš„ html ä»£ç ï¼ˆåŒ…æ‹¬mapä¸­çš„å€¼ï¼‰ç›´æ¥ä¼ ç»™äº†å‰å° js ä¸­ã€‚ js è·å–çš„ data æ•°æ®åˆ™æ˜¯éœ€è¦å±•ç¤ºç»™ç”¨æˆ·çœ‹çš„è¡¨å•html ä»£ç äº†ï¼ˆåŒ…æ‹¬å›æ˜¾çš„å€¼ï¼‰ï¼Œé€šè¿‡ js åœ¨æŒ‡å®šçš„ divï¼ˆæ¨¡æ€æ¡†è¡¨å•idçš„â€˜çˆ¶çº§å…ƒç´ ï¼šdivID â€™ï¼‰ ä¸­å¡«å……è¿™ä¸ªæ•°æ®ï¼š$(&quot;#divID&quot;).html(data); â€”â€” data æ˜¯åå°è¿”å›çš„æ¨¡æ€æ¡† htmlã€‚ è¿™æ ·å°±ä¼šå°†åå°ä¼ è¿‡æ¥çš„ html ä»£ç ä»¥åŠèµ‹å€¼å¥½çš„æ•°æ®ä½œä¸ºè¡¨å•å›æ˜¾å†…å®¹ è¦†ç›–ä¹‹å‰æœªå¡«å……æ•°æ®çš„è¡¨å• å±•ç¤ºç»™ç”¨æˆ·ã€‚ å®ä¾‹ï¼šåšå®¢ç³»ç»Ÿåå°ç®¡ç†ç”¨æˆ·ç®¡ç†ç¼–è¾‘æ“ä½œ","link":"/2018/10/13/è§£å†³ä½¿ç”¨ bootstrap æ›´æ–°æ“ä½œæ—¶-æ¨¡æ€æ¡†å›æ˜¾ä¼ å€¼é—®é¢˜/"},{"title":"Linux - è§£å‹ç¼©","text":"è§£å‹ç¼©tar tar -zcvf å‹ç¼©åçš„æ–‡ä»¶å ç›®æ ‡æ–‡ä»¶ tar -zxvf è§£å‹æ–‡ä»¶å","link":"/2019/06/21/è§£å‹ç¼©/"},{"title":"Docker è¡¥æ•‘æŒ‡å—ï¼ˆäº”ï¼‰â€”â€” Docker Compose","text":"What It Isï¼Ÿ referenceï¼šOverview of Docker Compose Compose æ˜¯ä¸€ä¸ªå®šä¹‰å’Œ\bè¿è¡Œå¤šä¸ªå®¹å™¨çš„ Docker åº”ç”¨ã€‚åœ¨ Composeï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª YAML æ–‡ä»¶é…ç½®ä½ çš„åº”ç”¨çš„ï¼ˆå¤šä¸ªï¼‰æœåŠ¡ã€‚ç„¶åï¼Œ\bä½¿ç”¨ä¸€æ¡å‘½ä»¤ä½ å¯ä»¥åˆ›å»ºå’Œå¯åŠ¨æ‰€æœ‰çš„æœåŠ¡ä»ä½ çš„é…ç½®ä¸­ã€‚\bè¦å­¦ä¹ æ›´å¤šçš„å…³äº Compose çš„ç‰¹æ€§ï¼Œè¯·å‚çœ‹ï¼š\bç‰¹æ€§åˆ—è¡¨Compose å·¥ä½œåœ¨æ‰€æœ‰ç¯å¢ƒï¼šç”Ÿäº§ã€å¼€å‘ã€æµ‹è¯•ï¼Œä»¥åŠ CLI å·¥ä½œæµã€‚ä½ å¯ä»¥å­¦ä¹ æ›´æ‰€çš„ç”¨ä¾‹åœ¨ï¼šComm Use Cases Compose çš„ä½¿ç”¨åŸºæœ¬ä¸Šæ˜¯ä»¥ä¸‹ä¸‰ä¸ª\bè®¾ç½®çš„è¿‡ç¨‹ï¼š ä½¿ç”¨ Dockerfile å®šä¹‰ä½ çš„åº”ç”¨ç¯å¢ƒï¼Œå®ƒå¯ä»¥å¤åˆ¶åˆ°ä»»ä½•åœ°æ–¹ã€‚ åœ¨ docker-compose.yml ä¸­å®šä¹‰ç»„æˆä½ çš„åº”ç”¨çš„æœåŠ¡ï¼Œä»–ä»¬å¯ä»¥åœ¨éš”ç¦»çš„ç¯å¢ƒä¸‹\bå…±åŒè¿è¡Œã€‚ è¿è¡Œ docker-compose up å¯åŠ¨ Composeï¼Œè¿è¡Œä½ çš„æ•´ä¸ª app ä¸€ä¸ª docker-compose.yml æ–‡ä»¶çœ‹èµ·æ¥åƒè¿™æ ·ï¼š version: &apos;3&apos; services: web: build: . ports: - &quot;5000:5000&quot; volumes: - .:/code - logvolume01:/var/log links: - redis redis: image: redis volumes: logvolume01: {} å…³äºæ›´å¤š compose æ–‡ä»¶ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼šCompose file reference. compose æœ‰ç®¡ç†ä½ åº”ç”¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„å‘½ä»¤ï¼š å¯åŠ¨ã€åœæ­¢ã€é‡æ–°æ„å»ºæœåŠ¡ æŸ¥çœ‹æ‰€æœ‰è¿è¡Œä¸­æœåŠ¡çš„çŠ¶æ€ æ­£åœ¨è¿è¡Œçš„æœåŠ¡çš„æ—¥å¿—è¾“å‡ºæµ åœ¨æœåŠ¡ä¸Šè¿è¡Œä¸€æ¬¡æ€§å‘½ä»¤ã€‚ ç‰¹æ€§ï¼šæœ‰æ•ˆçš„ Compose åŠŸèƒ½æœ‰ï¼š å•ä¸ªä¸»æœºä¸Šå¤šä¸ªéš”ç¦»çš„ç¯å¢ƒ \bä¿å­˜æ•°æ®å·æ•°æ®å½“å®¹å™¨è¢«åˆ›å»º ä»…é‡æ–°åˆ›å»ºå·²æ›´æ”¹çš„å®¹å™¨ å˜é‡å’Œç¯å¢ƒæ›´æ”¹ â€¦â€¦ How To Do Itï¼Ÿä¸€ä¸ªè¾ƒä¸ºè¯¦ç»†çš„å¾®æœåŠ¡é¡¹ç›®æ‰€éœ€è¦çš„ docker-compose.yml åŠ\bä¸»è¦ä¸€çº§å…³é”®å­—ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354version: '3'# \bç”¨æ¥å£°æ˜æœåŠ¡ï¼Œåœ¨è¯¥èŠ‚ç‚¹ä¹‹ä¸‹\bé…ç½®å¤šä¸ªæœåŠ¡ã€‚service: # web æœåŠ¡ web: image: id/imagename:lable # æŒ‡å®š\bé‡å¯ç­–ç•¥ï¼ˆonï¼šé»˜è®¤å€¼ï¼Œè‹¥å¯åŠ¨å¤±è´¥ä¸åšä»»ä½•åŠ¨ä½œ / alwaysï¼šä¼šä¸€ç›´é‡æ–°å¯åŠ¨ / on-failureï¼šæœåŠ¡æç¤ºå¤±è´¥é”™è¯¯åä¼šé‡æ–°å¯åŠ¨ / unless-stoppedï¼šåªæœ‰æœåŠ¡åœ¨åœæ­¢åæ‰ä¼š\bé‡å¯ï¼‰ restart: on-failure container_name: my-web-container_name ports: - 8080:8080 # æŒ‡å®šç½‘ç»œï¼Œè¯¥ç½‘ç»œå¼•ç”¨ä¸‹é¢çš„é…ç½®ã€‚ networks: - example-net # æœåŠ¡ä¾èµ–ï¼ŒæŒ‡å®šæœåŠ¡å¯åŠ¨é¡ºåºã€‚ï¼ˆ3ç‰ˆæœ¬ä¹‹åè¯¥å±æ€§è¢«å¿½ç•¥ï¼‰ depends_on: - db # æœåŠ¡ swarm é›†ç¾¤éƒ¨ç½²ï¼Œéé›†ç¾¤ä¸‹æ— æ•ˆã€‚ deploy: # æœåŠ¡å‰¯æœ¬æ•°é‡ replicas: 2 # é›†ç¾¤ç¯å¢ƒä¸‹çš„é‡å¯ç­–ç•¥ï¼Œå±æ€§å€¼ä¸ä¸Šé¢çš„ä¸€æ · restart_policy: condition: on-failure # æ•°æ®åº“æœåŠ¡ db: images: mysql:5.6 restart: on-failure container_name: mysql-container ports: - 3306:3306 volumes: - example-mysql: /var/lib/mysql networks: - example-net: # \bç¯å¢ƒå˜é‡ environment: MYSQL_ROOT_PASSWORD: root MYSQL_DATABASE: mysql_database deploy: replicas: 1 restart_policy: condition: on-failure # \bè¯¥æœåŠ¡åªæœ‰ç®¡ç†èŠ‚ç‚¹æ‰èƒ½å¯åŠ¨ placement: constraints: [node.role == manager]networks: example-net:volumes: example-mysql: å…³äº docker-compose æ–‡ä»¶çš„æ‰€æœ‰ç»†èŠ‚ï¼Œå‚è€ƒï¼šhttps://docs.docker.com/compose/compose-file/ å¾®æœåŠ¡ä¸‹çš„ Docker éƒ¨ç½²å‡†å¤‡å¾®æœåŠ¡æµ‹è¯•é¡¹ç›®å››ä¸ªå¾®æœåŠ¡ï¼Œåˆ†åˆ«æ˜¯ï¼š euraka-server gateway-zuul microservice-orderservice microservice-userservice ç¼–å†™ Dockerfileåˆ†åˆ«ä¸ºå››ä¸ªåŸºç¡€æœåŠ¡æä¾› Dockerfile ç”¨ä»¥æ„å»ºé•œåƒä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“ï¼Œå››ä¸ª Dockerfile éƒ½æ˜¯ç±»ä¼¼çš„ï¼š euraka-server:1234567FROM java:8-jreMAINTAINER harry&lt;yuzh233@gmail.com&gt;ADD ./target/microservice-eureka-server-0.0.1-SNAPSHOT.jar /app/microservice-eureka-service.jarCMD [\"java\", \"-Xmx200m\", \"-jar\", \"/app/microservice-eureka-service.jar\"]EXPOSE 8761 gateway-zuul:1234567FROM java:8-jreMAINTAINER harry&lt;yuzh233@gmail.com&gt;ADD ./target/microservice-gateway-zuul-0.0.1-SNAPSHOT.jar /app/microservice-gateway-zuul.jarCMD [\"java\", \"-Xmx200m\", \"-jar\", \"/app/microservice-gateway-zuul.jar\"]EXPOSE 8050 microservice-orderservice:1234567FROM java:8-jreMAINTAINER harry&lt;yuzh233@gmail.com&gt;ADD ./target/microservice-orderservice-0.0.1-SNAPSHOT.jar /app/microservice-orderservice.jarCMD [\"java\", \"-Xmx200m\", \"-jar\", \"/app/microservice-orderservice.jar\"]EXPOSE 7900 microservice-userservice:123456789FROM java:8-jreMAINTAINER harry&lt;yuzh233@gmail.com&gt;ADD ./target/microservice-userservice-0.0.1-SNAPSHOT.jar /app/microservice-userservice.jarEXPOSE 8030CMD [\"java\", \"-Xmx200m\", \"-jar\", \"/app/microservice-userservice.jar\"] æ„å»ºé•œåƒæ„å»ºåé¢éœ€è¦éƒ¨ç½²çš„åŸºç¡€é•œåƒï¼Œæœ‰äº†é•œåƒå\bå¯ä»¥é€šè¿‡æ‰§è¡Œ docker run å‘½ä»¤ä¸€ä¸€å¯åŠ¨ï¼Œä½†æ˜¯å¯¹äºå¾®æœåŠ¡é¡¹ç›®æ¥è¯´é€ä¸ªå¯åŠ¨æ•ˆç‡ä¸å…æœ‰ç‚¹å¤ªä½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ docker-compose å¿«é€Ÿå¯åŠ¨ã€‚ å…³äºé•œåƒçš„æ„å»ºä¸æ¨é€ï¼Œå¯ä»¥ä½¿ç”¨ maven çš„ dockerfile æ’ä»¶ ğŸ‘‰ ç¬”è®°\b ä¸¾ä¾‹ï¼š123456789101112131415161718192021&lt;plugin&gt; &lt;groupId&gt;com.spotify&lt;/groupId&gt; &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.4.3&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;default&lt;/id&gt; &lt;!-- å¦‚æœä¸æŒ‡å®š phase åˆ™ä¼šä½¿ç”¨é»˜è®¤çš„ goalsï¼Œå³ï¼špackage -&gt; build, deploy -&gt; push --&gt; &lt;phase&gt;install&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;build&lt;/goal&gt; &lt;goal&gt;push&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;configuration&gt; &lt;repository&gt;registry.cn-hangzhou.aliyuncs.com/yuzh/${artifactId}&lt;/repository&gt; &lt;tag&gt;${project.version}&lt;/tag&gt; &lt;useMavenSettingsForAuth&gt;true&lt;/useMavenSettingsForAuth&gt; &lt;/configuration&gt;&lt;/plugin&gt; NOTEï¼šéœ€è¦\bå…ˆå®‰è£… JDK å’Œ MAVEN ç¯å¢ƒã€‚ éé›†ç¾¤ç¯å¢ƒä¸‹çš„éƒ¨ç½²ä¸€ï¼‰ç™»é™†è¿œç¨‹æœåŠ¡å™¨ï¼Œæ‹‰å–é•œåƒã€‚ å¦‚æœæ˜¯åœ¨é•œåƒä¸Šä¼ çš„ä¸»æœºä¸Šè¿è¡Œï¼Œåˆ™\bé»˜è®¤å­˜åœ¨äº†ã€‚ äºŒï¼‰å‡†å¤‡ docker-compose.yml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101version: \"3\"services: # ç¬¬ä¸€ä¸ªæœåŠ¡ mysql: image: mysql restart: on-failure ports: - 3336:3306 # å®¹å™¨å¤–å¯ä»¥é€šè¿‡ 3336 è¿æ¥\båˆ°å®¹å™¨å†…çš„æœåŠ¡ç«¯ volumes: - microservice-mysql:/var/lib/mysql networks: - microservice-net environment: MYSQL_ROOT_PASSWORD: harry@admin MYSQL_DATABASE: microservice_mallmanagement deploy: replicas: 1 # å‰¯æœ¬æ•°é‡ restart_policy: # é‡å¯ç­–ç•¥ condition: on-failure # å¤±è´¥æ—¶é‡å¯ placement: constraints: [node.role == manager] # ç¬¬äºŒä¸ªæœåŠ¡ eureka-server: image: registry.cn-hangzhou.aliyuncs.com/yuzh/microservice-eureka-server:0.0.1-SNAPSHOT restart: on-failure ports: - 8761:8761 networks: - microservice-net deploy: replicas: 1 restart_policy: condition: on-failure # ç¬¬ä¸‰ä¸ªæœåŠ¡ gateway-zuul: image: registry.cn-hangzhou.aliyuncs.com/yuzh/microservice-gateway-zuul:0.0.1-SNAPSHOT restart: on-failure ports: - 8050:8050 networks: - microservice-net depends_on: - eureka-server deploy: replicas: 1 restart_policy: condition: on-failure placement: constraints: [node.role == manager] # ç¬¬å››ä¸ªæœåŠ¡ order-service: image: registry.cn-hangzhou.aliyuncs.com/yuzh/microservice-orderservice:0.0.1-SNAPSHOT restart: on-failure ports: - 7900:7900 networks: - microservice-net depends_on: - mysql - eureka-server deploy: replicas: 1 restart_policy: condition: on-failure # ç¬¬äº”ä¸ªæœåŠ¡ user-service: image: registry.cn-hangzhou.aliyuncs.com/yuzh/microservice-userservice:0.0.1-SNAPSHOT restart: on-failure ports: - 8030:8030 networks: - microservice-net depends_on: - mysql - eureka-server deploy: replicas: 1 restart_policy: condition: on-failure # ç¬¬å…­ä¸ªæœåŠ¡ visualizer: image: dockersamples/visualizer:stable ports: - 8081:8080 volumes: - /var/run/docker.sock:/var/run/docker.sock deploy: placement: constraints: [node.role == manager] networks: - microservice-netnetworks: microservice-net:volumes: microservice-mysql: note: Mysql \bå®¹å™¨è¿è¡Œçš„ä¸€äº›ç»†èŠ‚ï¼Œå¯è§ ã€ŠDocker è¡¥æ•‘æŒ‡å—ï¼ˆä¸€ï¼‰â€”â€” åŸºç¡€ä½¿ç”¨ã€‹ çš„ Mysql å®¹å™¨ éƒ¨åˆ†ã€‚ ä¸‰ï¼‰\båœ¨ docker-compose.yml ç›®å½•ä¸‹æ‰§è¡Œï¼šdocker-compose up å¦‚éœ€åœæ­¢ï¼šdocker-compose down é›†ç¾¤ç¯å¢ƒä¸‹çš„éƒ¨ç½²ä¸€ï¼‰ç™»é™†è¿œç¨‹ä»“åº“ äºŒï¼‰éƒ¨ç½²æœåŠ¡ docker stack deploy -c docker-compose-swarm.yml --with-registry-auth mall-management -cï¼šæŒ‡å®š docker-compose æ–‡ä»¶åœ°å€ --with-registry-authï¼šé€šçŸ¥æ‰€æœ‰æœåŠ¡èŠ‚ç‚¹è¦åˆ°\bæŒ‡å®šçš„ç§æœ‰ä»“åº“æ‹‰å–é•œåƒ mall-managementï¼šé›†ç¾¤æœåŠ¡çš„æ€»åç§° ä¸‰ï¼‰ç®¡ç†å‘½ä»¤ æŸ¥çœ‹æ‰€æœ‰é›†ç¾¤æœåŠ¡ï¼š docker stack ps åˆ é™¤æŒ‡å®šé›†ç¾¤æœåŠ¡ï¼š docker stack rm XX \bæ›´å¤šå‘½ä»¤ï¼š docker stack --help","link":"/2019/05/31/Docker \bè¡¥æ•‘æŒ‡å—ï¼ˆäº”ï¼‰ â€”â€” Docker Compose/"},{"title":"Spring Annotation development","text":"https://docs.spring.io/spring/docs/5.0.9.RELEASE/spring-framework-reference/web.html ç»„ä»¶æ³¨å†Œ @Configuration @ComponentScan @Bean @Scope @Lazy @Conditional @Import ç”Ÿå‘½å‘¨æœŸ @Bean æŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³• å®ç° InitializingBeanå’ŒDisposableBean æŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³• @PostConstruct / @PreDestroy æŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³• å±æ€§èµ‹å€¼ @Value èµ‹å€¼ @PropertySource åŠ è½½å¤–éƒ¨é…ç½®æ–‡ä»¶ è‡ªåŠ¨è£…é… @Autowired / @Qualifier / @Primary @Resource / @Inject å®ç° Aware æ³¨å…¥ Spring åº•å±‚ç»„ä»¶ @Profile ç¯å¢ƒæ­å»º @Profile ç¯å¢ƒæ¿€æ´» AOP @Aspect / @Pointcut / @Before / @After / @AfterReturning / @AfterThrowing / @Around @EnableAspectJAutoProxy äº‹åŠ¡ @Transactional @EnableTransactionManagement DataSource / Template / PlatformTransactionManager Servlet è‡ªå®šä¹‰ç»„ä»¶ @WebServlet / @WebFilter / @WebListener ServletContainerInitializer åˆå§‹åŒ–å™¨ åˆ©ç”¨ ServletContainerInitializer.ServletContext / ServletContextListener.ServletContext æ·»åŠ ç¬¬ä¸‰æ–¹ç»„ä»¶ SpringMVCWeb é…ç½®ç±»ç»„ä»¶åŠ è½½æµç¨‹ï¼š å¯¼å…¥ webmvc åŒ…åï¼Œlib ä¸­å¤šäº†ä¸€ä¸ª spring-web-4.3.12.RELEASE.jar webå®¹å™¨åœ¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šæ‰«ææ¯ä¸ªjaråŒ…ä¸‹çš„ META-INF/services/javax.servlet.ServletContainerInitializer ã€‚æ­¤æ—¶åœ¨ spring-web-4.3.12.RELEASE.jar åŒ…ä¸­æ‰«æåˆ°äº†è¯¥æ–‡ä»¶ï¼š åŠ è½½æ–‡ä»¶ä¸­æŒ‡å®šçš„ç±»ï¼š org.springframework.web.SpringServletContainerInitializer SpringServletContainerInitializer ä¼šåŠ è½½ WebApplicationInitializer æ¥å£ä¸‹æ‰€æœ‰çš„ç»„ä»¶ã€‚å¹¶ä¸”ä¸º WebApplicationInitializer ç»„ä»¶åˆ›å»ºå¯¹è±¡ï¼ˆå½“ç»„ä»¶ä¸æ˜¯æ¥å£ï¼Œä¸æ˜¯æŠ½è±¡ç±»æ—¶ï¼‰ æˆ‘ä»¬çš„ webé…ç½®ç±» è¦ç»§æ‰¿çš„ç±»ï¼š AbstractAnnotationConfigDispatcherServletInitializer æ˜¯ WebApplicationInitializer æ¥å£çš„é—´æ¥å­ç±»ã€‚ 12345678910111213141516171819202122232425262728public class MyWebAppInitializer extends AbstractAnnotationConfigDispatcherServletInitializer { /** * åŠ è½½æ ¹å®¹å™¨çš„é…ç½®ç±»ï¼šSpringé…ç½® */ @Override protected Class&lt;?&gt;[] getRootConfigClasses() { return new Class[]{RootConfig.class}; } /** * åŠ è½½webmvcå®¹å™¨çš„é…ç½®ç±»ï¼šSpringMVC é…ç½® */ @Override protected Class&lt;?&gt;[] getServletConfigClasses() { return new Class[]{MvcConfig.class}; } /** * è·å– DispatcherServlet çš„æ˜ å°„ä¿¡æ¯ * &lt;p&gt; * - `/` æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼ˆåŒ…æ‹¬é™æ€èµ„æºï¼ˆxx.js,xx.pngï¼‰ï¼‰ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬*.jspï¼› * - `/*` æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼›è¿*.jspé¡µé¢éƒ½æ‹¦æˆªï¼›jspé¡µé¢æ˜¯tomcatçš„jspå¼•æ“è§£æçš„ï¼› */ @Override protected String[] getServletMappings() { return new String[]{\"/\"}; }} SpringMVC é…ç½®ç±»123456789101112131415161718192021222324252627282930313233343536373839@ComponentScan(value = {\"xyz.yuzh.learn.spring.annotation\"}, includeFilters = { @ComponentScan.Filter(type = FilterType.ANNOTATION, classes = Controller.class)}, useDefaultFilters = false)@EnableWebMvc // å¼€å¯ SpringMVC å®šåˆ¶é…ç½®åŠŸèƒ½ï¼Œç­‰åŒäº &lt;mvc:annotation-driven/&gt;public class WebConfig extends WebMvcConfigurerAdapter { // WebMvcConfigurerAdapteræŠ½è±¡ç±» å®ç°äº† WebMvcConfigurer æ¥å£æ¥å®šåˆ¶MVCçš„æ‰€æœ‰é…ç½®ï¼Œå®ç°æŠ½è±¡ç±»ä½¿å¾—æˆ‘ä»¬ä¸å¿…é‡å†™æ‰€æœ‰æ‰€æœ‰æ¥å£æ–¹æ³• /** * å®šåˆ¶è§†å›¾è§£æå™¨ */ @Override public void configureViewResolvers(ViewResolverRegistry registry) { registry.jsp(\"/WEB-INF/views/\", \".jsp\"); // è‹¥ä¸åŠ å‚æ•°é»˜è®¤ä¸ºï¼š(\"/WEB-INF/\",\".jsp\") } /** * å¼€å¯é™æ€èµ„æºè®¿é—® ç›¸å½“äº &lt;mvc:default-servlet-handler&gt; * springMVC é»˜è®¤æ‹¦æˆªæ‰€æœ‰çš„è¯·æ±‚åŒ…æ‹¬é™æ€èµ„æºï¼Œè§£é™¤é™æ€èµ„æºè®¿é—®é™åˆ¶ï¼Œä½†ä»…å¯¹WEBæ ¹ç›®å½•ä¸‹æ–‡ä»¶æœ‰æ•ˆï¼Œå¦‚æœæ–‡ä»¶åœ¨WEB-INFè§£é™¤æ— æ•ˆã€‚ */ /*@Override public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) { configurer.enable(); }*/ /** * å®šåˆ¶æ‹¦æˆªå™¨ */ @Override public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(new MyIntercepter()).addPathPatterns(\"/**\"); // æ‹¦æˆªæ‰€æœ‰ç›®å½•åŠæ–‡ä»¶ } /** * è¿™ç§æ–¹å¼è®¿é—® WEB-INF ä¸‹çš„é™æ€èµ„æº &lt;mvc:resources location=\"/WEB-INF/resources/\" mapping=\"/resources/**\"/&gt; */ @Override public void addResourceHandlers(ResourceHandlerRegistry registry) { registry.addResourceHandler(\"/resources/**\").addResourceLocations(\"/WEB-INF/resources/\"); }} æ›´å¤šé…ç½®æŸ¥é˜… æ–‡æ¡£ å¼‚æ­¥å¤„ç†Servlet 3.0 å¼‚æ­¥å¤„ç†åœ¨Servlet 3.0ä¹‹å‰ï¼ŒServleté‡‡ç”¨Thread-Per-Requestçš„æ–¹å¼å¤„ç†è¯·æ±‚ã€‚å³æ¯ä¸€æ¬¡Httpè¯·æ±‚éƒ½ç”±æŸä¸€ä¸ªçº¿ç¨‹ä»å¤´åˆ°å°¾è´Ÿè´£å¤„ç†ã€‚ å¦‚æœä¸€ä¸ªè¯·æ±‚éœ€è¦è¿›è¡ŒIOæ“ä½œï¼Œæ¯”å¦‚è®¿é—®æ•°æ®åº“ã€è°ƒç”¨ç¬¬ä¸‰æ–¹æœåŠ¡æ¥å£ç­‰ï¼Œé‚£ä¹ˆå…¶æ‰€å¯¹åº”çš„çº¿ç¨‹å°†åŒæ­¥åœ°ç­‰å¾…IOæ“ä½œå®Œæˆï¼Œ è€ŒIOæ“ä½œæ˜¯éå¸¸æ…¢çš„ï¼Œæ‰€ä»¥æ­¤æ—¶çš„çº¿ç¨‹å¹¶ä¸èƒ½åŠæ—¶åœ°é‡Šæ”¾å›çº¿ç¨‹æ± ä»¥ä¾›åç»­ä½¿ç”¨ï¼Œåœ¨å¹¶å‘é‡è¶Šæ¥è¶Šå¤§çš„æƒ…å†µä¸‹ï¼Œå½“çº¿ç¨‹æ± å·²æ»¡ï¼Œè®¸å¤šè¯·æ±‚ä¸èƒ½åŠæ—¶çš„è¢«å¤„ç†ã€‚è¿™å°†å¸¦æ¥ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚ å³ä¾¿æ˜¯åƒSpringã€Strutsè¿™æ ·çš„é«˜å±‚æ¡†æ¶ä¹Ÿè„±ç¦»ä¸äº†è¿™æ ·çš„æ¡æ¢ï¼Œå› ä¸ºä»–ä»¬éƒ½æ˜¯å»ºç«‹åœ¨Servletä¹‹ä¸Šçš„ã€‚ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ï¼ŒServlet 3.0å¼•å…¥äº†å¼‚æ­¥å¤„ç†ï¼Œç„¶ååœ¨Servlet 3.1ä¸­åˆå¼•å…¥äº†éé˜»å¡IOæ¥è¿›ä¸€æ­¥å¢å¼ºå¼‚æ­¥å¤„ç†çš„æ€§èƒ½ã€‚ 123456789101112131415161718192021222324252627282930313233@WebServlet(value = \"/async\", asyncSupported = true) // æ”¯æŒå¼‚æ­¥å¤„ç†asyncSupported=truepublic class HelloAsyncServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { // å¼€å¯å¼‚æ­¥æ¨¡å¼ System.out.println(\"ä¸»çº¿ç¨‹å¼€å§‹ã€‚ã€‚ã€‚\" + Thread.currentThread() + \"-&gt;\" + System.currentTimeMillis()); AsyncContext startAsync = req.startAsync(); //ä¸šåŠ¡é€»è¾‘è¿›è¡Œå¼‚æ­¥å¤„ç†; å¼€å§‹å¼‚æ­¥å¤„ç† startAsync.start(new Runnable() { @Override public void run() { try { System.out.println(\"å‰¯çº¿ç¨‹å¼€å§‹ \" + Thread.currentThread() + \"-&gt;\" + System.currentTimeMillis()); sayHello(); startAsync.complete(); // å¼‚æ­¥å¤„ç†å®Œ AsyncContext asyncContext = req.getAsyncContext(); // è·å–åˆ°å¼‚æ­¥ä¸Šä¸‹æ–‡ ServletResponse response = asyncContext.getResponse(); // è·å–å“åº” response.getWriter().write(\"hello async...\"); System.out.println(\"å‰¯çº¿ç¨‹ç»“æŸ \" + Thread.currentThread() + \"-&gt;\" + System.currentTimeMillis()); } catch (Exception e) { } } }); System.out.println(\"ä¸»çº¿ç¨‹ç»“æŸã€‚ã€‚ã€‚\" + Thread.currentThread() + \"-&gt;\" + System.currentTimeMillis()); } public void sayHello() throws Exception { System.out.println(Thread.currentThread() + \" processing...\"); Thread.sleep(3000); }} SpringMVC å¼‚æ­¥å¤„ç†åŸºäº Callable çš„ç®€å•å¼‚æ­¥å¤„ç†ã€‚è¿”å› Callable ç»“æœå¯¹è±¡ï¼Œå°† Callable å¯¹è±¡æ”¾å…¥å¼‚æ­¥å¤„ç†çº¿ç¨‹å¤„ç†ç»“æœï¼Œä¸»çº¿ç¨‹ç»“æŸï¼Œç­‰å¾…å¼‚æ­¥çº¿ç¨‹è¿”å›ç»“æœæ¸²æŸ“é¡µé¢ã€‚ 1234567891011121314151617181920212223242526272829@Controllerpublic class AsyncController { /** * å¼‚æ­¥å¤„ç† * 1. æ§åˆ¶å™¨è¿”å› Callable * 2. Spring å¼‚æ­¥å¤„ç†ï¼Œå°†Callable æäº¤åˆ° TaskExecutor ä½¿ç”¨ä¸€ä¸ªéš”ç¦»çš„çº¿ç¨‹è¿›è¡Œæ‰§è¡Œ * 3. DispatcherServlet å’Œæ‰€æœ‰çš„ Filter é€€å‡º web å®¹å™¨çš„çº¿ç¨‹ï¼Œä½†æ˜¯ response ä¿æŒæ‰“å¼€çŠ¶æ€ï¼› * 4. Callable è¿”å›ç»“æœï¼ŒSpring MVC å°†è¯·æ±‚é‡æ–°æ´¾å‘ç»™å®¹å™¨ï¼Œæ¢å¤ä¹‹å‰çš„å¤„ç†ï¼› * 5. æ ¹æ® Callable è¿”å›çš„ç»“æœã€‚Spring MVC ç»§ç»­è¿›è¡Œè§†å›¾æ¸²æŸ“æµç¨‹ç­‰ï¼ˆä»æ”¶è¯·æ±‚-è§†å›¾æ¸²æŸ“ï¼‰ã€‚ */ @ResponseBody @RequestMapping(\"/async01\") public Callable&lt;String&gt; async01() { System.out.println(\"ä¸»çº¿ç¨‹å¼€å§‹.\" + Thread.currentThread() + \"-&gt;\" + System.currentTimeMillis()); Callable&lt;String&gt; callable = new Callable&lt;String&gt;() { @Override public String call() throws Exception { System.out.println(\"å‰¯çº¿ç¨‹å¼€å§‹.\" + Thread.currentThread() + \"-&gt;\" + System.currentTimeMillis()); Thread.sleep(2000); System.out.println(\"å‰¯çº¿ç¨‹å¼€å§‹.\" + Thread.currentThread() + \"-&gt;\" + System.currentTimeMillis()); return \"Callable&lt;String&gt; async01()\"; } }; System.out.println(\"ä¸»çº¿ç¨‹ç»“æŸ.\" + Thread.currentThread() + \"-&gt;\" + System.currentTimeMillis()); return callable; }} åŸºäº DeferredResult çš„å¼‚æ­¥å¤„ç†ã€‚è¿™ç§æ–¹å¼çš„ç‰¹ç‚¹åœ¨äºå¯ä»¥ä»ä¸åŒçš„çº¿ç¨‹å¼‚æ­¥åœ°äº§ç”Ÿè¿”å›å€¼ï¼Œé…åˆ JMS ï¼Œå¯ä»¥å®ç°åœ¨å…¶ä»–æ§åˆ¶å™¨ä¸­è¿”å›æœ¬æ¬¡è¯·æ±‚çš„ç»“æœã€‚ 12345678910@GetMapping(\"/quotes\")@ResponseBodypublic DeferredResult&lt;String&gt; quotes() { DeferredResult&lt;String&gt; deferredResult = new DeferredResult&lt;String&gt;(); // æŠŠè¿™ä¸ªå¯¹è±¡å­˜åœ¨ä¸€ä¸ªåœ°æ–¹ return deferredResult;}// åœ¨æŸä¸ªåœ°æ–¹è·å–å¯¹è±¡å¹¶å­˜å…¥å¯¹è±¡çš„å€¼ç„¶åè¿”å›deferredResult.setResult(data); ç”¨ä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354@Controllerpublic class AsyncController { /************************************************** * DeferredResult **************************************************/ /** * å¤„ç†è¯·æ±‚ï¼šåˆ›å»ºè®¢å• * - 1. æ„å»º DeferredResult å¯¹è±¡ï¼Œè®¾ç½®è¶…æ—¶äº‹ä»¶ï¼Œå¤±è´¥æç¤º * - 2. é€šè¿‡ JMS å‘é€ä¸€ä¸ª DeferredResultQueue å¯¹è±¡çš„æ¶ˆæ¯ï¼Œè¯¥å¯¹è±¡å­˜å‚¨ DeferredResult. * - 3. è‹¥æ¥æ”¶ç«¯åœ¨é™å®šæ—¶é—´å†…ç»™ DeferredResult å­˜å…¥äº†ç»“æœï¼Œåˆ™è¿”å› DeferredResult çš„ç»“æœï¼Œå¦åˆ™ç»“æœæ˜¯å¤±è´¥æç¤ºã€‚ */ @ResponseBody @RequestMapping(\"/createOrder\") public DeferredResult&lt;Object&gt; createOrder() { DeferredResult&lt;Object&gt; deferredResult = new DeferredResult&lt;&gt;((long) 3000, \"create fail...\"); // æ¨¡æ‹Ÿå‘é€æ¶ˆæ¯ï¼šæŠŠç»“æœå¯¹è±¡å­˜å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå‡è®¾ DeferredResultQueue é˜Ÿåˆ—å°±æ˜¯æ¶ˆæ¯é€šçŸ¥å†…å®¹ DeferredResultQueue.save(deferredResult); // ç­‰å¾…å¼‚æ­¥å­˜å…¥ç»“æœåˆ° deferredResult ä¸­å¹¶è¿”å›ï¼Œè¶…æ—¶åˆ™å¤±è´¥ return deferredResult; } /** * æ¨¡æ‹Ÿå¼‚æ­¥çš„å­˜å…¥è¯·æ±‚ç»“æœï¼šæ‰§è¡Œåˆ›å»º * - 1. ç›‘å¬ JMS æ¶ˆæ¯ï¼Œè·å¾—æ¶ˆæ¯å†…å®¹ï¼ˆDeferredResultQueueå¯¹è±¡ï¼‰ * - 2. ä»æ¶ˆæ¯å¯¹è±¡ DeferredResultQueue ä¸­æ‹¿åˆ° DeferredResult å»¶è¿Ÿå¼‚æ­¥ç»“æœå¯¹è±¡ã€‚ * - 3. æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œèµ‹å€¼ã€‚ */ @ResponseBody @RequestMapping(\"/create\") public String create() { //åˆ›å»ºè®¢å• String order = UUID.randomUUID().toString(); // è·å–åˆ°æ¶ˆæ¯é€šçŸ¥ï¼Œä»ä¸­è·å–åˆ°éœ€è¦å­˜å–ç»“æœçš„å¯¹è±¡ DeferredResult&lt;Object&gt; deferredResult = DeferredResultQueue.get(); // å‘ç»“æœå¯¹è±¡å­˜å…¥å€¼ï¼Œè¯·æ±‚è¿”å›ç»“æœ deferredResult.setResult(order); return \"success: \" + order; }}class DeferredResultQueue { private static ConcurrentLinkedQueue&lt;DeferredResult&lt;Object&gt;&gt; queue = new ConcurrentLinkedQueue&lt;DeferredResult&lt;Object&gt;&gt;(); public static void save(DeferredResult&lt;Object&gt; deferredResult) { queue.add(deferredResult); } public static DeferredResult&lt;Object&gt; get() { return queue.poll(); }} SSM é›¶é…ç½®æ•´åˆ Webï¼š WebInitializer spring context / spring mvc context / postFilter â€¦ Springï¼šRootConfig dataSource / transactionManager / sqlSessionFactory â€¦ Spring MVC: DispatcherServletConfig viewResolvers / resourceHandlers â€¦ demo","link":"/2018/09/13/Spring-Annotation-development/"},{"title":"åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆäºŒï¼‰","text":"10.Redisé›†ç¾¤çš„æ­å»ºåŠä¸šåŠ¡å®ç°Redisé›†ç¾¤çš„æ­å»ºåŠä¸šåŠ¡å®ç°redisé›†ç¾¤ï¼ˆRedis-clusterï¼‰æ¶æ„å›¾ ç¯å¢ƒå‡†å¤‡ è‡³å°‘3ä¸ªèŠ‚ç‚¹ï¼Œä¸ºäº†é›†ç¾¤çš„é«˜å¯ç”¨ï¼Œä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹å¢åŠ ä¸€ä¸ªå¤‡ä»½æœºã€‚ï¼ˆ6å°æœåŠ¡å™¨ï¼‰ã€‚æ­å»ºä¼ªåˆ†å¸ƒå¼é›†ç¾¤æ–¹æ¡ˆï¼šåœ¨ä¸€å°æœºå™¨é‡Œé¢è¿è¡Œ6ä¸ªrediså®ä¾‹ã€‚ç«¯å£éœ€è¦ä¸åŒï¼ˆ7001-7006ï¼‰ 1ã€ä½¿ç”¨rubyè„šæœ¬æ­å»ºé›†ç¾¤ã€‚éœ€è¦rubyçš„è¿è¡Œç¯å¢ƒã€‚å®‰è£…rubyï¼š 12yum install rubyyum install rubygems 2ã€ä»å®˜ç½‘ä¸‹è½½ redis-3.0.4.gem å¹¶ä¸Šä¼ åˆ° linux ä¸­ åœ°å€ï¼šhttps://rubygems.org/gems/redis/versions 3ã€å®‰è£…rubyè¿è¡Œæ—¶æ‰€ä½¿ç”¨çš„åŒ… 1gem install redis-3.0.0.gem æ­å»ºæ­¥éª¤ éœ€è¦6å°redisæœåŠ¡å™¨ã€‚æ­å»ºä¼ªåˆ†å¸ƒå¼ã€‚éœ€è¦6ä¸ªrediså®ä¾‹ã€‚éœ€è¦è¿è¡Œåœ¨ä¸åŒçš„ç«¯å£7001-7006æ³¨æ„ï¼šæ­å»ºå‰ å¦‚æœèŠ‚ç‚¹é‡Œæœ‰æ•°æ®ï¼Œéœ€è¦åˆ é™¤ï¼ˆrdbæ–‡ä»¶ï¼Œaofæ–‡ä»¶ï¼‰ã€‚ ç¬¬ä¸€æ­¥ï¼šåˆ›å»º6ä¸ªrediså®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹è¿è¡Œåœ¨ä¸åŒçš„ç«¯å£ã€‚éœ€è¦ä¿®æ”¹redis.confé…ç½®æ–‡ä»¶ã€‚é…ç½®æ–‡ä»¶ä¸­è¿˜éœ€è¦æŠŠcluster-enabled yeså‰çš„æ³¨é‡Šå»æ‰ã€‚ 12345678910[root@localhost redis-cluster]# pwd/usr/local/redis-cluster[root@localhost redis-cluster]# llæ€»ç”¨é‡ 80drwxr-xr-x. 3 root root 4096 7æœˆ 10 21:12 redis01drwxr-xr-x. 3 root root 4096 7æœˆ 10 21:53 redis02drwxr-xr-x. 3 root root 4096 7æœˆ 10 21:53 redis03drwxr-xr-x. 3 root root 4096 7æœˆ 10 21:53 redis04drwxr-xr-x. 3 root root 4096 7æœˆ 10 21:53 redis05drwxr-xr-x. 3 root root 4096 7æœˆ 10 21:54 redis06 æ¯ä¸ªå®ä¾‹å†…å®¹å¦‚ä¸‹ 12345678910111213141516[root@localhost redis-cluster]# cd redis01[root@localhost redis01]# llæ€»ç”¨é‡ 4drwxr-xr-x. 2 root root 4096 7æœˆ 10 22:39 bin[root@localhost redis01]# cd bin[root@localhost bin]# llæ€»ç”¨é‡ 15508-rw-r--r--. 1 root root 18 7æœˆ 10 22:39 dump.rdb-rw-r--r--. 1 root root 769 7æœˆ 10 22:02 nodes.conf-rwxr-xr-x. 1 root root 4589155 7æœˆ 10 21:12 redis-benchmark-rwxr-xr-x. 1 root root 22217 7æœˆ 10 21:12 redis-check-aof-rwxr-xr-x. 1 root root 45435 7æœˆ 10 21:12 redis-check-dump-rwxr-xr-x. 1 root root 4693114 7æœˆ 10 21:12 redis-cli-rw-r--r--. 1 root root 41391 7æœˆ 10 21:14 redis.conflrwxrwxrwx. 1 root root 12 7æœˆ 10 21:12 redis-sentinel -&gt; redis-server-rwxr-xr-x. 1 root root 6466389 7æœˆ 10 21:12 redis-server å®é™…ä¸Šä¸€ä¸ªå®ä¾‹å°±æ˜¯ä¸€ä¸ªrediså®‰è£…æ–‡ä»¶ï¼ˆä¸æ˜¯å®‰è£…åŒ…ï¼‰ï¼Œä¸ºæ¯ä¸ªå®ä¾‹å¤åˆ¶ä¸€ä»½redis.confï¼Œåˆ†åˆ«é…ç½®ä¸åŒçš„ç«¯å£ã€cluster-enabled yesæ³¨é‡Šæ‰“å¼€ã€‚ ç¬¬äºŒæ­¥ï¼šå¯åŠ¨æ¯ä¸ªrediså®ä¾‹ã€‚ é€šè¿‡è„šæœ¬æ‰¹é‡å¯åŠ¨å…¨éƒ¨æœåŠ¡ 1234567891011121314151617181920vim redis-cluster-start-all.sh æ·»åŠ å¦‚ä¸‹ï¼šcd /usr/local/redis-cluster/redis01/bin./redis-server redis.confcd /usr/local/redis-cluster/redis02/bin./redis-server redis.confcd /usr/local/redis-cluster/redis03/bin./redis-server redis.confcd /usr/local/redis-cluster/redis04/bin./redis-server redis.confcd /usr/local/redis-cluster/redis05/bin./redis-server redis.confcd /usr/local/redis-cluster/redis06/bin./redis-server redis.conf ç„¶åæˆäºˆå¯æ‰§è¡Œæƒé™ã€æ‰§è¡Œå³å¯ã€‚ 123456789[root@localhost redis-cluster]# ./redis-cluster-start-all.sh [root@localhost redis-cluster]# ps -ef |grep redisroot 4001 1 10 22:14 ? 00:00:00 ./redis-server *:7001 [cluster]root 4003 1 8 22:14 ? 00:00:00 ./redis-server *:7002 [cluster]root 4009 1 7 22:14 ? 00:00:00 ./redis-server *:7003 [cluster]root 4013 1 2 22:14 ? 00:00:00 ./redis-server *:7004 [cluster]root 4017 1 2 22:14 ? 00:00:00 ./redis-server *:7005 [cluster]root 4021 1 2 22:14 ? 00:00:00 ./redis-server *:7006 [cluster]root 4028 3302 0 22:14 pts/0 00:00:00 grep redis ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨rubyè„šæœ¬æ­å»ºé›†ç¾¤ã€‚ ä»Redisè§£å‹ç›®å½•ä¸‹çš„srcä¸‹çš„æ‹·è´redis-trib.rbæ–‡ä»¶åˆ°redis-clusterç›®å½•ä¸­ æ‰§è¡Œåˆ›å»º 1./redis-trib.rb create --replicas 1 192.168.184.130:7001 192.168.184.130:7002 192.168.184.130:7003 192.168.184.130:7004 192.168.184.130:7005 192.168.184.130:7006 ç¬¬å››æ­¥ åˆ›å»ºå…³é—­é›†ç¾¤çš„è„šæœ¬ï¼šï¼ˆä¸æ˜¯å¿…é¡»çš„ï¼‰ 12345678910111213141516171819vim å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ redis-cluster-stop-all.sh cd /usr/local/redis-cluster/redis01/bin./redis-cli -p 7001 shutdowncd /usr/local/redis-cluster/redis02/bin./redis-cli -p 7002 shutdowncd /usr/local/redis-cluster/redis03/bin./redis-cli -p 7003 shutdowncd /usr/local/redis-cluster/redis04/bin./redis-cli -p 7004 shutdowncd /usr/local/redis-cluster/redis05/bin./redis-cli -p 7005 shutdowncd /usr/local/redis-cluster/redis06/bin./redis-cli -p 7006 shutdown ç„¶åæˆäºˆå¯æ‰§è¡Œæƒé™ã€æ‰§è¡Œå³å¯ã€‚ é›†ç¾¤ä½¿ç”¨Redis-cliè¿æ¥é›†ç¾¤ã€‚-cï¼šä»£è¡¨è¿æ¥çš„æ˜¯redisé›†ç¾¤ 123456789101112[root@localhost bin]# ./redis-cli -p 7001 -c127.0.0.1:7001&gt; set adsadsafd jkljlkjl-&gt; Redirected to slot [16142] located at 192.168.184.130:7006OK192.168.184.130:7006&gt; get adsadsafd&quot;jkljlkjl&quot;192.168.184.130:7006&gt; set key2 v2-&gt; Redirected to slot [4998] located at 192.168.184.130:7001OK192.168.184.130:7001&gt; get key2&quot;v2&quot;192.168.184.130:7001&gt; Jediså®¢æˆ·ç«¯è¿æ¥Redisé›†ç¾¤æœåŠ¡å™¨æ³¨æ„ï¼šå¼€æ”¾é›†ç¾¤çš„7001-7006ç«¯å£ 12345678910111213141516171819@Testpublic void testJedisCluster() throws Exception { // ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨JedisClusterå¯¹è±¡ã€‚éœ€è¦ä¸€ä¸ªSet&lt;HostAndPort&gt;å‚æ•°ã€‚RedisèŠ‚ç‚¹çš„åˆ—è¡¨ã€‚ Set&lt;HostAndPort&gt; nodes = new HashSet&lt;&gt;(); nodes.add(new HostAndPort(\"192.168.184.130\", 7001)); nodes.add(new HostAndPort(\"192.168.184.130\", 7002)); nodes.add(new HostAndPort(\"192.168.184.130\", 7003)); nodes.add(new HostAndPort(\"192.168.184.130\", 7004)); nodes.add(new HostAndPort(\"192.168.184.130\", 7005)); nodes.add(new HostAndPort(\"192.168.184.130\", 7006)); JedisCluster jedisCluster = new JedisCluster(nodes); // ç¬¬äºŒæ­¥ï¼šç›´æ¥ä½¿ç”¨JedisClusterå¯¹è±¡æ“ä½œredisã€‚åœ¨ç³»ç»Ÿä¸­å•ä¾‹å­˜åœ¨ã€‚ jedisCluster.set(\"hello\", \"100\"); String result = jedisCluster.get(\"hello\"); // ç¬¬ä¸‰æ­¥ï¼šæ‰“å°ç»“æœ System.out.println(result); // ç¬¬å››æ­¥ï¼šç³»ç»Ÿå…³é—­å‰ï¼Œå…³é—­JedisClusterå¯¹è±¡ã€‚ jedisCluster.close();} å®ç°ä¸šåŠ¡ å› ä¸ºé›†ç¾¤æ˜¯æ¯”è¾ƒæ¶ˆè€—æˆæœ¬çš„ï¼Œæ‰€ä»¥åœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸€èˆ¬ç”Ÿäº§ç¯å¢ƒä½¿ç”¨é›†ç¾¤ï¼Œå¼€å‘ç¯å¢ƒä½¿ç”¨å•æœºç‰ˆã€‚æˆ‘ä»¬åœ¨é¡¹ç›®æ•´åˆä¸­éƒ½éœ€è¦æœ‰ã€‚å¯ä»¥å¼€å‘ä¸€ä¸ªæ¥å£ï¼Œæœ‰å•æœºç‰ˆçš„å®ç°ç±»å’Œé›†ç¾¤ç‰ˆçš„å®ç°ç±»ã€‚ä½¿ç”¨æ—¶å¯ä»¥é¢å‘æ¥å£å¼€å‘ï¼Œä¸å½±å“ä¸šåŠ¡é€»è¾‘ï¼Œä½¿ç”¨springç®¡ç†å®ç°ç±»ï¼Œéƒ¨ç½²æ—¶åˆ‡æ¢å®ç°ç±»å³å¯ã€‚ æ¥å£å°è£…å¸¸ç”¨çš„æ“ä½œredisçš„æ–¹æ³•æŠ½å–å‡ºä¸€ä¸ªæ¥å£ï¼Œåˆ†åˆ«å¯¹åº”å•æœºç‰ˆå’Œé›†ç¾¤ç‰ˆåˆ›å»ºä¸¤ä¸ªå®ç°ç±»ã€‚ 123456789101112131415161718192021package xyz.taotao.content.service;/** * Created with IntelliJ IDEA. * Jedisæ¥å£ * @Author: yu_zh * @DateTime: 2018/07/14 23:32 */public interface JedisClient { String set(String key, String value); String get(String key); Boolean exists(String key); Long expire(String key, int seconds); Long ttl(String key); Long incr(String key); Long hset(String key, String field, String value); String hget(String key, String field); Long hdel(String key, String... field); } å•æœºç‰ˆå®ç°ç±»ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091package xyz.taotao.content.service.impl;import org.springframework.beans.factory.annotation.Autowired;import redis.clients.jedis.Jedis;import redis.clients.jedis.JedisPool;import xyz.taotao.content.service.JedisClient;/** * Created with IntelliJ IDEA. * å•æœºç‰ˆå®ç° * @Author: yu_zh * @DateTime: 2018/07/14 23:35 */public class JedisClientPool implements JedisClient { @Autowired private JedisPool jedisPool; @Override public String set(String key, String value) { Jedis jedis = jedisPool.getResource(); String result = jedis.set(key, value); jedis.close(); return result; } @Override public String get(String key) { Jedis jedis = jedisPool.getResource(); String result = jedis.get(key); jedis.close(); return result; } @Override public Boolean exists(String key) { Jedis jedis = jedisPool.getResource(); Boolean result = jedis.exists(key); jedis.close(); return result; } @Override public Long expire(String key, int seconds) { Jedis jedis = jedisPool.getResource(); Long result = jedis.expire(key, seconds); jedis.close(); return result; } @Override public Long ttl(String key) { Jedis jedis = jedisPool.getResource(); Long result = jedis.ttl(key); jedis.close(); return result; } @Override public Long incr(String key) { Jedis jedis = jedisPool.getResource(); Long result = jedis.incr(key); jedis.close(); return result; } @Override public Long hset(String key, String field, String value) { Jedis jedis = jedisPool.getResource(); Long result = jedis.hset(key, field, value); jedis.close(); return result; } @Override public String hget(String key, String field) { Jedis jedis = jedisPool.getResource(); String result = jedis.hget(key, field); jedis.close(); return result; } @Override public Long hdel(String key, String... field) { Jedis jedis = jedisPool.getResource(); Long result = jedis.hdel(key, field); jedis.close(); return result; }} é›†ç¾¤ç‰ˆå®ç°ç±»ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162package xyz.taotao.content.service.impl;import org.springframework.beans.factory.annotation.Autowired;import redis.clients.jedis.JedisCluster;import xyz.taotao.content.service.JedisClient;/** * Created with IntelliJ IDEA. * é›†ç¾¤ç‰ˆå®ç°ç±» * @Author: yu_zh * @DateTime: 2018/07/14 23:44 */public class JedisClientCluster implements JedisClient { @Autowired private JedisCluster jedisCluster; @Override public String set(String key, String value) { return jedisCluster.set(key, value); } @Override public String get(String key) { return jedisCluster.get(key); } @Override public Boolean exists(String key) { return jedisCluster.exists(key); } @Override public Long expire(String key, int seconds) { return jedisCluster.expire(key, seconds); } @Override public Long ttl(String key) { return jedisCluster.ttl(key); } @Override public Long incr(String key) { return jedisCluster.incr(key); } @Override public Long hset(String key, String field, String value) { return jedisCluster.hset(key, field, value); } @Override public String hget(String key, String field) { return jedisCluster.hget(key, field); } @Override public Long hdel(String key, String... field) { return jedisCluster.hdel(key, field); }} é…ç½®ï¼šspring-redis.xmlæ³¨æ„ï¼šå•æœºç‰ˆå’Œé›†ç¾¤ç‰ˆåªèƒ½æ”¾å¼€ä¸€ä¸ª 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;!-- ç”¨äºæ¿€æ´»å·²ç»æ³¨å†Œçš„Bean --&gt; &lt;context:annotation-config&gt;&lt;/context:annotation-config&gt; &lt;!-- é…ç½®å•æœºç‰ˆçš„è¿æ¥ --&gt; &lt;bean id=\"jedisPool\" class=\"redis.clients.jedis.JedisPool\"&gt; &lt;constructor-arg name=\"host\" value=\"192.168.184.130\"&gt;&lt;/constructor-arg&gt; &lt;constructor-arg name=\"port\" value=\"6379\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt; &lt;!-- åˆ›å»ºå•æœºç‰ˆçš„å®ç°ç±» --&gt; &lt;bean id=\"jedisClientPool\" class=\"xyz.taotao.content.service.impl.JedisClientPool\"/&gt; &lt;!--------------------------------------------------------&gt; &lt;!-- é…ç½®é›†ç¾¤ç‰ˆ --&gt; &lt;bean class=\"redis.clients.jedis.JedisCluster\"&gt; &lt;constructor-arg name=\"nodes\"&gt; &lt;set&gt; &lt;bean class=\"redis.clients.jedis.HostAndPort\"&gt; &lt;constructor-arg name=\"host\" value=\"192.168.184.130\"&gt;&lt;/constructor-arg&gt; &lt;constructor-arg name=\"port\" value=\"7001\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt; &lt;bean class=\"redis.clients.jedis.HostAndPort\"&gt; &lt;constructor-arg name=\"host\" value=\"192.168.184.130\"&gt;&lt;/constructor-arg&gt; &lt;constructor-arg name=\"port\" value=\"7002\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt; &lt;bean class=\"redis.clients.jedis.HostAndPort\"&gt; &lt;constructor-arg name=\"host\" value=\"192.168.184.130\"&gt;&lt;/constructor-arg&gt; &lt;constructor-arg name=\"port\" value=\"7003\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt; &lt;bean class=\"redis.clients.jedis.HostAndPort\"&gt; &lt;constructor-arg name=\"host\" value=\"192.168.184.130\"&gt;&lt;/constructor-arg&gt; &lt;constructor-arg name=\"port\" value=\"7004\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt; &lt;bean class=\"redis.clients.jedis.HostAndPort\"&gt; &lt;constructor-arg name=\"host\" value=\"192.168.184.130\"&gt;&lt;/constructor-arg&gt; &lt;constructor-arg name=\"port\" value=\"7005\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt; &lt;bean class=\"redis.clients.jedis.HostAndPort\"&gt; &lt;constructor-arg name=\"host\" value=\"192.168.184.130\"&gt;&lt;/constructor-arg&gt; &lt;constructor-arg name=\"port\" value=\"7006\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt; &lt;/set&gt; &lt;/constructor-arg&gt; &lt;/bean&gt; &lt;!-- åˆ›å»ºé›†ç¾¤ç‰ˆçš„å®ç°ç±» --&gt; &lt;bean class=\"xyz.taotao.content.service.impl.JedisClientCluster\"&gt;&lt;/bean&gt; å°è£…ä»£ç æµ‹è¯•rediså®¢æˆ·ç«¯Beanåªåœ¨spring-redis.xmlä¸­æ³¨å†Œï¼Œæ‰€ä»¥åªéœ€åŠ è½½è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ³¨æ„ï¼šéœ€è¦æ¿€æ´»å·²ç»æ³¨å†Œçš„Beanæ‰èƒ½æ³¨å…¥åˆ°å±æ€§ã€‚ 12345678910@Testpublic void testJedisClient() throws Exception { //åˆå§‹åŒ–Springå®¹å™¨ ApplicationContext applicationContext = new ClassPathXmlApplicationContext(\"classpath:spring-redis.xml\"); //ä»å®¹å™¨ä¸­è·å¾—JedisClientå¯¹è±¡ï¼ˆæ¥å£ï¼‰ JedisClient jedisClient = applicationContext.getBean(JedisClient.class); jedisClient.set(\"testJedis\", \"500\"); String result = jedisClient.get(\"testJedis\"); System.out.println(result);} ä¸ºæŸ¥è¯¢æ·»åŠ ç¼“å­˜åˆ›å»ºJsonå·¥å…·ç±» 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869package xyz.taotao.utils;import java.util.List;import com.fasterxml.jackson.core.JsonProcessingException;import com.fasterxml.jackson.databind.JavaType;import com.fasterxml.jackson.databind.ObjectMapper;/** * ä½¿ç”¨ jackson-databind å·¥å…·åŒ…å°è£…Json */public class JsonUtils { // å®šä¹‰jacksonå¯¹è±¡ private static final ObjectMapper MAPPER = new ObjectMapper(); /** * å°†å¯¹è±¡è½¬æ¢æˆjsonå­—ç¬¦ä¸²ã€‚ * * @param data * @return */ public static String objectToJson(Object data) { try { String string = MAPPER.writeValueAsString(data); return string; } catch (JsonProcessingException e) { e.printStackTrace(); } return null; } /** * å°†jsonç»“æœé›†è½¬åŒ–ä¸ºå¯¹è±¡ * * @param jsonData jsonæ•°æ® * @param beanType å¯¹è±¡ä¸­çš„objectç±»å‹ * @return */ public static &lt;T&gt; T jsonToPojo(String jsonData, Class&lt;T&gt; beanType) { try { T t = MAPPER.readValue(jsonData, beanType); return t; } catch (Exception e) { e.printStackTrace(); } return null; } /** * å°†jsonæ•°æ®è½¬æ¢æˆpojoå¯¹è±¡list * * @param jsonData * @param beanType * @return */ public static &lt;T&gt; List&lt;T&gt; jsonToList(String jsonData, Class&lt;T&gt; beanType) { JavaType javaType = MAPPER.getTypeFactory().constructParametricType(List.class, beanType); try { List&lt;T&gt; list = MAPPER.readValue(jsonData, javaType); return list; } catch (Exception e) { e.printStackTrace(); } return null; }} æ·»åŠ ç¼“å­˜ï¼Œä¸èƒ½å½±å“ä¸šåŠ¡ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485package xyz.taotao.service.impl;import com.github.pagehelper.PageHelper;import com.github.pagehelper.PageInfo;import org.apache.commons.lang3.StringUtils;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Value;import org.springframework.stereotype.Service;import xyz.taotao.mapper.TbItemMapper;import xyz.taotao.pojo.EasyUIDataGridResult;import xyz.taotao.pojo.TbItem;import xyz.taotao.pojo.TbItemExample;import xyz.taotao.redis.JedisClient;import xyz.taotao.service.ItemService;import xyz.taotao.utils.JsonUtils;import java.util.List;/** * Created with IntelliJ IDEA. * * @Author: yu_zh * @DateTime: 2018/07/05 19:02 */@Servicepublic class ItemServiceImpl implements ItemService { @Autowired TbItemMapper tbItemMapper; @Autowired private JedisClient jedisClient; @Value(\"ITEM_LIST_KEY\") private String ITEM_LIST_KEY; /** * ä¸ºæŸ¥è¯¢åˆ—è¡¨é¡¹æ·»åŠ ç¼“å­˜ * ç»“æ„ï¼šHash * &lt;p&gt; * item_list_key * | * 1,50 â€”â€” EasyUIDataGridResult Jsonå­—ç¬¦ä¸² * 2,50 â€”â€” EasyUIDataGridResult Jsonå­—ç¬¦ä¸² * 3,50 â€”â€” EasyUIDataGridResult Jsonå­—ç¬¦ä¸² * &lt;p&gt; * ç¼“å­˜ä¸èƒ½å½±å“ä¸šåŠ¡æµç¨‹ï¼Œç”¨try-catchèµ·æ¥ã€‚ * * @param page æŸ¥è¯¢é¡µç  * @param rows æŸ¥è¯¢è¡Œæ•° * @return EasyUIDataGridResult */ @Override public EasyUIDataGridResult getItemList(int page, int rows) { //æŸ¥è¯¢ç¼“å­˜ try { String json = jedisClient.hget(ITEM_LIST_KEY, page + \"-\" + rows); //åˆ¤æ–­jsonæ˜¯å¦ä¸ºç©º if (StringUtils.isNotBlank(json)) { //æŠŠjsonè½¬æ¢æˆlist System.out.println(\"è·å¾—ç¼“å­˜\"); return JsonUtils.jsonToPojo(json, EasyUIDataGridResult.class); } } catch (Exception e) { e.printStackTrace(); } //è®¾ç½®åˆ†é¡µä¿¡æ¯ PageHelper.startPage(page, rows); //æŸ¥è¯¢æ•°æ®ï¼Œè®¾ç½®æŸ¥è¯¢æ¡ä»¶ TbItemExample example = new TbItemExample(); List&lt;TbItem&gt; tbItemList = tbItemMapper.selectByExample(example); //å°è£…åˆ†é¡µç»“æœé›† PageInfo&lt;TbItem&gt; pageInfo = new PageInfo&lt;&gt;(tbItemList); //åˆ›å»ºåˆ†é¡µå¯¹è±¡ EasyUIDataGridResult result = new EasyUIDataGridResult((int) pageInfo.getTotal(), pageInfo.getList()); //å‘ç¼“å­˜ä¸­æ·»åŠ æ•°æ® try { jedisClient.hset(ITEM_LIST_KEY, page + \"-\" + rows, JsonUtils.objectToJson(result)); System.out.println(\"æ”¾å…¥redis -&gt; \" + page + \"-\" + rows); System.out.println(JsonUtils.objectToJson(result)); } catch (Exception e) { e.printStackTrace(); } return result; }} æ§åˆ¶å°æ‰“å°ï¼šRedisæ•°æ®åº“ï¼š ç¼“å­˜åŒæ­¥å¯¹æ·»åŠ äº†ç¼“å­˜çš„æ•°æ®è¿›è¡Œæ›´æ–°ï¼ˆå¢ã€åˆ ã€æ”¹ï¼‰ä¹‹åï¼Œéœ€è¦åŒæ­¥æœ€æ–°çš„æ•°æ®æ”¾å…¥ç¼“å­˜ã€‚åšæ³•å°±æ˜¯åˆ é™¤å¯¹åº”ç¼“å­˜çš„keyï¼Œå†æ¬¡è·å–æ•°æ®ä¼šå…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œå†æ”¾å…¥ç¼“å­˜ã€‚","link":"/2018/07/14/åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆäºŒï¼‰/"},{"title":"åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆä¸‰ï¼‰","text":"11.Solrç´¢å¼•åº“çš„æ­å»ºä¸ä½¿ç”¨ï¼ˆå•æœºç‰ˆå’Œé›†ç¾¤ç‰ˆï¼‰ä¸‹è½½åœ°å€ï¼šhttps://lucene.apache.org/solr/ å•æœºç‰ˆæ­å»º* ç‰ˆæœ¬ï¼šsolr-4.10.3 * windowsä¸‹çš„é…ç½®å®Œå…¨ä¸€æ ·ã€‚ ç¬¬ä¸€æ­¥ï¼šæŠŠsolr çš„å‹ç¼©åŒ…ä¸Šä¼ åˆ°Linuxç³»ç»Ÿç¬¬äºŒæ­¥ï¼šè§£å‹solrã€‚ç¬¬ä¸‰æ­¥ï¼šæŠŠsolréƒ¨ç½²åˆ°Tomcatä¸‹ã€‚ è·¯å¾„ï¼š`/opt/solr-4.10.3/dist/solr-4.10.3.war` ç¬¬å››æ­¥ï¼šè§£å‹ç¼©waråŒ…ã€‚å¯ä»¥å¯åŠ¨Tomcatè§£å‹ã€‚ç¬¬äº”æ­¥ï¼šæŠŠ/root/solr-4.10.3/example/lib/extç›®å½•ä¸‹çš„æ‰€æœ‰çš„jaråŒ…ï¼Œæ·»åŠ åˆ°solrå·¥ç¨‹ä¸­ã€‚ç¬¬å…­æ­¥ï¼šåˆ›å»ºä¸€ä¸ªsolrhomeã€‚å®‰è£…åŒ…è‡ªå¸¦æœ‰ä¸€ä¸ªsolrhomeï¼š/example/solrï¼Œè¯¥ç›®å½•å°±æ˜¯ä¸€ä¸ªsolrhomeã€‚å¤åˆ¶æ­¤ç›®å½•åˆ°è‡ªå·±åˆ›å»ºsolrhomeã€‚ç¬¬ä¸ƒæ­¥ï¼šå…³è”solråŠsolrhomeã€‚éœ€è¦ä¿®æ”¹solrå·¥ç¨‹çš„web.xmlæ–‡ä»¶ã€‚ 12345&lt;env-entry&gt; &lt;env-entry-name&gt;solr/home&lt;/env-entry-name&gt; &lt;env-entry-value&gt;/opt/solrhome&lt;/env-entry-value&gt; &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;&lt;/env-entry&gt; ç¬¬å…«æ­¥ï¼šå¯åŠ¨Tomcathttp://192.168.184.130:8080/solr/ ä½¿ç”¨æ·»åŠ æ–‡æ¡£å¿…é¡»æœ‰idåŸŸï¼Œå…¶ä»–åŸŸ å¿…é¡»åœ¨solrçš„schema.xmlä¸­å®šä¹‰ã€‚ schema.xmlä¸­å®šä¹‰ æœ¬ç³»ç»Ÿä¸šåŠ¡æ‰€éœ€è¦çš„ä¸šåŠ¡åŸŸæœ‰ï¼š1ã€å•†å“Id ä½¿ç”¨schema.xmlä¸­çš„idåŸŸ2ã€å•†å“æ ‡é¢˜3ã€å•†å“å–ç‚¹4ã€å•†å“ä»·æ ¼5ã€å•†å“å›¾ç‰‡6ã€åˆ†ç±»åç§°7ã€å•†å“æè¿° é…ç½®ä¸­æ–‡åˆ†è¯å™¨åˆ›å»ºå¯¹åº”çš„ä¸šåŠ¡åŸŸã€‚éœ€è¦åˆ¶å®šä¸­æ–‡åˆ†æå™¨ã€‚ä¸‹è½½åœ°å€ï¼šhttps://code.google.com/archive/p/ik-analyzer/downloads ç¬¬ä¸€æ­¥ï¼šæŠŠä¸­æ–‡åˆ†æå™¨æ·»åŠ åˆ°solrå·¥ç¨‹ä¸­ã€‚ 1ã€æŠŠIKAnalyzer2012FF_u1.jaræ·»åŠ åˆ°solrå·¥ç¨‹çš„libç›®å½•ä¸‹ã€‚ 2ã€æŠŠæ‰©å±•è¯å…¸ã€é…ç½®æ–‡ä»¶æ”¾åˆ°solrå·¥ç¨‹çš„WEB-INF/classesç›®å½•ä¸‹ã€‚ ç¬¬äºŒæ­¥ï¼šé…ç½®ä¸€ä¸ªFieldTypeï¼Œåˆ¶å®šä½¿ç”¨IKAnalyzer ä¿®æ”¹solrHomeä¸­çš„schema.xmlæ–‡ä»¶ï¼Œæ·»åŠ FieldTypeã€‚ è·¯å¾„ï¼š`/opt/solrhome/collection1/conf/schema.xml` 123&lt;fieldType name=\"text_ik\" class=\"solr.TextField\"&gt; &lt;analyzer class=\"org.wltea.analyzer.lucene.IKAnalyzer\"/&gt;&lt;/fieldType&gt; ç¬¬ä¸‰æ­¥ï¼šé…ç½®ä¸šåŠ¡åŸŸï¼Œtypeåˆ¶å®šä½¿ç”¨è‡ªå®šä¹‰çš„FieldTypeã€‚è®¾ç½®ä¸šåŠ¡ç³»ç»ŸField 123456789101112&lt;field name=\"item_title\" type=\"text_ik\" indexed=\"true\" stored=\"true\"/&gt;&lt;field name=\"item_sell_point\" type=\"text_ik\" indexed=\"true\" stored=\"true\"/&gt;&lt;field name=\"item_price\" type=\"long\" indexed=\"true\" stored=\"true\"/&gt;&lt;field name=\"item_image\" type=\"string\" indexed=\"false\" stored=\"true\" /&gt;&lt;field name=\"item_category_name\" type=\"string\" indexed=\"true\" stored=\"true\" /&gt;&lt;field name=\"item_desc\" type=\"text_ik\" indexed=\"true\" stored=\"false\" /&gt;&lt;field name=\"item_keywords\" type=\"text_ik\" indexed=\"true\" stored=\"false\" multiValued=\"true\"/&gt;&lt;copyField source=\"item_title\" dest=\"item_keywords\"/&gt;&lt;copyField source=\"item_sell_point\" dest=\"item_keywords\"/&gt;&lt;copyField source=\"item_category_name\" dest=\"item_keywords\"/&gt;&lt;copyField source=\"item_desc\" dest=\"item_keywords\"/&gt; ç¬¬å››æ­¥ï¼šé‡å¯tomcat Tomcatå¯åŠ¨åè®¿é—®ä¸äº†ï¼Ÿå¤šæ¬¡å‡ºç°è¿™æ ·çš„é—®é¢˜ï¼Œå¯åŠ¨ä¹‹åè®¿é—®ä¸äº†ï¼Œä¸€å®šè¦çœ‹æ—¥å¿—ï¼/opt/apache-tomcat-8.5.32/logs/catalina.outã€‚ ç”±äºæœ¬æœºä¸­dubbo-adminå’Œsolræ”¾åœ¨äº†åŒä¸€ä¸ªtomcatï¼Œè€Œdubbo-adminå¯åŠ¨éœ€è¦å…ˆå¼€å¯zookeeperæœåŠ¡ï¼Œæ‰€ä»¥tomcatä¸€ç›´å¤„äºå¯åŠ¨çŠ¶æ€ã€‚ Linuxä¸­å¤šæ¬¡å¯åŠ¨å…³é—­Tomcatä¸‹æ¬¡å¯åŠ¨ä¼šå¼‚å¸¸ï¼Œéœ€è¦å¼ºåˆ¶æ€æ­»è¿›ç¨‹ kill -s 9 pid ç„¶åå†å¯åŠ¨ã€‚ æµ‹è¯•CRUDä½¿ç”¨SolrJå¯ä»¥å®ç°ç´¢å¼•åº“çš„å¢åˆ æ”¹æŸ¥æ“ä½œã€‚ Maven: 12345&lt;!-- solrå®¢æˆ·ç«¯ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.solr&lt;/groupId&gt; &lt;artifactId&gt;solr-solrj&lt;/artifactId&gt;&lt;/dependency&gt; æ·»åŠ åˆ°æ–‡æ¡£1234567891011121314151617181920212223242526/** * ç¬¬ä¸€æ­¥ï¼šæŠŠsolrJçš„jaråŒ…æ·»åŠ åˆ°å·¥ç¨‹ä¸­ã€‚ * ç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrServerï¼Œä½¿ç”¨HttpSolrServeråˆ›å»ºå¯¹è±¡ã€‚ * ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ–‡æ¡£å¯¹è±¡SolrInputDocumentå¯¹è±¡ã€‚ * ç¬¬å››æ­¥ï¼šå‘æ–‡æ¡£ä¸­æ·»åŠ åŸŸã€‚å¿…é¡»æœ‰idåŸŸï¼ŒåŸŸçš„åç§°å¿…é¡»åœ¨schema.xmlä¸­å®šä¹‰ã€‚ * ç¬¬äº”æ­¥ï¼šæŠŠæ–‡æ¡£æ·»åŠ åˆ°ç´¢å¼•åº“ä¸­ã€‚ * ç¬¬å…­æ­¥ï¼šæäº¤ã€‚ * * @throws Exception */@Testpublic void addDocument() throws Exception { // ç¬¬ä¸€æ­¥ï¼šæŠŠsolrJçš„jaråŒ…æ·»åŠ åˆ°å·¥ç¨‹ä¸­ã€‚ // ç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrServerï¼Œä½¿ç”¨HttpSolrServeråˆ›å»ºå¯¹è±¡ã€‚ SolrServer solrServer = new HttpSolrServer(\"http://192.168.184.130:8080/solr\"); // ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ–‡æ¡£å¯¹è±¡SolrInputDocumentå¯¹è±¡ã€‚ SolrInputDocument document = new SolrInputDocument(); // ç¬¬å››æ­¥ï¼šå‘æ–‡æ¡£ä¸­æ·»åŠ åŸŸã€‚å¿…é¡»æœ‰idåŸŸï¼ŒåŸŸçš„åç§°å¿…é¡»åœ¨schema.xmlä¸­å®šä¹‰ã€‚ document.addField(\"id\", \"test001\"); document.addField(\"item_title\", \"æµ‹è¯•å•†å“\"); document.addField(\"item_price\", \"199\"); // ç¬¬äº”æ­¥ï¼šæŠŠæ–‡æ¡£æ·»åŠ åˆ°ç´¢å¼•åº“ä¸­ã€‚ solrServer.add(document); // ç¬¬å…­æ­¥ï¼šæäº¤ã€‚ solrServer.commit();} åˆ é™¤æ–‡æ¡£1234567891011121314151617181920212223242526/** * ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrServerå¯¹è±¡ã€‚ * ç¬¬äºŒæ­¥ï¼šè°ƒç”¨SolrServerå¯¹è±¡çš„æ ¹æ®idåˆ é™¤çš„æ–¹æ³•ã€‚ * ç¬¬ä¸‰æ­¥ï¼šæäº¤ã€‚ * * @throws Exception */@Testpublic void deleteDocumentById() throws Exception { // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrServerå¯¹è±¡ã€‚ SolrServer solrServer = new HttpSolrServer(\"http://192.168.184.130:8080/solr\"); // ç¬¬äºŒæ­¥ï¼šè°ƒç”¨SolrServerå¯¹è±¡çš„æ ¹æ®idåˆ é™¤çš„æ–¹æ³•ã€‚ solrServer.deleteById(\"1\"); // ç¬¬ä¸‰æ­¥ï¼šæäº¤ã€‚ solrServer.commit();} /** * æ ¹æ®æŸ¥è¯¢åˆ é™¤ */@Testpublic void deleteDocumentByQuery() throws Exception { SolrServer solrServer = new HttpSolrServer(\"http://192.168.184.130:8080/solr\"); solrServer.deleteByQuery(\"title:change.me\"); solrServer.commit();} æŸ¥è¯¢æ–‡æ¡£1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071/** * ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrServerå¯¹è±¡ * ç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrQueryå¯¹è±¡ã€‚ * ç¬¬ä¸‰æ­¥ï¼šå‘SolrQueryä¸­æ·»åŠ æŸ¥è¯¢æ¡ä»¶ã€è¿‡æ»¤æ¡ä»¶ã€‚ã€‚ã€‚ * ç¬¬å››æ­¥ï¼šæ‰§è¡ŒæŸ¥è¯¢ã€‚å¾—åˆ°ä¸€ä¸ªResponseå¯¹è±¡ã€‚ * ç¬¬äº”æ­¥ï¼šå–æŸ¥è¯¢ç»“æœã€‚ * ç¬¬å…­æ­¥ï¼šéå†ç»“æœå¹¶æ‰“å°ã€‚ * * @throws Exception */@Testpublic void queryDocument() throws Exception { // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrServerå¯¹è±¡ SolrServer solrServer = new HttpSolrServer(\"http://192.168.184.130:8080/solr\"); // ç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrQueryå¯¹è±¡ã€‚ SolrQuery query = new SolrQuery(); // ç¬¬ä¸‰æ­¥ï¼šå‘SolrQueryä¸­æ·»åŠ æŸ¥è¯¢æ¡ä»¶ã€è¿‡æ»¤æ¡ä»¶ã€‚ã€‚ã€‚ query.setQuery(\"*:*\"); // ç¬¬å››æ­¥ï¼šæ‰§è¡ŒæŸ¥è¯¢ã€‚å¾—åˆ°ä¸€ä¸ªResponseå¯¹è±¡ã€‚ QueryResponse response = solrServer.query(query); // ç¬¬äº”æ­¥ï¼šå–æŸ¥è¯¢ç»“æœã€‚ SolrDocumentList solrDocumentList = response.getResults(); System.out.println(\"æŸ¥è¯¢ç»“æœçš„æ€»è®°å½•æ•°ï¼š\" + solrDocumentList.getNumFound()); // ç¬¬å…­æ­¥ï¼šéå†ç»“æœå¹¶æ‰“å°ã€‚ for (SolrDocument solrDocument : solrDocumentList) { System.out.println(solrDocument.get(\"id\")); System.out.println(solrDocument.get(\"item_title\")); System.out.println(solrDocument.get(\"item_price\")); }}/** * é«˜äº®æŸ¥è¯¢ */@Testpublic void queryDocumentWithHighLighting() throws Exception { // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrServerå¯¹è±¡ SolrServer solrServer = new HttpSolrServer(\"http://192.168.184.130:8080/solr\"); // ç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrQueryå¯¹è±¡ã€‚ SolrQuery query = new SolrQuery(); // ç¬¬ä¸‰æ­¥ï¼šå‘SolrQueryä¸­æ·»åŠ æŸ¥è¯¢æ¡ä»¶ã€è¿‡æ»¤æ¡ä»¶ã€‚ã€‚ã€‚ query.setQuery(\"æµ‹è¯•\"); //æŒ‡å®šé»˜è®¤æœç´¢åŸŸ query.set(\"df\", \"item_keywords\"); //å¼€å¯é«˜äº®æ˜¾ç¤º query.setHighlight(true); //é«˜äº®æ˜¾ç¤ºçš„åŸŸ query.addHighlightField(\"item_title\"); query.setHighlightSimplePre(\"&lt;em&gt;\"); query.setHighlightSimplePost(\"&lt;/em&gt;\"); // ç¬¬å››æ­¥ï¼šæ‰§è¡ŒæŸ¥è¯¢ã€‚å¾—åˆ°ä¸€ä¸ªResponseå¯¹è±¡ã€‚ QueryResponse response = solrServer.query(query); // ç¬¬äº”æ­¥ï¼šå–æŸ¥è¯¢ç»“æœã€‚ SolrDocumentList solrDocumentList = response.getResults(); System.out.println(\"æŸ¥è¯¢ç»“æœçš„æ€»è®°å½•æ•°ï¼š\" + solrDocumentList.getNumFound()); // ç¬¬å…­æ­¥ï¼šéå†ç»“æœå¹¶æ‰“å°ã€‚ for (SolrDocument solrDocument : solrDocumentList) { System.out.println(solrDocument.get(\"id\")); //å–é«˜äº®æ˜¾ç¤º Map&lt;String, Map&lt;String, List&lt;String&gt;&gt;&gt; highlighting = response.getHighlighting(); List&lt;String&gt; list = highlighting.get(solrDocument.get(\"id\")).get(\"item_title\"); String itemTitle = null; if (list != null &amp;&amp; list.size() &gt; 0) { itemTitle = list.get(0); } else { itemTitle = (String) solrDocument.get(\"item_title\"); } System.out.println(itemTitle); System.out.println(solrDocument.get(\"item_price\")); }} æ­å»ºæœç´¢æœåŠ¡å·¥ç¨‹ åˆ†å¸ƒå¼é›†ç¾¤ç‰ˆä¸€äº›æ¦‚å¿µ SolrCloudæ˜¯Solræä¾›åŸºäºSolrå’ŒZookeeperçš„åˆ†å¸ƒå¼æœç´¢æ–¹æ¡ˆï¼Œå®ƒçš„ä¸»è¦æ€æƒ³æ˜¯ä½¿ç”¨Zookeeperä½œä¸ºé›†ç¾¤çš„é…ç½®ä¿¡æ¯ä¸­å¿ƒã€‚ Solré›†ç¾¤çš„ç³»ç»Ÿæ¶æ„ éœ€è¦å®ç°çš„solré›†ç¾¤æ¶æ„ Zookeeperä½œä¸ºé›†ç¾¤çš„ç®¡ç†å·¥å…·ã€‚1ã€é›†ç¾¤ç®¡ç†ï¼šå®¹é”™ã€è´Ÿè½½å‡è¡¡ã€‚2ã€é…ç½®æ–‡ä»¶çš„é›†ä¸­ç®¡ç†3ã€é›†ç¾¤çš„å…¥å£ æ­å»ºä¼ªåˆ†å¸ƒå¼ éœ€è¦ä¸‰ä¸ªzookeeperèŠ‚ç‚¹ éœ€è¦å››ä¸ªtomcatèŠ‚ç‚¹ Zookeeperé›†ç¾¤æ­å»ºç¬¬ä¸€æ­¥ï¼šåˆ›å»ºsolré›†ç¾¤çš„æ ¹ç›®å½• /opt/solrCloud/ç¬¬äºŒæ­¥ï¼šè§£å‹ zookeeper.tar.gz å¹¶åœ¨æ ¹ç›®å½•ä¸‹å¤åˆ¶ä¸‰ä»½ 123drwxr-xr-x. 11 1000 1000 4096 7æœˆ 22 20:15 zookeeper01drwxr-xr-x. 11 root root 4096 7æœˆ 22 20:18 zookeeper02drwxr-xr-x. 11 root root 4096 7æœˆ 22 20:18 zookeeper03 ç¬¬ä¸‰æ­¥ï¼šåœ¨æ¯ä¸€ä¸ªzookeeperä¸­åˆ›å»ºdataç›®å½•ï¼Œåœ¨dataä¸­åˆ›å»ºæ–‡ä»¶ myidï¼Œå†…å®¹å°±æ˜¯æ¯ä¸ªå®ä¾‹çš„idï¼Œæ¯”å¦‚ï¼š1ï¼Œ2ï¼Œ3ç¬¬å››æ­¥ï¼šæŠŠæ¯ä¸€ä¸ªzookeeperä¸‹çš„confç›®å½•ä¸‹çš„zoo_sample.cfgæ–‡ä»¶æ”¹åä¸ºzoo.cfgç¬¬äº”æ­¥ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶ dataDir clientPort é›†ç¾¤çš„èŠ‚ç‚¹åˆ—è¡¨ 1.é›†ç¾¤çš„èŠ‚ç‚¹åˆ—è¡¨ï¼Œ1ã€2ã€3ä»£è¡¨èŠ‚ç‚¹çš„id2.ipåçš„ç«¯å£å·æ˜¯zookeeperå†…éƒ¨é€šè®¯çš„ç«¯å£å’ŒæŠ•ç¥¨é€‰ä¸¾çš„ç«¯å£ï¼Œæ¯ä¸ªç«¯å£ä¸èƒ½é‡å¤ã€‚ ç¬¬å…­æ­¥ï¼šå¯åŠ¨æ¯ä¸ªzookeeperå®ä¾‹ 12345678910[root@yuzh solrCloud]# vim zookeeper_start_all.sh cd /opt/solrCloud/zookeeper01/bin./zkServer.sh startcd /opt/solrCloud/zookeeper02/bin./zkServer.sh startcd /opt/solrCloud/zookeeper03/bin./zkServer.sh start æˆæƒã€å¯åŠ¨ã€‚ Solré›†ç¾¤æ­å»ºç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå››ä¸ªtomcatå®ä¾‹ã€‚æ¯ä¸ªtomcatè¿è¡Œåœ¨ä¸åŒçš„ç«¯å£ã€‚8180ã€8280ã€8380ã€8480ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²solrçš„waråŒ…ã€‚æŠŠå•æœºç‰ˆçš„solrå·¥ç¨‹å¤åˆ¶åˆ°é›†ç¾¤ä¸­æ¯ä¸ªçš„tomcatä¸­ã€‚ç¬¬ä¸‰æ­¥ï¼šä¸ºæ¯ä¸ªsolrå®ä¾‹åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„solrhomeã€‚ä½¿ç”¨å•æœºç‰ˆçš„solrhomeå¤åˆ¶å››ä»½ã€‚ 12345678drwxr-xr-x. 4 root root 4096 7æœˆ 23 14:40 solrhome01drwxr-xr-x. 4 root root 4096 7æœˆ 23 14:40 solrhome02drwxr-xr-x. 4 root root 4096 7æœˆ 23 14:40 solrhome03drwxr-xr-x. 4 root root 4096 7æœˆ 23 14:40 solrhome04drwxr-xr-x. 9 root root 4096 7æœˆ 22 20:23 tomcat01drwxr-xr-x. 9 root root 4096 7æœˆ 22 20:24 tomcat02drwxr-xr-x. 9 root root 4096 7æœˆ 22 20:24 tomcat03drwxr-xr-x. 9 root root 4096 7æœˆ 22 20:24 tomcat04 ç¬¬å››æ­¥ï¼šéœ€è¦ä¿®æ”¹æ¯ä¸ªtomcatå®ä¾‹ä¸­çš„solrçš„web.xmlæ–‡ä»¶ã€‚æŠŠsolrhomeå…³è”èµ·æ¥ã€‚ 12345&lt;env-entry&gt; &lt;env-entry-name&gt;solr/home&lt;/env-entry-name&gt; &lt;env-entry-value&gt;/opt/solrCloud/solrhome01&lt;/env-entry-value&gt; &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;&lt;/env-entry&gt; ç¬¬äº”æ­¥ï¼šé…ç½®SolrCloudç›¸å…³çš„é…ç½®ã€‚æ¯ä¸ªsolrhomeä¸‹éƒ½æœ‰ä¸€ä¸ªsolr.xmlï¼ŒæŠŠå…¶ä¸­çš„ipåŠç«¯å£å·é…ç½®å¥½ã€‚ 123456789&lt;solrcloud&gt; &lt;!-- æœ¬æœºIP --&gt; &lt;str name=&quot;host&quot;&gt;192.168.184.130&lt;/str&gt; &lt;!-- æ¯ä¸ªsolrå¯¹åº”çš„solrhomeæ‰€å±çš„tomcatç«¯å£å· --&gt; &lt;int name=&quot;hostPort&quot;&gt;8180&lt;/int&gt; &lt;str name=&quot;hostContext&quot;&gt;${hostContext:solr}&lt;/str&gt; &lt;int name=&quot;zkClientTimeout&quot;&gt;${zkClientTimeout:30000}&lt;/int&gt; &lt;bool name=&quot;genericCoreNodeNames&quot;&gt;${genericCoreNodeNames:true}&lt;/bool&gt;&lt;/solrcloud&gt; ç¬¬å…­æ­¥ï¼šè®©zookeeperç»Ÿä¸€ç®¡ç†é…ç½®æ–‡ä»¶ã€‚ éœ€è¦æŠŠ`solrhome/collection1/conf`ç›®å½•ä¸Šä¼ åˆ°zookeeperã€‚ä¸Šä¼ ä»»æ„solrhomeä¸­çš„é…ç½®æ–‡ä»¶å³å¯ã€‚ï¼ˆéœ€è¦ä¿è¯zookeeperé›†ç¾¤æ˜¯å¯åŠ¨çš„çŠ¶æ€ï¼‰ ä½¿ç”¨å·¥å…·ä¸Šä¼ é…ç½®æ–‡ä»¶ï¼šæ‰§è¡Œ/opt/solr-4.10.3/example/scripts/cloud-scripts/zkcli.shæ³¨æ„ä¸æ˜¯zookeeper/binä¸­çš„zkCli.sh ./zkcli.sh -zkhost 192.168.184.130:2181,192.168.184.130:2182,192.168.184.130:2183 -cmd upconfig -confdir /opt/solrCloud/solrhome01/collection1/conf -confname myconf ç¬¬ä¸ƒæ­¥ï¼šä¿®æ”¹æ¯ä¸€ä¸ªtomcat/binç›®å½•ä¸‹çš„catalina.sh æ–‡ä»¶ï¼Œå…³è”solrå’Œzookeeperã€‚æŠŠæ­¤é…ç½®æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼š 1JAVA_OPTS=&quot;-DzkHost=192.168.184.130:2181,192.168.184.130:2182,192.168.184.130:2183&quot; ç¬¬å…«æ­¥ï¼šå¯åŠ¨æ¯ä¸ªtomcatå®ä¾‹ã€‚è¦ä¿è¯zookeeperé›†ç¾¤æ˜¯å¯åŠ¨çŠ¶æ€ã€‚ç¬¬ä¹æ­¥ï¼šè®¿é—®é›†ç¾¤ http://192.168.184.130:8180/solr åˆ›å»ºæ–°çš„Collectionè¿›è¡Œåˆ†ç‰‡å¤„ç†:http://192.168.184.130:8180/solr/admin/collections?action=CREATE&amp;name=collection2&amp;numShards=2&amp;replicationFactor=2åˆ é™¤ä¸ç”¨çš„Collection:http://192.168.184.130:8180/solr/admin/collections?action=DELETE&amp;name=collection1 æ³¨æ„ï¼šå…³é—­é˜²ç«å¢™å§ï¼Œç«¯å£å¤ªå¤šäº†ã€‚æ¯æ¬¡å¼€æœºä¹‹åé˜²ç«å¢™ä¼šè‡ªåŠ¨é‡å¯ã€‚ ä½¿ç”¨solrJç®¡ç†é›†ç¾¤123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960package xyz.taotao.search.test;import org.apache.solr.client.solrj.SolrQuery;import org.apache.solr.client.solrj.SolrServerException;import org.apache.solr.client.solrj.impl.CloudSolrServer;import org.apache.solr.client.solrj.response.QueryResponse;import org.apache.solr.common.SolrDocument;import org.apache.solr.common.SolrDocumentList;import org.apache.solr.common.SolrInputDocument;import org.junit.Test;/** * Created with IntelliJ IDEA. * Author: yu_zh * DateTime: 2018/07/23 14:46 * Solré›†ç¾¤ç‰ˆå®¢æˆ·ç«¯è¿æ¥æµ‹è¯• */public class SolrCloudTest { @Test public void add() throws Exception { //1.åˆ›å»ºé›†ç¾¤ç‰ˆSolrï¼Œä¼ å…¥zookeeperé›†ç¾¤åœ°å€ã€‚ CloudSolrServer solrServer = new CloudSolrServer(\"192.168.184.130:2181,192.168.184.130:2182,192.168.184.130:2183\"); //2.è®¾ç½®é»˜è®¤é›†åˆå±æ€§ solrServer.setDefaultCollection(\"collection2\"); //3.åˆ›å»ºæ–‡æ¡£å¯¹è±¡ SolrInputDocument document = new SolrInputDocument(); //4.å‘æ–‡æ¡£å¯¹è±¡æ·»åŠ ä¸šåŠ¡åŸŸï¼ˆè¿™äº›åŸŸè¦åœ¨é…ç½®æ–‡ä»¶ schema.xml ä¸­å­˜åœ¨ï¼‰ document.addField(\"id\", \"test01\"); document.addField(\"item_title\", \"æµ‹è¯•å•†å“\"); document.addField(\"item_price\", \"100\"); //5.æŠŠæ–‡æ¡£å¯¹è±¡å†™å…¥ç´¢å¼•åº“ solrServer.add(document); //6.æäº¤æ“ä½œ solrServer.commit(); } @Test public void query() throws Exception { //åˆ›å»ºsolrServerå¯¹è±¡å®ç°ç±»CloudSolrServerå¯¹è±¡ CloudSolrServer solrServer = new CloudSolrServer(\"192.168.184.130:2181,192.168.184.130:2182,192.168.184.130:2183\"); //è®¾ç½®æŸ¥è¯¢çš„é»˜è®¤é›†åˆ solrServer.setDefaultCollection(\"collection2\"); //åˆ›å»ºSolrQueryæŸ¥è¯¢ SolrQuery solrQuery = new SolrQuery(); //æ·»åŠ æŸ¥è¯¢æ¡ä»¶ solrQuery.setQuery(\"*:*\"); //æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¾—åˆ°ç»“æœé›†å¯¹è±¡ QueryResponse queryResponse = solrServer.query(solrQuery); //æ“ä½œç»“æœ SolrDocumentList resultList = queryResponse.getResults(); System.out.println(\"æ€»è®°å½•æ•°ï¼š\" + resultList.getNumFound()); for (SolrDocument solrDocument : resultList) { System.out.println(solrDocument.get(\"id\")); System.out.println(solrDocument.get(\"item_title\")); System.out.println(solrDocument.get(\"item_price\")); } }} æŠŠæœç´¢ä¸šåŠ¡åŠŸèƒ½åˆ‡æ¢åˆ°é›†ç¾¤ç‰ˆ 12345678910111213141516171819202122232425&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:context=\"http://www.springframework.org/schema/context\" xmlns:p=\"http://www.springframework.org/schema/p\" xmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:dubbo=\"http://code.alibabatech.com/schema/dubbo\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.2.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.2.xsd\"&gt; &lt;!-- å•æœºç‰ˆ --&gt; &lt;!-- &lt;bean id=\"httpSolrServer\" class=\"org.apache.solr.client.solrj.impl.HttpSolrServer\"&gt; &lt;constructor-arg name=\"baseURL\" value=\"http://192.168.184.130:8080/solr\"/&gt; &lt;/bean&gt;--&gt; &lt;!-- é›†ç¾¤ç‰ˆ --&gt; &lt;bean id=\"cloudSolrServer\" class=\"org.apache.solr.client.solrj.impl.CloudSolrServer\"&gt; &lt;constructor-arg name=\"zkHost\" value=\"192.168.184.130:2181,192.168.184.130:2182,192.168.184.130:2183\"&gt;&lt;/constructor-arg&gt; &lt;property name=\"defaultCollection\" value=\"collection2\"&gt;&lt;/property&gt; &lt;/bean&gt;&lt;/beans&gt; OVER~~ğŸ˜­","link":"/2018/07/22/åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆä¸‰ï¼‰/"},{"title":"åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆå››ï¼‰","text":"12.Javaæ¶ˆæ¯é˜Ÿåˆ—å­¦ä¹ ä¸ä½¿ç”¨ActiveMQå®˜ç½‘ï¼šhttp://activemq.apache.org/ å®‰è£… è§£å‹ cdåˆ°binç›®å½• ./activemq start è®¿é—®ï¼Œé»˜è®¤ç«¯å£ï¼š8161 é»˜è®¤ç”¨æˆ·åä¸å¯†ç ï¼šadmin ä½¿ç”¨ä¸¤ç§æ¨¡å¼ ç‚¹å¯¹ç‚¹ å‘å¸ƒ/è®¢é˜… éœ€è¦åŒ…ï¼š 1234567891011121314151617&lt;!-- æ¶ˆæ¯é˜Ÿåˆ—æ•´åˆåŒ… --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jms&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt;&lt;/dependency&gt;&lt;!-- activemq --&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt; &lt;artifactId&gt;activemq-all&lt;/artifactId&gt; &lt;version&gt;${activemq.version}&lt;/version&gt;&lt;/dependency&gt; ç‚¹å¯¹ç‚¹æ¨¡å¼ç›®çš„åœ°å®ç°ç±» â€”â€” Queueå‘é€æ¶ˆæ¯ 12345678910111213141516171819202122232425262728293031323334353637383940414243package xyz.yuzh.activemq.queue;import org.apache.activemq.ActiveMQConnectionFactory;import javax.jms.*;/** * Created with IntelliJ IDEA. * Author: yu_zh * DateTime: 2018/07/24 12:31 * æ¶ˆæ¯å‘é€ç«¯ * ç‚¹å¯¹ç‚¹æ¨¡å¼ */public class QueueProducer { public static void main(String[] args) throws Exception{ // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºConnectionFactoryå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šæœåŠ¡ç«¯ipåŠç«¯å£å·ã€‚ //brokerURLæœåŠ¡å™¨çš„ipåŠç«¯å£å· ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(\"tcp://192.168.184.130:61616\"); // ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ConnectionFactoryå¯¹è±¡åˆ›å»ºä¸€ä¸ªConnectionå¯¹è±¡ã€‚ Connection connection = connectionFactory.createConnection(); // ç¬¬ä¸‰æ­¥ï¼šå¼€å¯è¿æ¥ï¼Œè°ƒç”¨Connectionå¯¹è±¡çš„startæ–¹æ³•ã€‚ connection.start(); // ç¬¬å››æ­¥ï¼šä½¿ç”¨Connectionå¯¹è±¡åˆ›å»ºä¸€ä¸ªSessionå¯¹è±¡ã€‚ //ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ˜¯å¦å¼€å¯äº‹åŠ¡ã€‚trueï¼šå¼€å¯äº‹åŠ¡ï¼Œç¬¬äºŒä¸ªå‚æ•°å¿½ç•¥ã€‚ //ç¬¬äºŒä¸ªå‚æ•°ï¼šå½“ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºfalseæ—¶ï¼Œæ‰æœ‰æ„ä¹‰ã€‚æ¶ˆæ¯çš„åº”ç­”æ¨¡å¼ã€‚1ã€è‡ªåŠ¨åº”ç­”2ã€æ‰‹åŠ¨åº”ç­”ã€‚ä¸€èˆ¬æ˜¯è‡ªåŠ¨åº”ç­”ã€‚ Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE); // ç¬¬äº”æ­¥ï¼šä½¿ç”¨Sessionå¯¹è±¡åˆ›å»ºä¸€ä¸ªDestinationå¯¹è±¡ï¼ˆtopicã€queueï¼‰ï¼Œæ­¤å¤„åˆ›å»ºä¸€ä¸ªQueueå¯¹è±¡ã€‚ //å‚æ•°ï¼šé˜Ÿåˆ—çš„åç§°ã€‚ Queue queue = session.createQueue(\"queue-test\"); // ç¬¬å…­æ­¥ï¼šä½¿ç”¨Sessionå¯¹è±¡åˆ›å»ºä¸€ä¸ªProducerå¯¹è±¡ã€‚ MessageProducer producer = session.createProducer(queue); // ç¬¬ä¸ƒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªMessageå¯¹è±¡ï¼Œåˆ›å»ºä¸€ä¸ªTextMessageå¯¹è±¡ã€‚ /*TextMessage message = new ActiveMQTextMessage(); message.setText(\"hello activeMq,this is my first test.\");*/ TextMessage textMessage = session.createTextMessage(\"hello activeMq,this is my first test.\"); // ç¬¬å…«æ­¥ï¼šä½¿ç”¨Producerå¯¹è±¡å‘é€æ¶ˆæ¯ã€‚ producer.send(textMessage); // ç¬¬ä¹æ­¥ï¼šå…³é—­èµ„æºã€‚ producer.close(); session.close(); connection.close(); }} æ¥æ”¶æ¶ˆæ¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566package xyz.yuzh.activemq.queue;import org.apache.activemq.ActiveMQConnectionFactory;import javax.jms.*;/** * Created with IntelliJ IDEA. * Author: yu_zh * DateTime: 2018/07/24 12:31 * æ¶ˆæ¯æ¥æ”¶ç«¯ */public class QueueConsumer { public static void main(String[] args) throws Exception { // 1.åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚ ï¼ˆActivemqçš„è¿æ¥å·¥å‚ï¼‰å‚æ•°ï¼šæŒ‡å®šè¿æ¥çš„activemqçš„æœåŠ¡ ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(\"tcp://192.168.184.130:61616\"); // 2.è·å–è¿æ¥ Connection connection = connectionFactory.createConnection(); // 3.å¼€å¯è¿æ¥ connection.start(); // 4.æ ¹æ®è¿æ¥å¯¹è±¡åˆ›å»ºsession // ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¡¨ç¤ºæ˜¯å¦ä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆJTAï¼‰ // ç¬¬äºŒä¸ªå‚æ•°ï¼šå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸ºfalse,ç¬¬äºŒä¸ªå‚æ•°æ‰æœ‰æ„ä¹‰ï¼›è¡¨ç¤ºä½¿ç”¨çš„åº”ç­”æ¨¡å¼ ï¼šè‡ªåŠ¨åº”ç­”ï¼Œæ‰‹åŠ¨åº”ç­”.è¿™é‡Œé€‰æ‹©è‡ªåŠ¨åº”ç­”ã€‚ Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE); // 5.æ ¹æ®sessionåˆ›å»ºDestination(ç›®çš„åœ°ï¼Œqueue topic,è¿™é‡Œä½¿ç”¨çš„æ˜¯queue) Queue queue = session.createQueue(\"queue-test\"); // 6.åˆ›å»ºæ¶ˆè´¹è€… MessageConsumer consumer = session.createConsumer(queue); //7.æ¥æ”¶æ¶ˆæ¯ //ç¬¬ä¸€ç§/* while(true){ //æ¥æ”¶æ¶ˆæ¯ ï¼ˆå‚æ•°çš„å€¼è¡¨ç¤ºçš„æ˜¯è¶…è¿‡ä¸€å®šæ—¶é—´ ä»¥æ¯«ç§’ä¸ºå•ä½å°±æ–­å¼€è¿æ¥ï¼‰ Message message = consumer.receive(10000); //å¦‚æœmessageä¸ºç©ºï¼Œæ²¡æœ‰æ¥æ”¶åˆ°æ¶ˆæ¯äº†å°±è·³å‡º if(message==null){ break; } if(message instanceof TextMessage){ TextMessage messaget = (TextMessage)message; System.out.println(\"&gt;&gt;&gt;è·å–çš„æ¶ˆæ¯å†…å®¹ï¼š\"+messaget.getText());//è·å–æ¶ˆæ¯å†…å®¹ } }*/ //ç¬¬äºŒç§ï¼š //è®¾ç½®ç›‘å¬å™¨,å…¶å®å¼€å¯äº†ä¸€ä¸ªæ–°çš„çº¿ç¨‹ã€‚ consumer.setMessageListener((m) -&gt; { //æ¥æ”¶æ¶ˆæ¯ï¼Œå¦‚æœæœ‰æ¶ˆæ¯æ‰è¿›å…¥ï¼Œå¦‚æœæ²¡æœ‰æ¶ˆæ¯å°±ä¸ä¼šè¿›å…¥æ­¤æ–¹æ³• if (m instanceof TextMessage) { TextMessage message = (TextMessage) m; try { //è·å–æ¶ˆæ¯å†…å®¹ System.out.println(\"&gt;&gt;&gt;è·å–çš„æ¶ˆæ¯å†…å®¹ï¼š\" + message.getText()); } catch (JMSException e) { e.printStackTrace(); } } }); Thread.sleep(10000);//ç¡çœ 10ç§’é’Ÿã€‚ // 9.å…³é—­èµ„æº consumer.close(); session.close(); connection.close(); }} å‘å¸ƒ/è®¢é˜…æ¨¡å¼ç›®çš„åœ°å®ç°ç±» â€”â€” Topic å‘é€æ¶ˆæ¯ 12345678910111213141516171819202122232425262728293031323334353637383940package xyz.yuzh.activemq.topic;import org.apache.activemq.ActiveMQConnectionFactory;import org.apache.activemq.command.ActiveMQTextMessage;import javax.jms.*;/** * Created with IntelliJ IDEA. * Author: yu_zh * DateTime: 2018/07/24 12:50 * å‘å¸ƒè®¢é˜…æ¨¡å¼ */public class TopicProducer { public static void main(String[] args) throws Exception { // 1.åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚ ï¼ˆActivemqçš„è¿æ¥å·¥å‚ï¼‰å‚æ•°ï¼šæŒ‡å®šè¿æ¥çš„activemqçš„æœåŠ¡ ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(\"tcp://192.168.184.130:61616\"); // 2.è·å–è¿æ¥ Connection connection = connectionFactory.createConnection(); // 3.å¼€å¯è¿æ¥ connection.start(); // 4.æ ¹æ®è¿æ¥å¯¹è±¡åˆ›å»ºsession // ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¡¨ç¤ºæ˜¯å¦ä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆJTAï¼‰ // ç¬¬äºŒä¸ªå‚æ•°ï¼šå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸ºfalse,ç¬¬äºŒä¸ªå‚æ•°æ‰æœ‰æ„ä¹‰ï¼›è¡¨ç¤ºä½¿ç”¨çš„åº”ç­”æ¨¡å¼ ï¼šè‡ªåŠ¨åº”ç­”ï¼Œæ‰‹åŠ¨åº”ç­”.è¿™é‡Œé€‰æ‹©è‡ªåŠ¨åº”ç­”ã€‚ Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE); // 5.æ ¹æ®sessionåˆ›å»ºDestination(ç›®çš„åœ°ï¼Œqueue topic,è¿™é‡Œä½¿ç”¨çš„æ˜¯topic) Topic topic = session.createTopic(\"topic-test\"); // 6.åˆ›å»ºç”Ÿäº§è€… MessageProducer producer = session.createProducer(topic); // 7.æ„å»ºæ¶ˆæ¯å¯¹è±¡ï¼Œï¼ˆæ„å»ºå‘é€æ¶ˆæ¯çš„å†…å®¹ï¼‰ å­—ç¬¦ä¸²ç±»å‹çš„æ¶ˆæ¯æ ¼å¼ï¼ˆTEXTMessageï¼‰ TextMessage textMessage = new ActiveMQTextMessage(); textMessage.setText(\"å‘é€æ¶ˆæ¯123\");// æ¶ˆæ¯çš„å†…å®¹ // 8.å‘é€æ¶ˆæ¯ producer.send(textMessage); // 9.å…³é—­èµ„æº producer.close(); session.close(); connection.close(); }} æ¥æ”¶æ¶ˆæ¯ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162package xyz.yuzh.activemq.topic;import org.apache.activemq.ActiveMQConnectionFactory;import javax.jms.*;/** * Created with IntelliJ IDEA. * Author: yu_zh * DateTime: 2018/07/24 12:50 */public class TopicConsumer { public static void main(String[] args) throws Exception { // 1.åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚ ï¼ˆActivemqçš„è¿æ¥å·¥å‚ï¼‰å‚æ•°ï¼šæŒ‡å®šè¿æ¥çš„activemqçš„æœåŠ¡ ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(\"tcp://192.168.184.130:61616\"); // 2.è·å–è¿æ¥ Connection connection = connectionFactory.createConnection(); // 3.å¼€å¯è¿æ¥ connection.start(); // 4.æ ¹æ®è¿æ¥å¯¹è±¡åˆ›å»ºsession // ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¡¨ç¤ºæ˜¯å¦ä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆJTAï¼‰ // ç¬¬äºŒä¸ªå‚æ•°ï¼šå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸ºfalse,ç¬¬äºŒä¸ªå‚æ•°æ‰æœ‰æ„ä¹‰ï¼›è¡¨ç¤ºä½¿ç”¨çš„åº”ç­”æ¨¡å¼ ï¼šè‡ªåŠ¨åº”ç­”ï¼Œæ‰‹åŠ¨åº”ç­”.è¿™é‡Œé€‰æ‹©è‡ªåŠ¨åº”ç­”ã€‚ Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE); // 5.æ ¹æ®sessionåˆ›å»ºDestination(ç›®çš„åœ°ï¼Œqueue topic,è¿™é‡Œä½¿ç”¨çš„æ˜¯queue) Topic topic = session.createTopic(\"topic-test\"); // 6.åˆ›å»ºæ¶ˆè´¹è€… MessageConsumer consumer = session.createConsumer(topic); // 7.æ¥æ”¶æ¶ˆæ¯ while (true) { //æ¥æ”¶æ¶ˆæ¯ ï¼ˆå‚æ•°çš„å€¼è¡¨ç¤ºçš„æ˜¯è¶…è¿‡ä¸€å®šæ—¶é—´ ä»¥æ¯«ç§’ä¸ºå•ä½å°±æ–­å¼€è¿æ¥ï¼‰ Message message = consumer.receive(100000); //å¦‚æœmessageä¸ºç©ºï¼Œæ²¡æœ‰æ¥æ”¶åˆ°æ¶ˆæ¯äº†å°±è·³å‡º if (message == null) { break; } if (message instanceof TextMessage) { TextMessage messaget = (TextMessage) message; System.out.println(\"&gt;&gt;&gt;è·å–çš„æ¶ˆæ¯å†…å®¹ï¼š\" + messaget.getText());//è·å–æ¶ˆæ¯å†…å®¹ } } // ç¬¬äºŒç§ï¼š // è®¾ç½®ç›‘å¬å™¨,å…¶å®å¼€å¯äº†ä¸€ä¸ªæ–°çš„çº¿ç¨‹ã€‚ /* consumer.setMessageListener((m) -&gt; { // æ¥æ”¶æ¶ˆæ¯ï¼Œå¦‚æœæœ‰æ¶ˆæ¯æ‰è¿›å…¥ï¼Œå¦‚æœæ²¡æœ‰æ¶ˆæ¯å°±ä¸ä¼šè¿›å…¥æ­¤æ–¹æ³• if (m instanceof TextMessage) { TextMessage messaget = (TextMessage) m; try { // è·å–æ¶ˆæ¯å†…å®¹ System.out.println(\"&gt;&gt;&gt;è·å–çš„æ¶ˆæ¯å†…å®¹ï¼š\" + messaget.getText()); } catch (JMSException e) { e.printStackTrace(); } } }); Thread.sleep(10000);// ç¡çœ 10ç§’é’Ÿã€‚*/ // 9.å…³é—­èµ„æº consumer.close(); session.close(); connection.close(); }} ä¸Springæ•´åˆè¿™é‡Œåªåšæµ‹è¯•ï¼Œå‘é€ä¸æ¥æ”¶å‡åœ¨åŒä¸€ç³»ç»Ÿå¹¶åœ¨åŒä¸€é…ç½®æ–‡ä»¶ mvcé…ç½® 1234567891011121314151617181920212223242526272829303132333435363738&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:context=\"http://www.springframework.org/schema/context\" xmlns:p=\"http://www.springframework.org/schema/p\" xmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.2.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.2.xsd\"&gt; &lt;!-- ActiveMQçš„è¿æ¥å·¥å‚ --&gt; &lt;bean id=\"targetConnection\" class=\"org.apache.activemq.ActiveMQConnectionFactory\"&gt; &lt;property name=\"brokerURL\" value=\"tcp://192.168.184.130:61616\"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- Springé€šç”¨çš„connectionfacotry æŒ‡å®šçœŸæ­£ä½¿ç”¨çš„è¿æ¥å·¥å‚ --&gt; &lt;bean id=\"connectionFactory\" class=\"org.springframework.jms.connection.SingleConnectionFactory\"&gt; &lt;property name=\"targetConnectionFactory\" ref=\"targetConnection\"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- æ¥æ”¶å’Œå‘é€æ¶ˆæ¯æ—¶ä½¿ç”¨çš„æ¨¡æ¿ç±» --&gt; &lt;bean class=\"org.springframework.jms.core.JmsTemplate\"&gt; &lt;property name=\"connectionFactory\" ref=\"connectionFactory\"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- ç›®çš„åœ°å®ç°ç±»ï¼šQueueã€Topic --&gt; &lt;bean id=\"queueDestination\" class=\"org.apache.activemq.command.ActiveMQQueue\"&gt; &lt;constructor-arg name=\"name\" value=\"item-change-queue\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt; &lt;!-- &lt;bean id=\"topicDestination\" class=\"org.apache.activemq.command.ActiveMQTopic\"&gt; &lt;constructor-arg name=\"name\" value=\"item-change-topic\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt; --&gt; &lt;!-- é…ç½®æ¶ˆæ¯æ¥æ”¶ç›‘å¬å™¨ --&gt; &lt;bean id=\"myMessageListener\" class=\"xyz.yuzh.activemq.spring.SpringActiveMqReciveListener\"&gt;&lt;/bean&gt; &lt;bean class=\"org.springframework.jms.listener.DefaultMessageListenerContainer\"&gt; &lt;property name=\"connectionFactory\" ref=\"connectionFactory\"&gt;&lt;/property&gt; &lt;property name=\"destination\" ref=\"queueDestination\"&gt;&lt;/property&gt; &lt;property name=\"messageListener\" ref=\"myMessageListener\"&gt;&lt;/property&gt; &lt;/bean&gt;&lt;/beans&gt; å‘é€æ¶ˆæ¯ 123456789101112131415161718192021222324252627282930313233343536373839package xyz.yuzh.activemq.spring;import org.apache.xbean.spring.context.ClassPathXmlApplicationContext;import org.junit.Test;import org.springframework.context.ApplicationContext;import org.springframework.jms.core.JmsTemplate;import org.springframework.jms.core.MessageCreator;import javax.jms.Destination;import javax.jms.JMSException;import javax.jms.Message;import javax.jms.Session;/** * Created with IntelliJ IDEA. * Author: yu_zh * DateTime: 2018/07/24 17:21 * æ¶ˆæ¯å‘é€ç«¯ */public class SpringActiveMqSend { public static void main(String[] args) throws Exception{ //åˆå§‹åŒ–å®¹å™¨ ApplicationContext context = new ClassPathXmlApplicationContext(\"classpath:spring-activemq.xml\"); //è·å¾—JMSæ¨¡æ¿å¯¹è±¡ JmsTemplate jmsTemplate = context.getBean(JmsTemplate.class); //è·å¾—æ¶ˆæ¯é˜Ÿåˆ—ç›®çš„åœ°ï¼ˆæ³¨æ„æ˜¯jmsæ¥å£çš„åŒ…ï¼Œä¸æ˜¯activemqçš„åŒ…ã€‚ï¼‰ Destination queueDestination = context.getBean(Destination.class); //å‘é€æ¶ˆæ¯ jmsTemplate.send(queueDestination, (s) -&gt; { StringBuilder message = new StringBuilder(); for (int i = 1 ; i &lt;= 100;i++){ message.append(\"æµ‹è¯•æ¶ˆæ¯\"+i+\"\\n\"); } return s.createTextMessage(message.toString()); }); Thread.sleep(100000); }} æ¥æ”¶æ¶ˆæ¯ 123456789101112131415161718192021222324252627282930package xyz.yuzh.activemq.spring;import javax.jms.JMSException;import javax.jms.Message;import javax.jms.MessageListener;import javax.jms.TextMessage;/** * Created with IntelliJ IDEA. * Author: yu_zh * DateTime: 2018/07/24 18:06 * æ¶ˆæ¯æ¥æ”¶ç›‘å¬å™¨ */public class SpringActiveMqReciveListener implements MessageListener { @Override public void onMessage(Message message) { if(message instanceof TextMessage){ TextMessage textMessage = (TextMessage)message; String text; try { text = textMessage.getText(); System.out.println(\"SpringActiveMqReciveListener-&gt; \"+text); } catch (JMSException e) { e.printStackTrace(); } } }} å…·ä½“ä¸šåŠ¡åœºæ™¯ä¸‹ä½¿ç”¨manager-serviceå·¥ç¨‹æ›´æ–°ä¸€ä¸ªå•†å“ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰ï¼Œsearch-serviceå·¥ç¨‹è¦åœ¨ç´¢å¼•åº“ä¸­æ›´æ–°è¯¥å•†å“ã€‚ manager-serviceç³»ç»Ÿï¼ˆå‘é€æ¶ˆæ¯ç«¯ï¼‰spring-activemq.xml 123456789101112131415161718192021222324252627282930&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:context=\"http://www.springframework.org/schema/context\" xmlns:p=\"http://www.springframework.org/schema/p\" xmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:dubbo=\"http://code.alibabatech.com/schema/dubbo\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.2.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.2.xsd\"&gt; &lt;!-- ç³»ç»Ÿé—´é€šä¿¡ â€”â€” æ¶ˆæ¯å‘é€æ–¹ --&gt; &lt;bean id=\"targetConnection\" class=\"org.apache.activemq.ActiveMQConnectionFactory\"&gt; &lt;property name=\"brokerURL\" value=\"tcp://192.168.184.130:61616\"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- é€šç”¨çš„connectionfacotry æŒ‡å®šçœŸæ­£ä½¿ç”¨çš„è¿æ¥å·¥å‚ --&gt; &lt;bean id=\"connectionFactory\" class=\"org.springframework.jms.connection.SingleConnectionFactory\"&gt; &lt;property name=\"targetConnectionFactory\" ref=\"targetConnection\"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- æ¥æ”¶å’Œå‘é€æ¶ˆæ¯æ—¶ä½¿ç”¨çš„ç±» --&gt; &lt;bean id=\"jmsTemplate\" class=\"org.springframework.jms.core.JmsTemplate\"&gt; &lt;property name=\"connectionFactory\" ref=\"connectionFactory\"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- è®¢é˜…é€šçŸ¥æ¨¡å¼ --&gt; &lt;bean id=\"topicDestination\" class=\"org.apache.activemq.command.ActiveMQTopic\"&gt; &lt;constructor-arg name=\"name\" value=\"item-change-topic\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt;&lt;/beans&gt; Service 1234567891011121314151617181920212223@Servicepublic class ItemServiceImpl implements ItemService { //...... @Resource private JmsTemplate jmsTemplate; @Resource private Destination topicDestination; //...... @Override public Object addItem() { //æ‰§è¡Œå•†å“æ·»åŠ é€»è¾‘ //TODO... //å‘é€ä¸€ä¸ªæ¶ˆæ¯é€šçŸ¥æœç´¢ç³»ç»Ÿæ›´æ–°è¯¥å•†å“åˆ°ç´¢å¼•åº“ jmsTemplate.send(topicDestination, (s) -&gt;{ System.out.println(\"å‘é€æ–¹-&gt; æ·»åŠ æ“ä½œï¼Œå•†å“ç¼–å·æ˜¯123\"); return s.createTextMessage(\"addItem:123\"); }); return null; }} search-serviceç³»ç»Ÿï¼ˆæ¥æ”¶æ¶ˆæ¯ç«¯ï¼‰spring-activemq.xml 1234567891011121314151617181920212223242526272829303132333435363738&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:context=\"http://www.springframework.org/schema/context\" xmlns:p=\"http://www.springframework.org/schema/p\" xmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:dubbo=\"http://code.alibabatech.com/schema/dubbo\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.2.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.2.xsd\"&gt; &lt;!-- ç³»ç»Ÿé—´é€šä¿¡ â€”â€” æ¶ˆæ¯æ¥æ”¶æ–¹ --&gt; &lt;bean id=\"targetConnection\" class=\"org.apache.activemq.ActiveMQConnectionFactory\"&gt; &lt;property name=\"brokerURL\" value=\"tcp://192.168.184.130:61616\"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- é€šç”¨çš„connectionfacotry æŒ‡å®šçœŸæ­£ä½¿ç”¨çš„è¿æ¥å·¥å‚ --&gt; &lt;bean id=\"connectionFactory\" class=\"org.springframework.jms.connection.SingleConnectionFactory\"&gt; &lt;property name=\"targetConnectionFactory\" ref=\"targetConnection\"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- æ¥æ”¶å’Œå‘é€æ¶ˆæ¯æ—¶ä½¿ç”¨çš„ç±» --&gt; &lt;bean id=\"jmsTemplate\" class=\"org.springframework.jms.core.JmsTemplate\"&gt; &lt;property name=\"connectionFactory\" ref=\"connectionFactory\"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- è®¢é˜…é€šçŸ¥æ¨¡å¼ --&gt; &lt;bean id=\"topicDestination\" class=\"org.apache.activemq.command.ActiveMQTopic\"&gt; &lt;!-- nameä¸å’Œå‘é€ç«¯ä¿æŒä¸€è‡´æ¥æ”¶ä¸åˆ°æ¶ˆæ¯ï¼ --&gt; &lt;constructor-arg name=\"name\" value=\"item-change-topic\"&gt;&lt;/constructor-arg&gt; &lt;/bean&gt; &lt;!-- æ¥æ”¶æ¶ˆæ¯çš„ç›‘å¬å™¨ --&gt; &lt;bean class=\"org.springframework.jms.listener.DefaultMessageListenerContainer\"&gt; &lt;property name=\"connectionFactory\" ref=\"connectionFactory\"&gt;&lt;/property&gt; &lt;property name=\"destination\" ref=\"topicDestination\"&gt;&lt;/property&gt; &lt;property name=\"messageListener\" ref=\"itemChangeListener\"&gt;&lt;/property&gt; &lt;/bean&gt;&lt;/beans&gt; Service 12345678910111213141516171819202122232425262728293031323334353637383940414243package xyz.taotao.search.activemq.recive;import org.apache.solr.client.solrj.SolrServer;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Component;import javax.jms.JMSException;import javax.jms.Message;import javax.jms.MessageListener;import javax.jms.TextMessage;/** * Created with IntelliJ IDEA. * Author: yu_zh * DateTime: 2018/07/24 23:22 * å•†å“æ”¹å˜åé€šçŸ¥è¯¥æ–¹æ³•æ›´æ–°ç´¢å¼•åº“ */@Componentpublic class ItemChangeListener implements MessageListener { @Autowired private SolrServer solrserver; @Override public void onMessage(Message message) { if (message instanceof TextMessage) { TextMessage textMessage = (TextMessage) message; String text = \"\"; try { text = textMessage.getText(); if (text.contains(\"addItem\")) { String itemId = text.substring(text.lastIndexOf(\":\")+1); //é€šçŸ¥ç´¢å¼•åº“æœåŠ¡æä¾›è€…æ›´æ–°å•†å“ //TODO... System.out.println(\"æ¥æ”¶æ–¹-&gt; ç´¢å¼•åº“æ›´æ–°äº§å“:\"+itemId); } } catch (JMSException e) { e.printStackTrace(); } } }} æ¨èåšå®¢ï¼šhttp://elim.iteye.com/blog/1893038","link":"/2018/07/25/åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆå››ï¼‰/"},{"title":"NIO","text":"Java Non blocking IO å­¦ä¹ ç¬”è®° Java NIO ç®€ä»‹ Java NIOï¼ˆNon blocking IOï¼‰æ˜¯ä»Java 1.4ç‰ˆæœ¬å¼€å§‹å¼•å…¥çš„ä¸€ä¸ªæ–°çš„IO APIï¼Œå¯ä»¥æ›¿ä»£æ ‡å‡†çš„Java IO APIã€‚NIOä¸åŸæ¥çš„IOæœ‰åŒæ ·çš„ä½œç”¨å’Œç›®çš„ï¼Œä½†æ˜¯ä½¿ç”¨çš„æ–¹å¼å®Œå…¨ä¸åŒï¼ŒNIOæ”¯æŒé¢å‘ç¼“å†²åŒºçš„ã€åŸºäºé€šé“çš„IOæ“ä½œã€‚NIOå°†ä»¥æ›´åŠ é«˜æ•ˆçš„æ–¹å¼è¿›è¡Œæ–‡ä»¶çš„è¯»å†™æ“ä½œã€‚ Java NIO ä¸ IO çš„ä¸»è¦åŒºåˆ« IO NIO é¢å‘æµ(Stream Oriented) é¢å‘ç¼“å†²åŒº(Buffer Oriented) é˜»å¡IO(Blocking IO) éé˜»å¡IO(Non Blocking IO) (æ— ) é€‰æ‹©å™¨(Selectors) ç¼“å†²åŒº(Buffer)å’Œé€šé“(Channel) Java NIOç³»ç»Ÿçš„æ ¸å¿ƒåœ¨äºï¼šé€šé“(Channel)å’Œç¼“å†²åŒº(Buffer)ã€‚é€šé“è¡¨ç¤ºæ‰“å¼€åˆ° IO è®¾å¤‡(ä¾‹å¦‚ï¼šæ–‡ä»¶ã€å¥—æ¥å­—)çš„è¿æ¥ã€‚è‹¥éœ€è¦ä½¿ç”¨ NIO ç³»ç»Ÿï¼Œéœ€è¦è·å–ç”¨äºè¿æ¥ IO è®¾å¤‡çš„é€šé“ä»¥åŠç”¨äºå®¹çº³æ•°æ®çš„ç¼“å†²åŒºã€‚ç„¶åæ“ä½œç¼“å†²åŒºï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚ç®€è€Œè¨€ä¹‹ï¼ŒChannel è´Ÿè´£ä¼ è¾“ï¼Œ Buffer è´Ÿè´£å­˜å‚¨ã€‚ ç¼“å†²åŒºç¼“å†²åŒºï¼ˆBufferï¼‰ï¼šä¸€ä¸ªç”¨äºç‰¹å®šåŸºæœ¬æ•°æ®ç±»å‹çš„å®¹å™¨ã€‚ç”± java.nio åŒ…å®šä¹‰çš„ï¼Œæ‰€æœ‰ç¼“å†²åŒºéƒ½æ˜¯ Buffer æŠ½è±¡ç±»çš„å­ç±»ã€‚ Java NIO ä¸­çš„ Buffer ä¸»è¦ç”¨äºä¸ NIO é€šé“è¿›è¡Œäº¤äº’ï¼Œæ•°æ®æ˜¯ä»é€šé“è¯»å…¥ç¼“å†²åŒºï¼Œä»ç¼“å†²åŒºå†™å…¥é€šé“ä¸­çš„ã€‚ Buffer å°±åƒä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥ä¿å­˜å¤šä¸ªç›¸åŒç±»å‹çš„æ•°æ®ã€‚æ ¹æ®æ•°æ®ç±»å‹ä¸åŒ(boolean é™¤å¤–) ï¼Œæœ‰ä»¥ä¸‹ Buffer å¸¸ç”¨å­ç±»ï¼š ByteBuffer / CharBuffer / ShortBuffer / IntBuffer / LongBuffer / FloatBuffer / DoubleBuffer ä¸Šè¿° Buffer ç±» ä»–ä»¬éƒ½é‡‡ç”¨ç›¸ä¼¼çš„æ–¹æ³•è¿›è¡Œç®¡ç†æ•°æ®ï¼Œåªæ˜¯å„è‡ªç®¡ç†çš„æ•°æ®ç±»å‹ä¸åŒè€Œå·²ã€‚éƒ½æ˜¯é€šè¿‡å¦‚ä¸‹æ–¹æ³•è·å–ä¸€ä¸ª Buffer å¯¹è±¡ï¼š static XxxBuffer allocate(int capacity) : åˆ›å»ºä¸€ä¸ªå®¹é‡ä¸º capacity çš„ XxxBuffer å¯¹è±¡ åŸºæœ¬å±æ€§ï¼š å®¹é‡ (capacity) ï¼šè¡¨ç¤º Buffer æœ€å¤§æ•°æ®å®¹é‡ï¼Œç¼“å†²åŒºå®¹é‡ä¸èƒ½ä¸ºè´Ÿï¼Œå¹¶ä¸”åˆ›å»ºåä¸èƒ½æ›´æ”¹ã€‚ é™åˆ¶ (limit)ï¼šç¬¬ä¸€ä¸ªä¸åº”è¯¥è¯»å–æˆ–å†™å…¥çš„æ•°æ®çš„ç´¢å¼•ï¼Œå³ä½äº limit åçš„æ•°æ®ä¸å¯è¯»å†™ã€‚ç¼“å†²åŒºçš„é™åˆ¶ä¸èƒ½ä¸ºè´Ÿï¼Œå¹¶ä¸”ä¸èƒ½å¤§äºå…¶å®¹é‡ã€‚ ä½ç½® (position)ï¼šä¸‹ä¸€ä¸ªè¦è¯»å–æˆ–å†™å…¥çš„æ•°æ®çš„ç´¢å¼•ã€‚ç¼“å†²åŒºçš„ä½ç½®ä¸èƒ½ä¸ºè´Ÿï¼Œå¹¶ä¸”ä¸èƒ½å¤§äºå…¶é™åˆ¶ æ ‡è®° (mark)ä¸é‡ç½® (reset)ï¼šæ ‡è®°æ˜¯ä¸€ä¸ªç´¢å¼•ï¼Œé€šè¿‡ Buffer ä¸­çš„ mark() æ–¹æ³•æŒ‡å®š Buffer ä¸­ä¸€ä¸ªç‰¹å®šçš„positionï¼Œä¹‹åå¯ä»¥é€šè¿‡è°ƒç”¨ reset() æ–¹æ³•æ¢å¤åˆ°è¿™ä¸ª position. æ ‡è®°ã€ä½ç½®ã€é™åˆ¶ã€å®¹é‡éµå®ˆä»¥ä¸‹ä¸å˜å¼ï¼š 0 &lt;= mark &lt;= position &lt;= limit &lt;= capacity å¸¸ç”¨æ–¹æ³•ï¼š æ–¹ æ³• æ è¿° byte get() è¯»å–å•ä¸ªå­—èŠ‚ Buffer put(byte b) å†™å…¥å•ä¸ªå­—èŠ‚åˆ°ç¼“å†²åŒº Buffer clear() æ¸…ç©ºç¼“å†²åŒºå¹¶è¿”å›å¯¹ç¼“å†²åŒºçš„å¼•ç”¨ Buffer flip() å°†ç¼“å†²åŒºçš„ç•Œé™è®¾ç½®ä¸ºå½“å‰ä½ç½®ï¼Œå¹¶å°†å½“å‰ä½ç½®å……å€¼ä¸º 0 int capacity() è¿”å› Buffer çš„ capacity å¤§å° boolean hasRemaining() åˆ¤æ–­ç¼“å†²åŒºä¸­æ˜¯å¦è¿˜æœ‰å…ƒç´  int limit() è¿”å› Buffer çš„ç•Œé™(limit) çš„ä½ç½® Buffer limit(int n) å°†è®¾ç½®ç¼“å†²åŒºç•Œé™ä¸º n, å¹¶è¿”å›ä¸€ä¸ªå…·æœ‰æ–° limit çš„ç¼“å†²åŒºå¯¹è±¡ Buffer mark() å¯¹ç¼“å†²åŒºè®¾ç½®æ ‡è®° int position() è¿”å›ç¼“å†²åŒºçš„å½“å‰ä½ç½® position Buffer position(int n) å°†è®¾ç½®ç¼“å†²åŒºçš„å½“å‰ä½ç½®ä¸º n , å¹¶è¿”å›ä¿®æ”¹åçš„ Buffer å¯¹è±¡ int remaining() è¿”å› position å’Œ limit ä¹‹é—´çš„å…ƒç´ ä¸ªæ•° Buffer reset() å°†ä½ç½® position è½¬åˆ°ä»¥å‰è®¾ç½®çš„ mark æ‰€åœ¨çš„ä½ç½® Buffer rewind() å°†ä½ç½®è®¾ä¸ºä¸º 0ï¼Œ å–æ¶ˆè®¾ç½®çš„ mark ç”¨ä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677public class TestBuffer { @Test public void test() { // åˆ†é…ä¸€ä¸ªæŒ‡å®šå®¹é‡çš„ç¼“å†²åŒº ByteBuffer buffer = ByteBuffer.allocate(1024); System.out.println(\"-----&lt; allocate &gt;-----\"); showAttribute(buffer); // position:0 - limit:1024 - capacity:1024 // å­˜æ•°æ®åˆ°ç¼“å†²åŒº buffer.put(\"abcde\".getBytes()); // å­˜å…¥äº†5ä¸ªå­—èŠ‚ System.out.println(\"-----&lt; put &gt;-----\"); showAttribute(buffer); // position:5 - limit:1024 - capacity:1024 // åˆ‡æ¢åˆ°è¯»å–æ•°æ®ï¼Œå°†ç¼“å†²åŒºçš„ç•Œé™è®¾ç½®ä¸ºå½“å‰ä½ç½®ï¼ˆ5ï¼‰ï¼Œå¹¶å°†å½“å‰ä½ç½®å……å€¼ä¸º 0ï¼ˆä»0å¼€å§‹è¯»å–ï¼‰ buffer.flip(); System.out.println(\"-----&lt; flip &gt;-----\"); showAttribute(buffer); // position:ä» 0 å¼€å§‹è¯» - limit:5 - capacity:1024 // è¿™ä¸ªæ—¶å€™å¦‚æœå­˜å…¥æ•°æ®ä¼šæŠ¥é”™ï¼Œå› ä¸ºæŒ‡é’ˆåœ¨0ï¼Œç•Œé™æ˜¯5ï¼Œè€Œå­˜å…¥çš„æ•°æ®é•¿åº¦10å¤§äºç•Œé™ã€‚// buffer.put(\"zhangyu123\".getBytes()); // å–æ•°æ® byte[] bytes = new byte[buffer.limit()]; buffer.get(bytes); System.out.println(new String(bytes, 0, bytes.length)); System.out.println(\"-----&lt; get &gt;-----\"); showAttribute(buffer); // position:5 - limit:5 - capacity:1024 // é‡å¤è¯»å– buffer.rewind(); System.out.println(\"-----&lt; rewind &gt;-----\"); showAttribute(buffer); // position:0 - limit:5 - capacity:1024 // æ¸…ç©ºç¼“å­˜åŒºï¼Œç¼“å­˜åŒºçš„æ•°æ®ä¾æ—§å­˜åœ¨ï¼Œåªæ˜¯positionåˆ°äº†0ï¼Œlimitå’Œcapacityå˜ä¸ºæœ€å¤§å®¹é‡æ•°å€¼ï¼Œæ•°æ®å¤„äºæ¸¸ç¦»çŠ¶æ€ã€‚ buffer.clear(); System.out.println(\"-----&lt; clear &gt;-----\"); showAttribute(buffer); // position:0 - limit:1024 - capacity:1024 } @Test public void testMark() { String s = \"abcde\"; ByteBuffer buffer = ByteBuffer.allocate(1024); buffer.put(s.getBytes()); buffer.flip(); byte[] bytes = new byte[buffer.limit()]; buffer.get(bytes, 0, 2); // ä»ç¼“å†²åŒºè·å–ä»0å¼€å§‹çš„ä¸¤ä¸ªå­—ç¬¦ System.out.println(new String(bytes, 0, bytes.length)); // ab System.out.println(\"position:\" + buffer.position()); // 2 buffer.mark(); // å¯¹ä½ç½® 2 åšæ ‡è®°ï¼Œç»§ç»­å¾€ä¸‹è¯»ã€‚ buffer.get(bytes, 2, 2); System.out.println(new String(bytes, 0, bytes.length)); // abcd System.out.println(\"position:\" + buffer.position()); // 4 buffer.reset(); // position é‡æ–°æ¢å¤åˆ°äº† 2 System.out.println(\"position:\" + buffer.position()); // 2 System.out.println((char) buffer.get()); // è·å–ä¸‹ä¸€ä¸ªå­—èŠ‚ c if (buffer.hasRemaining()) System.out.println(buffer.remaining()); // è·å¾—å‰©ä½™å­—èŠ‚æ•°é‡ 2 } @Test public void test3() { //åˆ†é…ç›´æ¥ç¼“å†²åŒº ByteBuffer buf = ByteBuffer.allocateDirect(1024); System.out.println(buf.isDirect()); } public void showAttribute(ByteBuffer buffer) { System.out.println(\"position:\" + buffer.position()); System.out.println(\"limit:\" + buffer.limit()); System.out.println(\"capacity:\" + buffer.capacity()); }} éç›´æ¥ç¼“å†²åŒºï¼šé€šè¿‡ allocate() æ–¹æ³•åˆ†é…ç¼“å†²åŒºï¼Œå°†ç¼“å†²åŒºå»ºç«‹åœ¨ JVM çš„å†…å­˜ä¸­ã€‚ ç›´æ¥ç¼“å†²åŒºï¼šé€šè¿‡ allocateDirect() æ–¹æ³•åˆ†é…ç›´æ¥ç¼“å†²åŒºï¼Œå°†ç¼“å†²åŒºå»ºç«‹åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚å¯ä»¥æé«˜æ•ˆç‡ã€‚å¼Šç«¯ï¼šç›´æ¥åœ¨ç³»ç»Ÿå†…å­˜ä¸­å»ºç«‹ï¼ˆåˆ†é…ã€é”€æ¯ï¼‰ç¼“å­˜æ¯”åœ¨JVMä¸­å»ºç«‹ç¼“å­˜å†…å­˜æ¶ˆè€—è¦å¤§,å¹¶ä¸”å½“æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°†æ•°æ®å†™å…¥åˆ°ç³»ç»Ÿå†…å­˜ä¹‹åæ•°æ®æ˜¯ä¸å¯æ§çš„ï¼ˆä¸å½’åº”ç”¨ç¨‹åºç®¡äº†ï¼‰ï¼Œç¼“å­˜ä¸­çš„æ•°æ®ä»€ä¹ˆå†™å…¥åˆ°ç£ç›˜ç”±æ“ä½œç³»ç»Ÿå†³å®šã€‚ä½¿ç”¨ç›´æ¥ç¼“å†²åŒºæœ€å¥½çš„åœºæ™¯æ˜¯å½“æˆ‘ä»¬éœ€è¦é•¿æ—¶é—´åœ¨ç¼“å­˜ä¸­æ“ä½œæ•°æ®æˆ–è€…å¤§é‡çš„æ•°æ®æ—¶ï¼Œæ­¤æ—¶çš„æ•ˆç‡ä¼šå¾—åˆ°å¾ˆå¤§çš„æé«˜ã€‚ é€šé“ é€šé“ï¼ˆChannelï¼‰ï¼šç”± java.nio.channels åŒ…å®šä¹‰çš„ã€‚Channel è¡¨ç¤º IO æºä¸ç›®æ ‡æ‰“å¼€çš„è¿æ¥ã€‚Channel ç±»ä¼¼äºä¼ ç»Ÿçš„â€œæµâ€ã€‚åªä¸è¿‡ Channel æœ¬èº«ä¸èƒ½ç›´æ¥è®¿é—®æ•°æ®ï¼ŒChannel åªèƒ½ä¸Buffer è¿›è¡Œäº¤äº’ã€‚ ä¸»è¦å®ç°ç±»ï¼š java.nio.channels.Channel æ¥å£ï¼š |--FileChannel |--SocketChannel |--ServerSocketChannel |--DatagramChannel è·å–é€šé“çš„å‡ ç§æ–¹å¼ï¼š Java é’ˆå¯¹æ”¯æŒé€šé“çš„ç±»æä¾›äº† getChannel() æ–¹æ³• æœ¬åœ° IOï¼š FileInputStream/FileOutputStream RandomAccessFile ç½‘ç»œIOï¼š Socket ServerSocket DatagramSocket åœ¨ JDK 1.7 ä¸­çš„ NIO.2 é’ˆå¯¹å„ä¸ªé€šé“æä¾›äº†é™æ€æ–¹æ³• open() åœ¨ JDK 1.7 ä¸­çš„ NIO.2 çš„ Files å·¥å…·ç±»çš„ newByteChannel() æ–‡ä»¶é€šé“(FileChannel)FileChannel çš„å¸¸ç”¨æ–¹æ³•ï¼š æ–¹ æ³• æ è¿° int read(ByteBuffer dst) ä» Channel ä¸­è¯»å–æ•°æ®åˆ° ByteBuffer long read(ByteBuffer[] dsts) å°† Channel ä¸­çš„æ•°æ®â€œåˆ†æ•£â€åˆ° ByteBuffer[] int write(ByteBuffer src) å°† ByteBuffer ä¸­çš„æ•°æ®å†™å…¥åˆ° Channel long write(ByteBuffer[] srcs) å°† ByteBuffer[] ä¸­çš„æ•°æ®â€œèšé›†â€åˆ° Channel long position() è¿”å›æ­¤é€šé“çš„æ–‡ä»¶ä½ç½® FileChannel position(long p) è®¾ç½®æ­¤é€šé“çš„æ–‡ä»¶ä½ç½® long size() è¿”å›æ­¤é€šé“çš„æ–‡ä»¶çš„å½“å‰å¤§å° FileChannel truncate(long s) å°†æ­¤é€šé“çš„æ–‡ä»¶æˆªå–ä¸ºç»™å®šå¤§å° void force(boolean metaData) å¼ºåˆ¶å°†æ‰€æœ‰å¯¹æ­¤é€šé“çš„æ–‡ä»¶æ›´æ–°å†™å…¥åˆ°å­˜å‚¨è®¾å¤‡ä¸­ ä»¥æ–‡ä»¶ä¼ è¾“ä½“éªŒé€šé“çš„æ•°æ®ä¼ è¾“ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081public class TestFileChannel { /** * åˆ©ç”¨é€šé“å’Œéç›´æ¥ç¼“å†²åŒºä¼ è¾“æ–‡ä»¶ */ @Test public void test1() throws IOException { FileInputStream in = null; FileOutputStream out = null; FileChannel inChannel = null; FileChannel outChannel = null; try { in = new FileInputStream(\"img/mm.jpg\"); out = new FileOutputStream(\"img/mm2.jpg\"); // é€šè¿‡è¾“å…¥è¾“å‡ºæµè·å¾—é€šé“ inChannel = in.getChannel(); outChannel = out.getChannel(); // æ„å»ºç¼“å†²åŒº ByteBuffer buffer = ByteBuffer.allocate(1024); while (inChannel.read(buffer) != -1) { // ä»è¾“å…¥é€šé“ä¸­è¯»å–å†…å®¹åˆ°ç¼“å†²åŒº buffer.flip(); // åˆ‡æ¢æˆè¯»å–æ•°æ®æ¨¡å¼ outChannel.write(buffer); // å†™å…¥ç¼“å†²åŒºæ•°æ®åˆ°è¾“å‡ºé€šé“ buffer.clear(); // æ¸…ç©ºç¼“å†²åŒºï¼Œç”¨äºä¸‹ä¸€æ¬¡å­˜å‚¨ } } catch (IOException e) { e.printStackTrace(); } finally { outChannel.close(); inChannel.close(); out.close(); in.close(); } } /** * åˆ©ç”¨é€šé“å’Œç›´æ¥ç¼“å†²åŒºä¼ è¾“æ–‡ä»¶ï¼ˆå†…å­˜æ˜ å°„æ–‡ä»¶ï¼‰ */ @Test public void test2() throws IOException { /** * open() æ–¹å¼æ‰“å¼€é€šé“ * * StandardOpenOption.READ : ä»¥åªè¯»æ–¹å¼åˆ›å»ºé€šé“ * StandardOpenOption.CREATE: è‹¥æ–‡ä»¶å­˜åœ¨è¦†ç›–ï¼Œä¸å­˜åœ¨åˆ›å»ºã€‚ * StandardOpenOption.CREATE_NEW: è‹¥æ–‡ä»¶ä¸å­˜åœ¨åˆ›å»ºï¼Œå­˜åœ¨æŠ¥é”™ã€‚ */ FileChannel inChannel = FileChannel.open(Paths.get(\"img/mm.jpg\"), StandardOpenOption.READ); FileChannel outChannel = FileChannel.open(Paths.get(\"img/mm2.jpg\"), StandardOpenOption.READ, StandardOpenOption.WRITE, StandardOpenOption.CREATE); // æ„å»ºå†…å­˜æ˜ å°„æ–‡ä»¶ï¼ˆæ•°æ®åœ¨ç‰©ç†å†…å­˜ä¸­çš„æ˜ å°„ï¼Œä¹Ÿæ˜¯ç›´æ¥ç¼“å†²åŒºï¼‰ MappedByteBuffer inMappedBuf = inChannel.map(FileChannel.MapMode.READ_ONLY, 0, inChannel.size()); MappedByteBuffer outMappedBuf = outChannel.map(FileChannel.MapMode.READ_WRITE, 0, inChannel.size()); // å¯¹ç›´æ¥ç¼“å†²åŒºè¿›è¡Œæ•°æ®è¯»å– System.out.println(\"byte:\" + inMappedBuf.limit() + \"k\"); byte[] dst = new byte[inMappedBuf.limit()]; inMappedBuf.get(dst); outMappedBuf.put(dst); inChannel.close(); outChannel.close(); } /** * ç›´æ¥åˆ©ç”¨é€šé“è¿›è¡Œä¼ è¾“ï¼Œå°†æºé€šé“ä¸­çš„æ•°æ®ä¼ è¾“åˆ°ç›®æ ‡é€šé“ä¸­å»ã€‚ */ @Test public void test3() throws IOException { FileChannel inChannel = FileChannel.open(Paths.get(\"img/mm.jpg\"), StandardOpenOption.READ); FileChannel outChannel = FileChannel.open(Paths.get(\"img/mm2.jpg\"), StandardOpenOption.READ, StandardOpenOption.WRITE, StandardOpenOption.CREATE); inChannel.transferTo(0, inChannel.size(), outChannel); // æŠŠè¾“å…¥ç®¡é“çš„æ•°æ®ä¼ åˆ°è¾“å‡ºç®¡é“ä¸­å»// outChannel.transferFrom(inChannel,0,inChannel.size()); // ä»è¾“å…¥ç®¡é“ä¸­ä¼ è¾“æ•°æ®åˆ°è¾“å‡ºç®¡é“ä¸­æ¥ outChannel.close(); inChannel.close(); }} RandomAccessFile ç±»åœ¨æŸäº›åº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸€ä¸ªæ•°æ®æµä¸­çš„æœ«å°¾æ’å…¥æ•°æ®ï¼Œé€šå¸¸çš„æ–¹å¼æ˜¯å…ˆæŠŠæ–‡ä»¶å…¨éƒ¨è¯»å–å‡ºæ¥ï¼Œå†ç”¨æ’å…¥çš„æ•°æ®æ‹¼æ¥åˆ°æœ«å°¾ï¼Œç„¶åé‡æ–°å†™å…¥ã€‚ä½†æ˜¯å½“æ•°æ®é‡ç‰¹åˆ«å¤§æ—¶ï¼Œå†…å­˜å ç”¨ä¼šç‰¹åˆ«çš„é«˜ç”šè‡³æº¢å‡ºã€‚ RandomAccessFileæ˜¯Javaä¸­è¾“å…¥ï¼Œè¾“å‡ºæµä½“ç³»ä¸­åŠŸèƒ½æœ€ä¸°å¯Œçš„æ–‡ä»¶å†…å®¹è®¿é—®ç±»ï¼Œå®ƒæä¾›å¾ˆå¤šæ–¹æ³•æ¥æ“ä½œæ–‡ä»¶ï¼ŒåŒ…æ‹¬è¯»å†™æ”¯æŒï¼Œä¸æ™®é€šçš„IOæµç›¸æ¯”ï¼Œå®ƒæœ€å¤§çš„ç‰¹åˆ«ä¹‹å¤„å°±æ˜¯æ”¯æŒä»»æ„è®¿é—®çš„æ–¹å¼ï¼Œç¨‹åºå¯ä»¥ç›´æ¥è·³åˆ°ä»»æ„åœ°æ–¹æ¥è¯»å†™æ•°æ®ã€‚å¦‚æœæˆ‘ä»¬åªå¸Œæœ›è®¿é—®æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹ï¼Œè€Œä¸æ˜¯æŠŠæ–‡ä»¶ä»å¤´è¯»åˆ°å°¾ï¼Œä½¿ç”¨RandomAccessFileå°†ä¼šå¸¦æ¥æ›´ç®€æ´çš„ä»£ç ä»¥åŠæ›´å¥½çš„æ€§èƒ½ã€‚ é€šè¿‡ç”¨ä¾‹ç»ƒä¹ RandomAccessFileï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576public class TestRandomAccessFile { /** * è¯»å–ä»»æ„ä½ç½®çš„æ–‡ä»¶å†…å®¹ * &lt;p&gt; * r ä»£è¡¨ä»¥åªè¯»æ–¹å¼æ‰“å¼€æŒ‡å®šæ–‡ä»¶ * rw ä»¥è¯»å†™æ–¹å¼æ‰“å¼€æŒ‡å®šæ–‡ä»¶ * rws è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå¹¶å¯¹å†…å®¹æˆ–å…ƒæ•°æ®éƒ½åŒæ­¥å†™å…¥åº•å±‚å­˜å‚¨è®¾å¤‡ * rwd è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå¯¹æ–‡ä»¶å†…å®¹çš„æ›´æ–°åŒæ­¥æ›´æ–°è‡³åº•å±‚å­˜å‚¨è®¾å¤‡ */ @Test public void randomReadFile() throws IOException { RandomAccessFile read = new RandomAccessFile(\"src/subject_1/TestBuffer.java\", \"r\"); System.out.println(\"æ–‡ä»¶æŒ‡é’ˆåˆå§‹ä½ç½®ï¼š\" + read.getFilePointer()); read.seek(1000); // å°†æŒ‡é’ˆå®šä½åˆ°æŸä¸ªä½ç½® FileChannel readChannel = read.getChannel(); // ä»æŒ‡å®šä½ç½®å¼€å§‹è¯»å–ï¼Œè·å¾—é€šé“ ByteBuffer buffer = ByteBuffer.allocate(1024); // åˆ›å»ºç¼“å†²åŒºï¼Œå¯ä»¥å°†å®¹é‡è®¾ä¸ºé€šé“å¤§å°`(int) readChannel.size()`è¿™æ ·å°±ä¸ç”¨å¾ªç¯è¯»å– // æ§åˆ¶å°æ‰“å°çš„åŒæ—¶è¿˜å°†æ•°æ®ä¼ è¾“åˆ°è¾“å‡ºé€šé“ RandomAccessFile write = new RandomAccessFile(\"src/subject_1/TestBuffer.txt\", \"rw\"); FileChannel writeChannel = write.getChannel(); while (readChannel.read(buffer) != -1) { // ä¸æ–­çš„å°†è¾“å…¥é€šé“ä¸­çš„æ•°æ®è¯»å–åˆ°ç¼“å†²åŒº buffer.flip(); // å¼€å¯è¯»å–æ¨¡å¼ï¼Œè¯»å–å®Œæ¯•ä¹‹å position åˆ°äº†æ•°æ®æœ«å°¾ï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡è¯»å–ã€‚ System.out.println(new String(buffer.array(), 0, buffer.limit())); writeChannel.write(buffer); buffer.clear(); } } /** * è¿½åŠ æ•°æ®åˆ°æ–‡ä»¶çš„æŒ‡å®šä½ç½® */ @Test public void randomWriteFile() throws IOException { RandomAccessFile write = new RandomAccessFile(\"src/subject_1/TestBuffer.txt\", \"rw\"); write.seek(write.length()); // å°†æ–‡ä»¶æŒ‡é’ˆç§»åŠ¨åˆ°æœ«å°¾ write.write(\"---------&lt; this is append content &gt;--------\".getBytes()); } /** * åœ¨ä»»æ„å¤„æ’å…¥æ•°æ®ï¼Œå¦‚æœä¸å°†æ’å…¥ç‚¹ä¹‹åçš„æ•°æ®å¤‡ä»½çš„è¯ï¼Œæ’å…¥çš„æ•°æ®ä¼šè¦†ç›–æ’å…¥ç‚¹ä¹‹åçš„æ•°æ®ã€‚ * &lt;p&gt; * - å°†æ’å…¥ç‚¹ä¹‹åçš„æ•°æ®å­˜å…¥ä¸´æ—¶æ–‡ä»¶ * - å°†æ•°æ®æ’å…¥åˆ°æ’å…¥ç‚¹ * - å°†ä¸´æ—¶æ–‡ä»¶ä¸­çš„å†…å®¹æ’å…¥åˆ°æ—§æ–‡ä»¶ */ @Test public void randomReadWriteFile() throws IOException { File tempFile = File.createTempFile(\"src/subject_1/tmp\", \"txt\", null); tempFile.deleteOnExit(); // JVMé€€å‡ºæ—¶åˆ é™¤ // å»ºç«‹ä¸´æ—¶æ–‡ä»¶çš„è¾“å…¥è¾“å‡ºé€šé“ FileChannel temInChannel = new FileInputStream(tempFile).getChannel(); FileChannel temOutChannel = new FileOutputStream(tempFile).getChannel(); RandomAccessFile target = new RandomAccessFile(\"src/subject_1/target.txt\", \"rw\"); int seekIndex = 1210; // æ’å…¥ç‚¹ target.seek(seekIndex); FileChannel targetChannel = target.getChannel(); // å°†ç›®æ ‡æ–‡ä»¶æ’å…¥ç‚¹ä¹‹åçš„æ•°æ®åˆ›å»ºé€šé“ä¼ è¾“åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­çš„é€šé“ temOutChannel.transferFrom(targetChannel, 0, targetChannel.size()); // æŒ‡é’ˆå›åˆ°æ’å…¥ç‚¹ï¼Œæ’å…¥æ•°æ®ã€‚ target.seek(seekIndex); target.write(\"[ this is append content ]\\n\".getBytes()); // å¤åˆ¶æ’å…¥ç‚¹ä¹‹åçš„æ•°æ®.è¯»å–ä¸´æ—¶æ–‡ä»¶é€šé“ä¸­çš„æ•°æ®ï¼Œå°†ä¸´æ—¶æ–‡ä»¶é€šé“æ•°æ®ä¼ è¾“åˆ°ç›®æ ‡æ–‡ä»¶é€šé“ã€‚å¦‚æœèƒ½è¯»å–åˆ°è¯´æ˜æ•°æ®ä¼ è¾“æˆåŠŸ ByteBuffer buffer = ByteBuffer.allocate(2048); while (temInChannel.read(buffer) != -1) { buffer.flip(); System.out.println(new String(buffer.array(), 0, buffer.limit())); targetChannel.write(buffer); buffer.clear(); } }} åˆ†æ•£å’Œèšé›†åˆ†æ•£è¯»å–ï¼ˆScattering Readsï¼‰æ˜¯æŒ‡ä» Channel ä¸­è¯»å–çš„æ•°æ®â€œåˆ†æ•£â€åˆ°å¤šä¸ª Buffer ä¸­ï¼ˆæŒ‰ç…§ç¼“å†²åŒºçš„é¡ºåºï¼Œä» Channel ä¸­è¯»å–çš„æ•°æ®ä¾æ¬¡å°† Buffer å¡«æ»¡ï¼‰ã€‚ èšé›†å†™å…¥ï¼ˆGathering Writesï¼‰æ˜¯æŒ‡å°†å¤šä¸ª Buffer ä¸­çš„æ•°æ®â€œèšé›†â€åˆ° Channelï¼ˆæŒ‰ç…§ç¼“å†²åŒºçš„é¡ºåºï¼Œå†™å…¥ position å’Œ limit ä¹‹é—´çš„æ•°æ®åˆ° Channelï¼‰ã€‚ 12345678910111213141516171819202122232425public class ScatterAndGather { /** * åˆ†æ•£è¯»å–ä¸èšé›†å†™å…¥ */ @Test public void test1() throws IOException { RandomAccessFile file = new RandomAccessFile(\"src/subject_1/target.txt\", \"rw\"); FileChannel channel = file.getChannel(); // åˆ†é…ä¸¤ä¸ªç¼“å†²åŒº ByteBuffer buf1 = ByteBuffer.allocate(100); ByteBuffer buf2 = ByteBuffer.allocate((int) channel.size() - 100); // åˆ†æ•£è¯»å–åˆ°ç¼“å†²åŒº ByteBuffer[] buffers = {buf1, buf2}; channel.read(buffers); // å°†è¾“å…¥é€šé“çš„ä¸­çš„æ•°æ®ä¾æ¬¡åˆ†æ•£è¯»å–åˆ°ä¸åŒçš„ç¼“å†²åŒº for (ByteBuffer buffer : buffers) { buffer.flip(); System.out.println(new String(buffer.array(), 0, buffer.limit())); System.out.println(\"-----&lt; åˆ†å‰² &gt;-----\"); } // èšé›†å†™å…¥åˆ°æ–‡ä»¶ FileChannel bakChannel = new RandomAccessFile(\"src/subject_1/target_bak.txt\", \"rw\").getChannel(); bakChannel.write(buffers); }} å­—ç¬¦é›† Charset123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354public class TestCharset { /** * æŸ¥çœ‹æ”¯æŒçš„æ‰€æœ‰å­—ç¬¦é›† */ @Test public void test1() { SortedMap&lt;String, Charset&gt; map = Charset.availableCharsets(); Set&lt;Map.Entry&lt;String, Charset&gt;&gt; set = map.entrySet(); Iterator&lt;Map.Entry&lt;String, Charset&gt;&gt; iterator = set.iterator(); while (iterator.hasNext()) { Map.Entry&lt;String, Charset&gt; entry = iterator.next(); System.out.println(entry.getKey() + \" &lt;&gt; \" + entry.getValue()); } System.out.println(\"defaultCharset: \" + Charset.defaultCharset()); } /** * ç¼–ç ï¼šå­—ç¬¦ -&gt; å­—èŠ‚æ•°ç»„ * è§£ç ï¼šå­—èŠ‚æ•°ç»„ -&gt; å­—ç¬¦ */ @Test public void test2() throws CharacterCodingException { // ä»¥æŒ‡å®šç¼–ç åŠ è½½å­—ç¬¦é›† Charset gbk = Charset.forName(\"GBK\"); Charset utf8 = Charset.forName(\"UTF-8\"); // åˆ›å»ºç¼–ç å™¨ CharsetEncoder gbkEncoder = gbk.newEncoder(); CharsetEncoder utf8Encoder = utf8.newEncoder(); // åˆ›å»ºè§£ç å™¨ CharsetDecoder utf8Decoder = utf8.newDecoder(); CharsetDecoder gbkDecoder = gbk.newDecoder(); // å°†æ•°æ®æ”¾åˆ°ç¼“å†²åŒº CharBuffer buffer = CharBuffer.allocate(1024); buffer.put(\"æµ‹è¯•ç¼–ç è§£ç \"); // å¯¹å­—ç¬¦ä½¿ç”¨ GBK ç¼–ç ï¼Œåˆ‡æ¢åˆ°è¯»æ¨¡å¼ï¼ŒæŒ‡é’ˆä»0å¼€å§‹ã€‚ buffer.flip(); ByteBuffer byteBuffer = gbkEncoder.encode(buffer); // ByteBuffer byteBuffer = utf8Encoder.encode(buffer); // ä½¿ç”¨ UTF8 ç¼–ç  for (int i = 0; i &lt; byteBuffer.limit(); i++) { System.out.println(byteBuffer.get()); } // ä½¿ç”¨ GBK è§£ç  byteBuffer.flip(); CharBuffer cb = gbkDecoder.decode(byteBuffer); System.out.println(new String(cb.array(), 0, cb.limit())); // ä½¿ç”¨ UTF8 è§£ç ï¼Œå¤±è´¥ byteBuffer.flip(); CharBuffer cb1 = utf8Decoder.decode(byteBuffer); System.out.println(new String(cb1.array(), 0, cb1.limit())); }} NIO çš„éé˜»å¡å¼ç½‘ç»œé€šä¿¡ ä¼ ç»Ÿçš„ IO æµéƒ½æ˜¯é˜»å¡å¼çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ read() æˆ– write() æ—¶ï¼Œè¯¥çº¿ç¨‹è¢«é˜»å¡ï¼Œç›´åˆ°æœ‰ä¸€äº›æ•°æ®è¢«è¯»å–æˆ–å†™å…¥ï¼Œè¯¥çº¿ç¨‹åœ¨æ­¤æœŸé—´ä¸èƒ½æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚å› æ­¤ï¼Œåœ¨å®Œæˆç½‘ç»œé€šä¿¡è¿›è¡Œ IO æ“ä½œæ—¶ï¼Œç”±äºçº¿ç¨‹ä¼šé˜»å¡ï¼Œæ‰€ä»¥æœåŠ¡å™¨ç«¯å¿…é¡»ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯éƒ½æä¾›ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œå½“æœåŠ¡å™¨ç«¯éœ€è¦å¤„ç†å¤§é‡å®¢æˆ·ç«¯æ—¶ï¼Œæ€§èƒ½æ€¥å‰§ä¸‹é™ã€‚Java NIO æ˜¯éé˜»å¡æ¨¡å¼çš„ã€‚å½“çº¿ç¨‹ä»æŸé€šé“è¿›è¡Œè¯»å†™æ•°æ®æ—¶ï¼Œè‹¥æ²¡æœ‰æ•°æ®å¯ç”¨æ—¶ï¼Œè¯¥çº¿ç¨‹å¯ä»¥è¿›è¡Œå…¶ä»–ä»»åŠ¡ã€‚çº¿ç¨‹é€šå¸¸å°†éé˜»å¡ IO çš„ç©ºé—²æ—¶é—´ç”¨äºåœ¨å…¶ä»–é€šé“ä¸Šæ‰§è¡Œ IO æ“ä½œï¼Œæ‰€ä»¥å•ç‹¬çš„çº¿ç¨‹å¯ä»¥ç®¡ç†å¤šä¸ªè¾“å…¥å’Œè¾“å‡ºé€šé“ã€‚å› æ­¤ï¼ŒNIO å¯ä»¥è®©æœåŠ¡å™¨ç«¯ä½¿ç”¨ä¸€ä¸ªæˆ–æœ‰é™å‡ ä¸ªçº¿ç¨‹æ¥åŒæ—¶å¤„ç†è¿æ¥åˆ°æœåŠ¡å™¨ç«¯çš„æ‰€æœ‰å®¢æˆ·ç«¯ã€‚ é€šè¿‡ç”¨ä¾‹ä»£ç éªŒè¯é˜»å¡å¼ç½‘ç»œé€šä¿¡ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465public class BlockingNioTest { /** * å®¢æˆ·ç«¯ï¼šå‘é€æ•°æ® */ @Test public void client() throws IOException, InterruptedException { // æ‰“å¼€ç½‘ç»œIOé€šé“ SocketChannel socketChannel = SocketChannel.open(new InetSocketAddress(\"localhost\", 1998)); // è¯»æ¨¡å¼æ‰“å¼€æœ¬åœ°ä¼ è¾“æ–‡ä»¶é€šé“ FileChannel inChannel = FileChannel.open(Paths.get(\"img/mm.jpg\"), StandardOpenOption.READ); // ä¼ è¾“ ByteBuffer buffer = ByteBuffer.allocate(1024); while (inChannel.read(buffer) != -1) { buffer.flip(); socketChannel.write(buffer); buffer.clear(); } /** * æ¥æ”¶æœåŠ¡ç«¯åé¦ˆä¿¡æ¯ * è°ƒç”¨ read()/write() æ–¹æ³•å½“å‰çº¿ç¨‹ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå¦‚æœä¸å¼ºåˆ¶åœæ­¢writeï¼Œä¸ä¼šè¿›è¡Œä¸‹é¢çš„æ“ä½œã€‚ */ socketChannel.shutdownOutput(); while (socketChannel.read(buffer) != -1) { System.out.println(\"æ¥æ”¶æœåŠ¡å™¨åé¦ˆä¸­...\"); buffer.flip(); System.out.println(new String(buffer.array(), 0, buffer.limit())); buffer.clear(); } inChannel.close(); socketChannel.close(); } /** * æœåŠ¡å™¨ç«¯ï¼šæ¥æ”¶æ•°æ® */ @Test public void server() throws IOException { // æ‰“å¼€ç½‘ç»œIOé€šé“ ServerSocketChannel ssChannel = ServerSocketChannel.open(); // ç»‘å®šè¿æ¥ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€ ssChannel.bind(new InetSocketAddress(\"localhost\", 1998)); // è·å–å®¢æˆ·ç«¯çš„è¿æ¥é€šé“ System.out.println(\"æœåŠ¡ç«¯ç­‰å¾…è·å–å®¢æˆ·ç«¯è¿æ¥é€šé“...\"); SocketChannel socketChannel = ssChannel.accept(); System.out.println(\"æˆåŠŸè·å–åˆ°å®¢æˆ·ç«¯è¿æ¥é€šé“ï¼\"); // ä»å®¢æˆ·ç«¯è¿æ¥é€šé“è¯»å–æ•°æ®åˆ°æœ¬åœ° FileChannel outChannel = FileChannel.open(Paths.get(\"src/subject_2/mm.jpg\"), StandardOpenOption.WRITE, StandardOpenOption.CREATE); // ä¼ è¾“ ByteBuffer buffer = ByteBuffer.allocate(1024); while (socketChannel.read(buffer) != -1) { buffer.flip(); outChannel.write(buffer); buffer.clear(); } /*å‘é€åé¦ˆä¿¡æ¯ç»™å®¢æˆ·ç«¯*/ buffer.put(\"[æœåŠ¡ç«¯]ï¼šæ¶ˆæ¯æ¥æ”¶æˆåŠŸï¼\".getBytes()); buffer.flip(); socketChannel.write(buffer); outChannel.close(); socketChannel.close(); ssChannel.close(); }} é€‰æ‹©å™¨(Selector)é€‰æ‹©å™¨ï¼ˆSelectorï¼‰ æ˜¯ SelectableChannle å¯¹è±¡çš„å¤šè·¯å¤ç”¨å™¨ï¼ŒSelector å¯ä»¥åŒæ—¶ç›‘æ§å¤šä¸ª SelectableChannel çš„ IO çŠ¶å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ©ç”¨ Selector å¯ä½¿ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ç®¡ç†å¤šä¸ªChannelã€‚Selector æ˜¯éé˜»å¡ IO çš„æ ¸å¿ƒã€‚ java.nio.channels.Channel æ¥å£ï¼š |--SelectableChannel |--SocketChannel |--ServerSocketChannel |--DatagramChannel |--Pipe.SinkChannel |--Pipe.SourceChannel éé˜»å¡å¼IOåŠé€‰æ‹©å™¨çš„ç”¨ä¾‹è¯´æ˜ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455public class NonBlockingNioTest { @Test public void client() throws IOException { SocketChannel sChannel = SocketChannel.open(new InetSocketAddress(\"localhost\", 1998)); sChannel.configureBlocking(false); //åˆ‡æ¢éé˜»å¡æ¨¡å¼ ByteBuffer buf = ByteBuffer.allocate(1024); buf.put((new Date().toString()).getBytes()); buf.flip(); sChannel.write(buf); buf.clear(); sChannel.close(); } @Test public void server() throws IOException { ServerSocketChannel ssChannel = ServerSocketChannel.open(); ssChannel.configureBlocking(false); // æœåŠ¡ç«¯é€šé“åˆ‡æ¢éé˜»å¡æ¨¡å¼ ssChannel.bind(new InetSocketAddress(1998)); Selector selector = Selector.open(); // è·å–é€‰æ‹©å™¨ /* * å°†æœåŠ¡å™¨é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ä¸Š, å¹¶ä¸”æŒ‡å®šâ€œç›‘å¬æ¥æ”¶äº‹ä»¶â€ã€‚ * - è¯»: SelectionKey.OP_READ * - å†™: SelectionKey.OP_WRITE * - è¿æ¥: SelectionKey.OP_CONNECT * - æ¥æ”¶: SelectionKey.OP_ACCEPT */ ssChannel.register(selector, SelectionKey.OP_ACCEPT); // è½®è¯¢å¼çš„è·å–é€‰æ‹©å™¨ä¸Šå·²ç»â€œå‡†å¤‡å°±ç»ªâ€çš„äº‹ä»¶ while (selector.select() &gt; 0) { // è·å–å½“å‰é€‰æ‹©å™¨ä¸­æ‰€æœ‰æ³¨å†Œçš„â€œé€‰æ‹©é”®(å·²å°±ç»ªçš„ç›‘å¬äº‹ä»¶)â€ Iterator&lt;SelectionKey&gt; it = selector.selectedKeys().iterator(); while (it.hasNext()) { SelectionKey sk = it.next(); // è·å–å‡†å¤‡â€œå°±ç»ªâ€çš„äº‹ä»¶ if (sk.isAcceptable()) { // è‹¥äº‹ä»¶æ˜¯ â€œæ¥æ”¶å°±ç»ªâ€ï¼Œè·å–å®¢æˆ·ç«¯è¿æ¥ SocketChannel sChannel = ssChannel.accept(); sChannel.configureBlocking(false); // å®¢æˆ·ç«¯åˆ‡æ¢éé˜»å¡æ¨¡å¼ sChannel.register(selector, SelectionKey.OP_READ); // å°†å®¢æˆ·ç«¯é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ä¸Š } else if (sk.isReadable()) { // è·å–å½“å‰é€‰æ‹©å™¨ä¸Šâ€œè¯»å°±ç»ªâ€çŠ¶æ€çš„é€šé“ SocketChannel sChannel = (SocketChannel) sk.channel(); ByteBuffer buf = ByteBuffer.allocate(1024); int len = 0; while ((len = sChannel.read(buf)) &gt; 0) { buf.flip(); System.out.println(new String(buf.array(), 0, len)); buf.clear(); } } it.remove(); // å–æ¶ˆé€‰æ‹©é”® SelectionKey } } }} SocketChannelã€ServerSocketChannelã€DatagramChannelJava NIOä¸­çš„SocketChannelæ˜¯ä¸€ä¸ªè¿æ¥åˆ°TCPç½‘ç»œå¥—æ¥å­—çš„é€šé“ã€‚æ“ä½œæ­¥éª¤ï¼š æ‰“å¼€ SocketChannel è¯»å†™æ•°æ® å…³é—­ SocketChannel Java NIOä¸­çš„ ServerSocketChannel æ˜¯ä¸€ä¸ªå¯ä»¥ç›‘å¬æ–°è¿›æ¥çš„TCPè¿æ¥çš„é€šé“ï¼Œå°±åƒæ ‡å‡†IOä¸­çš„ServerSocketä¸€æ ·ã€‚ Java NIOä¸­çš„DatagramChannelæ˜¯ä¸€ä¸ªèƒ½æ”¶å‘UDPåŒ…çš„é€šé“ã€‚æ“ä½œæ­¥éª¤ï¼š æ‰“å¼€ DatagramChannel æ¥æ”¶/å‘é€æ•°æ® ç®¡é“(Pipe)Java NIO ç®¡é“æ˜¯2ä¸ªçº¿ç¨‹ä¹‹é—´çš„å•å‘æ•°æ®è¿æ¥ã€‚Pipeæœ‰ä¸€ä¸ªsourceé€šé“å’Œä¸€ä¸ªsinké€šé“ã€‚æ•°æ®ä¼šè¢«å†™åˆ°sinké€šé“ï¼Œä»sourceé€šé“è¯»å–ã€‚ 1234567891011121314151617181920public class PipTest { @Test public void test1() throws IOException { Pipe pipe = Pipe.open(); // è·å–ç®¡é“ ByteBuffer buf = ByteBuffer.allocate(1024); // å°†ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥ç®¡é“ Pipe.SinkChannel sinkChannel = pipe.sink(); buf.put(\"é€šè¿‡å•å‘ç®¡é“å‘é€æ•°æ®\".getBytes()); buf.flip(); sinkChannel.write(buf); Pipe.SourceChannel sourceChannel = pipe.source(); // è¯»å–ç¼“å†²åŒºä¸­çš„æ•°æ® buf.flip(); int len = sourceChannel.read(buf); System.out.println(new String(buf.array(), 0, len)); sourceChannel.close(); sinkChannel.close(); }} Java NIO2 (Pathã€Paths ä¸ Files )java.nio.file.Path æ¥å£ä»£è¡¨ä¸€ä¸ªå¹³å°æ— å…³çš„å¹³å°è·¯å¾„ï¼Œæè¿°äº†ç›®å½•ç»“æ„ä¸­æ–‡ä»¶çš„ä½ç½®ã€‚ Paths æä¾›çš„ get() æ–¹æ³•ç”¨æ¥è·å– Path å¯¹è±¡ï¼š Path get(String first, String â€¦ more) : ç”¨äºå°†å¤šä¸ªå­—ç¬¦ä¸²ä¸²è¿æˆè·¯å¾„ã€‚ æ–¹æ³• æè¿° boolean endsWith(String path) åˆ¤æ–­æ˜¯å¦ä»¥ path è·¯å¾„ç»“æŸ boolean startsWith(String path) åˆ¤æ–­æ˜¯å¦ä»¥ path è·¯å¾„å¼€å§‹ boolean isAbsolute() åˆ¤æ–­æ˜¯å¦æ˜¯ç»å¯¹è·¯å¾„ Path getFileName() è¿”å›ä¸è°ƒç”¨ Path å¯¹è±¡å…³è”çš„æ–‡ä»¶å Path getName(int idx) è¿”å›çš„æŒ‡å®šç´¢å¼•ä½ç½® idx çš„è·¯å¾„åç§° int getNameCount() è¿”å›Path æ ¹ç›®å½•åé¢å…ƒç´ çš„æ•°é‡ Path getParent() è¿”å›Pathå¯¹è±¡åŒ…å«æ•´ä¸ªè·¯å¾„ï¼Œä¸åŒ…å« Path å¯¹è±¡æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„ Path getRoot() è¿”å›è°ƒç”¨ Path å¯¹è±¡çš„æ ¹è·¯å¾„ Path resolve(Path p) å°†ç›¸å¯¹è·¯å¾„è§£æä¸ºç»å¯¹è·¯å¾„ Path toAbsolutePath() ä½œä¸ºç»å¯¹è·¯å¾„è¿”å›è°ƒç”¨ Path å¯¹è±¡ String toString() è¿”å›è°ƒç”¨ Path å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ java.nio.file.Files ç”¨äºæ“ä½œæ–‡ä»¶æˆ–ç›®å½•çš„å·¥å…·ç±»ã€‚ æ–¹æ³• æè¿° Path copy(Path src, Path dest, CopyOption â€¦ how) æ–‡ä»¶çš„å¤åˆ¶ Path createDirectory(Path path, FileAttribute&lt;?&gt; â€¦ attr) åˆ›å»ºä¸€ä¸ªç›®å½• Path createFile(Path path, FileAttribute&lt;?&gt; â€¦ arr) åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ void delete(Path path) åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ Path move(Path src, Path dest, CopyOptionâ€¦how) å°† src ç§»åŠ¨åˆ° dest ä½ç½® long size(Path path) è¿”å› path æŒ‡å®šæ–‡ä»¶çš„å¤§å° boolean exists(Path path, LinkOption â€¦ opts) åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ boolean isDirectory(Path path, LinkOption â€¦ opts) åˆ¤æ–­æ˜¯å¦æ˜¯ç›®å½• boolean isExecutable(Path path) åˆ¤æ–­æ˜¯å¦æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ boolean isHidden(Path path) åˆ¤æ–­æ˜¯å¦æ˜¯éšè—æ–‡ä»¶ boolean isReadable(Path path) åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯è¯» boolean isWritable(Path path) åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯å†™ boolean notExists(Path path, LinkOption â€¦ opts) åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸å­˜åœ¨ SeekableByteChannel newByteChannel(Path path, OpenOptionâ€¦how) è·å–ä¸æŒ‡å®šæ–‡ä»¶çš„è¿æ¥ DirectoryStream newDirectoryStream(Path path) æ‰“å¼€ path æŒ‡å®šçš„ç›®å½• InputStream newInputStream(Path path, OpenOptionâ€¦how) è·å– InputStream å¯¹è±¡ OutputStream newOutputStream(Path path, OpenOptionâ€¦how) è·å– OutputStream å¯¹è±¡ è‡ªåŠ¨èµ„æºç®¡ç† Java 7 å¢åŠ äº†ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œè¯¥ç‰¹æ€§æä¾›äº†å¦å¤–ä¸€ç§ç®¡ç†èµ„æºçš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼èƒ½è‡ªåŠ¨å…³é—­æ–‡ä»¶ã€‚è¿™ä¸ªç‰¹æ€§æœ‰æ—¶è¢«ç§°ä¸ºè‡ªåŠ¨èµ„æºç®¡ç†(Automatic Resource Management, ARM)ï¼Œ è¯¥ç‰¹æ€§ä»¥ try è¯­å¥çš„æ‰©å±•ç‰ˆä¸ºåŸºç¡€ã€‚è‡ªåŠ¨èµ„æºç®¡ç†ä¸»è¦ç”¨äºï¼Œå½“ä¸å†éœ€è¦æ–‡ä»¶ï¼ˆæˆ–å…¶ä»–èµ„æºï¼‰æ—¶ï¼Œå¯ä»¥é˜²æ­¢æ— æ„ä¸­å¿˜è®°é‡Šæ”¾å®ƒä»¬ã€‚ è¯­æ³•ï¼š try( éœ€è¦å…³é—­çš„èµ„æºå£°æ˜ ){ //å¯èƒ½å‘ç”Ÿå¼‚å¸¸çš„è¯­å¥ }catch( å¼‚å¸¸ç±»å‹ å˜é‡å ){ //å¼‚å¸¸çš„å¤„ç†è¯­å¥ } â€¦â€¦ finally{ //ä¸€å®šæ‰§è¡Œçš„è¯­å¥ } å½“ try ä»£ç å—ç»“æŸæ—¶ï¼Œè‡ªåŠ¨é‡Šæ”¾èµ„æºã€‚å› æ­¤ä¸éœ€è¦æ˜¾ç¤ºçš„è°ƒç”¨ close() æ–¹æ³•ã€‚è¯¥å½¢å¼ä¹Ÿç§°ä¸ºâ€œå¸¦èµ„æºçš„ try è¯­å¥â€ã€‚æ³¨æ„ï¼š try è¯­å¥ä¸­å£°æ˜çš„èµ„æºè¢«éšå¼å£°æ˜ä¸º final ï¼Œèµ„æºçš„ä½œç”¨å±€é™äºå¸¦èµ„æºçš„ try è¯­å¥ å¯ä»¥åœ¨ä¸€æ¡ try è¯­å¥ä¸­ç®¡ç†å¤šä¸ªèµ„æºï¼Œæ¯ä¸ªèµ„æºä»¥â€œ;â€ éš”å¼€å³å¯ã€‚ éœ€è¦å…³é—­çš„èµ„æºï¼Œå¿…é¡»å®ç°äº† AutoCloseable æ¥å£æˆ–å…¶è‡ªæ¥å£ Closeable 12345678910111213public class TestNIO_2 { //è‡ªåŠ¨èµ„æºç®¡ç†ï¼šè‡ªåŠ¨å…³é—­å®ç° AutoCloseable æ¥å£çš„èµ„æº @Test public void test(){ try(FileChannel inChannel = FileChannel.open(Paths.get(\"1.jpg\"), StandardOpenOption.READ); FileChannel outChannel = FileChannel.open(Paths.get(\"2.jpg\"), StandardOpenOption.WRITE, StandardOpenOption.CREATE)){ ByteBuffer buf = ByteBuffer.allocate(1024); inChannel.read(buf); }catch(IOException e){} }}","link":"/2018/09/07/NIO/"},{"title":"ç®—æ³•ç¬¬ä¸€ç«  åŸºç¡€","text":"ç¬¬ä¸€ç«  åŸºç¡€åŸºç¡€ç¼–ç¨‹æ¨¡å‹æ ¼å¼åŒ–è¾“å‡ºä»æ ‡å‡†è¾“å‡ºæµä¸­æ‰“å°éšæœºç”Ÿæˆçš„æ•°å€¼ï¼Œâ€œ%.2f\\nâ€è¡¨ç¤ºè¾“å‡ºä¸¤ä½å°æ•°ç²¾åº¦çš„æµ®ç‚¹å‹æ•°å€¼å¹¶æ¢è¡Œã€‚ cmdè¿è¡Œéœ€è¦æ³¨æ„çš„å‡ ä¸ªåœ°æ–¹ï¼š æˆ‘ä»¬çš„å·¥ç¨‹ä¸€èˆ¬ä½¿ç”¨utf-8ç¼–ç ï¼Œä½†æ˜¯windowsç³»ç»Ÿé»˜è®¤gbkç¼–ç ï¼Œæ‰€ä»¥ç¼–è¯‘javacä¼šå‡ºç°â€œæ‰¾ä¸åˆ°gbkç¼–ç çš„å­—ç¬¦æ˜ å°„â€ã€‚è§£å†³åŠæ³•ï¼šç¼–è¯‘æ—¶æŒ‡å®šå‚æ•° -encoding utf-8 â€œæ‰¾ä¸åˆ°æŸä¸ªç±»â€ï¼Œç¨‹åºä¸­å¼•ç”¨äº†éå½“å‰ç›®å½•çš„jaræ–‡ä»¶ï¼Œåœ¨æœ¬è·¯å¾„ç¼–è¯‘ä¼šæ‰¾ä¸åˆ°jaråŒ…ï¼Œéœ€è¦æ‰§è¡Œå‚æ•°ï¼š-Djava.ext.dirs=jaråŒ…ä½œä¸ºè·¯å¾„ã€‚ â€œæ— æ³•è¿è¡Œä¸»ç±»â€ï¼Œæ£€æŸ¥æ˜¯å¦é…ç½®äº†classpathç¯å¢ƒå˜é‡ï¼ŒCLASSPATH=&quot;.;%JAVA_HOME%\\lib;%JAVA_HOME%\\lib\\tools.jar;&quot; å¦‚æœè¢«ç¼–è¯‘ç±»æœ‰åŒ…ï¼Œéœ€è¦åœ¨è¯¥åŒ…ä¸‹æ‰§è¡Œç¼–è¯‘å’Œè¿è¡Œï¼Œæœ€ç»ˆè¯¥ç±»çš„ç¼–è¯‘å’Œè¿è¡Œå‘½ä»¤ï¼š javac -Djava.ext.dirs=D:\\IdeaProjects\\Algorithms\\lib -encoding utf-8 chapter_1/programming_model/RandomSeq.java java -Djava.ext.dirs=D:\\IdeaProjects\\Algorithms\\lib chapter_1/programming_model/RandomSeq 10 1 100 12345678910111213public class RandomSeq { public static void main(String[] args) { // æ‰“å°nä¸ª(lo,hi)ä¹‹é—´çš„éšæœºå€¼ int N = Integer.parseInt(args[0]); double lo = Double.parseDouble(args[1]); double hi = Double.parseDouble(args[2]); for (int i = 0; i &lt; N; i++) { // è¿”å›éšæœºå®æ•° double x = StdRandom.uniform(lo, hi); StdOut.printf(\"%.2f\\n\", x); } }} æ³¨æ„ï¼šjavaè¦æ±‚å‚æ•°çš„æ•°æ®ç±»å‹å’Œè½¬æ¢ä»£ç è¡¨ç¤ºçš„æ•°æ®ç±»å‹å¿…é¡»ç›¸åŒï¼Œprintf()çš„ç¬¬ä¸€ä¸ªStringå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥åŒ…å«å…¶ä»–å­—ç¬¦ã€‚æ‰€æœ‰éæ ¼å¼çš„å­—ç¬¦ä¸²ä¼šè¢«ä¼ é€’åˆ°è¾“å‡ºä¹‹ä¸­ï¼Œè€Œæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²åˆ™ä¼šè¢«å‚æ•°çš„å€¼æ‰€ä»£æ›¿ã€‚ä¾‹å¦‚ï¼š 1Std.printf(\"PI is %.2f\\n\",Math.PI); ä¼šæ‰“å°å‡ºï¼šPI is 3.14 æ ‡å‡†è¾“å…¥ç‰¹ç‚¹æ ‡å‡†è¾“å…¥æµæœ€é‡è¦çš„ç‰¹ç‚¹å°±æ˜¯è¿™äº›å€¼ä¼šåœ¨ç¨‹åºè¯»å–ä¹‹åæ¶ˆå¤±ï¼Œç¨‹åºè¯»å–äº†å°±ä¸èƒ½å›é€€å†æ¬¡è¯»å–ã€‚ é‡å®šå‘ä¸ç®¡é“ä½¿è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯ç»ˆç«¯æ‰“å°ï¼šjava RandomSeq 1000 100.0 200.0 &gt; data.txtï¼Œæ¯æ¬¡æ‰“å°éƒ½ä¼šå‘æ–‡ä»¶è¿½åŠ å†…å®¹ã€‚ ä»æ–‡ä»¶è¯»å–è¾“å…¥æµè€Œä¸æ˜¯ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œâ€œ&lt;â€æ˜¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œå®ƒå‘Šè¯‰ç³»ç»Ÿä»æ–‡ä»¶ä¸­ä½œä¸ºè¾“å…¥æµè€Œä¸æ˜¯ç­‰ç»ˆç«¯ç”¨æˆ·è¾“å…¥ã€‚java Average &lt; data.txt å°†ä¸€ä¸ªç¨‹åºçš„è¾“å‡ºé‡å®šå‘ä¸ºä¸€ä¸ªç¨‹åºçš„è¾“å…¥å«åšç®¡é“ã€‚java RandomSeq 1000 100.0 200.0 | Java Averageï¼Œè¯¥å‘½ä»¤å°†RandomSeqçš„æ ‡å‡†è¾“å‡ºå’ŒAverageçš„æ ‡å‡†è¾“å…¥æŒ‡å®šä¸ºäº†åŒä¸€ä¸ªæµã€‚çœ‹èµ·æ¥çš„æ•ˆæœå°±æ˜¯Averageè¿è¡Œæ—¶ä»RandomSeqçš„è¾“å‡ºä½œä¸ºäº†è‡ªå·±çš„è¾“å…¥ã€‚è¿™ç§å†™æ³•çš„å¥½å¤„åœ¨äºå®ƒèƒ½å¤Ÿçªç ´è¾“å…¥è¾“å‡ºæµé•¿åº¦çš„é™åˆ¶ï¼Œæœ‰æ•ˆçš„åˆ©ç”¨äº†ç³»ç»Ÿèµ„æºã€‚RandomSeqè°ƒç”¨äº†printf()æ—¶ï¼Œå‘è¾“å…¥æµæœ«å°¾æ·»åŠ äº†ä¸€æ¡å­—ç¬¦ä¸²ï¼›Averageè°ƒç”¨readDouble()æ—¶ï¼Œå°±ä»è¾“å…¥æµå¼€å¤´åˆ é™¤äº†ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ äºŒåˆ†æŸ¥æ‰¾è¯»å–ç»ˆç«¯è¾“å…¥æµä¸­çš„å€¼ï¼Œå¦‚æœè¯¥å€¼åœ¨æŒ‡å®šæ–‡ä»¶ä¸­ä¸å­˜åœ¨åˆ™è¿”å›è¿™ä¸ªå€¼ï¼Œå¦åˆ™ä¸è¿”å›ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738public class BinarySearch { public static int rank(int key, int[] arr) { // ä½¿ç”¨loå’Œhiå˜é‡ä¿è¯keyä¸€å®šåœ¨arr[lo...hi]ä¸­ int lo = 0; int hi = arr.length - 1; for (int i = 0; i &lt; hi; i++) { // å–ä¸­é—´å€¼ç´¢å¼•ï¼Œå½“æŸ¥æ‰¾çš„èŒƒå›´åœ¨å·¦è¾¹ï¼Œloå§‹ç»ˆä¸º0ï¼Œå½“æŸ¥æ‰¾çš„èŒƒå›´åœ¨å³è¾¹ï¼Œä¸­é—´å€¼ç´¢å¼•å°±æ˜¯èµ·å§‹å€¼ç´¢å¼•+å‰åæŠ˜åŠçš„å€¼ int mid = lo + (hi - lo) / 2; // å°äºä¸­é—´å€¼ï¼ŒæŸ¥æ‰¾èŒƒå›´ç¼©å°åˆ°å·¦è¾¹ if (key &lt; arr[i]) { hi = mid - 1; } // å¤§äºä¸­é—´å€¼ï¼ŒæŸ¥æ‰¾èŒƒå›´ç¼©å°åˆ°å³è¾¹ if (key &gt; arr[i]) { lo = mid + 1; } else { return i; } } return -1; } public static void main(String[] args) { long start = System.currentTimeMillis(); // Reads all integers from a file and returns them as an array of integers. argumentï¼šfilename int[] whitelist = In.readInts(args[0]); Arrays.sort(whitelist); while (!StdIn.isEmpty()) { // Reads the next token from standard input, parses it as an integer, int key = StdIn.readInt(); if (rank(key, whitelist) &lt; 0) { StdOut.println(key); } } long end = System.currentTimeMillis(); StdOut.println(\"time-&gt;:\" + (end - start)); }} å‘½ä»¤è¡Œå‚æ•°ï¼š ç¼–è¯‘å¿½ç•¥è¿‡æœŸè­¦å‘Šï¼š javac -Djava.ext.dirs=D:\\IdeaProjects\\Algorithms\\lib -Xlint:deprecation -encoding utf-8 chapter_1/programming_model/BinarySearch.java è¿è¡Œï¼šä¼ å…¥ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œæ¯”è¾ƒè¾“å…¥çš„å€¼æ˜¯å¦åœ¨æ–‡ä»¶ä¸­å­˜åœ¨ java -Djava.ext.dirs=D:\\IdeaProjects\\Algorithms\\lib chapter_1/programming_model/BinarySearch D:\\IdeaProjects\\Algorithms\\algs4-data\\tinyW.txt è¿è¡Œï¼šä¼ å…¥ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼ŒæŒ‡å®šè¾“å…¥æµæ¥æºäºæ–‡ä»¶ï¼Œä»tinyT.txtä¸­ä½œä¸ºè¾“å…¥æµï¼Œæ¯”è¾ƒtinyT.txté‡Œçš„æ¯ä¸ªå€¼æ˜¯å¦åœ¨tinyW.txtä¸­å­˜åœ¨ java -Djava.ext.dirs=D:\\IdeaProjects\\Algorithms\\lib chapter_1/programming_model/BinarySearch D:\\IdeaProjects\\Algorithms\\algs4-data\\tinyW.txt &lt; D:\\IdeaProjects\\Algorithms\\algs4-data\\tinyT.txt æ•°æ®æŠ½è±¡èƒŒåŒ…ã€é˜Ÿåˆ—å’Œæ ˆèƒŒåŒ…ï¼ˆBagï¼‰æ˜¯ä¸€ç§ä¸æ”¯æŒä»ä¸­åˆ é™¤å…ƒç´ çš„æ•°æ®ç±»å‹ï¼Œå…¶ä¸»è¦ç›®çš„ç”¨æ¥å¸®åŠ©ç”¨ä¾‹ï¼ˆåº”ç”¨ç¨‹åºï¼‰æ”¶é›†å…ƒç´ å¹¶è¿­ä»£éå†æœé›†åˆ°çš„æ‰€æœ‰å…ƒç´ ï¼ˆæ£€æŸ¥èƒŒåŒ…æ˜¯å¦ä¸ºç©ºï¼Œæˆ–è·å–èƒŒåŒ…ä¸­å…ƒç´ çš„æ•°é‡ï¼‰ã€‚ä½¿ç”¨èƒŒåŒ…è¯´æ˜å…ƒç´ çš„å¤„ç†æ˜¯æ— åºçš„ã€‚ å…¸å‹ç”¨ä¾‹ï¼šè®¡ç®—æ ‡å‡†è¾“å…¥ä¸­æ‰€æœ‰doubleå€¼çš„å¹³å‡å€¼å’Œæ ‡å‡†å·® 1234567891011121314151617181920212223public class Stats { public static void main(String[] args) { Bag&lt;Double&gt; numbers = new Bag&lt;Double&gt;(); while (!StdIn.isEmpty()) { numbers.add(StdIn.readDouble()); } int N = numbers.size(); double sum = 0.0; for (double x : numbers) { sum += x; } double mean = sum / N; sum = 0.0; for (double x : numbers) { sum += (x - mean) * (x - mean); } double std = Math.sqrt(sum / N - 1); StdOut.printf(\"Mean: %.2f\\n\", mean); StdOut.printf(\"Std dec: %.2f\\n\", std); }} é˜Ÿåˆ—ï¼ˆQueueï¼‰æ˜¯ä¸€ç§åŸºäºå…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰ç­–ç•¥çš„é›†åˆç±»å‹ã€‚é˜Ÿåˆ—æ˜¯è®¸å¤šæ—¥å¸¸ç°è±¡çš„æ¨¡å‹ï¼Œä¹Ÿæ˜¯æ— æ•°åº”ç”¨ç¨‹åºçš„æ ¸å¿ƒã€‚ å…¸å‹ç”¨ä¾‹ï¼šè¯»å–æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ•°å­—å¹¶æ”¾å…¥æ•°ç»„ä¸­ï¼Œä½¿ç”¨é˜Ÿåˆ—å’Œå¥½å¤„åœ¨äºç”¨ä¾‹æ— éœ€çŸ¥é“æ–‡ä»¶ä¸­çš„æ•°å­—çš„å¤§å°å³å¯å°†æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ•°å­—æ”¾å…¥æ•°ç»„ä¸­ï¼Œé¦–å…ˆå°†æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ•°å­—æŒ‰é¡ºåºæ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œå†ä»é˜Ÿåˆ—ä¸­æŒ‰é¡ºåºä¸€ä¸ªä¸€ä¸ªå–å‡ºæ”¾å…¥æ•°ç»„ï¼Œé˜Ÿåˆ—ä¸­å…ƒç´ çš„é¡ºåºå°±æ˜¯æ–‡ä»¶ä¸­æ•°å­—çš„é¡ºåºã€‚ 1234567891011121314151617181920public class QueueDemo { public static int[] readInts(String name) { In in = new In(name); Queue&lt;Integer&gt; q = new Queue&lt;&gt;(); while (!in.isEmpty()) { q.enqueue(in.readInt()); } int N = q.size(); int[] a = new int[N]; for (int i = 0; i &lt; N; i++) { a[i] = q.dequeue(); } return a; } public static void main(String[] args) { readInts(args[0]); }} ä¸‹å‹æ ˆï¼ˆæ ˆã€Stackï¼‰æ˜¯ä¸€ç§åŸºäºåè¿›å…ˆå‡ºï¼ˆLIFOï¼‰ç­–ç•¥çš„é›†åˆç±»å‹ã€‚ç”Ÿæ´»ä¸­å¸¸è§çš„åè¿›å…ˆå‡ºç­–ç•¥çš„ä¾‹å­æ¯”å¦‚ï¼šæ¡Œé¢ä¸Šæ”¾æˆä¸€å çš„é‚®ä»¶ï¼Œå½“æ”¶ä¿¡æ—¶å°†é‚®ä»¶å‹å…¥ï¼ˆpushï¼‰æœ€é¡¶ç«¯ï¼Œå–ä¿¡æ—¶ä»æœ€é¡¶ç«¯å°†å…¶å¼¹å‡ºï¼ˆpopï¼‰ã€‚è¿™ç§ç­–ç•¥å¥½å¤„åœ¨äºæˆ‘ä»¬èƒ½å¤ŸåŠæ—¶çš„çœ‹åˆ°æœ€æ–°çš„é‚®ä»¶ï¼Œåå¤„å°±æ˜¯å½“æ²¡æœ‰æ¸…ç†æ ˆæ—¶ï¼ŒæŸäº›è¾ƒæ—©çš„é‚®ä»¶æ°¸è¿œä¸ä¼šè¢«é˜…è¯»ã€‚ å…¸å‹ç”¨ä¾‹ï¼šç”¨å…ƒç´ ä¿å­˜é›†åˆçš„åŒæ—¶é¢ å€’ä»–ä»¬çš„é¡ºåºï¼ŒReverseä¼šæŠŠæ ‡å‡†è¾“å…¥ä¸­çš„æ‰€æœ‰æ•´æ•°é€†åºæ’åˆ—ã€‚ 123456789101112public class Reverse { public static void main(String[] args) { Stack&lt;Integer&gt; stack = new Stack&lt;&gt;(); while (!StdIn.isEmpty()) { stack.push(StdIn.readInt()); } for (int i : stack) { StdOut.println(i); } }} æ ˆçš„å…¸å‹ç”¨ä¾‹ï¼šåŒæ ˆç®—æœ¯è¡¨è¾¾å¼æ±‚å€¼ç®—æ³•ç¼–å†™ä¸€ä¸ªç®—æ³•æ¥æ¨¡æ‹Ÿç³»ç»Ÿè¿ç®—ç®—æœ¯è¡¨è¾¾å¼ï¼š ( 1 + ( ( 2 + 3 ) * ( 4 * 5 ) ) ) ï¼Œè¾“å…¥ä¸€ä¸ªè¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬å‡è®¾è¡¨è¾¾å¼åªç”±è¿ç®—ç¬¦+ã€-ã€*ã€/ï¼Œå°æ‹¬å·ï¼Œå’Œæ•°å­—ç»„æˆï¼Œå¹¶ä¸”æ¯ä¸ªå…ƒç´ ä¹‹é—´éƒ½ç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€ã€‚ åŒæ ˆç®—æœ¯è¡¨è¾¾å¼æ±‚å€¼ç®—æ³•æ ¸å¿ƒåˆ©ç”¨äº†ç”¨ä¸¤ä¸ªæ ˆï¼šä¸€ä¸ªä¿å­˜è¿ç®—ç¬¦ã€ä¸€ä¸ªä¿å­˜æ“ä½œæ•°ã€‚å¤„ç†é€»è¾‘å¦‚ä¸‹ï¼š å½“é‡åˆ°æ“ä½œæ•°å°†æ“ä½œæ•°å‹å…¥æ“ä½œæ•°æ ˆ å½“é‡åˆ°è¿ç®—ç¬¦å°†è¿ç®—ç¬¦å‹å…¥è¿ç®—ç¬¦æ ˆ å¿½ç•¥å·¦æ‹¬å· å½“é‡åˆ°å³æ‹¬å·æ—¶ï¼Œå¼¹å‡ºä¸€ä¸ªè¿ç®—ç¬¦ï¼Œå¼¹å‡ºæ‰€éœ€æ•°é‡çš„æ“ä½œæ•°ï¼Œå¹¶å°†æ“ä½œæ•°å’Œè¿ç®—ç¬¦çš„è¿ç®—ç»“æœå‹å…¥æ“ä½œæ•°æ ˆ 123456789101112131415161718192021222324252627282930313233343536373839404142public class Evaluate { public static void main(String[] args) { Stack&lt;String&gt; ops = new Stack&lt;&gt;(); Stack&lt;Double&gt; vals = new Stack&lt;&gt;(); while (!StdIn.isEmpty()) { // å¾ªç¯è¯»å–æ¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œå¦‚æœæ˜¯è¿ç®—ç¬¦åˆ™å‹å…¥è¿ç®—ç¬¦æ ˆ String s = StdIn.readString(); if (s.equals(\"(\")) { } else if (s.equals(\"+\")) { ops.push(s); } else if (s.equals(\"-\")) { ops.push(s); } else if (s.equals(\"*\")) { ops.push(s); } else if (s.equals(\"/\")) { ops.push(s); } else if (s.equals(\"sqrt\")) { ops.push(s); } else if (s.equals(\")\")) { // å¦‚æœè¿ç®—ç¬¦ä¸º ï¼‰ ï¼Œå¼¹å‡ºè¿ç®—ç¬¦å’Œæ“ä½œæ•°ï¼Œè®¡ç®—ç»“æœå¹¶å‹å…¥æ“ä½œæ•°æ ˆ String op = ops.pop(); double v = vals.pop(); // å¼¹å‡ºæ ˆé¡¶çš„æ“ä½œæ•°ã€‚å¼¹å‡ºæ ˆå…ƒç´ æ˜¯åœ¨æ ˆä¸­åˆ é™¤äº†çš„ if (op.equals(\"+\")) { v = vals.pop() + v; // å†å¼¹å‡ºä¸€ä¸ªæ ˆé¡¶æ“ä½œæ•°ï¼Œä¸å‰é¢å¼¹å‡ºçš„æ ˆé¡¶æ“ä½œæ•°ï¼ˆvï¼‰åšè¿ç®—å¹¶é‡æ–°èµ‹å€¼ç»™å˜é‡v } else if (op.equals(\"-\")) { v = vals.pop() - v; // ç¬¬äºŒæ¬¡å¼¹å‡ºçš„æ“ä½œæ•°åœ¨å‰ï¼Œç¬¬ä¸€æ¬¡å¼¹å‡ºçš„æ“ä½œæ•°åœ¨åã€‚å› ä¸ºå…ˆè¿›æ ˆçš„æ“ä½œæ•°åå¼¹å‡ºï¼Œåè¿›æ ˆçš„å…ƒç´ å…ˆå¼¹å‡º } else if (op.equals(\"*\")) { v = vals.pop() * v; } else if (op.equals(\"/\")) { v = vals.pop() / v; } else if (op.equals(\"sqrt\")) { v = Math.sqrt(v); } vals.push(v); // è¿ç®—åçš„å€¼å…¥æ ˆï¼Œè¿›è¡Œè¿ç®—çš„ä¸¤ä¸ªæ“ä½œæ•°è¢«å¼¹å‡ºï¼ˆåˆ é™¤ï¼‰äº†ã€‚ } else { // å¦‚æœæ—¢ä¸æ˜¯è¿ç®—ç¬¦ä¹Ÿä¸æ˜¯æ‹¬å·ï¼Œåˆ™å°±æ˜¯æ•°å­—ï¼Œå°†å…¶å‹å…¥æ•°å€¼æ ˆã€‚ vals.push(Double.parseDouble(s)); } } StdOut.println(vals.pop()); }} æ±‚å€¼ç®—æ³•è½¨è¿¹å›¾ï¼š é›†åˆç±»æ•°æ®ç±»å‹çš„å®ç°åŸºäºé¡ºåºå­˜å‚¨ç»“æ„çš„é›†åˆç±»å‹å®ç°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859public class ResizingArrayStack&lt;Item&gt; implements Iterable&lt;Item&gt; { private Item[] a; private int N; public ResizingArrayStack(int cap) { a = (Item[]) new Object[cap]; } public void push(Item item) { if (N == a.length) { resize(a.length * 2); } a[N++] = item; } public Item pop() { Item item = a[--N]; a[N] = null; if (N &gt; 0 &amp;&amp; N == a.length / 4) { resize(a.length / 2); } return item; } public boolean isEmpty() { return N == 0; } public int size() { return N; } public void resize(int max) { Item[] temp = (Item[]) new Object[max]; for (int i = 0; i &lt; N; i++) { temp[i] = a[i]; } a = temp; } @Override public Iterator&lt;Item&gt; iterator() { return new ReverseArrayStack&lt;&gt;(); } private class ReverseArrayStack&lt;Item&gt; implements Iterator&lt;Item&gt; { private int i = N; @Override public boolean hasNext() { return i == 0; } @Override public Item next() { return (Item) a[--i]; } }} åŸºäºé“¾å¼å­˜å‚¨ç»“æ„çš„é›†åˆç±»å‹å®ç°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public class LinkedStack&lt;Item&gt; implements Iterable&lt;Item&gt; { private Node first; private int N; private class Node&lt;Item&gt; { private Item item; private Node next; } private class listIterator&lt;Item&gt; implements Iterator&lt;Item&gt; { private Node currentNode = first; @Override public boolean hasNext() { return currentNode != null; } @Override public Item next() { Item item = (Item) currentNode.item; currentNode = currentNode.next; return item; } } public void push(Item item) { Node oldFirst = first; first = new Node&lt;&gt;(); first.item = item; first.next = oldFirst; N++; } public Item pop() { Node&lt;Item&gt; oldFirst = first; first = first.next; N--; return oldFirst.item; } public boolean isEmpty() { return first == null; } public int size() { return N; } @Override public Iterator&lt;Item&gt; iterator() { return new listIterator&lt;&gt;(); }} 123456789101112131415161718192021222324public class LinkedQueue&lt;Item&gt; implements Iterable { // ...... public void enqueue(Item item) { Node&lt;Item&gt; oldLast = last; last = new Node(); last.item = item; if (isEmpty()) { first = last; } else { oldLast.next = last; } N++; } public Item dequeue() { Node&lt;Item&gt; oldFirst = first; first = first.next; if (isEmpty()) { last = null; } N--; return oldFirst.item; }} æ›´å¤šæ‹“å±•åœ¨ç»ƒä¹ é¢˜ï¼š ä¸‹å‹æ ˆï¼š è¡¥å…¨è¡¨è¾¾å¼è½¬ä¸ºä¸­åºè¡¨è¾¾å¼ ä¸­åºè¡¨è¾¾å¼è½¬ååºè¡¨è¾¾å¼ ååºè¡¨è¾¾å¼æ±‚å€¼å®ç°ç®€å•è®¡ç®—å™¨ é˜Ÿåˆ—ï¼š è¯»å–å€’æ•°ç¬¬Kä¸ªå­—ç¬¦ä¸² é“¾è¡¨ï¼š LinkedStackExercise.java åŒå‘é“¾å¼å­˜å‚¨ç»“æ„é›†åˆæ•°æ®ç±»å‹å®ç°ï¼š Ex31_DoubleLinkedStack.java éšæœºèƒŒåŒ…ï¼š Ex34_RandomBag.java Josephusç”Ÿå­˜æ¸¸æˆï¼š Ex37_Josephus.java å¯è¿æ¥é˜Ÿåˆ—ã€æ ˆï¼š Ex47.java ç®—æ³•åˆ†ææ¡ˆä¾‹ç ”ç©¶ï¼šå¹¶æŸ¥é›†ï¼ˆunion-findï¼‰ç®—æ³•é—®é¢˜ç”±æ¥ â€”â€” åŠ¨æ€è¿é€šæ€§é—®é¢˜ï¼š ç¨‹åºä»è¾“å…¥ä¸­æ¯æ¬¡è¯»å–ä¸€å¯¹æ•´æ•° P å’Œ Q ï¼Œå¦‚æœå·²çŸ¥çš„æ‰€æœ‰æ•´æ•°å¯¹ä¸èƒ½è¯æ˜ä»–ä»¬æ˜¯â€œç›¸è¿â€çš„ï¼Œé‚£ä¹ˆæŠŠä»–ä»¬â€œè¿èµ·æ¥â€ï¼Œå¹¶æ‰“å°ï¼›å¦‚æœèƒ½è¯æ˜ä»–ä»¬æ˜¯ç›¸è¿çš„åˆ™ä¸å¤„ç†ï¼Œç»§ç»­è¯»å–ä¸‹ä¸€å¯¹æ•´æ•°å¯¹ã€‚å½“ä¸¤ä¸ªå¯¹è±¡ï¼ˆæ•´æ•°ç‚¹ï¼‰ç›¸è¿æ—¶ç§°ä¸ºå±äºä¸€ä¸ªç­‰ä»·ç±»ã€‚ æ¦‚å¿µï¼šå¦‚æœä¸¤ä¸ªå¯¹è±¡â€œç›¸è¿â€æ˜¯ä¸€ç§ç­‰ä»·å…³ç³»ï¼Œé‚£ä¹ˆå®ƒå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š è‡ªåæ€§ï¼šPå’ŒPæ˜¯ç›¸è¿çš„ï¼ˆå°±æ˜¯ä¸€ä¸ªç‚¹å’Œè‡ªå·±æœ¬èº«æ˜¯ç›¸è¿çš„ï¼Œemâ€¦ï¼‰ï¼› å¯¹ç§°æ€§ï¼šè‹¥På’ŒQæ˜¯ç›¸è¿çš„ï¼Œé‚£ä¹ˆQå’ŒPä¹Ÿæ˜¯ç›¸è¿çš„ï¼› ä¼ é€’æ€§ï¼šè‹¥På’ŒQç›¸è¿ä¸”Qå’ŒRç›¸è¿ï¼Œé‚£ä¹ˆPå’ŒRæ˜¯ç›¸è¿çš„ ç†è§£å¹¶æŸ¥é›†ä»¥ä¸Šé—®é¢˜å…¶å®å°±æ˜¯å¹¶æŸ¥é›†çš„ä¸€ä¸ªå…·ä½“æ¡ˆä¾‹ï¼Œå…³äºå¹¶æŸ¥é›†ï¼Œè§£é‡Šå¦‚ä¸‹ï¼š å¹¶æŸ¥é›†ï¼Œåœ¨ä¸€äº›æœ‰Nä¸ªå…ƒç´ çš„é›†åˆåº”ç”¨é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æ˜¯åœ¨å¼€å§‹æ—¶è®©æ¯ä¸ªå…ƒç´ æ„æˆä¸€ä¸ªå•å…ƒç´ çš„é›†åˆï¼Œç„¶åæŒ‰ä¸€å®šé¡ºåºå°†å±äºåŒä¸€ç»„çš„å…ƒç´ æ‰€åœ¨çš„é›†åˆåˆå¹¶ï¼Œå…¶é—´è¦åå¤æŸ¥æ‰¾ä¸€ä¸ªå…ƒç´ åœ¨å“ªä¸ªé›†åˆä¸­ã€‚ â€œå¹¶æŸ¥é›†â€æ˜¯ä¸€ç§ä¸ç›¸äº¤é›†åˆçš„æ•°æ®ç±»å‹ï¼Œåˆå§‹æ—¶å¹¶æŸ¥é›†ä¸­çš„å…ƒç´ æ˜¯ä¸ç›¸äº¤çš„ï¼Œç»è¿‡ä¸€ç³»åˆ—çš„åŸºæœ¬æ“ä½œ(Union)ï¼Œæœ€ç»ˆåˆå¹¶æˆä¸€ä¸ªå¤§çš„é›†åˆã€‚ API åˆå§‹åŒ–è§¦ç‚¹ è¿æ¥è§¦ç‚¹ æŸä¸ªè§¦ç‚¹æ‰€åœ¨çš„è¿é€šåˆ†é‡ åˆ¤æ–­ä¸¤ä¸ªè§¦ç‚¹æ˜¯å¦åœ¨åŒä¸€ä¸ªè¿é€šåˆ†é‡ä¹‹ä¸­ è¿”å›è¿é€šåˆ†é‡çš„æ•°é‡ 123456789101112131415161718192021public interface UF { /** * è¿æ¥På’ŒQ */ void union(int p, int q); /** * pæ‰€åœ¨åˆ†é‡ï¼ˆç›¸ç­‰æ•´æ•°å¯¹ï¼‰çš„æ ‡è¯†ç¬¦ */ int find(int p); /** * på’Œqå­˜åœ¨åŒä¸€åˆ†é‡è¿”å›true */ boolean connected(int p, int q); /** * åˆ†é‡çš„ä¸ªæ•° */ int count();} å®ç°ä¸€ï¼šquick-find ç®—æ³•æ•°æ®ç»“æ„ï¼šæ•°ç»„ ç”¨æ•°ç»„ id[] è¡¨ç¤ºæ¯ä¸€ä¸ªè§¦ç‚¹çš„å€¼ï¼Œæ•°ç»„ç´¢å¼•è¡¨ç¤ºè§¦ç‚¹ï¼Œè§¦ç‚¹çš„å€¼å°±æ˜¯åˆ†é‡çš„å€¼ï¼Œè§¦ç‚¹å€¼ç›¸åŒè¡¨æ˜åˆ†é‡ç›¸åŒã€‚ åˆå§‹åŒ–æ—¶æ¯ä¸ªè§¦ç‚¹çš„å€¼éƒ½æ˜¯è¯¥è§¦ç‚¹çš„ç´¢å¼•ã€‚ æ¯”å¦‚ï¼šè§¦ç‚¹0 = id[0] = 0; è§¦ç‚¹1 = id[1] = 1; è§¦ç‚¹3 = id[3] = 3; å¤šä¸ªè§¦ç‚¹å±äºåŒä¸€ä¸ªè¿é€šåˆ†é‡æ—¶ï¼Œå…¶ä¸­æŸä¸ªè§¦ç‚¹çš„å€¼â€œä»£è¡¨â€è¯¥è¿é€šåˆ†é‡çš„å€¼ï¼ŒæŠŠå…¶ä»–è§¦ç‚¹çš„å€¼ç»Ÿä¸€æˆæ‰€å±åˆ†é‡çš„ä»£è¡¨å€¼ï¼Œæ¯”å¦‚ï¼š è¦æŠŠid[4] (å€¼ä¸º4) å’Œ id[8] (å€¼ä¸º8) ç›¸è¿ä¸ºåŒä¸€åˆ†é‡ï¼Œå¯ä»¥æŠŠid[4]çš„å€¼æ”¹æˆid[8]çš„å€¼ï¼Œé‚£ä¹ˆæŠŠ id[8] å€¼ç§°ä¸ºè¯¥è¿é€šåˆ†é‡çš„ä»£è¡¨ï¼ˆæˆ–æ ‡è¯†ç¬¦æˆ–å€¼ï¼‰ï¼›ä¹Ÿå¯ä»¥æŠŠid[8]çš„å€¼æ”¹æˆid[4]çš„å€¼ï¼Œè¿é€šåˆ†é‡çš„å€¼å°±æ˜¯id[4]äº†ã€‚ è¦æŠŠid[5] (å€¼ä¸º5) å’Œ id[4] (å‡è®¾æ‰€å±åˆ†é‡å€¼ä¸º8) ç›¸è¿ä¸ºåŒä¸€åˆ†é‡ï¼Œè¿é€šåˆ†é‡çš„å€¼ä»¥id[5]ä¸ºä»£è¡¨ï¼Œé‚£ä¹ˆæ‰€æœ‰å€¼ä¸º 8 çš„åˆ†é‡çš„å€¼éƒ½æ”¹æˆäº† 5ã€‚ è¿é€šåˆ†é‡ä¸­çš„æ‰€æœ‰è§¦ç‚¹çš„å€¼æ˜¯ç»Ÿä¸€çš„ã€‚ ç®—æ³•åˆ†æå¯ä»¥å¿«é€Ÿè¿›è¡Œ find æ“ä½œï¼Œå³å¯ä»¥å¿«é€Ÿåˆ¤æ–­ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦è¿é€šã€‚ åŒä¸€è¿é€šåˆ†é‡çš„æ‰€æœ‰èŠ‚ç‚¹çš„ id å€¼ç›¸ç­‰ã€‚ ä½†æ˜¯ union æ“ä½œä»£ä»·å´å¾ˆé«˜ï¼Œéœ€è¦å°†å…¶ä¸­ä¸€ä¸ªè¿é€šåˆ†é‡ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ id å€¼éƒ½ä¿®æ”¹ä¸ºå¦ä¸€ä¸ªèŠ‚ç‚¹çš„ id å€¼ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748public class QuickFind implements UF { private int[] id; // è¿é€šåˆ†é‡æ ‡è¯†ç¬¦é›†åˆ private int count; // è¿é€šåˆ†é‡æ•°é‡ /** * åˆå§‹åŒ–æ‰€æœ‰è¿é€šåˆ†é‡ */ QuickFind(int N) { count = N; id = new int[N]; for (int i = 0; i &lt; count; i++) { id[i] = i; } } @Override public void union(int p, int q) { int pID = find(p); int qID = find(q); if (pID == qID) { // å·²ç»åœ¨åŒä¸€ä¸ªåˆ†é‡ä¸­ä¸åšå¤„ç† return; } for (int i = 0; i &lt; count; i++) { if (id[i] == pID) { id[i] = qID; } count--; } } @Override public int find(int p) { return id[p]; } @Override public boolean connected(int p, int q) { return id[p] == id[q]; } @Override public int count() { return count; }} å®ç°äºŒï¼šquick-union ç®—æ³•æ•°æ®ç»“æ„ï¼šæ ‘ åŒæ ·ä»¥ id[] è¡¨ç¤ºæ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆè§¦ç‚¹ï¼‰çš„å€¼ï¼Œä½†èŠ‚ç‚¹çš„å€¼ä¸æ˜¯åˆ†é‡çš„å€¼ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹å€¼æ˜¯ä»¥å…¶çˆ¶èŠ‚ç‚¹çš„ç´¢å¼•å·çš„id[]å€¼ï¼Œè¯¥èŠ‚ç‚¹æœ€ç»ˆçš„å€¼æ˜¯æ ¹èŠ‚ç‚¹çš„å€¼ï¼ˆçˆ¶èŠ‚ç‚¹æŒ‡å‘çˆ¶èŠ‚ç‚¹ï¼Œç›´åˆ°æŒ‡å‘æ ¹èŠ‚ç‚¹ï¼‰ã€‚ æ¯”å¦‚èŠ‚ç‚¹4ï¼ˆid[4]=9ï¼‰ æ˜¯ èŠ‚ç‚¹8 çš„çˆ¶èŠ‚ç‚¹ï¼Œé‚£ä¹ˆèŠ‚ç‚¹8id[8]çš„å€¼å°±æ˜¯id[4]ï¼Œå³ï¼šid[8] = id[4] = 9 åˆå§‹åŒ–æ—¶æ¯ä¸ªè§¦ç‚¹çš„å€¼éƒ½æ˜¯è¯¥è§¦ç‚¹çš„ç´¢å¼•ï¼Œå¹¶ä¸”éƒ½æ˜¯æ ¹èŠ‚ç‚¹ã€‚ å±äºåŒä¸€ä¸ªè¿é€šåˆ†é‡çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å±äºåŒä¸€é¢—æ•°ï¼Œåˆ¤æ–­æ˜¯å¦å±äºåŒä¸€åˆ†é‡éœ€è¦åˆ¤æ–­æ˜¯å¦å±äºåŒä¸€æ£µæ ‘ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ ¹èŠ‚ç‚¹ä»£è¡¨åˆ†é‡çš„æ ‡è¯†ç¬¦ã€‚ ä¸¤ä¸ªèŠ‚ç‚¹çš„è”åˆæ“ä½œï¼Œæ“ä½œçš„æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹çš„æ ¹èŠ‚ç‚¹ï¼Œåªéœ€è¦å°†ä¸€ä¸ªæ ¹èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹è®¾ä¸ºå¦å¤–ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œè¿™æ ·ä¸¤ä¸ªèŠ‚ç‚¹ï¼ˆåˆ†é‡ï¼‰è”åˆæˆäº†ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆåˆ†é‡ï¼‰ã€‚ æ¯”å¦‚ï¼šåˆå§‹åŒ–æ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯æ ¹èŠ‚ç‚¹ã€‚ id[0] = 0; id[1] = 1; id[3] = 3; id[7] = 7 â€¦ è”åˆèŠ‚ç‚¹ 0 å’Œ 1ï¼Œå°†id[0]çš„çˆ¶èŠ‚ç‚¹è®¾ä¸ºid[1]ï¼Œå³ï¼šid[0] = id[1] = 1 è”åˆèŠ‚ç‚¹ 3 å’Œ 0ï¼Œå°†id[3]çš„çˆ¶èŠ‚ç‚¹è®¾ä¸ºid[0]ï¼Œå³ï¼šid[3] = id[0] = id[1] = 1 è”åˆèŠ‚ç‚¹ 1 å’Œ 7ï¼Œå°†id[1]çš„çˆ¶èŠ‚ç‚¹è®¾ä¸ºid[7]ï¼Œå³ï¼šid[1] = id [7] = 7ï¼ˆæ­¤æ—¶id[3] = id[0] = id[1] = id [7] = 7ï¼‰ ç®—æ³•åˆ†æå¯ä»¥å¿«é€Ÿè¿›è¡Œ union æ“ä½œï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸ªèŠ‚ç‚¹çš„ id å€¼å³å¯ã€‚ unionæ“ä½œï¼Œå›ºå®šçš„å°†å·¦è¾¹çš„æ ‘é“¾æ¥åˆ°å³è¾¹çš„æ ‘ï¼Œå¯¼è‡´æ ‘çš„æ·±åº¦å¾ˆæ·±ï¼Œè¿›è¡Œfind()æ“ä½œæ—¶æ•ˆç‡å˜ä½ã€‚ ä½†æ˜¯ find æ“ä½œå¼€é”€å¾ˆå¤§ï¼Œå› ä¸ºåŒä¸€ä¸ªè¿é€šåˆ†é‡çš„èŠ‚ç‚¹ id å€¼ä¸åŒï¼Œid å€¼åªæ˜¯ç”¨æ¥æŒ‡å‘å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚å› æ­¤éœ€è¦ä¸€ç›´å‘ä¸ŠæŸ¥æ‰¾æ“ä½œï¼Œç›´åˆ°æ‰¾åˆ°æœ€ä¸Šå±‚çš„èŠ‚ç‚¹ã€‚ è¿™ç§æ–¹æ³•å¯ä»¥å¿«é€Ÿè¿›è¡Œ union æ“ä½œï¼Œä½†æ˜¯ find æ“ä½œå’Œæ ‘é«˜æˆæ­£æ¯”ï¼Œæœ€åçš„æƒ…å†µä¸‹æ ‘çš„é«˜åº¦ä¸ºè§¦ç‚¹çš„æ•°ç›®ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344public class QuickUnion implements UF { private int[] id; // æ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆè§¦ç‚¹ï¼‰ private int count; // è¿é€šåˆ†é‡ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰çš„æ•°é‡ QuickUnion(int N) { count = N; id = new int[N]; for (int i = 0; i &lt; count; i++) { id[i] = i; } } @Override public void union(int p, int q) { // è·å–ä¸¤ä¸ªèŠ‚ç‚¹æ‰€å±åˆ†é‡ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ int pRoot = find(p); int qRoot = find(q); if (pRoot == qRoot) { return; } // æŠŠpçš„æ ¹èŠ‚ç‚¹çš„çˆ¸çˆ¸è®¾ä¸ºqçš„æ ¹èŠ‚ç‚¹ï¼Œè¿™æ ·på’Œqå°±æœ‰äº†å…±åŒçš„çˆ¸çˆ¸ã€‚ id[pRoot] = qRoot; count--; } @Override public int find(int p) { // å½“id[p]çš„å€¼æ˜¯æœ¬èº«ï¼Œè¯´æ˜å®ƒæ˜¯æ ¹èŠ‚ç‚¹ï¼ˆåˆ†é‡åï¼‰ï¼›è‹¥ä¸æ˜¯ï¼Œå‘ä¸Šå¾ªç¯æ‰¾åˆ°æ ¹èŠ‚ç‚¹ã€‚ while (p != id[p]) { p = id[p]; } return p; // æ‰€åœ¨åˆ†é‡å°±æ˜¯æ ¹èŠ‚ç‚¹ } @Override public boolean connected(int p, int q) { return id[p] == id[q]; } @Override public int count() { return count; }} è½¨è¿¹å›¾ï¼š å®ç°ä¸‰ï¼šåŠ æƒ quick-union ç®—æ³•ç®—æ³•åˆ†æåŠ æƒ quick-union ç®—æ³•çš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³ quick-union ä¸­find()æ“ä½œéšç€æ ‘çš„æ·±åº¦åŠ æ·±æˆæœ¬å˜å¾—è¶Šæ¥è¶Šæ˜‚è´µçš„é—®é¢˜ã€‚ ä¸å†å›ºå®šçš„å°†å·¦è¾¹çš„æ ‘é“¾æ¥åˆ°å³è¾¹çš„æ ‘ï¼Œè€Œæ˜¯æ ¹æ®æ ‘çš„æ·±åº¦ï¼ˆèŠ‚ç‚¹çš„ä¸ªæ•°ï¼‰å†³å®šå°†æ·±åº¦å°çš„æ ‘é“¾æ¥åœ¨æ·±åº¦å¤§çš„æ ‘ï¼Œç”±æ­¤é™ä½find()æ“ä½œæ¬¡æ•°ã€‚ æ•°æ®ç»“æ„ å’Œ quick-union ç»“æ„ç›¸åŒï¼Œä»…ä»…æ·»åŠ äº†ä¸€ä¸ªç”¨äºè®°å½•æ¯ä¸ªåˆ†é‡ä¸ªæ•°çš„æ•°ç»„ ä¸å†æ˜¯æŠŠpçš„æ ¹èŠ‚ç‚¹çš„çˆ¸çˆ¸è®¾ä¸ºqçš„æ ¹èŠ‚ç‚¹äº†ï¼Œè€Œæ˜¯æ¯”è¾ƒpçš„åˆ†é‡ä¸ªæ•°å’Œqçš„åˆ†é‡ä¸ªæ•°ï¼Œåˆ†é‡ä¸ªæ•°å°çš„è®¤åˆ†é‡ä¸ªæ•°å¤§çš„å½“çˆ¸çˆ¸ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455public class WeightQuickUnion implements UF { private int[] id; // æ¯ä¸ªè§¦ç‚¹çš„å€¼æ˜¯çˆ¶é“¾æ¥ private int count; // è¿é€šåˆ†é‡ä¸ªæ•° private int[] sz; // å„ä¸ªæ ¹èŠ‚ç‚¹å¯¹åº”çš„åˆ†é‡å¤§å°ï¼ˆèŠ‚ç‚¹ä¸ªæ•°ï¼‰ WeightQuickUnion(int N) { count = N; id = new int[N]; for (int i = 0; i &lt; count; i++) { id[i] = i; } // åˆå§‹åŒ–æ¯ä¸ªæ ¹èŠ‚ç‚¹å¯¹åº”åˆ†é‡çš„å¤§å°éƒ½æ˜¯1 sz = new int[N]; for (int i = 0; i &lt; count; i++) { sz[i] = 1; } } @Override public void union(int p, int q) { int pRoot = find(p); int qRoot = find(q); if (pRoot == qRoot) { return; } // ä¸å†æ˜¯æŠŠpçš„æ ¹èŠ‚ç‚¹çš„çˆ¸çˆ¸è®¾ä¸ºqçš„æ ¹èŠ‚ç‚¹äº†ï¼Œè€Œæ˜¯æ¯”è¾ƒpçš„åˆ†é‡ä¸ªæ•°å’Œqçš„åˆ†é‡ä¸ªæ•°ï¼Œåˆ†é‡ä¸ªæ•°å°çš„è®¤åˆ†é‡ä¸ªæ•°å¤§çš„å½“çˆ¸çˆ¸ if (sz[pRoot] &gt; sz[qRoot]) { id[qRoot] = pRoot; sz[pRoot] += sz[qRoot]; } else { // å½“påˆ†é‡å¤§å° &lt;= qåˆ†é‡å¤§å°æ—¶ï¼Œé»˜è®¤qçš„æ ¹èŠ‚ç‚¹è®¤qçš„æ ¹èŠ‚ç‚¹å½“çˆ¸çˆ¸ id[pRoot] = qRoot; sz[qRoot] += sz[pRoot]; } count--; } @Override public int find(int p) { while (p != id[p]) { p = id[p]; } return p; } @Override public boolean connected(int p, int q) { return find(p) == find(q); } @Override public int count() { return count; }} è½¨è¿¹å›¾ï¼š å®ç°å››ï¼šè·¯å¾„å‹ç¼©çš„åŠ æƒ quick-union ç®—æ³•ç®—æ³•åˆ†æè·¯å¾„å‹ç¼©çš„åŠ æƒ quick-union ç®—æ³•æ˜¯ä¸ºäº†ä¼˜åŒ–find()æ“ä½œï¼Œå‡å°‘æŸ¥æ‰¾çˆ¶èŠ‚ç‚¹çš„æ¬¡æ•°ï¼Œä»è€Œæå‡æŸ¥æ‰¾çš„æ•ˆç‡ï¼› ä½¿ç”¨è·¯å¾„å‹ç¼©çš„åŠ æƒ quick-union ç®—æ³•æ˜¯è§£å†³åŠ¨æ€è¿é€šæ€§é—®é¢˜çš„æœ€ä¼˜è§£ï¼› å®ƒå°†æ¯ä¸€ä¸ªå­èŠ‚ç‚¹éƒ½æŒ‚åœ¨æ ¹èŠ‚ç‚¹å½¢æˆä¸€ä¸ªè¿‘ä¼¼æ‰å¹³çš„æ ‘çŠ¶ç»“æ„ï¼› æ¯æ¬¡æŸ¥æ‰¾æŒ‡å®šèŠ‚ç‚¹çš„æ ¹å…ƒç´ ï¼ˆåˆ†é‡ï¼‰æ—¶ï¼Œéƒ½å°†è·¯å¾„ä¸Šï¼ˆè¯¥èŠ‚ç‚¹çš„æ‰€æœ‰çˆ¶èŠ‚ç‚¹ï¼‰é‡åˆ°æ‰€æœ‰èŠ‚ç‚¹æŒ‚åœ¨æ ¹èŠ‚ç‚¹ä¹‹ä¸‹ï¼› å‹ç¼©åŠ æƒåçš„ç®—æ³•find()æ•ˆç‡ä¸ quick-find çš„æ•ˆç‡éå¸¸æ¥è¿‘ã€‚ 12345678910111213141516171819202122232425262728293031323334public class WeightQuickUnion implements UF { public int pathCompressionFind(int p) { // å…ˆå‘ä¸Šå¾ªç¯æ‰¾åˆ°æ ¹èŠ‚ç‚¹ int root = p; while (root != id[root]) { root = id[root]; } // å†æ¬¡å¾ªç¯ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹ä¸æ˜¯æ ¹èŠ‚ç‚¹ï¼ŒæŠŠå½“å‰èŠ‚ç‚¹æŒ‚åœ¨æ ¹èŠ‚ç‚¹ä¸Šæˆä¸ºæ ¹èŠ‚ç‚¹çš„ä¸€çº§èŠ‚ç‚¹ã€‚ while (p != id[p]) { int tem = p; p = id[p]; id[tem] = root; } return root; } public void union(int p, int q) { int pRoot = pathCompressionFind(p); int qRoot = pathCompressionFind(q); if (pRoot == qRoot) { return; } // ä¸å†æ˜¯æŠŠpçš„æ ¹èŠ‚ç‚¹çš„çˆ¸çˆ¸è®¾ä¸ºqçš„æ ¹èŠ‚ç‚¹äº†ï¼Œè€Œæ˜¯æ¯”è¾ƒpçš„åˆ†é‡ä¸ªæ•°å’Œqçš„åˆ†é‡ä¸ªæ•°ï¼Œåˆ†é‡ä¸ªæ•°å°çš„è®¤åˆ†é‡ä¸ªæ•°å¤§çš„å½“çˆ¸çˆ¸ if (sz[pRoot] &gt; sz[qRoot]) { id[qRoot] = pRoot; sz[pRoot] += sz[qRoot]; } else { // å½“påˆ†é‡å¤§å° &lt;= qåˆ†é‡å¤§å°æ—¶ï¼Œé»˜è®¤qçš„æ ¹èŠ‚ç‚¹è®¤qçš„æ ¹èŠ‚ç‚¹å½“çˆ¸çˆ¸ id[pRoot] = qRoot; sz[qRoot] += sz[pRoot]; } count--; }}","link":"/2018/08/05/ç®—æ³•ç¬¬ä¸€ç«  åŸºç¡€/"},{"title":"ç®—æ³•ç¬¬äºŒç«  æ’åº","text":"ç¬¬äºŒç«  æ’åºå¾…æ’åºçš„å…ƒç´ éœ€è¦å®ç° Java çš„ Comparable æ¥å£ï¼Œè¯¥æ¥å£æœ‰ compareTo() æ–¹æ³•ï¼Œå¯ä»¥ç”¨å®ƒæ¥åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ çš„å¤§å°å…³ç³»ã€‚ å®šä¹‰ç®—æ³•æ¨¡æ¿ç±»API 1234567891011121314151617181920212223242526272829303132333435363738394041424344public abstract class Example { /** * å…·ä½“æ’åºç®—æ³•å®ç° */ public abstract void sort(Comparable[] a); /** * å¯¹å…ƒç´ è¿›è¡Œæ¯”è¾ƒ * @return first &lt; second ? true : false */ public static boolean less(Comparable first, Comparable second) { return first.compareTo(second) &lt; 0; } /** * æŠŠä¸¤ä¸ªå…ƒç´ äº¤æ¢ä½ç½® */ public static void exch(Comparable[] a, int i, int j) { Comparable tem = a[i]; a[i] = a[j]; a[j] = tem; } /** * è¿”å›åºåˆ—æ˜¯å¦æœ‰åºï¼ˆascï¼‰ */ public static boolean isSorted(Comparable[] a) { for (int i = 1; i &lt; a.length; i++) { if (less(a[i], a[i - 1])) { // åé¢çš„å…ƒç´  &lt; å‰é¢çš„å…ƒç´  ä¸æ˜¯å‡åºæ’åˆ— è¿”å›false return false; } } return true; } public static void show(Comparable[] a) { for (int i = 0; i &lt; a.length; i++) { StdOut.print(a[i] + \" \"); } StdOut.println(); }} é€‰æ‹©æ’åºé¦–å…ˆåœ¨æ•°ç»„ä¸­æ‰¾åˆ°æœ€å°çš„å…ƒç´ ï¼Œå°†å…¶å’Œç¬¬ä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼›ç„¶åç»§ç»­åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ ä¹‹åçš„å…ƒç´ ä¸­å¯»æ‰¾æœ€å°å…ƒç´ ï¼Œå°†å…¶å’Œç¬¬äºŒä¸ªå…ƒç´ äº¤æ¢â€¦ å¾ªç¯å¾€å¤ç›´åˆ°å°†æ•´ä¸ªæ•°ç»„æ’åºã€‚ å¤–å¾ªç¯éå†æ•°ç»„çš„æ¯ä¸ªå½“å‰å…ƒç´  å†…å¾ªç¯éå†å½“å‰å…ƒç´ ä¹‹åçš„æ‰€æœ‰å…ƒç´ å¯»æ‰¾æœ€å°å€¼ ç®—æ³•åˆ†æä¼˜ç‚¹ï¼šæ•°æ®ç§»åŠ¨æ¬¡æ•°æœ€å°‘ï¼Œé€‰æ‹©æ’åºçš„äº¤æ¢æ¬¡æ•°å’Œæ•°ç»„é•¿åº¦Næˆçº¿æ€§å…³ç³»ï¼Œå…¶ä»–æ’åºç®—æ³•ä¸å…·å¤‡è¯¥ç‰¹å¾ã€‚ ç¼ºç‚¹ï¼šè¿è¡Œæ—¶é—´ä¸è¾“å…¥ï¼ˆæ•´ä¸ªåºåˆ—çš„å€¼ï¼‰æ— å…³ï¼Œä¸€ä¸ªå€¼ç›¸åŒçš„æˆ–æœ‰åºçš„åºåˆ—å’Œä¸€ä¸ªéšæœºæ— åºçš„åºåˆ—è¿›è¡Œæ’åºçš„æ—¶é—´ä¸€æ ·é•¿ã€‚ 123456789101112131415161718192021public class Selection extends Example { @Override public void sort(Comparable[] a) { int N = a.length; for (int i = 0; i &lt; N; i++) { int minIndex = i; for (int j = i + 1; j &lt; N; j++) { if (less(a[j], a[minIndex])) { minIndex = j; // å¦‚æœåç»­å…ƒç´ å°äºæœ€å°å…ƒç´ ï¼ŒæŠŠåç»­å…ƒç´ ç´¢å¼•èµ‹ç»™æœ€å°å…ƒç´ ç´¢å¼•ã€‚ } exch(a, i, minIndex); // äº¤æ¢åŸæœ€å°å…ƒç´ ä¸æ–°æœ€å°å…ƒç´ ä½ç½® } } } public static void main(String[] args) { String[] a = new In().readAllStrings(); new Selection().sort(a); assert isSorted(a); // éªŒè¯ï¼šç¡®è®¤æ’åºåçš„ç®—æ³•æ˜¯æœ‰åºçš„ï¼Œå½“åºåˆ—å…ƒç´ ç›¸åŒæ—¶æ— æ³•é€šè¿‡éªŒè¯ã€‚ show(a); }} æ’å…¥æ’åºå°†å½“å‰å…ƒç´ æ’å…¥åˆ°å½“å‰å…ƒç´ ä¹‹å‰çš„åˆé€‚ä½ç½® é¦–å…ˆä»æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆç›®æ ‡å…ƒç´ ï¼‰å¼€å§‹ï¼Œå½“ç›®æ ‡å…ƒç´ å°äºå‰é¢çš„å…ƒç´ ï¼Œäº¤æ¢ä¸¤è€…ä½ç½®ï¼ˆå¦åˆ™ä¸å˜ï¼‰ï¼›ç„¶åç›®æ ‡å…ƒç´ å˜ä¸ºç¬¬ä¸‰ä¸ªå…ƒç´ ï¼Œå°†å…¶ä¸ç¬¬äºŒä¸ªå…ƒç´ æ¯”è¾ƒï¼Œè‹¥å°åˆ™äº¤æ¢ä½ç½®ï¼ˆæ­¤æ—¶ç›®æ ‡å…ƒç´ ç´¢å¼•ä¸º1ï¼‰ï¼Œå†å°†å…¶ä¸ç¬¬ä¸€ä¸ªå…ƒç´ å¯¹æ¯”ï¼Œå¾ªç¯å¾€å¤â€¦ å¤–å¾ªç¯éå†æ¯ä¸€ä¸ªéœ€è¦æ’å…¥çš„ç›®æ ‡å…ƒç´  å†…å¾ªç¯å°†ç›®æ ‡å…ƒç´ ä¸å…¶å·¦è¾¹çš„æ¯ä¸€ä¸ªå…ƒç´ å¯¹æ¯”ã€äº¤æ¢ä½ç½®ï¼Œç›´è‡³ç›®æ ‡å…ƒç´ è¢«æ’å…¥åˆ°äº†åˆé€‚çš„ä½ç½®ã€‚ ç›®æ ‡å…ƒç´ ï¼ˆa[i]ï¼‰ä»å·¦åˆ°å³ç§»åŠ¨æ—¶ï¼Œå…¶å·¦ä¾§çš„å…ƒç´ å§‹ç»ˆæ—¶æœ‰åºçš„ï¼Œå½“å…¶ç§»åŠ¨åˆ°äº†æœ€å³è¾¹ï¼Œæ•°ç»„ä¹Ÿå®Œæˆäº†æ’åºã€‚ ç®—æ³•åˆ†ææ’å…¥æ’åºæ‰€éœ€çš„æ—¶é—´å–å†³äºæ•°ç»„ä¸­å…ƒç´ çš„åˆå§‹ä½ç½®ã€‚å› ä¸ºå½“å…ƒç´ æœ‰åºæ—¶ä¸ä¼šè¿›è¡Œäº¤æ¢ï¼Œå¯¹äºä¸€ä¸ªå…ƒç´ å¾ˆå¤§çš„ä¸”å…ƒç´ æœ‰åºï¼ˆæˆ–æ¥è¿‘æœ‰åºï¼‰çš„åºåˆ—è¿›è¡Œæ’åºä¼šæ¯”éšæœºé¡ºåºçš„åºåˆ—è¿›è¡Œæ’åºè¦å¿«å¾—å¤šã€‚ 12345678910111213public class Insertion extends Example { @Override public void sort(Comparable[] a) { int N = a.length; for (int i = 1; i &lt; N; i++) { // å°†å½“å‰å…ƒç´  a[i] ä¸ å…¶å·¦è¾¹çš„æ‰€æœ‰å…ƒç´ å¯¹æ¯”ã€äº¤æ¢ä½ç½® for (int j = i; j &gt; 0 &amp;&amp; less(a[j], a[j - 1]); j--) { // åé¢çš„å…ƒç´ æ¯”å‰é¢çš„å…ƒç´ å°æ‰è¿›è¡Œæ’åº exch(a, j, j - 1); } } }} å¤§å¹…åº¦æé«˜æ’å…¥æ’åºçš„é€Ÿåº¦ï¼Œåªéœ€è¦åœ¨å†…å¾ªç¯ä¸­å°†è¾ƒå¤§çš„å…ƒç´ å‘å³ç§»åŠ¨è€Œä¸æ€»æ˜¯äº¤æ¢ä¸¤ä¸ªå…ƒç´ ï¼ˆè¿™æ ·è®¿é—®æ•°ç»„çš„æ¬¡æ•°ä¼šå‡åŠï¼‰ï¼Œå®ç°è§ ç»ƒä¹ ã€‚ 12345678910111213public class Ex25 extends Example { public void sort(Comparable[] a) { int n = a.length; for (int i = 1; i &lt; n; i++) { Comparable target = a[i]; // ä¿å­˜ç›®æ ‡å…ƒç´ çš„å€¼ int j; // ä¿å­˜ç›®æ ‡å…ƒç´ åº”è¯¥æ’å…¥çš„ä½ç½® for (j = i; j &gt; 0 &amp;&amp; less(target, a[j - 1]); j--) { a[j] = a[j - 1]; // å‰é©±å…ƒç´ åç§» } a[j] = target; } }} é€‰æ‹©æ’åºä¸æ’å…¥æ’åºæ¯”è¾ƒä»ç›´è§‚ä¸Šæ¥è¯´ï¼š é€‰æ‹©æ’åºä¸ä¼šè®¿é—®ç´¢å¼•å·¦ä¾§çš„å…ƒç´ ï¼ˆæ¯æ¬¡éƒ½æ˜¯ä»ç›®æ ‡å…ƒç´ çš„ç´¢å¼•å³è¾¹éå†æ‰€æœ‰å…ƒç´ å–æœ€å°å€¼è¿›è€Œä¸ç›®æ ‡å…ƒç´ äº¤æ¢ä½ç½®ï¼‰ æ’å…¥æ’åºä¸ä¼šè®¿é—®ç´¢å¼•å³ä¾§çš„å…ƒç´ ï¼ˆæ¯æ¬¡éƒ½æ˜¯ç›®æ ‡å…ƒç´ ä¸å…¶å·¦è¾¹çš„æ¯ä¸€ä¸ªå…ƒç´ åšå¯¹æ¯”è¿›è€Œäº¤æ¢ä½ç½®ï¼‰ é¦–å…ˆè§„å®šè¾“å…¥æ¨¡å‹ï¼šæ•°ç»„ä¸­çš„å…ƒç´ éšæœºæ’åºï¼Œä¸”ä¸»é”®å€¼ä¸é‡å¤ã€‚ é€Ÿåº¦å¯¹æ¯”ï¼š 1000æ¡æ•°æ®æ’åº100æ¬¡ï¼Œé€‰æ‹©æ’åºèŠ±è´¹0.4sï¼Œæ’å…¥æ’åºèŠ±è´¹0.1sï¼› 10000æ¡æ•°æ®æ’åº100æ¬¡ï¼Œé€‰æ‹©æ’åºèŠ±è´¹43.6sï¼Œæ’å…¥æ’åºèŠ±è´¹10.2sï¼› ç»“è®ºï¼š å¯¹äºéšæœºæ’åºçš„æ— é‡å¤ä¸»é”®ï¼Œæ’å…¥æ’åºå’Œé€‰æ‹©æ’åºçš„è¿è¡Œæ—¶é—´éƒ½æ˜¯å¹³æ–¹çº§åˆ«çš„ã€‚ 123456789101112131415161718192021222324252627282930313233343536public class SortCompare { public static double time(String alg, Comparable[] a) { StopWatch watch = new StopWatch(); if (alg.equals(\"Insertion\")) { new Insertion().sort(a); } if (alg.equals(\"Selection\")) { new Selection().sort(a); } return watch.elapsedTime(); } //ä½¿ç”¨algç®—æ³•å°†é•¿åº¦ä¸ºNçš„æ•°ç»„æ’åºTæ¬¡ public static double timeRandomInput(String alg, int N, int T) { double total = 0.0; Double[] a = new Double[N]; // ç›®æ ‡æ•°ç»„ for (int t = 0; t &lt; T; t++) { for (int i = 0; i &lt; N; i++) { a[i] = StdRandom.uniform(); // ç”Ÿæˆéšæœºå€¼ } total += time(alg, a); // è®¡ç®—Tæ¬¡æ—¶é—´æ€»å’Œ } return total; } public static void main(String[] args) { String alg1 = args[0]; String alg2 = args[1]; int N = Integer.parseInt(args[2]); int T = Integer.parseInt(args[3]); double t1 = timeRandomInput(alg1, N, T); // ç®—æ³•1çš„æ€»æ—¶é—´ double t2 = timeRandomInput(alg2, N, T); // ç®—æ³•2çš„æ€»æ—¶é—´ StdOut.printf(\"the %s algorithm takes %.1f seconds.\\n\", alg2, t2); StdOut.printf(\"the %s algorithm takes %.1f seconds.\\n\", alg1, t1); }} å¸Œå°”æ’åºå¸Œå°”æ’åºæ˜¯æ’å…¥æ’åºçš„å¢å¼ºç‰ˆï¼Œæ˜¯ä¸ºäº†æ”¹è¿›æ’å…¥æ’åºå¯¹äºå¤„ç†å¤§è§„æ¨¡ä¹±åºæ•°ç»„æ’åºé€Ÿåº¦è¿‡æ…¢çš„é—®é¢˜ã€‚å®è´¨ä¸Šæ˜¯åˆ†ç»„æ’å…¥æ’åºï¼Œè¯¥æ–¹æ³•åˆç§°ç¼©å°å¢é‡æ’åºã€‚ è¯¥æ–¹æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šå…ˆå°†æ•´ä¸ªå¾…æ’å…ƒç´ åºåˆ—åˆ†å‰²æˆè‹¥å¹²ä¸ªå­åºåˆ—ï¼ˆç”±ç›¸éš”æŸä¸ªâ€œå¢é‡â€çš„å…ƒç´ ç»„æˆçš„ï¼‰åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œç„¶åä¾æ¬¡ç¼©å‡å¢é‡å†è¿›è¡Œæ’åºï¼Œå¾…æ•´ä¸ªåºåˆ—ä¸­çš„å…ƒç´ åŸºæœ¬æœ‰åºï¼ˆå¢é‡è¶³å¤Ÿå°ï¼‰æ—¶ï¼Œå†å¯¹å…¨ä½“å…ƒç´ è¿›è¡Œä¸€æ¬¡ç›´æ¥æ’å…¥æ’åºã€‚å› ä¸ºç›´æ¥æ’å…¥æ’åºåœ¨å…ƒç´ åŸºæœ¬æœ‰åºçš„æƒ…å†µä¸‹ï¼ˆæ¥è¿‘æœ€å¥½æƒ…å†µï¼‰ï¼Œæ•ˆç‡æ˜¯å¾ˆé«˜çš„ï¼Œå› æ­¤å¸Œå°”æ’åºåœ¨æ—¶é—´æ•ˆç‡ä¸Šæ¯”å‰ä¸¤ç§æ–¹æ³•æœ‰è¾ƒå¤§æé«˜ã€‚ åºåˆ—åˆ†ç»„è½¨è¿¹å›¾ï¼š å‚è€ƒï¼šhttps://blog.csdn.net/IWantToHitRen/article/details/51583047 å¯¹äºå¸Œå°”æ’åºå’Œæ’å…¥æ’åºé€Ÿåº¦çš„å¯¹æ¯”ï¼š 10000æ¡æ•°æ®æ’åº100æ¬¡ï¼Œæ’å…¥æ’åºç”¨æ—¶12.3sï¼Œå¸Œå°”æ’åºç”¨æ—¶0.3s!ï¼› 50000æ¡æ•°æ®æ’åº100æ¬¡ï¼Œæ’å…¥æ’åºç”¨æ—¶380.7sï¼Œå¸Œå°”æ’åºç”¨æ—¶1.8s!ï¼› ä»¥ä¸‹æ˜¯ç»“åˆç½‘ä¸Šå¯¹å¸Œå°”æ’åºçš„ç†è§£å®ç°çš„ç®—æ³•ä»¥åŠã€Šç®—æ³• ç¬¬å››ç‰ˆã€‹åŸæ–‡ä¸­çš„ç®—æ³•ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940public class Shell extends Example { /** * æ ¹æ®ç½‘ä¸Šæ€»ç»“è‡ªå·±å®ç°çš„ç®—æ³• */ @Override public void sort(Comparable[] a) { int N = a.length; for (int gap = N / 2; gap &gt; 0; gap /= 2) { // gapï¼šå¢é‡ï¼ˆæ­¥æ•°ï¼‰ï¼Œæ¯æ¬¡å¾ªç¯å¢é‡å‡å°‘ä¸€å€ï¼Œç›´è‡³å¢é‡ä¸º1ï¼ˆæ­¤æ—¶å¯¹å…¨éƒ¨å…ƒç´ è¿›è¡Œæ’å…¥æ’åºï¼‰å®Œæˆæ’åºã€‚ for (int i = 0; i &lt; gap; i++) { // æŠŠæ•´ä½“åºåˆ—åˆ†ä¸ºè‹¥å¹²å­åºåˆ—ã€‚a[i]æ˜¯æ¯ä¸€ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´  for (int j = i + gap; j &lt; N; j += gap) { // æ¯é—´éš”ä¸€ä¸ªå¢é‡ï¼Œè·å¾—ä¸€ä¸ªè¯¥ç»„çš„å…ƒç´ ã€‚ int tarIndex = j; // ç›®æ ‡å…ƒç´ ç´¢å¼•ï¼Œå½“å‰å…ƒç´ ç´¢å¼•ã€‚ for (int k = tarIndex; k &gt; i &amp;&amp; less(a[k], a[k - gap]); k -= gap) { // å¯¹å­åºåˆ—è¿›è¡Œæ’å…¥æ’åºï¼Œå°†è¯¥å…ƒç´ ä¸æœ¬ç»„å·¦è¾¹æ‰€æœ‰å…ƒç´ è¿›è¡Œæ¯”è¾ƒã€‚ exch(a, k, k - gap); } } } } } /** * åŸæ–‡çš„ç®—æ³•ï¼Œå¢é‡ä½¿ç”¨äº†é€’å¢åºåˆ—ï¼Œæœ‰æ—¶é—´å†æ¥ç†è§£ã€‚ */ public void sort3(Comparable[] a) { int N = a.length; int h = 1; while (h &lt; N / 3) { h = 3 * h + 1; } while (h &gt;= 1) { // å­æ•°ç»„æ’å…¥æ’åº for (int i = h; i &lt; N; i++) { for (int j = i; j &gt;= h &amp;&amp; less(a[j], a[j - h]); j -= h) { exch(a, j, j - h); } } h = h / 3; } }} å½’å¹¶æ’åºå½’å¹¶æ’åºçš„æ ¸å¿ƒæ˜¯å½’å¹¶æ“ä½œï¼Œå½’å¹¶æ’åºæ¯æ¬¡å°†æ•°ç»„ é€’å½’çš„ æ‹†åˆ†æˆä¸¤åŠåˆ†åˆ«æ’åºï¼Œå†å°†ä¸¤åŠçš„ç»“æœ åˆå¹¶ èµ·æ¥æœ€ç»ˆå®ç°æ•´ä¸ªæ•°ç»„çš„æ’åºã€‚ å½’å¹¶æ“ä½œå½’å¹¶æ“ä½œçš„å‰ææ˜¯æ•°ç»„çš„ä¸¤è¾¹æ˜¯åˆ†åˆ« æœ‰åº çš„ï¼Œå°†ä¸€ä¸ªâ€œä¸¤è¾¹æœ‰åºçš„æ•°ç»„â€åˆå¹¶æˆä¸€ä¸ªâ€œæ•´ä½“æœ‰åºçš„æ•°ç»„â€ã€‚ 1234567891011121314151617181920212223242526public class Merge extends Example { private static Comparable aux[]; // è¾…åŠ©æ•°ç»„ï¼Œç”¨äºåˆå¹¶æ“ä½œã€‚ //TODO sort() public static void merge(Comparable[] a, Comparable[] aux, int lo, int mid, int hi) { int le = lo; int ri = mid + 1; for (int k = lo; k &lt;= hi; k++) { aux[k] = a[k]; } for (int k = lo; k &lt;= hi; k++) { if (le &gt; mid) { a[k] = aux[ri++]; // å·¦è¾¹å…ƒç´ ç”¨å°½ï¼Œå°†å³è¾¹å…ƒç´ ä¸€ä¸ªä¸€ä¸ªæ”¾å…¥a[] } else if (ri &gt; hi) { a[k] = aux[le++]; // å³è¾¹å…ƒç´ ç”¨å°½ï¼Œå°†å·¦è¾¹å…ƒç´ ä¸€ä¸ªä¸€ä¸ªæ”¾å…¥a[] } else if (less(aux[ri], aux[le])) { a[k] = aux[ri++]; // å³è¾¹å…ƒç´ å°äºå·¦è¾¹å…ƒç´ ï¼Œå³è¾¹å…ƒç´ æ”¾å…¥a[]ï¼Œå³è¾¹å…ƒç´ ç´¢å¼•+1 } else { a[k] = aux[le++]; // å·¦è¾¹å…ƒç´ å°äºå³è¾¹å…ƒç´ ï¼Œå·¦è¾¹å…ƒç´ æ”¾å…¥a[]ï¼Œå·¦è¾¹å…ƒç´ ç´¢å¼•+1 } } }} è‡ªé¡¶å‘ä¸‹å½’å¹¶æ’åºå½’å¹¶æ’åºä¸æ–­ï¼ˆé€’å½’ï¼‰çš„å°†å¤§æ•°ç»„æ’æ‹†åˆ†ä¸ºä¸¤åŠï¼Œç›´åˆ°ä¸å¯å†æ‹†ï¼ˆå°æ•°ç»„ä»…å‰©â€œå·¦å³â€ä¸¤ä¸ªå…ƒç´ ï¼‰ï¼Œå†å°†ä¸¤è¾¹çš„æ•°ç»„åˆå¹¶æˆä¸€ä¸ªæ•´ä½“æœ‰åºçš„å¤§æ•°ç»„ã€‚ 1234567891011121314151617public class Merge extends Example { private static Comparable aux[]; // è¾…åŠ©æ•°ç»„ï¼Œç”¨äºåˆå¹¶æ“ä½œã€‚ @Override public void sort(Comparable[] a) { aux = new Comparable[a.length]; sort(a, 0, a.length - 1); } private void sort(Comparable[] a, int lo, int hi) { if (hi &lt;= lo) return; int mid = lo + (hi - lo) / 2; sort(a, lo, mid); // å·¦åŠè¾¹æ’åº sort(a, mid + 1, hi); // å³åŠè¾¹æ’åº merge(a, aux, lo, mid, hi); // åˆå¹¶å­æ•°ç»„ }} æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ merge() æ“ä½œå½¢æˆçš„å­æ•°ç»„ã€‚å½“æ•°ç»„ä¸å¯å†åˆ†ï¼ˆé€’å½’åˆ°äº†æœ€å°æƒ…å†µï¼‰ï¼Œmerge()é€šè¿‡äº¤æ¢å‰åå…ƒç´ å®ç°æ’åºã€‚ æ”¹è¿›å¯¹äºå°è§„æ¨¡æ•°ç»„ä½¿ç”¨æ’å…¥æ’åº æµ‹è¯•æ•°ç»„æ˜¯å¦æœ‰åº æœ‰å‚è€ƒä»·å€¼åšå®¢ï¼šå›¾è§£æ’åºç®—æ³•(å››)ä¹‹å½’å¹¶æ’åº è‡ªåº•å‘ä¸Šå½’å¹¶æ’åºå…ˆå½’å¹¶å¾®å‹æ•°ç»„ï¼Œå†æˆå¯¹å½’å¹¶å¾—åˆ°çš„å­æ•°ç»„ï¼Œç›´åˆ°å½’å¹¶å½¢æˆä¸€ä¸ªå¤§æ•°ç»„ï¼Œæ’åºç»“æŸã€‚ ç¬¬ä¸€è½®ï¼šå°†å¤§æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ å½“ä½œä¸€ä¸ªå­æ•°ç»„ï¼ˆæœ€å°çš„å­æ•°ç»„ï¼‰ï¼Œä¸¤ä¸¤å½’å¹¶ å­æ•°ç»„ï¼ˆå°†å¤§å°ä¸º1çš„å­æ•°ç»„å½’å¹¶æˆå¤§å°ä¸º2çš„å­æ•°ç»„ï¼‰ã€‚ ç¬¬äºŒè½®ï¼šä¸€è½®å½’å¹¶ä¹‹åæ¯ä¸ªå­æ•°ç»„å­˜åœ¨ 2 ä¸ªå…ƒç´ ï¼Œå† å››å››å½’å¹¶ å­æ•°ç»„ï¼ˆå°†å¤§å°ä¸º2çš„å­æ•°ç»„å½’å¹¶ä¸ºå¤§å°ä¸º4çš„å­æ•°ç»„ï¼‰ã€‚ ç¬¬ä¸‰è½®ï¼šäºŒè½®å½’å¹¶ä¹‹åæ¯ä¸ªå­æ•°ç»„å­˜åœ¨ 4 ä¸ªå…ƒç´ ï¼Œå† å…«å…«å½’å¹¶ å­æ•°ç»„ï¼ˆå°†å¤§å°ä¸º4çš„å­æ•°ç»„å½’å¹¶ä¸ºå¤§å°ä¸º8çš„å­æ•°ç»„ï¼‰ã€‚ â€¦â€¦ å¦‚æ­¤å¾€å¤ï¼Œç›´åˆ°å­æ•°ç»„å¤§å° &gt;= å¾…æ’åºçš„å¤§æ•°ç»„ï¼Œå®Œæˆäº†æ’åºã€‚ 123456789101112131415161718192021222324public class MergeBU extends Example { private static Comparable aux[]; @Override public void sort(Comparable[] a) { int N = a.length; aux = new Comparable[N]; for (int sz = 1; sz &lt; N; sz = sz + sz) { // æ§åˆ¶å­æ•°ç»„å¤§å°å‘ˆå€æ•°é€’å¢ /** * éå†æ¯ä¸ªå­æ•°ç»„ * lo æ¯ä¸ªå­æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´  * lo &lt; N - sz æ§åˆ¶æœ€åä¸€ä¸ªå­æ•°ç»„çš„å¼€å¤´ * lo = lo + sz + sz è·³åˆ°ä¸‹ä¸€ä¸ªå­æ•°ç»„å¼€å¤´ * Math.min(lo + sz + sz - 1, N - 1) æœ€åä¸€ä¸ªå­æ•°ç»„çš„å¤§å°æœ‰å¯èƒ½ä¸æ˜¯szçš„æ•´æ•°å€ï¼Œlo + sz + sz - 1å¯èƒ½ä¼šå‡ºç°æ•°ç»„è¶Šç•Œã€‚ */ for (int lo = 0; lo &lt; N - sz; lo = lo + sz + sz) { int mid = lo + sz - 1; int hi = Math.min(lo + sz + sz - 1, N - 1); merge(a, aux, lo, mid, hi); } } assert isSorted(a); }} å¯è§†å›¾ï¼š å¿«é€Ÿæ’åºå¿«é€Ÿæ’åºåŒå½’å¹¶æ’åºä¸€æ ·æ˜¯ä¸€ç§åˆ†æ²»çš„æ’åºç®—æ³•ã€‚å®ƒé€šè¿‡ åˆ‡åˆ† é€’å½’çš„å°†æ•°ç»„åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¯¹ä¸¤ä¸ªéƒ¨åˆ†åˆ†åˆ«æ’åºï¼Œå¹¶ä¿è¯å·¦è¾¹çš„å…ƒç´ éƒ½ &lt;= åˆ‡ç‚¹ï¼Œå³è¾¹çš„å…ƒç´ éƒ½ &gt;= åˆ‡ç‚¹ã€‚ æ¯æ¬¡åˆ‡åˆ†éƒ½èƒ½ä¿è¯å­æ•°ç»„å·¦è¾¹çš„å…ƒç´ å°äºåˆ‡ç‚¹ï¼Œå³è¾¹çš„å…ƒç´ å¤§äºåˆ‡ç‚¹ã€‚é€šè¿‡é€’å½’ï¼Œå¯¹å·¦åŠè¾¹å’Œå³åŠè¾¹æ•°ç»„å†æ¬¡åˆ‡åˆ†ï¼Œæœ€ç»ˆè¾¾åˆ°æ•´ä¸ªæ•°ç»„çš„æœ‰åºã€‚ åˆ‡åˆ†ç®—æ³•ï¼š åˆ‡ç‚¹å®šä¸ºå­æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå¯ä»¥æ˜¯ä»»æ„å…ƒç´ ï¼‰ æŒ‡é’ˆ i ä»å·¦å¾€å³æ‰«æ å¤§äº åˆ‡ç‚¹çš„å€¼ï¼Œæ‰¾åˆ°å³é€€å‡ºæ‰«æï¼›æŒ‡é’ˆ j ä»å³å¾€å·¦æ‰«æ å°äº åˆ‡ç‚¹çš„å€¼ï¼Œæ‰¾åˆ°å³é€€å‡ºæ‰«æã€‚ äº¤æ¢ a[i] ä¸ a[j] çš„ä½ç½®ï¼Œå°çš„å€¼æ”¾åœ¨å·¦è¾¹ï¼Œå¤§çš„å€¼æ”¾åœ¨å³è¾¹ã€‚ è‹¥ i æ‰«æå®Œæ¯•æ‰¾ä¸åˆ°æœ€å¤§å€¼ï¼Œè¯´æ˜ åˆ‡ç‚¹ å°±æ˜¯æœ€å¤§å€¼ï¼›è‹¥ j æ‰«æå®Œæ¯•æ‰¾ä¸åˆ°æœ€å°å€¼ï¼Œè¯´æ˜ åˆ‡ç‚¹ å°±æ˜¯æœ€å°å€¼ ä¸ºä»€ä¹ˆæŒ‡é’ˆç›¸é‡(i &gt;= j)åˆ‡åˆ†ç»“æŸï¼Ÿå› ä¸ºç›¸é‡äº†ä»£è¡¨æ‰€æœ‰å…ƒç´ éƒ½å·²éå†å®Œæ¯•ã€‚ æŒ‡é’ˆç›¸é‡ï¼ˆåŒå‘æ‰«æå®Œæ¯•ï¼‰ä¹‹åï¼Œäº¤æ¢ åˆ‡ç‚¹(v) ä¸ a[j] çš„å€¼ï¼Œæ­¤æ—¶a[j]æ˜¯æœ€åä¸€ä¸ªå°äº v çš„å€¼ï¼Œè€Œåˆ‡ç‚¹åˆ°äº†æ•°ç»„ä¸­é—´ï¼Œæœ€åè¿”å›åˆ‡ç‚¹ç´¢å¼•ã€‚ åšå®¢å‚è€ƒï¼Œå¯¹äºç†è§£å¾ˆæœ‰å¸®åŠ©ï¼šååœ¨é©¬æ¡¶ä¸Šçœ‹ç®—æ³•ï¼šå¿«é€Ÿæ’åº 12345678910111213141516171819202122232425262728293031public class Quick extends Example { @Override public void sort(Comparable[] a) { StdRandom.shuffle(a); sort(a, 0, a.length - 1); } private void sort(Comparable[] a, int lo, int hi) { if (hi &lt;= lo) return; int j = partition(a, lo, hi); // åˆ‡åˆ† sort(a, lo, j - 1); // å·¦åŠè¾¹æ’åº sort(a, j + 1, hi); // å³åŠè¾¹æ’åº } private int partition(Comparable[] a, int lo, int hi) { int i = lo, j = hi + 1; // å·¦å³æ‰«æçš„æŒ‡é’ˆ Comparable v = a[lo]; // åˆ‡åˆ†çš„å…ƒç´  while (true) { while (less(a[++i], v)) { // æŒ‡é’ˆ i ä»å·¦å¾€å³æ‰«æå¤§äºvçš„å€¼ if (i == hi) break; } while (less(v, a[--j])) { // æŒ‡é’ˆ j ä»å³å¾€å·¦æ‰«æå°äºvçš„å€¼ if (j == lo) break; } if (i &gt;= j) break; // ä¸ºä»€ä¹ˆ i &gt;= j é€€å‡ºå¤–å¾ªç¯ï¼Ÿ exch(a, i, j); // å°å€¼æ”¾å·¦è¾¹ï¼Œå¤§å€¼æ”¾å³è¾¹ã€‚ } exch(a, lo, j); return j; }} å¿«é€Ÿæ’åºæœ€å¥½çš„æƒ…å†µä¸‹æ˜¯æ¯æ¬¡éƒ½æ­£å¥½èƒ½å°†æ•°ç»„å¯¹åŠåˆ†ï¼Œè¿™æ ·é€’å½’è°ƒç”¨æ¬¡æ•°æ‰æ˜¯æœ€å°‘çš„ã€‚ æœ€åçš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸€æ¬¡ä»æœ€å°çš„å…ƒç´ åˆ‡åˆ†ï¼Œç¬¬äºŒæ¬¡ä»ç¬¬äºŒå°çš„å…ƒç´ åˆ‡åˆ†ï¼Œå¦‚æ­¤è¿™èˆ¬ã€‚ä¸ºäº†é˜²æ­¢æ•°ç»„æœ€å¼€å§‹å°±æ˜¯æœ‰åºçš„ï¼Œåœ¨è¿›è¡Œå¿«é€Ÿæ’åºæ—¶éœ€è¦éšæœºæ‰“ä¹±æ•°ç»„ã€‚ æ”¹è¿› å¯¹äºå°æ•°ç»„ï¼Œä½¿ç”¨æ’å…¥æ’åºã€‚åªéœ€å°†é€’å½’ç»“æŸæ¡ä»¶ä» if (hi &lt;= lo) return; æ”¹ä¸ºï¼šif (hi &lt;= lo + 15) { new Insertion().sort(a); return; } ä¸‰å–æ ·åˆ‡åˆ†ï¼šé€‰å–è¾ƒä¼˜çš„åˆ‡ç‚¹å…ƒç´ æ¥æé«˜æ€§èƒ½ã€‚å°†å­æ•°ç»„çš„ä¸€å°éƒ¨åˆ†å…ƒç´ ä¸­çš„ä¸­ä½æ•°ä½œä¸ºåˆ‡ç‚¹æ¥åˆ‡åˆ†æ•°ç»„æ•ˆæœä¸ºå¥½ï¼Œä¸€èˆ¬å–3ä¸ªå…ƒç´ ã€‚å‚è€ƒï¼šå›¾è§£æ’åºç®—æ³•(äº”)ä¹‹å¿«é€Ÿæ’åºâ€”â€”ä¸‰æ•°å–ä¸­æ³• å¯¹äºå«æœ‰å¤§é‡é‡å¤å…ƒç´ çš„æ•°ç»„ï¼Œè¯¥ç®—æ³•è¿˜æ˜¯ä¼šç»§ç»­åˆ‡åˆ†æ•°ç»„ï¼Œå¢åŠ ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚è§£å†³æ–¹æ¡ˆï¼šä¸‰å‘åˆ‡åˆ†ç®—æ³•ï¼šQuick3way.java ä»¥ä¸Šæ”¹è¿› å‡æœªï¼å®ç°ï¼å¤ªæè„‘å­äº†ğŸ˜£~~~ ä¼˜å…ˆé˜Ÿåˆ—åœ¨æŸäº›æ‹¥æœ‰å¤§é‡è¾“å…¥Nï¼ˆæ•°åäº¿ç”šè‡³æ— é™ï¼‰çš„ç”¨ä¾‹ä¸­ï¼Œéœ€è¦åœ¨å¤§é‡è¾“å…¥ä¸­å–æœ€å¤§ï¼ˆæˆ–æœ€å°ï¼‰çš„å‰Mä¸ªå€¼ã€‚è§£å†³è¿™ç§éœ€æ±‚ï¼Œæ•°ç»„æ’åºçš„ä»£ä»·ç‰¹åˆ«é«˜æ˜‚ï¼ŒåŸå› æœ‰2ç‚¹ï¼š1. æ•°æ®é‡ç‰¹åˆ«å¤§ï¼Œä¸å¯èƒ½å°†åäº¿ä¸ªæ•°æ”¾è¿›æ•°ç»„æ’åºï¼Œæœ‰å¯èƒ½å†…å­˜éƒ½è£…ä¸ä¸‹ï¼›2. åªéœ€è¦å–å‰Mçš„æœ‰åºçš„å€¼ï¼Œå¹¶ä¸éœ€è¦å°†æ‰€æœ‰æ•°æ®æ’åºï¼Œç”šè‡³éƒ½æ— æ³•è·å–å…¨éƒ¨çš„æ•°æ®ã€‚ ä¼˜å…ˆé˜Ÿåˆ—å¯ä»¥è§£å†³è¿™ç±»é—®é¢˜ï¼Œæœ‰äº†ä¼˜å…ˆé˜Ÿåˆ—ï¼Œåªéœ€è¦åˆ›å»ºä¸€ä¸ªå¤§å°ä¸ºMçš„é˜Ÿåˆ—å³å¯ä»£æ›¿åˆ›å»ºå¤§å°ä¸ºæ€»æ•°æ®é‡Nçš„æ•°ç»„ã€‚ API æ–¹æ³• æè¿° MaxPQ() åˆ›å»ºä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ— MaxPQ(int max) åˆ›å»ºä¸€ä¸ªåˆå§‹å®¹é‡çš„ä¼˜å…ˆé˜Ÿåˆ— MaxPQ(Key[] arr) ç”¨arr[]ä¸­çš„å…ƒç´ åˆ›å»ºä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ— void insert(Key v) å‘ä¼˜å…ˆé˜Ÿåˆ—æ’å…¥ä¸€ä¸ªå…ƒç´  Key max() è¿”å›æœ€å¤§å…ƒç´  Key delMax() åˆ é™¤æœ€å¤§å…ƒç´  boolean isEmpty() åˆ¤æ–­æ˜¯å¦ä¸ºç©º int size() æŸ¥çœ‹é˜Ÿåˆ—å¤§å° åˆçº§å®ç°åŸºäºæ— åºæ•°ç»„çš„ä¼˜å…ˆé˜Ÿåˆ—ï¼šMaxPQ4DisArray.java åŸºäºæœ‰åºæ•°ç»„çš„ä¼˜å…ˆé˜Ÿåˆ—ï¼šMaxPQ4Array.java åŸºäºæ— åºé“¾è¡¨æ ˆçš„ä¼˜å…ˆé˜Ÿåˆ—ï¼šMaxPQ4Linked.java åŸºäºå †çš„ä¼˜å…ˆé˜Ÿåˆ—äºŒå‰å †çš„å®šä¹‰ä¸è¡¨ç¤ºæ³• äºŒå‰å †ï¼ˆå®Œå…¨äºŒå‰æ ‘ï¼Œä¹‹ä¸è¿‡åœ¨è¿™å«åšå †ï¼‰æ˜¯ä¸€ç§åŸºäºæ•°ç»„çš„æ•°æ®ç»“æ„ã€‚æ—¢ç„¶æ˜¯æ ‘å½¢ç»“æ„ï¼Œå¿…ç„¶æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹ä¸‹é¢æŒ‚ç€ï¼ˆä¸€ä¸ªæˆ–ï¼‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œæ¯ä¸ªå­èŠ‚ç‚¹ä½œä¸ºçˆ¶èŠ‚ç‚¹åˆæŒ‚ç€ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚åŒçº§èŠ‚ç‚¹ä¹‹é—´æ— å…³é¡ºåºï¼Œçˆ¶èŠ‚ç‚¹å¤§äºç­‰äºå­èŠ‚ç‚¹ã€‚å½“ä¸€ä¸ªäºŒå‰æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å¤§äºç­‰äºå®ƒçš„ä¸¤ä¸ªå­èŠ‚ç‚¹æ—¶ï¼Œè¢«ç§°ä¹‹ä¸ºâ€œå †æœ‰åºâ€ã€‚ å¦‚ä½•ç”¨æ•°ç»„å­˜å‚¨å…·æœ‰å±‚çº§é¡ºåºå…³ç³»çš„äºŒå‰å †å‘¢ï¼Ÿ é¦–å…ˆï¼ŒäºŒå‰å †åœ¨æ•°ç»„ä¸­æŒ‰ç´¢å¼•ä½ç½® 1 å¼€å§‹å­˜å‚¨ï¼ˆä¸ä½¿ç”¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ åœ¨ä¸€ä¸ªå †ä¸­ä½ç½® k çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹çš„ä½ç½®ä¸º k/2ï¼Œè€Œå®ƒçš„ä¸¤ä¸ªå­èŠ‚ç‚¹çš„ä½ç½®åˆ†åˆ«ä¸º k*2, K*2+1ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡è®¡ç®—ç´¢å¼•åœ¨æ ‘ä¸­ä¸Šä¸‹ç§»åŠ¨ã€‚ äºŒå‰å †è¡¨ç¤ºï¼š äºŒå‰å †åœ¨æ•°ç»„ä¸­çš„å­˜å‚¨ç»“æ„ï¼š ç”¨é•¿åº¦ä¸º N+1 çš„æ•°ç»„ pq[] æ¥è¡¨ç¤ºä¸€ä¸ªå¤§å°ä¸º N çš„å †ï¼Œå› ä¸ºå †å…ƒç´ å­˜æ”¾ä¸ pq[1]åˆ°pq[N]ä¹‹ä¸­ï¼Œæ‰€ä»¥å®é™…æ•°ç»„çš„é•¿åº¦è¦æ˜¯å †çš„å…ƒç´ å¤§å°+1ã€‚ ç”±ä¸‹è‡³ä¸Šçš„å †æœ‰åºåŒ–ï¼ˆä¸Šæµ®ï¼‰å½“å †çš„æœ‰åºåŒ–å› ä¸ºæŸä¸ªèŠ‚ç‚¹å˜å¾—æ¯”å…¶çˆ¶èŠ‚ç‚¹æ›´å¤§è€Œè¢«æ‰“ç ´ï¼Œæˆ‘ä»¬éœ€è¦äº¤æ¢è¯¥èŠ‚ç‚¹å’Œå…¶çˆ¶èŠ‚ç‚¹æ¥ä¿®å¤å †ã€‚äº¤æ¢åè¯¥èŠ‚ç‚¹æ¯”å®ƒçš„ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼ˆä¸€ä¸ªæ˜¯äº¤æ¢ä¹‹å‰çš„çˆ¶èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªæ¯”å®ƒæ›´å°ï¼Œå› ä¸ºæ˜¯æ—§çˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼‰éƒ½è¦å¤§äº†ï¼Œä½†è¯¥èŠ‚ç‚¹ä»ç„¶æœ‰å¯èƒ½æ¯”ç°åœ¨çš„çˆ¶èŠ‚ç‚¹è¦å¤§ï¼Œæ‰€ä»¥éœ€è¦å†ä¸€æ¬¡äº¤æ¢ï¼Œä½¿å¾—è¯¥èŠ‚ç‚¹ä¸æ–­ä¸Šæµ®ç›´åˆ°é‡åˆ°äº†æ›´å¤§çš„èŠ‚ç‚¹æˆ–åˆ°è¾¾å †é¡¶ã€‚ 123456789public class MaxPQ&lt;Key extends Comparable&lt;Key&gt;&gt; implements IMaxPQ&lt;Key&gt; { //...... public void swim(int k) { while (k &gt; 1 &amp;&amp; less(k / 2, k)) { exch(k / 2, k); k = k / 2; } } } ç”±ä¸Šè‡³ä¸‹çš„å †æœ‰åºåŒ–ï¼ˆä¸‹æ²‰ï¼‰ä¸‹æ²‰ä¸ä¸Šæµ®ç›¸åï¼Œå½“æœ‰åºçŠ¶æ€å› ä¸ºæŸä¸ªèŠ‚ç‚¹å˜å¾—æ¯”å®ƒçš„ä¸¤ä¸ªï¼ˆæˆ–å…¶ä¸­ä¹‹ä¸€ï¼‰å­èŠ‚ç‚¹è¦å°è¢«æ‰“ç ´ï¼Œé‚£ä¹ˆéœ€è¦äº¤æ¢è¯¥èŠ‚ç‚¹ä¸å…¶è¾ƒå¤§çš„ä¸€ä¸ªå­èŠ‚ç‚¹æ¥ä¿æŒå¹³è¡¡ã€‚å€˜è‹¥äº¤æ¢ä¹‹åè¯¥èŠ‚ç‚¹ä»æ¯”ç°åœ¨çš„å­èŠ‚ç‚¹ä¹‹ä¸€è¦å¤§ï¼Œç»§ç»­äº¤æ¢ï¼Œç›´è‡³å‘ä¸‹äº¤æ¢åˆ°è¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹éƒ½æ¯”å®ƒå°æˆ–åˆ°è¾¾å †çš„åº•éƒ¨ã€‚ ç–‘é—®ï¼šâ€œçˆ¶èŠ‚ç‚¹æ€ä¹ˆä¼šå˜å¾—æ¯”å­èŠ‚ç‚¹è¦å°å‘¢ï¼Ÿæ·»åŠ ä¸€ä¸ªå…ƒç´ åœ¨æ•°ç»„æœ«å°¾æ—¶ä¼šé€šè¿‡ä¸Šæµ®ç§»åŠ¨åˆ°åˆé€‚çš„ä½ç½®çš„å•Šã€‚â€ â€” è¿™è·Ÿåˆ é™¤æœ€å¤§å…ƒç´ çš„ç®—æ³•æœ‰å…³ï¼Œç§»é™¤å †é¡¶å…ƒç´ æ—¶ï¼Œä¼šç”¨æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ æ›¿è¡¥æœ€å¤§å…ƒç´ ï¼Œæ‰€ä»¥æ­¤æ—¶å­˜åœ¨å…ƒç´ ä¸‹æ²‰çš„å¿…è¦ã€‚ 123456789101112public class MaxPQ&lt;Key extends Comparable&lt;Key&gt;&gt; implements IMaxPQ&lt;Key&gt; { //...... public void sink(int k) { while (2 * k &lt;= N) { int j = 2 * k; if (j &lt; N &amp;&amp; less(j, j + 1)) j++; if (!less(k, j)) break; exch(k, j); k = j; } } } å †çš„ä¸Šæµ®ä¸ä¸‹æ²‰ï¼š ä¼˜å…ˆé˜Ÿåˆ—å®ç°ç†è§£äº†ä¸Šæµ®å’Œä¸‹æ²‰ï¼Œä¼˜å…ˆé˜Ÿåˆ—æ ¸å¿ƒçš„ä¸¤ä¸ªapiå°±èƒ½å®ç°äº†ï¼Œå¯¹äº æ’å…¥å…ƒç´ ï¼Œåªéœ€å°†å…ƒç´ æ·»åŠ åˆ°æ•°ç»„æœ«å°¾ï¼Œå¢åŠ å †çš„å¤§å°å¹¶è®©æ–°å…ƒç´ ä¸Šæµ®åˆ°åˆé€‚çš„ä½ç½®ï¼›å¯¹äº åˆ é™¤æœ€å¤§å…ƒç´ ï¼Œæˆ‘ä»¬ä»æ•°ç»„é¡¶ç«¯å»é™¤æœ€å¤§å…ƒç´ ï¼Œå¹¶å°†æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ æ”¾åˆ°é¡¶ç«¯ï¼Œå‡å°‘å †çš„å¤§å°å¹¶è®©å…ƒç´ ä¸‹æ²‰åˆ°åˆé€‚çš„ä½ç½®å³å¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637public class MaxPQ&lt;Key extends Comparable&lt;Key&gt;&gt; implements IMaxPQ&lt;Key&gt; { private Key[] pq; // åŸºäºå †çš„å®Œå…¨äºŒå‰æ ‘ private int N; // å †å…ƒç´ æ•°é‡ @Override public void insert(Key v) { if (N == pq.length - 1) resize(pq.length * 2); pq[++N] = v; swim(N); } @Override public Key delMax() { if (isEmpty()) throw new NoSuchElementException(\"Priority queue underflow\"); Key max = pq[1]; exch(1, N--); pq[N + 1] = null; // é˜²æ­¢å¯¹è±¡æ¸¸ç¦» sink(1); if (N &gt; 0 &amp;&amp; (pq.length - 1) / 4 == N) resize(pq.length / 2); return max; } @Override public Key max() { if (isEmpty()) throw new NoSuchElementException(\"Priority queue underflow\"); return pq[1]; } private void resize(int max) { assert max &gt; N; Key[] temp = (Key[]) new Comparable[max]; for (int i = 1; i &lt; N + 1; i++) { temp[i] = pq[i]; } pq = temp; }} åŸºäºå †çš„ä¼˜å…ˆé˜Ÿåˆ—APIèƒ½å¤Ÿä¿è¯æ’å…¥å…ƒç´ å’Œåˆ é™¤æœ€å¤§å…ƒç´ çš„ç”¨æ—¶å’Œé˜Ÿåˆ—çš„å¤§å°ä»…æˆå¯¹æ•°å…³ç³»ã€‚ ç´¢å¼•ä¼˜å…ˆé˜Ÿåˆ—äºŒå‰æ ‘å­˜å‚¨çš„ä¸æ˜¯å…ƒç´ å€¼ï¼Œè€Œæ˜¯å…ƒç´ å€¼çš„keyï¼›é€šè¿‡è¿™ä¸ª key åœ¨å…ƒç´ æ•°ç»„ element[] ä¸­æ‰¾åˆ°å…ƒç´ å€¼ï¼›ç”¨keyIndex[]å­˜å‚¨keyçš„ç´¢å¼•ã€‚ å…ˆè¡¥ç‚¹æ™ºå•†ï¼Œå¹²äº†è¿™ç¢—é¸¡æ±¤ï¼šç´¢å¼•ä¼˜å…ˆé˜Ÿåˆ—çš„å·¥ä½œåŸç†ä¸ç®€æ˜“å®ç° æé†’ï¼šå‰æ–¹é«˜èƒ½ï¼ï¼ï¼ä¼ é€é—¨ å †æ’åºä»¥ä¼˜å…ˆé˜Ÿåˆ—å®ç°çš„æ’åºç®—æ³•ï¼Œå°†åŸå§‹æ•°ç»„å…ƒç´ æ”¾å…¥ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼Œç”±äºåœ¨é˜Ÿåˆ—ä¸­å¯ä»¥è½»æ˜“çš„è·å¾—æœ€å¤§å€¼ï¼Œæ¯æ¬¡è·å–çš„æœ€å¤§å€¼å¯ä»¥ç»„æˆä¸€ä¸ªé€’å‡åºåˆ—ã€‚å¦‚æœè·å–çš„æœ€å¤§å€¼ä¸åˆ é™¤ï¼Œè€Œæ˜¯å°†å…¶å’Œé˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œç¬¬äºŒæ¬¡å°†æ–°çš„æœ€å¤§å€¼ä¸æ•°ç»„çš„å€’æ•°ç¬¬äºŒä¸ªå€¼äº¤æ¢ï¼Œå¾ªç¯å¾€å¤ï¼Œç›´è‡³æ•°ç»„å…ƒç´ éå†å®Œï¼Œæ’åºå®Œæˆã€‚ å †çš„æ„å»ºå°†åŸå§‹æ•°ç»„å…ƒç´ ç»„æˆä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ç»“æ„ï¼Œä¸€ä¸ªç®€å•çš„æ–¹å¼å°±æ˜¯å°†æ•°ç»„ ä»å·¦è‡³å³ æ‰§è¡Œ ä¸Šæµ® æ“ä½œï¼Œç›´è‡³æ¯ä¸ªå…ƒç´ æ”¾åˆ°äº†åˆé€‚çš„ä½ç½®ã€‚ ä¸Šæµ®æ“ä½œç”Ÿæˆå †ä¼šæ‰«ææ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯ ä»å³è‡³å·¦ æ‰§è¡Œ ä¸‹æ²‰ æ“ä½œï¼Œå®ƒåªéœ€è¦æ‰«ææ•°ç»„ä¸€åŠçš„å…ƒç´ ï¼Œå› ä¸ºä¸éœ€è¦æ¯”è¾ƒå¶å­èŠ‚ç‚¹ã€‚ æ’åºäº¤æ¢å †é¡¶å…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ¯æ¬¡äº¤æ¢ä¹‹åé‡æ–°ä¸‹æ²‰ä»¥ç»´æŒå †çš„æœ‰åºçŠ¶æ€ã€‚ ç”±äºåœ¨å †ç»“æ„ä¸­ä¸ä½¿ç”¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®çš„å…ƒç´ ï¼Œå¯¼è‡´åŸå§‹æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å€¼å¿…é¡»ä¸ºnullï¼Œè¦ä»¥æ­£å¸¸å­˜å‚¨çš„æ–¹å¼ä½¿ç”¨å †æ’åºï¼Œåªéœ€è¦åœ¨ less() å’Œ exch() ä¸­å°†ä¼ å…¥çš„ç´¢å¼•-1å³å¯ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465public class Heap { public void sort(Comparable[] a) { int n = a.length - 1; // æ„é€ å † sinkGenerationHead(a, n);// swimGenerationHead(a, n); // å †æ’åº while (n &gt; 1) { exch(a, 1, n--); sink(a, 1, n); } } //ä¸‹æ²‰ç”Ÿæˆå¤§é¡¶å †ï¼ˆæœ€ä¼˜ï¼‰ public void sinkGenerationHead(Comparable[] a, int n) { for (int i = n / 2; i &gt;= 1; i--) { // ä»å³åˆ°å·¦ sink(a, i, n); } } // ä¸Šæµ®ç”Ÿæˆå¤§é¡¶å † public void swimGenerationHead(Comparable[] a, int n) { for (int k = 0; k &lt; n; k++) { // å¿…é¡»æ˜¯ä»å·¦åˆ°å³ swim(a, k, n); } } public void sink(Comparable[] a, int k, int n) { while (2 * k &lt;= n) { int j = 2 * k; if (j &lt; n &amp;&amp; less(a, j, j + 1)) j++; if (!less(a, k, j)) break; exch(a, k, j); k = j; } } public void swim(Comparable[] a, int k, int n) { while (k &gt; 1 &amp;&amp; less(a, k / 2, k)) { exch(a, k / 2, k); k = k / 2; } } private boolean less(Comparable[] a, int i, int j) { return a[i].compareTo(a[j]) &lt; 0; } private void exch(Comparable[] a, int i, int j) { Comparable tem = a[i]; a[i] = a[j]; a[j] = tem; } public static void main(String[] args) { Comparable[] a = new Comparable[]{null, 2, 0, 5, 7, 9, 8, 3, 1, 4, 6}; Heap heap = new Heap(); heap.sort(a); for (int i = 0; i &lt; a.length; i++) { StdOut.print(a[i] + \" \"); } }} æ€»ç»“åœ¨javaä¸­çš„æ’åºéƒ½æ˜¯åŸºäºæŒ‡é’ˆçš„ï¼Œé™¤äº†åŸå§‹æ•°æ®ç±»å‹ä»¥å¤–ï¼Œæˆ‘ä»¬æ“ä½œçš„éƒ½æ˜¯æ•°æ®çš„å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ï¼Œè€Œéæ•°æ®æœ¬èº«ã€‚æŒ‡é’ˆæ’åºå¢åŠ äº†ä¸€å±‚é—´æ¥æ€§ï¼Œå› ä¸ºæ•°ç»„ä¿å­˜çš„æ˜¯å¾…æ’åºå¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œéå¯¹è±¡æœ¬èº«ã€‚ åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œå¯¹äºæ’åºä¹‹åçš„æ•°æ®è¦æ±‚ä¸å¯æ”¹å˜é”®å€¼ï¼Œå¦‚æœèƒ½ä¿®æ”¹ï¼Œé‚£ä¹ˆæ•°ç»„å°†ä¸å†æœ‰åºã€‚ç±»ä¼¼çš„ï¼Œä¼˜å…ˆé˜Ÿåˆ—åœ¨èƒ½æ”¹å˜é”®å€¼çš„æƒ…å†µä¸‹ä¹Ÿä¸å¤ªå¯èƒ½æ­£å¸¸å·¥ä½œï¼ˆç´¢å¼•ä¼˜å…ˆé˜Ÿåˆ—èƒ½æ”¹å˜é”®å€¼å¹¶ç»´æŒæœ‰åºæ˜¯æ¯æ¬¡æ”¹å˜ä¹‹åéƒ½è¿›è¡Œä¸Šæµ®ä¸‹æ²‰æ“ä½œï¼‰ã€‚é™å®šæ’åºå…ƒç´ ä¸å¯å˜å¯ä»¥ä½¿ç”¨javaçš„ä¸å¯å˜æ•°æ®ç±»å‹ï¼Œå¦‚å…«å¤§å°è£…ç±»å‹å’ŒStringï¼Œä»¥åŠè‡ªå®šä¹‰çš„ä¸å¯å˜æ•°æ®ç±»å‹ï¼ˆä¸å¯å˜ç±»å‹ï¼šå®ä¾‹å˜é‡ä»¥privateã€finalä¿®é¥°ï¼›ä¸æä¾›setteræ–¹æ³•ï¼›æä¾›å¸¦å‚æ„é€ å™¨ä»¥åˆå§‹åŒ–å®ä¾‹å˜é‡ï¼‰ã€‚ åœ¨javaä¸­å®ç°ä»»æ„æ•°æ®ç±»å‹æ’åºçš„æ–¹æ³•å°±æ˜¯å®ç°Comparableæ¥å£ï¼Œé‡å†™å…¶compareToæ–¹æ³•ã€‚ä½†å½“æˆ‘ä»¬å¯¹è¯¥æ•°æ®ç±»å‹çš„æ’åºæ–¹æ³•æœ‰å¤šä¸ªæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ¯”è¾ƒå™¨å¯¹è±¡ï¼Œä½¿å…¶å®ç°Comparatoræ¥å£ï¼Œé‡å†™compareæ–¹æ³•ï¼Œè¿›è¡Œæ¯”è¾ƒæ—¶æ ¹æ®éœ€æ±‚ä¼ å…¥ä¸åŒComparatoræ¥å£çš„å®ç°å³å¯ã€‚ å¦‚æœä¸€ä¸ªæ’åºç®—æ³•èƒ½å¤Ÿä¿ç•™æ•°ç»„ä¸­é‡å¤å…ƒç´ çš„ç›¸å¯¹ä½ç½®åˆ™å¯ä»¥è¢«ç§°ä¹‹ä¸º ç¨³å®šçš„ï¼Œå¯¹äºæ’åºç®—æ³•ç¨³å®šæ€§çš„è¦æ±‚åœ¨æŸäº›åœºæ™¯å°¤ä¸ºé‡è¦ã€‚ å¯¹äºå‰é¢å­¦ä¹ è¿‡çš„å„ç§æ’åºç®—æ³•çš„æ€§èƒ½ç‰¹ç‚¹å¦‚ä¸‹ï¼š ç®— æ³• æ˜¯å¦ç¨³å®š æ˜¯å¦ä¸ºåŸåœ°æ’åº æ—¶é—´å¤æ‚åº¦ ç©ºé—´å¤æ‚åº¦ å¤‡ æ³¨ é€‰æ‹©æ’åº å¦ æ˜¯ N^2 1 æ’å…¥æ’åº æ˜¯ æ˜¯ ä»‹äºNå’ŒN^2ä¹‹é—´ 1 å–å†³äºè¾“å…¥å…ƒç´ çš„æ’åˆ—æƒ…å†µ å¸Œå°”æ’åº å¦ æ˜¯ NlogN? N^(6/5)? 1 å¿«é€Ÿæ’åº å¦ æ˜¯ NlogN lgN è¿è¡Œæ•ˆç‡ç”±æ¦‚ç‡æä¾›ä¿è¯ ä¸‰å‘å¿«é€Ÿæ’åº å¦ æ˜¯ ä»‹äºNå’ŒNlogNä¹‹é—´ lgN è¿è¡Œæ•ˆç‡ç”±æ¦‚ç‡ä¿è¯ï¼ŒåŒæ—¶ä¹Ÿå–å†³äºè¾“å…¥å…ƒç´ çš„åˆ†å¸ƒæƒ…å†µ å½’å¹¶æ’åº æ˜¯ å¦ NlogN N å †æ’åº å¦ æ˜¯ NlogN 1 å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¿«é€Ÿæ’åºæ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚ä½†æ˜¯å¦‚æœç¨³å®šæ€§å¾ˆé‡è¦è€Œç©ºé—´ä¸æ˜¯é—®é¢˜çš„æƒ…å†µä¸‹ï¼Œå½’å¹¶æ’åºå¯èƒ½æ˜¯æœ€å¥½çš„ã€‚ java å‡½æ•°åº“ä¸­å¯¹åŸå§‹æ•°æ®ç±»å‹ä½¿ç”¨ä¸‰å‘åˆ‡åˆ†å¿«é€Ÿæ’åºï¼Œå¯¹äºå¼•ç”¨ç±»å‹ä½¿ç”¨å½’å¹¶æ’åºã€‚è¿™ä¹ˆåšä¹Ÿå°è¯ç€ç”¨é€Ÿåº¦å’Œç©ºé—´ï¼ˆå¯¹äºåŸå§‹æ•°æ®ç±»å‹ï¼‰æ¥æ¢å–ç¨³å®šæ€§ï¼ˆå¯¹äºå¼•ç”¨ç±»å‹ï¼‰ã€‚","link":"/2018/08/14/ç®—æ³•ç¬¬äºŒç«  æ’åº/"},{"title":"Git å®ç”¨æŒ‡å—","text":"ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆVCSï¼‰ ç‰ˆæœ¬æ§åˆ¶ / ä¸»åŠ¨æäº¤ / ä¸­å¤®ä»“åº“ æ„æˆäº†ä¸€ä¸ªæœ€æ ¸å¿ƒçš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚ ç‰ˆæœ¬æ§åˆ¶ï¼šæœ€åŸºæœ¬çš„åŠŸèƒ½ ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæœ€åŸºæœ¬çš„åŠŸèƒ½æ˜¯ç‰ˆæœ¬æ§åˆ¶ã€‚ç‰ˆæœ¬æ§åˆ¶ï¼Œç®€å•çš„ç†è§£å°±æ˜¯åœ¨æ–‡ä»¶ä¸­çš„ä¿®æ”¹å†ç¨‹ä¸­ä¿å­˜ä¿®æ”¹å†å²ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„æ’¤é”€ä¹‹å‰å¯¹æ–‡ä»¶çš„ä¿®æ”¹ã€‚ åœ¨æ™®é€šæ–‡æœ¬ç¼–è¾‘å™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Undo æ“ä½œå›é€€åˆ°ä¸Šä¸€æ¬¡çš„æ“ä½œï¼›åœ¨ç¨‹åºç¼–ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ VCS å›é€€åˆ°æŒ‡å®šçš„ä¸€æ¬¡æ“ä½œï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸Šä¸€æ¬¡æ“ä½œã€‚ ä¸»åŠ¨æäº¤æœºåˆ¶ï¼šVCS ä¸æ™®é€šæ–‡æœ¬ç¼–è¾‘å™¨çš„åŒºåˆ« ä½¿ç”¨æ™®é€šæ–‡æœ¬ç¼–è¾‘å™¨çš„æ—¶å€™ï¼Œä¸€æ¬¡ä¿å­˜å°±æ˜¯ä¸€æ¬¡æ”¹åŠ¨ï¼Œå¯¹ç‰ˆæœ¬çš„ æ§åˆ¶ ä»…ä»…æ˜¯å›é€€åˆ°ä¸Šä¸€æ¬¡æ“ä½œã€‚è€Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ç¨‹åºä»£ç ä¿®æ”¹çš„ç”Ÿå‘½å‘¨æœŸååˆ†é•¿ï¼Œä¸€æ¬¡ä»£ç çš„ä¿®æ”¹ï¼Œåœ¨å‡ å¤©åã€å‡ ä¸ªæœˆåã€ç”šè‡³å‡ å¹´åéƒ½å¯èƒ½è¢«ç¿»å‡ºæ¥ã€‚æ­¤æ—¶åƒæ™®é€šç¼–è¾‘å™¨çš„â€œè‡ªåŠ¨ä¿å­˜æäº¤â€çš„åŠŸèƒ½åœ¨å¯¹å†å²ä»£ç å®¡æŸ¥ã€å›é€€ä¸­ä¼šå˜å¾—éå¸¸ç¹çå’Œæ— ç« å¯å¾ªã€‚æ‰€ä»¥å’Œæ™®é€šæ–‡æœ¬ç¼–è¾‘å™¨çš„â€œæ’¤é”€â€åŠŸèƒ½ä¸åŒï¼ŒVCS ä¿å­˜ä¿®æ”¹å†å²ï¼Œä½¿ç”¨ ä¸»åŠ¨æäº¤æ”¹åŠ¨ çš„æœºåˆ¶ã€‚ æ‰€è°“ ä¸»åŠ¨æäº¤æ”¹åŠ¨ ï¼Œæ˜¯æŒ‡æ¯æ¬¡ä»£ç çš„ä¿®æ”¹å’Œä¿å­˜ä¸ä¼šè‡ªåŠ¨æäº¤ï¼Œéœ€è¦æ‰‹åŠ¨æäº¤ï¼ˆcommitï¼‰åˆ°ä»“åº“ï¼ŒVCS ä¼šæŠŠè¿™æ¬¡æäº¤è®°å½•åˆ°ç‰ˆæœ¬å†å²ä¸­ï¼Œå½“å¾€åéœ€è¦å›é€€åˆ°è¿™ä¸ªç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨ VCS çš„å†å²æäº¤çºªå½•ä¸­æ‰¾åˆ°è¿™æ¡è®°å½•ã€‚ä¸­å¤®ä»“åº“ï¼šå¤šäººåˆä½œçš„åŒæ­¥éœ€æ±‚ ä¸­å¤®ä»“åº“ä½œä¸ºä»£ç çš„å­˜å‚¨ä¸­å¿ƒï¼Œæ‰€æœ‰äººçš„æ”¹åŠ¨éƒ½ä¸Šä¼ åˆ°è¿™é‡Œï¼Œæ‰€æœ‰äººéƒ½å¯ä»¥çœ‹åˆ°å¹¶ä¸‹è½½åˆ«äººä¸Šä¼ çš„æ”¹åŠ¨ã€‚ ç‰ˆæœ¬æ§åˆ¶ / ä¸»åŠ¨æäº¤ / ä¸­å¤®ä»“åº“ è¿™ä¸‰ä¸ªè¦ç´ ï¼Œå…±åŒæ„æˆäº†ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ VCS çš„æ ¸å¿ƒï¼šå¼€å‘å›¢é˜Ÿä¸­çš„æ¯ä¸ªäººå‘ä¸­å¤®ä»“åº“ä¸­ä¸»åŠ¨æäº¤è‡ªå·±çš„æ”¹åŠ¨å’ŒåŒæ­¥åˆ«äººçš„æ”¹åŠ¨ï¼Œå¹¶åœ¨éœ€è¦çš„æ—¶å€™æŸ¥çœ‹å’Œæ“ä½œå†å²çš„ç‰ˆæœ¬ï¼Œè¿™å°±æ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚ ä¸­å¤®å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ æœ€åŸºæœ¬çš„æ¨¡å‹æ˜¯ï¼šåœ¨ä¸€å°æœåŠ¡å™¨ä¸­åˆå§‹åŒ–ä¸€ä¸ªä¸­å¤®ä»“åº“ï¼Œæ¯ä¸ªäººä»ä¸­å¤®ä»“åº“ä¸‹è½½åˆå§‹ç‰ˆæœ¬å¼€å§‹å¹¶è¡Œå¼€å‘ï¼Œæäº¤å„è‡ªçš„ä»£ç åˆ°ä¸­å¤®ä»“åº“å¹¶æ›´æ–°å…¶ä»–äººçš„ä»£ç åŒæ­¥åˆ°è‡ªå·±çš„æœºå™¨ä¸Šã€‚ å›¢é˜Ÿä¸­çš„æ¯ä¸ªäººéœ€è¦åšçš„å°±æ˜¯ï¼š1. ç¬¬ä¸€æ¬¡åŠ å…¥å›¢é˜Ÿï¼Œä»ä¸­å¤®ä»“åº“å–ä»£ç åˆ°æœ¬åœ°ï¼› 2. å†™å¥½çš„æ–°åŠŸèƒ½æäº¤åˆ°ä¸­å¤®ä»“åº“ï¼› 3. åŒäº‹æœ‰æ–°çš„ä»£ç æäº¤ï¼ŒåŠæ—¶åŒæ­¥åˆ°æœ¬åœ°ã€‚å®é™…å¼€å‘ä¸­å½“ç„¶è¿˜ä¼šç»å¸¸éœ€è¦å¤„ç†ä»£ç å†²çªã€æŸ¥çœ‹ä»£ç å†å²ã€å›é€€ä»£ç ç‰ˆæœ¬ç­‰ã€‚ åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆDVCSï¼‰åˆ†å¸ƒå¼ VCS å’Œä¸­å¤®å¼ VCS çš„åŒºåˆ«åœ¨äºï¼šåˆ†å¸ƒå¼ VCS é™¤äº†æœ‰ä¸­å¤®ä»“åº“ä¹‹å¤–ï¼Œè¿˜æœ‰æœ¬åœ°ä»“åº“ï¼Œå›¢é˜Ÿä¸­çš„æ¯ä¸ªäººçš„æœºå™¨ä¸Šéƒ½æœ‰ä¸€ä¸ªæœ¬åœ°ä»“åº“ï¼Œè¿™ä¸ªä»“åº“ä¸­ä¿å­˜ç€ç‰ˆæœ¬çš„æ‰€æœ‰å†å²ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥åœ¨è‡ªå·±çš„æœºå™¨çš„æœ¬åœ°ä»“åº“ä¸­æäº¤ä»£ç ã€æŸ¥çœ‹å†å²è€Œæ— éœ€è”ç½‘ä¸ä¸­å¤®ä»“åº“äº¤äº’ï¼Œå–è€Œä»£ä¹‹çš„ï¼Œåªéœ€è¦å’Œæœ¬åœ°ä»“åº“äº¤äº’ã€‚ ä¸­å¤®å¼ VCS çš„ä¸­å¤®ä»“åº“æœ‰ä¸¤ä¸ªä¸»è¦åŠŸèƒ½ï¼šä¿å­˜ç‰ˆæœ¬å†å² / åŒæ­¥ä»£ç  ã€‚è€Œåœ¨åˆ†å¸ƒå¼çš„ VCS ä¸­ï¼Œä¿å­˜ç‰ˆæœ¬å†å²è½¬ç§»åˆ°äº†æ¯ä¸ªäººçš„æœ¬åœ°ä»“åº“ï¼Œä¸­å¤®ä»“åº“åªå‰©ä¸‹åŒæ­¥ä»£ç è¿™ä¸€ä¸ªä¸»è¦ä»»åŠ¡ã€‚å½“ç„¶ä¸­å¤®ä»“åº“ä¹Ÿä¼šä¿å­˜ç‰ˆæœ¬å†å²ï¼Œä¸è¿‡è¿™ä¸ªå†å²åªæ˜¯ä½œä¸ºå›¢é˜ŸåŒæ­¥ä»£ç çš„ä¸­è½¬ç«™ã€‚ å¿«é€Ÿä¸Šæ‰‹ åœ¨ github ä¸Šæ–°å»ºä¸€ä¸ªä»“åº“ï¼š git-practical-guide åœ¨æŒ‡å®šè·¯å¾„å…‹éš†è¯¥è¿œç¨‹ä»“åº“åˆ°æœ¬åœ°ï¼š git clone https://github.com/yuzh233/git-practical-guide.git æŸ¥çœ‹æ—¥å¿—ï¼š git log ï¼Œè‹¥æ—¥å¿—ä¿¡æ¯å¤ªé•¿ï¼ŒæŒ‰ q é€€å‡ºã€‚ 12345678$ git logcommit 0a00230727018a14d481fe482e8e85f7b312e39c (HEAD -&gt; master, origin/master, origin/HEAD)Author: yu_zh &lt;yuzh233@163.com&gt;Date: Wed Oct 3 00:23:27 2018 +0800 Initial commit -- github é»˜è®¤åˆ›å»ºäº†ä¸€æ¬¡æäº¤ æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªå·±åˆ›å»ºä¸€ä¸ªæäº¤ï¼šä½†å…ˆæŸ¥çœ‹ä¸€ä¸‹çŠ¶æ€ git status 12345678910111213$ git statusOn branch masterYour branch is up to date with 'origin/master'.Untracked files: (use \"git add &lt;file&gt;...\" to include in what will be committed) README.mdnothing added to commit but untracked files present (use \"git add\" to track)-- å½“å‰åˆ†æ”¯æ˜¯ä¸»åˆ†æ”¯ï¼Œå¹¶ä¸”å½“å‰åˆ†æ”¯æ˜¯æœ€æ–°çš„ï¼ˆç›¸å¯¹äºä¸­å¤®ä»“åº“ï¼‰-- æœ‰ä¸€ä¸ªæœªè¿½è¸ªçš„æ–‡ä»¶ â€œREADME.mdâ€ ,å¯ä»¥ä½¿ç”¨ git add è¿½è¸ªæ–‡ä»¶ï¼ˆæäº¤ï¼‰ è¿½è¸ªæ–‡ä»¶ï¼š git add README.mdï¼Œå†æ¬¡ git statusã€‚ æ·»åŠ å…¨éƒ¨æ–‡ä»¶åˆ°æš‚å­˜åŒºï¼šgit add . / git add -A 12345678910$ git statusOn branch masterYour branch is up to date with 'origin/master'.Changes to be committed: (use \"git reset HEAD &lt;file&gt;...\" to unstage) new file: README.md-- å½“å‰åˆ†æ”¯æ˜¯æœ€æ–°çš„ï¼Œå·²æš‚å­˜ä¸€ä¸ªæ–°æ–‡ä»¶ï¼šREADME.mdï¼Œè¯¥æ–‡ä»¶ç”±â€œæœªè¿½è¸ªâ€å˜æˆäº†â€œå·²æš‚å­˜â€ï¼Œè¡¨æ˜è¿™ä¸ªæ–‡ä»¶è¢«æ”¹åŠ¨çš„éƒ¨åˆ†å·²è¿›å…¥â€œæš‚å­˜åŒºâ€ æäº¤æ–‡ä»¶ï¼šgit commit ã€‚è¿›å…¥ vim å¡«å†™æäº¤çš„æè¿°ä¿¡æ¯ä¿å­˜é€€å‡ºå³å¯ã€‚ä¹Ÿå¯ä»¥ git commit -m &quot;æè¿°ä¿¡æ¯&quot; 123456789101112131415161718192021222324252627$ git commit*** Please tell me who you are.Run git config --global user.email \"you@example.com\" git config --global user.name \"Your Name\"to set your account's default identity.Omit --global to set the identity only in this repository.fatal: unable to auto-detect email address (got 'Administrator@YU-ZH.(none)')-- é¦–æ¬¡æäº¤éœ€è¦æŒ‡æ˜èº«ä»½ï¼ˆé¢å¤–ä¸€ç‚¹ï¼šgithubçš„è´¡çŒ®å€¼æ˜¯ä»¥é‚®ç®±åœ°å€ä½œä¸ºæäº¤çš„è®°å½•æ ‡è¯†ï¼Œå¦‚æœ setting é‡Œé¢æ²¡æœ‰æ·»åŠ è¯¥é‚®ç®±ï¼Œé‚£ä¹ˆè´¡çŒ®å€¼ä¼šä¸å­˜åœ¨ã€‚ï¼‰Administrator@YU-ZH MINGW64 /d/IdeaProjects/git-practical-guide (master)$ git config --global user.email \"yuzh233@gmail.com\"Administrator@YU-ZH MINGW64 /d/IdeaProjects/git-practical-guide (master)$ git config --global user.name \"yu.zh\"Administrator@YU-ZH MINGW64 /d/IdeaProjects/git-practical-guide (master)$ git commit[master 967f40b] add README.md 1 file changed, 76 insertions(+) create mode 100644 README.md å†æŸ¥çœ‹ä¸€æ¬¡æ—¥å¿—å§ï¼šgit log 123456789101112131415$ git logcommit 967f40b3fd29f102fc84f62ac9d20243db2a99b4 (HEAD -&gt; master)Author: yu.zh &lt;yuzh233@gmail.com&gt;Date: Wed Oct 3 21:50:03 2018 +0800 add README.mdcommit 0a00230727018a14d481fe482e8e85f7b312e39c (origin/master, origin/HEAD)Author: yu_zh &lt;yuzh233@163.com&gt;Date: Wed Oct 3 00:23:27 2018 +0800 Initial commit-- å¯ä»¥çœ‹åˆ°ï¼Œä¸€å…±æœ‰ä¸¤æ¬¡æäº¤è®°å½•ï¼Œæœ€è¿‘çš„ä¸€æ¬¡æäº¤åœ¨æœ€å‰é¢ã€‚-- origin/master, origin/HEAD æ˜¯å¯¹è¿œç«¯ä»“åº“çš„ master å’Œ HEAD çš„æœ¬åœ°é•œåƒã€‚ å½“æˆ‘ä»¬çš„æ–‡ä»¶æœ‰ä¿®æ”¹æ—¶ï¼Œéœ€è¦æ›´æ–°åˆ°æœ¬åœ°ä»“åº“ã€‚å…ˆçœ‹ä¸€ä¸‹çŠ¶æ€æ˜¯ä¸ªå¥½ä¹ æƒ¯ï¼š git status 123456789101112131415$ git statusOn branch masterYour branch is ahead of 'origin/master' by 1 commit. (use \"git push\" to publish your local commits)Changes not staged for commit: (use \"git add &lt;file&gt;...\" to update what will be committed) (use \"git checkout -- &lt;file&gt;...\" to discard changes in working directory) modified: README.mdno changes added to commit (use \"git add\" and/or \"git commit -a\")-- å½“å‰ä½äºä¸»åˆ†æ”¯ï¼Œå½“å‰åˆ†æ”¯â€œé¢†å…ˆäºâ€è¿œç¨‹ä»“åº“ä¸»åˆ†æ”¯ä¸€ä¸ªæäº¤-- æœªæäº¤çš„ä¸€ä¸ªæ›´æ”¹ README.md ï¼Œgit è®¤è¯†è¿™ä¸ªæ–‡ä»¶ï¼Œä½†å®ƒä¸æ˜¯ä¸€ä¸ªæ–°æ–‡ä»¶äº†ï¼Œæˆ‘ä»¬æŠŠå®ƒåŒæ­¥ä¸ºæœ€æ–°çš„ã€‚ ä¾ç„¶æ˜¯ï¼š git add README.md æŸ¥çœ‹çŠ¶æ€ï¼š git status 1234567891011$ git statusOn branch masterYour branch is ahead of 'origin/master' by 1 commit. (use \"git push\" to publish your local commits)Changes to be committed: (use \"git reset HEAD &lt;file&gt;...\" to unstage) modified: README.md-- ä¸€ä¸ªæ–‡ä»¶è¢«æ”¹åŠ¨äº† æäº¤ï¼š git commit æ­¤æ—¶æŸ¥çœ‹ä¸‹æ—¥å¿—ï¼šgit log 123456789101112131415161718$ git logcommit 7ba78ab8cef21de0174884ef13fb6210f9552fe3 (HEAD -&gt; master)Author: yu.zh &lt;yuzh233@gmail.com&gt;Date: Wed Oct 3 22:10:13 2018 +0800 update README.mdcommit 967f40b3fd29f102fc84f62ac9d20243db2a99b4Author: yu.zh &lt;yuzh233@gmail.com&gt;Date: Wed Oct 3 21:50:03 2018 +0800 add README.mdcommit 0a00230727018a14d481fe482e8e85f7b312e39c (origin/master, origin/HEAD)Author: yu_zh &lt;yuzh233@163.com&gt;Date: Wed Oct 3 00:23:27 2018 +0800 Initial commit æ­¤æ—¶æœ¬åœ°ä»“åº“å·²ç»é¢†å…ˆäºä¸­å¤®ä»“åº“ï¼ŒæŠŠæœ¬åœ°ä»“åº“æ¨é€åˆ°ä¸­å¤®ä»“åº“ï¼šgit push / git push origin master å°ç»“ git clone url git log git status git add æ–‡ä»¶ / git add . / git add -A git commit / git commit -m â€œinfoâ€ git push / git push origin master æœ¬åœ°åˆå§‹åŒ–ä»“åº“å¹¶æ¨é€åˆ° GitHub æŸä¸ªé¡¹ç›®æ–‡ä»¶å¤¹æ‰§è¡Œ git init git log / git add / git commit / git status å•¥çš„éƒ½æ¥ä¸€é åœ¨ github åˆ›å»ºä¸æœ¬åœ°åŒåçš„ä»“åº“ï¼Œå¦‚æœæœ¬åœ°æœ‰ README.md è¿œç¨‹å°±ä¸è¦å‹¾é€‰åˆ›å»ºè¿™ä¸ªæ–‡ä»¶ï¼Œå¦åˆ™ä¼šå†²çªã€‚ å…³è”è¿œç¨‹åº“: git remote add origin git@github.com:yuzh233/demo.git or git remote add origin https://github.com/yuzh233/demo.git æ¨é€åˆ°è¿œç¨‹åº“ï¼šgit push -u origin master ï¼Œéœ€è¦å…ˆå…³è” GitHub ä¸æœ¬æœºçš„ SSH Key. å…³è” GitHub ä¸æœ¬æœºçš„ SSH Key å…ˆç¡®ä¿å·²ç»åœ¨ git ä¸­ä¿å­˜äº†å…¨å±€ç”¨æˆ·åå’Œé‚®ç®± git config â€“global user.name â€œyournameâ€ git config â€“global user.emailâ€œyour@email.comâ€œ åˆ é™¤ C:\\Users\\Administrator.ssh\\known_hosts æ–‡ä»¶ bash è¾“å…¥ ssh-keygen -t rsa -C &quot;yuzh233@gmail.com&quot;ï¼Œå‡ºç°æç¤ºä¿¡æ¯ï¼Œä¸€è·¯å›è½¦ï¼Œç„¶åç³»ç»Ÿä¼šè‡ªåŠ¨åœ¨.sshæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼Œid_rsa å’Œ id_rsa.pubã€‚ æ‰“å¼€ id_rsa.pub å°†å…¨éƒ¨å†…å®¹å¤åˆ¶åˆ° Github-&gt;setting-&gt;SSH and GPG keys-&gt;New SSH key-&gt;key ssh -T git@github.com git pullpull æŒ‡ä»¤ç”¨äºä»ä¸­å¤®ä»“åº“æ›´æ–°ä»£ç åˆ°æœ¬åœ°ä»“åº“ã€‚å½“å¤šäººåä½œå¼€å‘æ—¶ï¼ŒåŒäº‹ A å…ˆäºåŒäº‹ B push è‡ªå·±çš„æœ¬åœ°ä»“åº“ä»£ç åˆ°ä¸­å¤®ä»“åº“åï¼ŒåŒäº‹ B å† push è‡ªå·±çš„æœ¬åœ°ä»“åº“æ—¶ä¼šæŠ¥é”™ï¼ŒåŸå› æ˜¯è¿œç¨‹ä»“åº“å«æœ‰æœ¬åœ°æ²¡æœ‰çš„ commit è€Œå¯¼è‡´ push å¤±è´¥ã€‚æ­¤æ—¶åŒäº‹ B éœ€è¦ä½¿ç”¨ git pull å°†åŒäº‹ A push åˆ°è¿œç¨‹ä»“åº“çš„å†…å®¹æ›´æ–°ä¸‹æ¥ï¼Œè¿™æ ·åŒäº‹ B çš„æœ¬åœ°ä»“åº“å°±å«æœ‰è¿œç¨‹ä»“åº“çš„commitäº†ï¼Œç„¶ååŒäº‹ B æ‰èƒ½æ‰§è¡Œè‡ªå·±çš„ pushã€‚ ä¸€ç§åœºæ™¯ï¼šåŒäº‹A commitäº†ä¸€æ¡è®°å½•å¹¶ push åˆ°è¿œç¨‹ä»“åº“ã€‚åŒäº‹B ä¹Ÿåœ¨è‡ªå·±çš„æœ¬åœ°ä»“åº“ä¸­ commit äº†ä¸€æ¡è®°å½•åè¯•å›¾ pushã€‚æ­¤æ—¶ git ä¼šå‘ç°è¿œç¨‹ä»“åº“å«æœ‰æœ¬åœ°æœªæœ‰çš„æäº¤ push å¤±è´¥ã€‚äºæ˜¯åŒäº‹B æ‰§è¡Œ git pull ï¼Œæ­¤æ—¶çš„ pull å¹¶ä¸ä¼šå’Œå¾€å¸¸ä¸€æ ·ç»“æŸï¼Œè€Œæ˜¯ä¼šè¿›å…¥ä¸€ä¸ª vim çš„ä¿¡æ¯æç¤ºç•Œé¢ï¼Œéœ€è¦è¾“å…¥æäº¤ä¿¡æ¯ï¼ˆgité»˜è®¤å¡«å†™äº†ä¿¡æ¯ï¼‰ï¼ŒåŸå› æ˜¯gitä¸ä»…å‘ç°è¿œç¨‹ä»“åº“å«æœ‰æœ¬åœ°ä»“åº“æ²¡æœ‰çš„æäº¤ï¼Œæœ¬åœ°ä»“åº“ä¹Ÿå«æœ‰è¿œç¨‹ä»“åº“æ²¡æœ‰çš„æäº¤ï¼Œgitä¼šå°†è¿œç¨‹ä»“åº“çš„ commit å’Œæœ¬åœ°ä»“åº“çš„ commit åˆå¹¶ï¼ˆgit mageï¼‰äº§ç”Ÿä¸€æ¡æ–°çš„æäº¤å¹¶æ·»åŠ é»˜è®¤æè¿°ä¿¡æ¯ã€‚ é€€å‡ºä¿å­˜ä¿¡æ¯æç¤ºç•Œé¢ä¹‹åï¼Œpullå°±å®Œæˆäº†ï¼Œç„¶åæ‰§è¡Œ pushï¼Œæ­¤æ—¶æœ¬åœ°ä»“åº“å«æœ‰è¿œç¨‹ä»“åº“æ‰€æœ‰çš„æäº¤ä¸ä¼šå¤±è´¥ã€‚ HEAD / master / branch ç†è§£æŒ‡å‘ commit çš„å¿«æ·æ–¹å¼ï¼šå¼•ç”¨ æ‹¬å·é‡Œçš„ HEAD -&gt; master, origin/master, origin/HEAD ï¼Œéƒ½æ˜¯æŒ‡å‘è¿™ä¸ª commit çš„å¼•ç”¨ã€‚commit åé¢ä¸€å¤§ä¸²çš„å­—ç¬¦æ˜¯å½“å‰æäº¤çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆSHA-1 æ ¡éªŒå’Œï¼‰ï¼Œæä¾›å¼•ç”¨æœºåˆ¶æ˜¯ä¸ºäº†ç®€åŒ–æ ‡è¯†ç¬¦ï¼Œæ–¹ä¾¿è®°å¿†ã€‚ HEAD æŒ‡å‘å½“å‰æœ€æ–°çš„ commit ï¼Œå½“å‰ commit åœ¨å“ªé‡Œï¼ŒHEAD å°±åœ¨å“ªé‡Œï¼Œè¿™æ˜¯ä¸€ä¸ªæ°¸è¿œæŒ‡å‘å½“å‰ commit çš„å¼•ç”¨ã€‚ HEAD é™¤äº†å¯ä»¥æŒ‡å‘ commitï¼Œè¿˜å¯ä»¥æŒ‡å‘ä¸€ä¸ª branchï¼Œå½“å®ƒæŒ‡å‘æŸä¸ª branch çš„æ—¶å€™ï¼Œä¼šé€šè¿‡è¿™ä¸ª branch æ¥é—´æ¥åœ°æŒ‡å‘æŸä¸ª commitï¼›å¦å¤–ï¼Œå½“ HEAD åœ¨æäº¤æ—¶è‡ªåŠ¨å‘å‰ç§»åŠ¨çš„æ—¶å€™ï¼Œå®ƒä¼šåƒä¸€ä¸ªæ‹–é’©ä¸€æ ·å¸¦ç€å®ƒæ‰€æŒ‡å‘çš„ branch ä¸€èµ·ç§»åŠ¨ã€‚ æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª commit ä¹‹åæŸ¥çœ‹ logï¼š æœ€æ–°çš„ commit è¢«åˆ›å»ºåï¼ŒHEAD å’Œ master è¿™ä¸¤ä¸ªå¼•ç”¨éƒ½æŒ‡å‘äº†å®ƒï¼Œè€Œåœ¨ä¸Šé¢ç¬¬ä¸€å¼ å›¾ä¸­çš„åä¸¤ä¸ªå¼•ç”¨ origin/master å’Œ origin/HEAD åˆ™ä¾ç„¶åœç•™åœ¨åŸå…ˆçš„ä½ç½®ã€‚ branch å¯ä»¥ç†è§£ä¸ºä»åˆå§‹ commit åˆ° branch æ‰€æŒ‡å‘çš„ commit ä¹‹é—´çš„æ‰€æœ‰ commit é›†åˆçš„ä¸€ä¸ªä¸²ã€‚ æ‰€æœ‰çš„ branch ä¹‹é—´éƒ½æ˜¯å¹³ç­‰çš„ branch åŒ…å«äº†ä»åˆå§‹ commit åˆ°å®ƒçš„æ‰€æœ‰è·¯å¾„ï¼Œè€Œä¸æ˜¯ä¸€æ¡è·¯å¾„ã€‚å¹¶ä¸”ï¼Œè¿™äº›è·¯å¾„ä¹‹é—´ä¹Ÿæ˜¯å½¼æ­¤å¹³ç­‰çš„ã€‚ master æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ branch ,æ˜¯gité»˜è®¤çš„åˆ†æ”¯ï¼ˆä¸»åˆ†æ”¯ï¼‰ã€‚æ–°åˆ›å»ºä¸€ä¸ª repository çš„ç¬¬ä¸€ä¸ª commit æ—¶ï¼Œä¼šæŠŠ master æŒ‡å‘å®ƒï¼Œå¹¶æŠŠ HEAD æŒ‡å‘ masterã€‚ æ–°å»ºçš„ä»“åº“ä¸­çš„ç¬¬ä¸€ä¸ª commit ä¼šè¢« master è‡ªåŠ¨æŒ‡å‘ åœ¨ git clone æ—¶ï¼Œä¼šè‡ªåŠ¨ checkout å‡º master branch xx / checkout branch xx / checkout -d xx / branch -d xx / branch -aåˆ›å»ºä¸€ä¸ªåˆ†æ”¯ï¼šgit branch feature1 åˆ‡æ¢åˆ°è¿™ä¸ªåˆ†æ”¯ï¼šgit checkout feature1ï¼Œæ­¤æ—¶ HEAD æŒ‡å‘äº† feature1 è¿™å’Œåˆ†æ”¯äº†ã€‚ åˆ›å»ºä¸€ä¸ªåˆ†æ”¯å¹¶åˆ‡æ¢è¿‡å»ï¼šgit checkout -b feature1 æˆ‘ä»¬åœ¨ feature1 åˆ†æ”¯ä¸­åˆ›å»ºä¸€ä¸ªæäº¤ï¼šæ·»åŠ  feature1.txtã€‚æ­¤æ—¶ HEADæŒ‡å‘äº† feature1ï¼Œfeature1 æŒ‡å‘å½“å‰æäº¤ã€‚ åˆåˆ‡æ¢å› master åˆ†æ”¯ï¼šgit checkout masterï¼Œåœ¨ master åˆ›å»ºä¸€ä¸ªæäº¤ï¼šæ·»åŠ  master.txtï¼Œæ­¤æ—¶å‡ºç°äº†åˆ†å‰ï¼ˆä¸¤ä¸ªåˆ†æ”¯æœ‰ä¸åŒçš„æäº¤ï¼‰ã€‚ åˆ é™¤åˆšåˆšåˆ›å»ºçš„åˆ†æ”¯ï¼šgit branch -d feature1 HEAD æŒ‡å‘çš„ branch ä¸èƒ½åˆ é™¤ã€‚å¦‚æœè¦åˆ é™¤ HEAD æŒ‡å‘çš„ branchï¼Œéœ€è¦å…ˆç”¨ checkout æŠŠ HEAD æŒ‡å‘å…¶ä»–åœ°æ–¹ã€‚ branch åªæ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œåˆ é™¤å¼•ç”¨å¹¶ä¸ä¼šåˆ é™¤è¯¥å¼•ç”¨è·¯å¾„ä¸Šçš„æ‰€æœ‰ commit é›†åˆï¼ˆä¸è¿‡ä¸€ä¸ª commit ä¸åœ¨ä»»ä½•ä¸€ä¸ª branch è·¯å¾„ä¸Šï¼Œå°±æ˜¯ä¸ªé‡ç”Ÿ commit äº†ï¼Œä¼šè¢« git åƒåœ¾å›æ”¶æ‰ï¼‰ æ²¡æœ‰è¢«åˆå¹¶åˆ° master è¿‡çš„ branch åœ¨åˆ é™¤æ—¶ä¼šå¤±è´¥ã€‚å¼ºåˆ¶åˆ é™¤å°† -d æ”¹ä¸º -D åˆ é™¤è¿œç¨‹çš„åˆ†æ”¯ï¼šgit push origin -d feature1 æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼šgit branch -a push çš„æœ¬è´¨push æ˜¯æŠŠå½“å‰çš„åˆ†æ”¯ä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“ï¼Œå¹¶æŠŠè¿™ä¸ª branch çš„è·¯å¾„ä¸Šçš„æ‰€æœ‰ commits ä¹Ÿä¸€å¹¶ä¸Šä¼ ã€‚ push çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰åˆ†æ”¯æ˜¯ä¸€ä¸ªæœ¬åœ°åˆ›å»ºçš„åˆ†æ”¯ï¼Œéœ€è¦æŒ‡å®šè¿œç¨‹ä»“åº“åå’Œåˆ†æ”¯åï¼Œç”¨ git push origin åˆ†æ”¯å çš„æ ¼å¼ï¼Œè€Œä¸èƒ½åªç”¨ git pushï¼›æˆ–è€…å¯ä»¥é€šè¿‡ git config ä¿®æ”¹ push.default æ¥æ”¹å˜ push æ—¶çš„è¡Œä¸ºé€»è¾‘ã€‚ push ä¹‹åä¸Šä¼ å½“å‰åˆ†æ”¯ï¼Œå¹¶ä¸ä¼šä¸Šä¼  HEADï¼›è¿œç¨‹ä»“åº“çš„ HEAD æ˜¯æ°¸è¿œæŒ‡å‘é»˜è®¤åˆ†æ”¯ï¼ˆå³ masterï¼‰çš„ã€‚ git merge &lt;è¢«åˆå¹¶åˆ†æ”¯&gt;merge(åˆå¹¶) ä»ç›®æ ‡ commitï¼ˆè¢«åˆå¹¶åˆ†æ”¯çš„æœ€æ–°commitï¼‰ å’Œå½“å‰ commit ï¼ˆå³ HEAD æ‰€æŒ‡å‘çš„æœ€æ–° commitï¼‰åˆ†å‰çš„ä½ç½®èµ·ï¼ŒæŠŠç›®æ ‡ commit çš„è·¯å¾„ä¸Šçš„æ‰€æœ‰ commit çš„å†…å®¹ä¸€å¹¶åº”ç”¨åˆ°å½“å‰ commitï¼Œç„¶åè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ–°çš„ commitã€‚ HEAD æŒ‡å‘ masterï¼Œè¯´æ˜å½“å‰åœ¨ä¸»åˆ†æ”¯ï¼Œæ‰§è¡Œ git merge branch1ä¹‹å git ä¼š åœ¨ commit 2 ï¼ˆäº¤å‰ä½ç½®ï¼‰ï¼Œå°†commit 5 å’Œcommit 6 åˆå¹¶åˆ° commit 4ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–°çš„æäº¤ã€‚ é¦–å…ˆåˆ›å»ºä¸€ä¸ªåˆ†æ”¯ branch1ï¼Œå¼€å§‹å¹¶è¡Œå¼€å‘ï¼š git branch branch1 ------------------------------------- åœ¨ master åˆ†æ”¯åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼š touch a.txt touch b.txt æ·»åŠ å¹¶æäº¤è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼š git add a.txt b.txt git commit -m &quot;add a.txt b.txt&quot; æ­¤æ—¶ master åˆ†æ”¯æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ ------------------------------------- åˆ‡æ¢åˆ° branch1 åˆ†æ”¯ï¼š git chekout branch1 åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ c.txt æ·»åŠ å¹¶æäº¤ï¼š touch c.txt git add c.txt git commit -m &quot;add c.txt&quot; æ­¤æ—¶ branch1 åˆ†æ”¯å«æœ‰ c.txt è¿™ä¸ªæ–‡ä»¶ -------------------------------------- master æœ‰è‡ªå·±çš„æ–°æäº¤ï¼šâ€œa.txt / b.txtâ€ï¼Œbranch1æœ‰è‡ªå·±çš„æ–°æäº¤ï¼šâ€œc.txtâ€ï¼Œæ­¤æ—¶æƒ³å°† branch1 çš„æäº¤åˆå¹¶åˆ° master ä¸»åˆ†æ”¯ä¸Šï¼š git checkout master å…ˆåˆ‡æ¢åˆ°ä¸»åˆ†æ”¯ git merge branch1 äºæ˜¯ master å°±å«æœ‰ a.txt / b.txt / c.txt è¿™ä¸‰ä¸ªæ–‡ä»¶äº†ã€‚ å†²çªï¼ˆconflictï¼‰ merge åœ¨åšåˆå¹¶çš„æ—¶å€™ï¼Œæ˜¯æœ‰ä¸€å®šçš„è‡ªåŠ¨åˆå¹¶èƒ½åŠ›çš„ï¼šå¦‚æœä¸€ä¸ªåˆ†æ”¯æ”¹äº† A æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªåˆ†æ”¯æ”¹äº† B æ–‡ä»¶ï¼Œé‚£ä¹ˆåˆå¹¶åå°±æ˜¯æ—¢æ”¹ A ä¹Ÿæ”¹ Bï¼Œè¿™ä¸ªåŠ¨ä½œä¼šè‡ªåŠ¨å®Œæˆï¼›å¦‚æœä¸¤ä¸ªåˆ†æ”¯éƒ½æ”¹äº†åŒä¸€ä¸ªæ–‡ä»¶ï¼Œä½†ä¸€ä¸ªæ”¹çš„æ˜¯ç¬¬ 1 è¡Œï¼Œå¦ä¸€ä¸ªæ”¹çš„æ˜¯ç¬¬ 2 è¡Œï¼Œé‚£ä¹ˆåˆå¹¶åå°±æ˜¯ç¬¬ 1 è¡Œå’Œç¬¬ 2 è¡Œéƒ½æ”¹ï¼Œä¹Ÿæ˜¯è‡ªåŠ¨å®Œæˆã€‚ä½†å¦‚æœä¸¤ä¸ªåˆ†æ”¯ä¿®æ”¹äº†åŒä¸€éƒ¨åˆ†å†…å®¹ï¼Œmerge çš„è‡ªåŠ¨ç®—æ³•å°±æä¸å®šäº†ã€‚è¿™ç§æƒ…å†µ Git ç§°ä¹‹ä¸ºï¼šå†²çªï¼ˆConflictï¼‰ã€‚ ä¾‹å¦‚ï¼šgitä»“åº“ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶ shopping-list.txtï¼Œå†…å®¹å¦‚ä¸‹ï¼š ç§»åŠ¨ç¡¬ç›˜ å¥³è£… æˆ‘ä»¬ç”¨ä¸¤ä¸ªåˆ†æ”¯åˆ†åˆ«ä¿®æ”¹æ–‡ä»¶çš„åŒä¸€ä¸ªåœ°æ–¹ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªåˆ†æ”¯ feature1ï¼š 1git branch feature1 åœ¨ master ä¸­ä¿®æ”¹å†…å®¹å¹¶æäº¤ï¼š 12345 ç§»åŠ¨ç¡¬ç›˜ å¥³è£…ï¼ˆå·²ä¹°ï¼‰git add shopping-list.txtgit commit -m \"è´­ä¹°å¥³è£…\" åˆ‡æ¢åˆ° feature1 ä¿®æ”¹å¹¶æäº¤ï¼š 1234567git checkout feature1 ç§»åŠ¨ç¡¬ç›˜ å¥³è£…ï¼ˆæ²¡ä¹°ï¼‰git add shopping-list.txtgit commit -m \"æ²¡ä¹°å¥³è£…\" æ­¤æ—¶åˆ‡æ¢å› master ï¼Œæ‰§è¡Œ git merge feature1ï¼Œgit å‚»äº† åœ¨ shopping-list.txt ä¸­å‡ºç°äº† â€œmerge conflictâ€ï¼Œè‡ªåŠ¨åˆå¹¶å¤±è´¥ï¼Œè¦æ±‚ â€œfix conflicts and then commit the resultâ€ï¼ˆæŠŠå†²çªè§£å†³æ‰åæäº¤ï¼‰ ç¬¬ä¸€æ­¥ï¼šè§£å†³å†²çªï¼Œæ‰“å¼€å†²çªçš„æ–‡ä»¶ï¼š ç§»åŠ¨ç¡¬ç›˜ &lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD å¥³è£…ï¼ˆå·²ä¹°ï¼‰ ======= å¥³è£…ï¼ˆæ²¡ä¹°ï¼‰ &gt;&gt;&gt;&gt;&gt;&gt;&gt; feature1 å‘ç°å†…å®¹æœ‰äº›å˜åŒ–ï¼ŒGit è™½ç„¶æ²¡æœ‰å¸®ä½ å®Œæˆè‡ªåŠ¨ mergeï¼Œä½†å®ƒå¯¹æ–‡ä»¶è¿˜æ˜¯åšäº†ä¸€äº›å·¥ä½œï¼šå®ƒæŠŠä¸¤ä¸ªåˆ†æ”¯å†²çªçš„å†…å®¹æ”¾åœ¨äº†ä¸€èµ·ï¼Œå¹¶ç”¨ç¬¦å·æ ‡è®°å‡ºäº†å®ƒä»¬çš„è¾¹ç•Œä»¥åŠå®ƒä»¬çš„å‡ºå¤„ã€‚ æˆ‘ä»¬è¦ä¿ç•™ä¸»åˆ†æ”¯çš„æ›´æ”¹ï¼Œå³ï¼šâ€œè´­ä¹°å¥³è£…â€ï¼Œåªè¦åˆ é™¤æ‰ feature1 çš„ä¿®æ”¹ï¼Œå†æŠŠ Git æ·»åŠ çš„é‚£ä¸‰è¡Œ &lt;&lt;&lt; === &gt;&gt;&gt; è¾…åŠ©æ–‡å­—ä¹Ÿåˆ æ‰ï¼Œä¿å­˜æ–‡ä»¶é€€å‡ºï¼Œå†²çªå°±è§£å†³äº†ã€‚ ç¬¬äºŒæ­¥ï¼šæ‰‹åŠ¨æäº¤ï¼Œæäº¤è§£å†³å†²çªä¹‹åçš„æ–‡ä»¶ï¼š 12git add shopping-list.txt # è¿™é‡Œ commit å‰ä¹Ÿéœ€è¦å…ˆ add ä¸€ä¸‹git commit å¦‚æœè¦æ”¾å¼ƒè¿™æ¬¡ merge ï¼Œå¯ä»¥æ‰§è¡Œï¼š 1git merge --abort HEAD é¢†å…ˆäºç›®æ ‡ commitå¦‚æœ merge æ—¶çš„ç›®æ ‡ commit å’Œ HEAD å¤„çš„ commit å¹¶ä¸å­˜åœ¨åˆ†å‰ï¼Œè€Œæ˜¯ HEAD é¢†å…ˆäºç›®æ ‡ commitã€‚ é‚£ä¹ˆ merge å°±æ²¡å¿…è¦å†åˆ›å»ºä¸€ä¸ªæ–°çš„ commit æ¥è¿›è¡Œåˆå¹¶æ“ä½œï¼Œå› ä¸ºå¹¶æ²¡æœ‰ä»€ä¹ˆéœ€è¦åˆå¹¶çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ Git ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œmerge æ˜¯ä¸€ä¸ªç©ºæ“ä½œã€‚ HEAD è½åäºç›®æ ‡ commitå¦‚æœ HEAD å’Œç›®æ ‡ commit ä¸å­˜åœ¨åˆ†å‰ï¼Œä½† HEAD è½åäºç›®æ ‡ commitã€‚é‚£ä¹ˆ Git ä¼šç›´æ¥æŠŠ HEADï¼ˆä»¥åŠå®ƒæ‰€æŒ‡å‘çš„ branchï¼Œå¦‚æœæœ‰çš„è¯ï¼‰ç§»åŠ¨åˆ°ç›®æ ‡ commitã€‚è¿™ä¹Ÿå«åšï¼šâ€œfast-forwardâ€ã€‚ fast-forward è¿™ç§åœºæ™¯åœ¨ pull ä¸­ç»å¸¸é‡åˆ°ï¼šæœ¬åœ°çš„ master æ²¡æœ‰æ–°æäº¤ï¼Œè€Œè¿œç«¯ä»“åº“ä¸­æœ‰åŒäº‹æäº¤äº†æ–°å†…å®¹åˆ° masterï¼Œæ­¤æ—¶çš„ HEAD è½åäºç›®æ ‡ commitï¼ˆè¿œç¨‹çš„ HEADï¼‰ï¼Œè€Œé€ æˆ â€œfast-forwardâ€ã€‚ Feature Branching å·¥ä½œæµ ä¹‹å‰çš„å·¥ä½œæ¨¡å‹æ˜¯ï¼šæ‰€æœ‰äººéƒ½åœ¨ master åˆ†æ”¯ä¸Šå·¥ä½œï¼Œcommit äº†ä»£ç é€šè¿‡ push æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œè·å–åˆ«äººçš„ commit é€šè¿‡ pullã€‚è¿™ç§æ¨¡å‹çš„å±€é™æ€§åœ¨äºï¼šæ¯ä¸€ä¸ªäººçš„ä»£ç åœ¨è¢«å¤§å®¶çœ‹åˆ°çš„æ—¶å€™ï¼Œæ˜¯å®ƒæ­£å¼è¿›å…¥ç”Ÿäº§ç¯å¢ƒçš„æ—¶å€™ã€‚æ‰€æœ‰äººçš„ä»£ç éƒ½ç›´æ¥ push åˆ°è¿œç¨‹çš„ masterï¼Œè¿™å°±å¯¼è‡´äº†æ¯ä¸ªäººçš„ä»£ç åœ¨æ­£å¼å¯ç”¨ï¼ˆæŠ•å…¥ç”Ÿäº§ç¯å¢ƒï¼‰å‰æ— æ³•è¢«åˆ«äººçœ‹åˆ°ã€‚ è¿™æ ·å°±è®©ä»£ç åœ¨æ­£å¼å¯ç”¨å‰çš„è®¨è®ºå’Œå®¡é˜…æä¸æ–¹ä¾¿ã€‚ feature branching å·¥ä½œæµè§£å†³äº†è¿™ç§é—®é¢˜ï¼Œè¯¥å·¥ä½œæµçš„æ ¸å¿ƒç‰¹ç‚¹å¦‚ä¸‹ï¼š ä»»ä½•ä¸€ä¸ªæ–°åŠŸèƒ½ï¼ˆfeatureï¼‰å’Œ bug çš„ä¿®å¤éƒ½ç”¨ä¸€ä¸ªæ–°çš„ branch æ¥å†™ï¼› branch å†™å®Œä¹‹åï¼Œåˆå¹¶åˆ° masterï¼Œå†åˆ é™¤è¿™ä¸ª branchã€‚ è¿™ç§å·¥ä½œæµä¸ºå›¢é˜Ÿåä½œé—´çš„ ä»£ç å®¡é˜… / ä¸€äººå¤šä»»åŠ¡ æä¾›è§£å†³æ–¹æ¡ˆã€‚ ä»£ç å®¡é˜…ï¼ˆbranch / commit / push / review / mergeï¼‰å‡å¦‚è¦å¼€å‘ä¸€ä¸ªæ–°çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåˆ†æ”¯ books ï¼Œå¼€å§‹å¼€å‘ï¼š git checkout -b books # åˆ›å»ºåˆ†æ”¯å¹¶åˆ‡æ¢è¿‡å» åå‡ ä¸ª commit è¿‡åï¼ŒåŠŸèƒ½å¼€å‘å®Œæ¯•ï¼Œå‘Šè¯‰åŒäº‹åŠŸèƒ½å¼€å‘å®Œæ¯•ï¼Œæœ‰æ—¶é—´å¸®æˆ‘ review ä¸€ä¸‹å‘—ï¼Œåˆ†æ”¯åæ˜¯ booksï¼Œç„¶åæŠŠè¿™ä¸ªåˆ†æ”¯ push ä¸Šå»ï¼š # ç¡®ä¿å½“å‰åœ¨ books åˆ†æ”¯ï¼Œå°†å½“å‰åˆ†æ”¯ push åˆ°è¿œç¨‹ä»“åº“çš„ books åˆ†æ”¯ã€‚ git push origin books [ æ¨¡æ‹ŸåŒäº‹ï¼šreview åˆšåˆšä¸Šä¼ çš„ books åˆ†æ”¯ï¼š] # å…‹éš†åŒäº‹çš„ä»“åº“åˆ°æ¡Œé¢ï¼ˆå¦‚æœåŒäº‹æœ‰è¿™ä¸ªä»“åº“å°±æ˜¯ git pull ï¼‰ git clone https://github.com/yuzh233/git-practical-guide.git cd git-practical-guide git checkout books # åˆ‡æ¢åˆ°åŒäº‹åˆšåˆšå¼€å‘æ–°åŠŸèƒ½çš„åˆ†æ”¯ï¼šbooks å¼€å§‹ review ... [ review å®Œæ¯•ï¼ŒåŒäº‹ï¼šæˆ‘è§‰å¾—å¾ˆ OK å•Š~ å¯ä»¥åˆå¹¶äº†ï¼] äºæ˜¯æˆ‘ä¸€é¡¿æ“ä½œï¼š git checkout master git pull # ä¿æŒæ›´æ–°ï¼Œæ˜¯ä¸ªå¥½ä¹ æƒ¯ git merge books -- æ­¤æ—¶ books åˆ†æ”¯çš„å†…å®¹åˆå¹¶åˆ°äº† master å·¥ä½œç›®å½• -- ç´§æ¥ç€ï¼ŒæŠŠåˆå¹¶åçš„ master push ä¸Šå»ï¼Œå¹¶åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹çš„ books åˆ†æ”¯ï¼š git push git branch -d books # åˆ é™¤æœ¬åœ° books åˆ†æ”¯ git push origin -d books # åˆ é™¤è¿œç¨‹ books åˆ†æ”¯ ä¸€åˆ‡éƒ½æ˜¯è¿™ä¹ˆçš„å®Œç¾ï¼Œç„¶è€Œæ­¤æ—¶ä¸€ä¸ªåŒäº‹å‘ç°ä¸å¯¹ï¼Œè¯´ï¼šâ€œå˜¿ï¼ä½ çš„ä»£ç ç¼©è¿›æ€ä¹ˆæ˜¯ tab ï¼Œå¿«æ”¹æˆç©ºæ ¼ï¼Œä¸ç„¶ç æ­»ä½ å“¦~â€ï¼Œæˆ‘ä¸€çœ‹æƒ…å†µä¸å¯¹ï¼Œç«‹é©¬é‡å¤ä¸Šé¢çš„æ“ä½œï¼šæ–°å»ºåˆ†æ”¯ã€æ”¹ä»£ç ã€æ¨é€ä¸Šå»ã€åŒäº‹å®¡é˜…ã€åˆå¹¶ã€å†æ¨é€ã€åˆ é™¤åˆ†æ”¯ï¼Œokï¼Œç©ºæ ¼å…šè§‰å¾—å¾ˆokï¼Œä¹~ perfectã€‚[ ç„¶è€Œï¼Œå‘ç°äº‹æƒ…æ²¡æœ‰è¿™ä¹ˆç®€å•â€¦ ] 12345678910git branch booksgit checkout books--- tab æ”¹ä¸º ç©ºæ ¼ git add / git commit ---git push origin books--- review... ok ---git checkout mastergit merge books # è¿™é‡Œä¼šå‡ºç° Fast-forwardï¼ŒåŸå› æ˜¯å½“å‰commitï¼ˆHEADï¼‰è½åäºç›®æ ‡commitï¼ˆbooks çš„ commit æ¯” master çš„ HEAD é¢†å…ˆï¼‰git pushgit branch -d booksgit push origin -d books pull request åœ¨ä¸Šä¸€ä¸»é¢˜ï¼ŒåŒäº‹å–åˆ°æˆ‘çš„æ–°åŠŸèƒ½å®¡é˜…ä»£ç ï¼Œéƒ½æ˜¯åœ¨è‡ªå·±æœ¬åœ°ä¸­æ‰“å¼€ï¼Œè§‰å¾—æœ‰é—®é¢˜ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡çŸ­ä¿¡ç”µè¯ï¼Œå‘é‚®ä»¶ç­‰ã€‚è¿™æ ·çš„å®¡é˜…æ˜¯å¾ˆä¸æ–¹ä¾¿çš„ï¼Œè€Œ pull request å°±æ˜¯å¯¹å‰é¢ä»£ç å®¡é˜…è¿‡ç¨‹çš„ç®€åŒ–ã€‚ pull request ä¸æ˜¯ git çš„å†…å®¹ï¼Œè€Œæ˜¯ git æœåŠ¡æä¾›å•†ï¼ˆå¦‚ GitHubï¼‰æä¾›çš„ä¸€ç§ä¾¿æ·åŠŸèƒ½ï¼Œå¯ä»¥è®©å›¢é˜Ÿæ–¹ä¾¿çš„è®¨è®ºä¸€ä¸ª branchï¼Œå¹¶åœ¨è®¨è®ºç»“æŸåä¸€ä»¶åˆå¹¶è¿™ä¸ª branch åˆ° masterã€‚ å¦‚ï¼šç°åœ¨åˆ›å»ºä¸€ä¸ªåˆ†æ”¯ä¿®æ”¹è´­ç‰©æ¸…å•ï¼šâ€œè´­ä¹°SSDâ€ï¼Œå¹¶æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œgithub ä¼šè‡ªåŠ¨æç¤ºæ˜¯å¦ pull request: åˆ›å»ºä¸€ä¸ª pull requestï¼š åˆ›å»ºä¹‹åï¼Œå…¶ä»–åŒäº‹å°±å¯ä»¥åœ¨ github ä¸Šçœ‹åˆ°æˆ‘ä»¬çš„æ‹‰è¯·æ±‚ã€‚ä»–ä»¬å¯ä»¥åœ¨è¿™ä¸ªé¡µé¢æŸ¥çœ‹æˆ‘ä»¬çš„æ‰€æœ‰ commit å¹¶æå»ºè®®ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®åŒäº‹ä»¬çš„å»ºè®®æäº¤æ–°çš„ commit å¹¶ push åˆ°è¿™ä¸ªåˆ†æ”¯ï¼Œè¿™ä¸ªé¡µé¢ä¼šéšç€ push å±•ç¤ºæœ€æ–°çš„ commitã€‚ æˆ‘ä»¬åœ¨ feature1 åˆ†æ”¯åˆå†³å®šä¸ä¹°SSDäº†ï¼Œäºæ˜¯æ›´æ–°åé‡æ–° pushï¼Œæ­¤æ—¶è¯¥ç•Œé¢ä¹ŸåŒæ­¥æ›´æ–°äº†ä¸€æ¡ commitï¼š å°±è¿™æ ·ï¼Œæ ¹æ®åŒäº‹çš„æ„è§ä¸æ–­çš„ push æ–° commit ä¹‹åï¼Œæœ€ç»ˆä¸€è‡´å†³å®šæ²¡é—®é¢˜å¯ä»¥åˆå¹¶åˆ° master äº†ï¼Œç‚¹å‡» Merge pull request ï¼ŒGitHub ä¼šè‡ªåŠ¨åœ¨ä¸­å¤®ä»“åº“ä¸­å°† feature1 åˆå¹¶åˆ° masterã€‚ ä¸€äººå¤šä»»åŠ¡åˆ©ç”¨ feature branching å·¥ä½œæµï¼Œä¸€ä¸ªå¤šä»»åŠ¡å¹¶è¡Œå¼€å‘å˜å¾—ç®€å•å¤šäº†ã€‚å½“ä¸€ä¸ªæ–°ä»»åŠ¡ä¸‹å‘æ—¶ï¼Œæˆ‘ä»¬ä»…éœ€è¦å°†å½“å‰ä»»åŠ¡çš„åˆ†æ”¯ç®€å•æ”¶å°¾ä¸€ä¸‹ï¼Œå›åˆ°ä¸»åˆ†æ”¯å†å¼€è¾Ÿä¸€ä¸ªæ–°ä»»åŠ¡çš„åˆ†æ”¯å°±å¯ä»¥å¼€å‘æ–°çš„ä»»åŠ¡äº†ã€‚ å…³äº addadd æŒ‡ä»¤é™¤äº† git add æ–‡ä»¶å è¿™ç§ç”¨æ³•å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ add . æ¥ç›´æ¥æŠŠå·¥ä½œç›®å½•ä¸‹çš„æ‰€æœ‰æ”¹åŠ¨å…¨éƒ¨æ”¾è¿›æš‚å­˜åŒº add æ·»åŠ çš„æ˜¯æ–‡ä»¶æ”¹åŠ¨ï¼Œè€Œä¸æ˜¯æ–‡ä»¶åã€‚ä¹Ÿå°±æ˜¯è¯´,å¯¹æ–‡ä»¶ä¿®æ”¹ä¹‹åé€šè¿‡ add æ”¾å…¥æš‚å­˜åŒºï¼Œå†ä¿®æ”¹ä¸€æ¬¡è¯¥æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œ commitï¼Œç¬¬äºŒæ¬¡çš„ä¿®æ”¹å¹¶æ²¡æœ‰æäº¤ï¼ŒåŸå› æ˜¯ç¬¬äºŒæ¬¡æ”¹åŠ¨äº†å†…å®¹æ²¡æœ‰é‡æ–° addã€‚ add ä¹Ÿæ”¯æŒåŒ¹é…è¡¨è¾¾å¼ï¼Œå¦‚ add *.java add æ–‡ä»¶è¿›æš‚å­˜åŒºï¼Œåˆä¸æƒ³ add äº†ï¼Œä½¿ç”¨ï¼šgit reset HEAD filename çœ‹çœ‹æˆ‘æ”¹äº†ä»€ä¹ˆ æŸ¥çœ‹å†å²è®°å½• git log æŸ¥çœ‹è¯¦ç»†å†å²è®°å½• git log -p æŸ¥çœ‹æ¦‚è¦å†å²è®°å½• git log --stat æŸ¥çœ‹å½“å‰ï¼ˆHEADæŒ‡å‘çš„ï¼‰ commit çš„ä¿¡æ¯ git show æŸ¥çœ‹æŒ‡å®š commit çš„ä¿¡æ¯ï¼šgit show &lt;commitçš„å¼•ç”¨&gt; æŸ¥çœ‹æŒ‡å®š commit ä¸­çš„æŸä¸ªæ–‡ä»¶çš„æ”¹åŠ¨ï¼šgit show 2edc shopping-list.txt æŸ¥çœ‹å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„åŒºåˆ«ï¼šgit diff æŸ¥çœ‹æš‚å­˜åŒºå’Œä¸Šä¸€æ¡æäº¤çš„åŒºåˆ«ï¼šgit diff --staged æŸ¥çœ‹å·¥ä½œç›®å½•å’Œä¸Šä¸€æ¡ commit çš„åŒºåˆ«ï¼šgit diff HEAD ä¸å–œæ¬¢ merge çš„åˆ†å‰ï¼Ÿç”¨ rebase æŠŠ rebase â€”â€” ç»™å½“å‰ commit åºåˆ—é‡æ–°è®¾ç½®åŸºç¡€ç‚¹ï¼ˆä¹Ÿå°±æ˜¯çˆ¶ commitï¼‰ã€‚å°±æ˜¯è¯´ï¼ŒæŠŠæŒ‡å®šçš„ commit ä»¥åŠæ‰€åœ¨çš„ commit ä¸²ï¼Œä»¥æŒ‡å®šçš„ç›®æ ‡ commit ä¸ºåŸºç¡€ï¼ˆå¤´ï¼‰ï¼Œé‡æ–°ä½œä¸ºä¸€æ¬¡æäº¤ã€‚ ä¾‹å¦‚ï¼šä¸‹é¢æ˜¯ä¸€ä¸ª merge æ“ä½œ: git merge branch1 å¦‚æœæŠŠ merge æ¢æˆ rebaseï¼š git checkout branch1 git rebase master å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ rebaseï¼Œå°† commit 5 å’Œ commit 6 è¿™ä¸ª commit ä¸²ï¼Œä»åŸæœ‰çš„çˆ¶èŠ‚ç‚¹ commit 2 ç§»åˆ°ç°åœ¨çš„çˆ¶èŠ‚ç‚¹ commit 4ã€‚é€šè¿‡è¿™æ ·ï¼Œè®©åŸæœ¬åˆ†å‰çš„æäº¤å†å²é‡æ–°å›åˆ°äº†ä¸€æ¡çº¿ã€‚è¿™ç§ [ é‡æ–°è®¾ç½®åŸºç¡€ç‚¹ ] çš„æ“ä½œï¼Œå°±æ˜¯ rebase çš„å«ä¹‰ã€‚ åœ¨ branch1 åˆ†æ”¯ rebase master ä¹‹åï¼Œbranch1 è·‘åˆ° master å‰é¢å˜æˆäº†åŒä¸€æ¡çº¿ï¼Œä½†æ˜¯å®é™…ä¸Šè¿˜æ˜¯ä¸¤ä¸ªå½¼æ­¤ç‹¬ç«‹çš„åˆ†æ”¯ï¼Œåªä¸è¿‡ branch1 ç°åœ¨æ˜¯ä»¥ master çš„ HEADï¼ˆå³ï¼šcommit 4ï¼‰ ä½œä¸º åŸºç¡€ç‚¹ï¼ˆcommit ä¸²çš„å¤´ï¼‰ã€‚master çš„ HEAD æ˜¯ commit 4ï¼Œbranch1 çš„ HEAD æ˜¯ commit 8ï¼Œå¹¶ä¸” branch1 çš„ commits é¢†å…ˆäº master çš„ commitsã€‚ æˆ‘ä»¬å¸Œæœ›ç”¨ rebase ä¹‹åèƒ½å®ç°å’Œ merge ä¸€æ ·çš„åˆå¹¶ä¸¤æ¡åˆ†æ”¯çš„æ•ˆæœï¼Œé‚£ä¹ˆæ€ä¹ˆåšå‘¢ï¼Ÿå…¶å®è¿˜æ˜¯éœ€è¦ç”¨åˆ° merge æ“ä½œï¼Œå½“å‰åˆ†æ”¯ï¼ˆmasterï¼‰ä¸ç›®æ ‡åˆ†æ”¯ï¼ˆbranch1ï¼‰æ²¡æœ‰åˆ†å‰ï¼Œå¹¶ä¸”å½“å‰ HEAD è½åäºç›®æ ‡åˆ†æ”¯çš„ commitï¼Œä½¿ç”¨ mergeï¼Œå°† HEAD ç§»åˆ°ç›®æ ‡çš„ commitï¼Œè¿™å°±æ˜¯å‰é¢å­¦åˆ°è¿‡çš„ Fast-Forwardã€‚ git checkout master # è¿˜éœ€å…ˆåˆ‡æ¢å› master git merge branch1 [ è’™åœˆäº†æ€ä¹ˆåŠï¼Œæ¼”ç¤ºä¸€æŠŠï¼š ] -----------&lt; æ–°å»ºä¸€ä¸ªåˆ†æ”¯ &gt;----------- git branch branch1 -----------&lt; åœ¨ master åˆ›å»ºä¸€ä¸ªæäº¤ &gt;----------- touch a.txt git add a.txt git commit -m &quot;add a.txt&quot; -----------&lt; åœ¨ branch1 åˆ›å»ºä¸€ä¸ªæäº¤ &gt;----------- git checkout branch1 touch b.txt / touch c.txt git add b.txt c.txt git commit -m &quot;add b.txt c.txt&quot; -----------&lt; æƒ³æŠŠ branch1 åˆå¹¶åˆ° master ä½†æ˜¯ä¸æƒ³æœ‰åˆ†å‰ &gt;----------- # æ³¨æ„ï¼šå¿…é¡»å…ˆåˆ‡æ¢åˆ°è¢«åˆå¹¶çš„åˆ†æ”¯ï¼ git checkout branch1 git rebase master [ æ­¤æ—¶ï¼Œbranch1 å’Œ master å±äºåŒä¸€æ¡çº¿ï¼Œä½†æ˜¯ branch1 é¢†å…ˆäº masterï¼š] [ branch1 çš„æ–°æäº¤æ˜¯ a.txt / b.txt ï¼Œmaster çš„æ–°æäº¤æ˜¯ a.txtï¼Œæ­¤æ—¶åˆå¹¶åˆ° masterï¼šgit checkout master / git merge branch1] [ å¯ä»¥çœ‹å‡ºæ˜¯ä¸€ä¸ªå¿«é€Ÿå‰ç§»æ“ä½œï¼Œæ­¤æ—¶çš„æ—¥å¿—ï¼šmaster å·²ç»ç§»åˆ°äº†æœ€æ–°çš„ commit] æ³¨æ„äº‹é¡¹ merge æ“ä½œæ˜¯åœ¨åˆå¹¶åˆ†æ”¯ä¸Šè¿›è¡Œçš„ï¼› rebase æ“ä½œæ˜¯åœ¨ è¢«åˆå¹¶ åˆ†æ”¯ä¸Šè¿›è¡Œçš„ï¼Œè¿™ç‚¹å¾ˆé‡è¦ã€‚ rebase æ˜¯å¸¦ç€å½“å‰ commit ç§»åˆ°åˆ«çš„ commit ä¸Šã€Œå»ã€ï¼Œè€Œ merge åˆ™æ˜¯æŠŠåˆ«çš„ commit åˆå¹¶è¿‡ã€Œæ¥ã€ â€œ ä¸ºä»€ä¹ˆè¦åœ¨è¢«åˆå¹¶åˆ†æ”¯ branch1 ä¸Šæ‰§è¡Œ rebaseï¼Œåœ¨åˆå¹¶åˆ†æ”¯ masterä¸Šæ‰§è¡Œ mergeï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨ masterä¸Šæ‰§è¡Œ rebase å‘¢ï¼Ÿâ€ â€”â€” ç®€å•çš„ç†è§£å°±æ˜¯ï¼šè¿™ä¸¤ç§ rebase æœ¬èº«å°±æ˜¯ä¸¤ç§ä¸åŒçš„æƒ…å†µï¼Œå¦‚æœåœ¨ master ä¸Š rebaseï¼šgit checkout master / git rebase branch1 ï¼Œmaster å°±ä¼šå¸¦ç€å®ƒçš„ commit ä¸²å†…å®¹ä½œä¸ºæ–°çš„ commit è·‘åˆ° branch1 çš„ HEAD å‰é¢å»å•¦ï¼ master è·‘åˆ°äº† branch1 è¿™æ¡çº¿ä¸Šï¼Œmaster çš„ commit çš„å†…å®¹è¿˜æ˜¯ä»¥å‰çš„å†…å®¹ï¼Œä½†æ˜¯å´ä¸æ˜¯åŒä¸€ä¸ª commit äº†ï¼Œåªä¸è¿‡æ˜¯å†…å®¹ç›¸åŒçš„å¦å¤–ä¸€ä¸ª commitç½¢äº†ã€‚è€Œå¦‚æœè¿œç¨‹ä»“åº“æœ‰ä¹‹å‰ master çš„ commitï¼Œä½†æ˜¯åœ¨æœ¬åœ°ä»“åº“ä¸­æ‰¾ä¸åˆ°è¿œç¨‹åº“å¯¹åº”çš„è¿™ä¸ª commitï¼Œä¼šå› ä¸ºè¿œç¨‹åº“å«æœ‰æœ¬åœ°æ²¡æœ‰çš„ commit å¯¼è‡´ push å¤±è´¥ï¼ åº”ç”¨åœºæ™¯ ä½ è‡ªå·±å¼€å‘åˆ†æ”¯ä¸€ç›´åœ¨åšï¼Œç„¶åæŸä¸€å¤©ï¼Œä½ æƒ³æŠŠä¸»çº¿çš„ä¿®æ”¹åˆåˆ°ä½ çš„åˆ†æ”¯ä¸Šï¼Œåšä¸€æ¬¡é›†æˆï¼Œè¿™ç§æƒ…å†µå°±ç”¨ rebase æ¯”è¾ƒå¥½ã€‚æŠŠä½ çš„æäº¤éƒ½æ”¾åœ¨ä¸»çº¿ä¿®æ”¹çš„å¤´ä¸Šã€‚ å‚è€ƒï¼šgit rebase è¿˜æ˜¯ mergeçš„ä½¿ç”¨åœºæ™¯æœ€é€šä¿—çš„è§£é‡Š ä¿®æ­£ commitç”¨ commit --amend ä¿®å¤å½“å‰æäº¤çš„é”™è¯¯ã€‚åœ¨ commit ä¸€æ¡æäº¤ä¹‹åå‘ç°å†™é”™äº†ï¼Œæˆ‘è¦ä¹°ï¼šâ€œæœºæ¢°é”®ç›˜â€ï¼Œå¯ä»¥ä½¿ç”¨ commit --amend æŒ‡ä»¤æ¥ä¿®æ­£æœ¬æ¬¡æäº¤çš„é”™è¯¯ã€‚git ä¸ä¼šåœ¨å½“å‰ commit ä¸Šå¢åŠ  commit ï¼Œè€Œæ˜¯æŠŠå½“å‰ commit é‡Œçš„å†…å®¹å’Œæš‚å­˜åŒºçš„å†…å®¹åˆå¹¶èµ·æ¥å½¢æˆä¸€ä¸ªæ–°çš„ commitï¼Œç”¨æ–°çš„ commit æŠŠå½“å‰çš„ commit æ›¿æ¢æ‰ã€‚ [ æˆ‘ä»¬åœ¨è´­ç‰©æ¸…å•ä¸­æ·»åŠ ä¸€ä¸ªï¼šâ€œè–„è†œé”®ç›˜â€ï¼Œæäº¤ä¹‹åå‘ç°å†™é”™äº†â€¦ äºæ˜¯å°†å†…å®¹é‡æ–°ä¿®æ”¹ï¼Œå¹¶é‡æ–° add åˆ°æš‚å­˜åŒºï¼Œä½¿ç”¨ commit â€“amend æŒ‡ä»¤è¦†ç›–å½“å‰æäº¤ï¼š] ä¿®æ­£ä¹‹åå¯ä»¥å‘ç°åªæœ‰ä¸€æ¡ commit è®°å½•ã€‚ ä¿®æ­£æŒ‡å®š commit äº¤äº’å¼ rebaseï¼šgit rebase -i &lt;æŒ‡å®š commit é“¾çš„å¤´&gt; æ‰€è°“äº¤äº’å¼ rebaseï¼Œå°±æ˜¯åœ¨ rebase çš„æ“ä½œæ‰§è¡Œä¹‹å‰ï¼ŒæŒ‡å®šè¦ rebase çš„ commit é“¾ä¸­çš„æ¯ä¸€ä¸ª commit æ˜¯å¦éœ€è¦è¿›ä¸€æ­¥ä¿®æ”¹ã€‚ -------&lt; ç¬¬ä¸€æ¬¡æäº¤ &gt;------- æˆ‘ä»¬åœ¨æ–‡ä»¶ rebase-i.txt ä¸­æ·»åŠ ä¸€è¡Œ aaaaa åæ‰§è¡Œæäº¤ï¼šgit add rebase-i.txt / git commit -m &quot;aaaaa&quot; -------&lt; ç¬¬äºŒæ¬¡æäº¤ &gt;------- åœ¨æ–‡ä»¶ rebase-i.txt ä¸­åˆæ·»åŠ ä¸€è¡Œ bbbbb åæ‰§è¡Œæäº¤ï¼šgit add rebase-i.txt / git commit -m &quot;bbbbb&quot; æŸ¥çœ‹æ—¥å¿—ï¼š ä½†æ˜¯å‘ç° â€œaaaaaâ€ è¿™ä¸ªæäº¤çš„å†…å®¹å†™é”™äº†ï¼Œæƒ³è¦ä¿®æ”¹è¿™æ¬¡æäº¤ã€‚ç”±äºä¸æ˜¯æœ€æ–°çš„æäº¤ï¼Œä¸èƒ½ä½¿ç”¨ commit â€“amend æ¥ä¿®æ­£ã€‚ å¯ä»¥ä½¿ç”¨ rabseï¼Œä¸è¿‡æ­¤æ—¶çš„ rebase æ˜¯åœ¨åŒä¸€æ¡åŸºçº¿ä¸Šï¼Œä¹Ÿå« [åŸåœ° rebase]ï¼Œé€šè¿‡åŸåœ°å˜åŸºï¼ŒæŒ‡å®šä¸€ä¸ª commit ï¼Œå°†å…¶æ‰€åœ¨çš„ commits ä¸²ä»çˆ¶åŸºç¡€ç‚¹æ–­å¼€ã€‚ç„¶åå¯¹è¯¥ commits ä¸²ä¸­çš„æ¯ä¸€ä¸ª commit ä¿®æ”¹åé‡æ–°æŒ‚åœ¨åŸæ¥çš„çˆ¶åŸºç¡€ç‚¹ã€‚ ä½¿ç”¨ git rebase -i HEAD^^ or git rebase -i HEAD~2 æ¥æŒ‡å®šä»å“ªä¸ª commit å¼€å§‹å˜åŸºã€‚ï¼ˆrebase ä¹‹å‰éœ€è¦å°†å·¥ä½œç©ºé—´æ–°çš„ä¿®æ”¹æ”¾å…¥æš‚å­˜åŒºï¼Œæ‰€ä»¥ç°åœ¨æœ‰äº†ä¸‰æ¡æäº¤ã€‚ï¼‰ æˆ‘ä»¬è¦ä¿®æ­£æŒ‡å®šçš„ commitï¼Œå°†éœ€è¦è¢«ä¿®æ­£çš„ commit å¯¹åº”çš„æ“ä½œç”± pick æ”¹ä¸º editï¼ˆåº”ç”¨å½“å‰çš„æäº¤ï¼Œä½†æ˜¯åœä¸‹æ¥ä¿®æ­£ï¼‰ï¼š æ ¹æ®æç¤ºä¿¡æ¯ï¼šrebase å·²ç»åœåˆ°äº† â€œaaaaaâ€ è¿™ä¸ªæäº¤ï¼Œç°åœ¨å¯ä»¥ä¿®æ­£è¿™ä¸ªæäº¤ï¼š 12ä¿®æ”¹ aaaaa ä¸º aaaaa_amendgit commit --amend # åº”ç”¨è¿™ä¸ªä¿®å¤ ä¿®å¤äº†ç¬¬ä¸€ä¸ªä¹‹åï¼Œæ‰§è¡Œï¼šgit rebase --continue ç»§ç»­æ‰§è¡Œç¬¬äºŒä¸ªï¼šç¬¬äºŒä¸ªä¹Ÿæ˜¯ä¿®å¤ï¼Œå¯¹æ–‡ä»¶ä¿®æ”¹ amend ä¹‹åç»§ç»­ continue ï¼Œç¬¬ä¸‰ä¸ª commit æ˜¯é»˜è®¤æ“ä½œæ˜¯ pickï¼ˆåº”ç”¨å½“å‰çš„æäº¤ï¼‰ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼Œè‡³æ­¤rebaseå®Œæ¯•ã€‚ æ’¤é”€ commit â€”â€” resetgit add åæ’¤é”€ï¼š æ’¤é”€æ‰€æœ‰addæ–‡ä»¶ git reset HEAD . æ’¤é”€å•ä¸ªaddæ–‡ä»¶ git reset HEAD -filename git commit åæ’¤é”€ï¼š åªå›é€€ commit çš„ä¿¡æ¯ï¼Œä¿ç•™ä¿®æ”¹ä»£ç ï¼šgit reset --soft head å›é€€åˆ°ä¸Šæ¬¡ commit ç‰ˆæœ¬ï¼Œä¸ä¿ç•™ä¿®æ”¹ä»£ç ï¼šgit reset --hard head^ HEADï¼šå›é€€åˆ°å½“å‰ç‰ˆæœ¬ï¼ˆå•¥ä¹Ÿæ²¡å¹²ï¼‰ HEAD^ ï¼šå›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ reset æœ¬è´¨ä¸Šä¸æ˜¯æ’¤é”€æäº¤ï¼Œè€Œæ˜¯ç§»åŠ¨ HEAD ï¼Œå¹¶ä¸”ã€Œæå¸¦ã€ä¸Š HEAD æ‰€æŒ‡å‘çš„ branchï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œç”¨æ¥é‡ç½® HEAD ä»¥åŠå®ƒæ‰€æŒ‡å‘çš„ branch çš„ä½ç½®ã€‚ reset --hard HEAD^ ä¹‹æ‰€ä»¥èµ·åˆ°äº†æ’¤é”€å‰ä¸€ä¸ª commit çš„æ•ˆæœï¼Œæ˜¯å› ä¸ºå®ƒæŠŠ HEAD å’Œå®ƒæ‰€æŒ‡å‘çš„ branch ä¸€èµ·ç§»åŠ¨åˆ°äº†å½“å‰ commit çš„çˆ¶ commit ä¸Šï¼Œä»è€Œèµ·åˆ°äº†ã€Œæ’¤é”€ã€çš„æ•ˆæœï¼š æ³¨æ„ï¼š --hardï¼š æ·»åŠ è¿™ä¸ªå‚æ•°ä¼šæŠ›å¼ƒå½“å‰å·¥ä½œåŒºçš„ä¿®æ”¹ --softï¼š æ·»åŠ è¿™ä¸ªå‚æ•°ä¼šå›é€€åˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯ä¿ç•™å½“å‰å·¥ä½œåŒºçš„ä¿®æ”¹ï¼Œå¯ä»¥é‡æ–°æäº¤ æ’¤é”€æŒ‡å®š commit â€”â€” rebase -iç°æœ‰ä¸‰æ¡æäº¤ï¼Œè¦æ’¤é”€ç¬¬äºŒæ¡æäº¤ï¼š git rebase -i HEAD~3 æ“ä½œå½“å‰ commit æ‰€åœ¨ commits é“¾ä¸­ä¸‰æ¡ commitï¼š æ’¤é”€æŸä¸ª commit ï¼Œå°†è¿™ä¸€è¡Œåˆ é™¤å³å¯ã€‚æ­¤æ—¶ç¬¬äºŒæ¡ commit è¢«åˆ æ‰äº†ï¼š æ’¤é”€å·² push çš„ commit â€”â€” revertgit revert æ’¤é”€æŸæ¬¡æ“ä½œï¼Œæ­¤æ¬¡æ“ä½œä¹‹å‰å’Œä¹‹åçš„ commit å’Œ history éƒ½ä¼šä¿ç•™ï¼Œå¹¶ä¸”æŠŠè¿™æ¬¡æ’¤é”€ä½œä¸ºä¸€æ¬¡æœ€æ–°çš„æäº¤ã€‚ æ¯”å¦‚æˆ‘ä»¬æˆ‘ä»¬å¯¹æ–‡ä»¶rebase-i.txtæ·»åŠ ä¸¤æ¬¡ä¿®æ”¹å¹¶æäº¤ä¸¤æ¬¡å push åˆ°è¿œç¨‹åº“ï¼š æˆ‘ä»¬è¦æ’¤é”€å‰ä¸€æ¬¡æäº¤:â€bbbâ€ï¼Œä¹Ÿå°±æ˜¯åˆ é™¤æ–‡ä»¶ä¸­çš„â€œbbbâ€è¿™ä¸€è¡Œï¼šgit revert HEAD å¯ä»¥çœ‹åˆ°æ‰§è¡Œå®Œä¹‹åå¢åŠ äº†ä¸€æ¡æ–°çš„ commitï¼Œå®ƒçš„å†…å®¹å’Œæœ€æ–°çš„ commit æ˜¯ç›¸åçš„ï¼Œä»è€Œå’Œæœ€æ–°çš„ commit ç›¸äº’æŠµæ¶ˆï¼Œè¾¾åˆ°æ’¤é”€çš„æ•ˆæœã€‚ æŠŠæ–°çš„ commit å† push ä¸Šå»ï¼Œè¿™ä¸ª commit çš„å†…å®¹å°±è¢«æ’¤é”€äº†ã€‚å®ƒå’Œå‰é¢æ‰€ä»‹ç»çš„æ’¤é”€æ–¹å¼ reset ç›¸æ¯”ï¼Œæœ€ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼Œè¿™æ¬¡æ”¹åŠ¨åªæ˜¯è¢«ã€Œåè½¬ã€äº†ï¼Œå¹¶æ²¡æœ‰åœ¨å†å²ä¸­æ¶ˆå¤±æ‰ï¼Œä½ çš„å†å²ä¸­ä¼šå­˜åœ¨ä¸¤æ¡ commit ï¼šä¸€ä¸ªåŸå§‹ commit ï¼Œä¸€ä¸ªå¯¹å®ƒçš„åè½¬ commitã€‚ checkout â€”â€” ä¸æ­¢å¯ä»¥ç­¾å‡ºåˆ†æ”¯å‰é¢å­¦ä¹ è¿‡ï¼Œä½¿ç”¨ï¼šgit checkout &lt;branch-name&gt; å¯ä»¥åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ï¼Œå³ï¼šæŠŠ HEAD æŒ‡å‘æŒ‡å®šçš„ branchï¼Œç„¶åç­¾å‡ºè¿™ä¸ª branch æ‰€å¯¹åº”çš„ commit çš„å·¥ä½œç›®å½•ã€‚ å®é™…ä¸Š checkout çš„æœ¬è´¨æ˜¯ç­¾å‡ºæŒ‡å®šçš„ commitï¼Œä¸æ­¢å¯ä»¥åˆ‡æ¢ branchï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŒ‡å®š commit ä½œä¸ºå‚æ•°ï¼Œæ¥æŠŠ HEAD ç§»åŠ¨åˆ°æŒ‡å®šçš„ commitã€‚ å¯¹äºç­¾å‡ºï¼ˆcheckoutï¼‰çš„æ¦‚å¿µï¼Œç®€å•çš„ç†è§£å°±æ˜¯åˆ‡æ¢åˆ†æ”¯å¹¶åœ¨æœ¬åœ°ä»“åº“ä¸­å–å‡ºæŒ‡å®šåˆ†æ”¯çš„å†…å®¹åˆ°å·¥ä½œç›®å½•ã€‚ [ æ¼”ç¤ºï¼š] åˆ›å»ºä¸€ä¸ªæ–‡ä»¶abc.txtå¹¶ä½œä¸ºä¸€ä¸ªæäº¤ ä½¿ç”¨ reset æ’¤å›æäº¤ï¼ˆä¸ä¿ç•™ä¿®æ”¹ä»£ç ï¼‰ï¼š git reset --hard HEAD^ å¯ä»¥çœ‹åˆ°åˆšåˆšçš„æäº¤è¢«æ’¤é”€äº†ï¼ŒHEAD å¸¦ç€ master ä¸€èµ·æŒ‡å‘äº†ä¸Šä¸€æ¡ commitï¼š å¦‚æœç”¨ checkout æ¥æ’¤é”€æäº¤ï¼šgit checkout HEAD^ å¯ä»¥çœ‹åˆ°ï¼ŒHEAD å·²ç»å’Œåˆšåˆšå®ƒæŒ‡å‘çš„ branch -&gt; master è„±ç¦»äº†ï¼Œæ­¤æ—¶å¦‚æœç»§ç»­æäº¤æ›´æ”¹ï¼ŒHEAD å°±ä¼šè·Ÿç€æ–°çš„ commit è·‘ï¼Œè€Œ master ä¾æ—§åœåˆ°åŸåœ°ã€‚å½“æˆ‘ä»¬åˆ‡æ¢ master ä¹‹åï¼ŒHEADä¼šå› ä¸ºæ²¡æœ‰æ‰€å±åˆ†æ”¯è€Œæç¤ºï¼šâ€œä½ æœ‰nä¸ªæäº¤æ²¡æœ‰è¿æ¥åˆ°åˆ†æ”¯,å¯ä»¥é€šè¿‡ï¼šgit branch &lt;new-branch-name&gt; commitID å°†æ–°æäº¤æ”¾åˆ°æ–°åˆ›å»ºçš„åˆ†æ”¯ä¸Šå»ã€‚ç„¶åå¯ä»¥å°†è¯¥åˆ†æ”¯åˆå¹¶åˆ° masterã€‚â€ stash ä¸´æ—¶å­˜æ”¾å·¥ä½œç›®å½•çš„æ”¹åŠ¨ ä¿å­˜å·¥ä½œç›®å½•çš„ä¿®æ”¹ï¼ˆä¸åŒ…å«æœª add è¿‡çš„æ–‡ä»¶ï¼‰å¹¶æ¸…ç©ºå·¥ä½œç›®å½•ï¼šgit stash æ¢å¤ä¿å­˜è¿‡çš„ä¿®æ”¹ï¼šgit stash pop åŒ…å«æœª add è¿‡çš„æ–‡ä»¶ä½¿ç”¨ï¼šgit stash -u åˆ‡æ¢åˆ†æ”¯ä¹‹å‰æäº¤å½“å‰åˆ†æ”¯çš„ä¿®æ”¹ï¼Œå…å»äº†ä¸å¿…è¦çš„éº»çƒ¦ï¼Œä¹Ÿæ²¡å¿…è¦ä½¿ç”¨ stash äº†ã€‚ æ¢å¤è¯¯åˆ çš„ branch reflog æ˜¯ â€œreference logâ€ çš„ç¼©å†™ï¼Œä½¿ç”¨å®ƒå¯ä»¥æŸ¥çœ‹ Git ä»“åº“ä¸­çš„å¼•ç”¨çš„ç§»åŠ¨è®°å½•ã€‚å¦‚æœä¸æŒ‡å®šå¼•ç”¨ï¼Œå®ƒä¼šæ˜¾ç¤º HEAD çš„ç§»åŠ¨è®°å½•ã€‚ æ¢å¤æŒ‡å®š branch ï¼Œåªéœ€è¦æŸ¥çœ‹ branch æœ€åä¸€æ¬¡ç§»åŠ¨çš„è®°å½•ï¼Œé‚£ä¹ˆå…¶ä¹‹å‰çš„ä¸€ä¸ª commit å°±æ˜¯åˆ é™¤ä¹‹å‰çš„æ•°æ®ï¼Œä½¿ç”¨ checkout ç­¾å‡ºè¿™ä¸ª commit çš„å†…å®¹åˆ°æ–°çš„åˆ†æ”¯ã€‚å®é™…ä¸Šä¸ä¼šæ¢å¤åˆ†æ”¯ï¼Œè€Œæ˜¯æ¢å¤åˆ†æ”¯é‡Œçš„å†…å®¹å¹¶æ”¾åˆ°æ–°çš„åˆ†æ”¯ã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¸ä»…å¯ä»¥æ¢å¤åˆ†æ”¯ï¼Œè¿˜å¯ä»¥æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œæ¯”å¦‚æ¢å¤ reset çš„æ•°æ®ã€‚ å‡å¦‚è¯¯åˆ äº† branch1ï¼Œé‚£ä¹ˆå¯ä»¥æŸ¥çœ‹ä¸€ä¸‹ HEAD çš„ç§»åŠ¨å†å²ï¼š git reflog HEAD çš„æœ€åä¸€æ¬¡ç§»åŠ¨è¡Œä¸ºæ˜¯ã€Œä» branch1 ç§»åŠ¨åˆ° masterã€ã€‚è€Œåœ¨è¿™ä¹‹åï¼Œbranch1 å°±è¢«åˆ é™¤äº†ã€‚æ‰€ä»¥å®ƒä¹‹å‰çš„é‚£ä¸ª commit å°±æ˜¯ branch1 è¢«åˆ é™¤ä¹‹å‰çš„ä½ç½®äº†ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒè¡Œçš„ c08de9aã€‚ ç°åœ¨å°±å¯ä»¥åˆ‡æ¢å› c08de9aï¼Œç„¶åé‡æ–°åˆ›å»º branch1: git checkout c08de9a git checkout -b branch1 è¿™æ ·åˆ†æ”¯é‡Œçš„å†…å®¹å°±å·²ç»æ¢å¤åˆ°æ–°å»ºçš„åŒååˆ†æ”¯é‡Œé¢äº†ã€‚","link":"/2018/10/07/Git å®ç”¨æŒ‡å—/"},{"title":"åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆä¸€ï¼‰","text":"çŸ¥è¯†ç‚¹:1.SOAåˆ†å¸ƒå¼æ¶æ„2.Maven-å¤šæ¨¡å—æ­å»º3.åˆè¯†dubboã€zookepper4.å¤šå·¥ç¨‹ä¹‹é—´çš„æ•´åˆ5.å­¦ä¹ MyBatisé€†å‘å·¥ç¨‹6.å­¦ä¹ PageHelper7.äº†è§£SEOï¼šæœç´¢å¼•æ“ä¼˜åŒ–ï¼Œä»¥åŠä½¿ç”¨ä¼ªé™æ€åŒ–å°½å¯èƒ½çš„æé«˜æ¨å¹¿åº¦8.å†…å®¹ç®¡ç†ç³»ç»Ÿ â€” ç»Ÿä¸€è¡¨å­—æ®µæŠ½å–9.mapperä¸­ä½¿ç”¨â€œä¸»é”®è¿”å›â€ SOA(Service Oriented Architecture)é¢å‘æœåŠ¡çš„æ¶æ„&nbsp;&nbsp;ä¹Ÿå°±æ˜¯æŠŠå·¥ç¨‹éƒ½æ‹†åˆ†æˆæœåŠ¡å±‚å·¥ç¨‹ã€è¡¨ç°å±‚å·¥ç¨‹ã€‚æœåŠ¡å±‚ä¸­åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼Œåªéœ€è¦å¯¹å¤–æä¾›æœåŠ¡å³å¯ã€‚è¡¨ç°å±‚åªéœ€è¦å¤„ç†å’Œé¡µé¢çš„äº¤äº’ï¼Œä¸šåŠ¡é€»è¾‘éƒ½æ˜¯è°ƒç”¨æœåŠ¡å±‚çš„æœåŠ¡æ¥å®ç°ã€‚å·¥ç¨‹éƒ½å¯ä»¥ç‹¬ç«‹éƒ¨ç½²ã€‚ Maven-å¤šæ¨¡å—æ­å»º&nbsp;&nbsp;Mavençš„å¸¸è§æ‰“åŒ…æ–¹å¼ï¼šjarã€warã€pomã€‚Pomå·¥ç¨‹ä¸€èˆ¬éƒ½æ˜¯çˆ¶å·¥ç¨‹ï¼Œç®¡ç†jaråŒ…çš„ç‰ˆæœ¬ã€mavenæ’ä»¶çš„ç‰ˆæœ¬ã€ç»Ÿä¸€çš„ä¾èµ–ç®¡ç†ã€‚èšåˆå·¥ç¨‹ã€‚ æœ¬é¡¹ç›®å·¥ç¨‹ç»“æ„ï¼štaotao-parentï¼šçˆ¶å·¥ç¨‹ï¼Œæ‰“åŒ…æ–¹å¼pomï¼Œç®¡ç†jaråŒ…çš„ç‰ˆæœ¬å·ã€‚é¡¹ç›®ä¸­æ‰€æœ‰å·¥ç¨‹éƒ½åº”è¯¥ç»§æ‰¿çˆ¶å·¥ç¨‹ã€‚&nbsp;&nbsp;|â€“taotao-commonï¼šé€šç”¨çš„å·¥å…·ç±»é€šç”¨çš„pojo,utilã€‚æ‰“åŒ…æ–¹å¼jar&nbsp;&nbsp;|â€“taotao-managerï¼šæœåŠ¡å±‚å·¥ç¨‹ã€‚èšåˆå·¥ç¨‹ã€‚Pomå·¥ç¨‹&nbsp;&nbsp;|â€“taotao-manager-daoï¼šæ‰“åŒ…æ–¹å¼jar&nbsp;&nbsp;|â€“taotao-manager-pojoï¼šæ‰“åŒ…æ–¹å¼jar&nbsp;&nbsp;|â€“taotao-manager-interfaceï¼šæ‰“åŒ…æ–¹å¼jar&nbsp;&nbsp;|â€“taotao-manager-serviceï¼šæ‰“åŒ…æ–¹å¼ï¼šwar (ä¸ºäº†å‘å¸ƒæœåŠ¡çš„æ–¹ä¾¿)&nbsp;&nbsp;|â€“taotao-manager-webï¼šè¡¨ç°å±‚å·¥ç¨‹ã€‚æ‰“åŒ…æ–¹å¼war taotao-parentpom123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;!-- çˆ¶å·¥ç¨‹ï¼Œæ‰“åŒ…æ–¹å¼pomï¼Œç®¡ç†jaråŒ…çš„ç‰ˆæœ¬å·ã€‚é¡¹ç›®ä¸­æ‰€æœ‰å·¥ç¨‹éƒ½åº”è¯¥ç»§æ‰¿çˆ¶å·¥ç¨‹. --&gt; &lt;groupId&gt;xyz.taotao&lt;/groupId&gt; &lt;artifactId&gt;taotao-parent&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;pom&lt;/packaging&gt; &lt;!-- æ‰€æœ‰å­å·¥ç¨‹ --&gt; &lt;modules&gt; &lt;module&gt;taotao-common&lt;/module&gt; &lt;module&gt;taotao-manager&lt;/module&gt; &lt;module&gt;taotao-manager-web&lt;/module&gt; &lt;module&gt;MybatisGenerator&lt;/module&gt; &lt;module&gt;taotao-protal-web&lt;/module&gt; &lt;module&gt;taotao-content&lt;/module&gt; &lt;/modules&gt; &lt;!-- é›†ä¸­å®šä¹‰ä¾èµ–ç‰ˆæœ¬å· --&gt; &lt;properties&gt; &lt;junit.version&gt;4.12&lt;/junit.version&gt; &lt;spring.version&gt;4.2.4.RELEASE&lt;/spring.version&gt; &lt;mybatis.version&gt;3.2.8&lt;/mybatis.version&gt; &lt;mybatis.spring.version&gt;1.2.2&lt;/mybatis.spring.version&gt; &lt;mybatis.paginator.version&gt;1.2.15&lt;/mybatis.paginator.version&gt; &lt;mysql.version&gt;5.1.32&lt;/mysql.version&gt; &lt;slf4j.version&gt;1.6.4&lt;/slf4j.version&gt; &lt;jackson.version&gt;2.4.2&lt;/jackson.version&gt; &lt;druid.version&gt;1.0.9&lt;/druid.version&gt; &lt;httpclient.version&gt;4.3.5&lt;/httpclient.version&gt; &lt;jstl.version&gt;1.2&lt;/jstl.version&gt; &lt;servlet-api.version&gt;2.5&lt;/servlet-api.version&gt; &lt;jsp-api.version&gt;2.0&lt;/jsp-api.version&gt; &lt;joda-time.version&gt;2.5&lt;/joda-time.version&gt; &lt;commons-lang3.version&gt;3.3.2&lt;/commons-lang3.version&gt; &lt;commons-io.version&gt;1.3.2&lt;/commons-io.version&gt; &lt;commons-net.version&gt;3.3&lt;/commons-net.version&gt; &lt;!-- 3.4.2-fixæ˜¯ä»å®˜æ–¹çš„3.4.2ç‰ˆæœ¬æ·»åŠ ä¿®æ”¹ä¹‹åå½¢æˆçš„è‡ªå·±çš„å·¥ç¨‹ --&gt; &lt;!--&lt;pagehelper.version&gt;3.4.2-fix&lt;/pagehelper.version&gt;--&gt; &lt;!--&lt;pagehelper.version&gt;3.4.2&lt;/pagehelper.version&gt;--&gt; &lt;!--è¯¥ç‰ˆæœ¬å·²ç»ä¿®å¤äº†ä½¿ç”¨é€†å‘å·¥ç¨‹å¯¼è‡´pageHelperæ— æ•ˆçš„é—®é¢˜ --&gt; &lt;pagehelper.version&gt;4.1.0&lt;/pagehelper.version&gt; &lt;jsqlparser.version&gt;0.9.1&lt;/jsqlparser.version&gt; &lt;commons-fileupload.version&gt;1.3.1&lt;/commons-fileupload.version&gt; &lt;jedis.version&gt;2.7.2&lt;/jedis.version&gt; &lt;solrj.version&gt;4.10.3&lt;/solrj.version&gt; &lt;dubbo.version&gt;2.5.4&lt;/dubbo.version&gt; &lt;zookeeper.version&gt;3.4.7&lt;/zookeeper.version&gt; &lt;zkclient.version&gt;0.1&lt;/zkclient.version&gt; &lt;activemq.version&gt;5.13.0&lt;/activemq.version&gt; &lt;freemarker.version&gt;2.3.23&lt;/freemarker.version&gt; &lt;quartz.version&gt;2.2.2&lt;/quartz.version&gt; &lt;/properties&gt; &lt;!-- çˆ¶å·¥ç¨‹ç»Ÿä¸€é¡¹ç›®çš„æ‰€æœ‰ä¾èµ–ï¼Œè¯¥ä¾èµ–å¯¹å­å·¥ç¨‹æ— æ•ˆï¼Œåªèµ·åˆ°ç‰ˆæœ¬æ§åˆ¶çš„æ•ˆæœï¼Œå­å·¥ç¨‹æ ¹æ®éœ€è¦å¤åˆ¶éƒ¨åˆ†çš„ä¾èµ– --&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;!-- æ—¶é—´æ“ä½œç»„ä»¶ --&gt; &lt;dependency&gt; &lt;groupId&gt;joda-time&lt;/groupId&gt; &lt;artifactId&gt;joda-time&lt;/artifactId&gt; &lt;version&gt;${joda-time.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Apacheå·¥å…·ç»„ä»¶ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt; &lt;version&gt;${commons-lang3.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-io&lt;/artifactId&gt; &lt;version&gt;${commons-io.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-net&lt;/groupId&gt; &lt;artifactId&gt;commons-net&lt;/artifactId&gt; &lt;version&gt;${commons-net.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Jackson Jsonå¤„ç†å·¥å…·åŒ… --&gt; &lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt; &lt;version&gt;${jackson.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- httpclient --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt; &lt;artifactId&gt;httpclient&lt;/artifactId&gt; &lt;version&gt;${httpclient.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- quartzä»»åŠ¡è°ƒåº¦æ¡†æ¶ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt; &lt;artifactId&gt;quartz&lt;/artifactId&gt; &lt;version&gt;${quartz.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- å•å…ƒæµ‹è¯• --&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;${junit.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- æ—¥å¿—å¤„ç† --&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;${slf4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Mybatis --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;${mybatis.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt; &lt;version&gt;${mybatis.spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- åˆ†é¡µç›¸å…³ --&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.miemiedev&lt;/groupId&gt; &lt;artifactId&gt;mybatis-paginator&lt;/artifactId&gt; &lt;version&gt;${mybatis.paginator.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt; &lt;artifactId&gt;pagehelper&lt;/artifactId&gt; &lt;version&gt;${pagehelper.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- MySql --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;${mysql.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- æœ€ç‰›é€¼çš„è¿æ¥æ±  --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;${druid.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Spring --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jms&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- JSPç›¸å…³ --&gt; &lt;dependency&gt; &lt;groupId&gt;jstl&lt;/groupId&gt; &lt;artifactId&gt;jstl&lt;/artifactId&gt; &lt;version&gt;${jstl.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;servlet-api&lt;/artifactId&gt; &lt;version&gt;${servlet-api.version}&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;jsp-api&lt;/artifactId&gt; &lt;version&gt;${jsp-api.version}&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- æ–‡ä»¶ä¸Šä¼ ç»„ä»¶ --&gt; &lt;dependency&gt; &lt;groupId&gt;commons-fileupload&lt;/groupId&gt; &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt; &lt;version&gt;${commons-fileupload.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Rediså®¢æˆ·ç«¯ --&gt; &lt;dependency&gt; &lt;groupId&gt;redis.clients&lt;/groupId&gt; &lt;artifactId&gt;jedis&lt;/artifactId&gt; &lt;version&gt;${jedis.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- solrå®¢æˆ·ç«¯ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.solr&lt;/groupId&gt; &lt;artifactId&gt;solr-solrj&lt;/artifactId&gt; &lt;version&gt;${solrj.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- dubboç›¸å…³ --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;dubbo&lt;/artifactId&gt; &lt;version&gt;${dubbo.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;version&gt;${zookeeper.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.sgroschupf&lt;/groupId&gt; &lt;artifactId&gt;zkclient&lt;/artifactId&gt; &lt;version&gt;${zkclient.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt; &lt;artifactId&gt;activemq-all&lt;/artifactId&gt; &lt;version&gt;${activemq.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.freemarker&lt;/groupId&gt; &lt;artifactId&gt;freemarker&lt;/artifactId&gt; &lt;version&gt;${freemarker.version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;build&gt; &lt;finalName&gt;${project.artifactId}&lt;/finalName&gt; &lt;plugins&gt; &lt;!-- èµ„æºæ–‡ä»¶æ‹·è´æ’ä»¶ --&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt; &lt;version&gt;2.7&lt;/version&gt; &lt;configuration&gt; &lt;encoding&gt;UTF-8&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;!-- javaç¼–è¯‘æ’ä»¶ --&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.2&lt;/version&gt; &lt;configuration&gt; &lt;source&gt;1.8&lt;/source&gt; &lt;target&gt;1.8&lt;/target&gt; &lt;encoding&gt;UTF-8&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;!-- æ’ä»¶ç‰ˆæœ¬çš„ç®¡ç† --&gt; &lt;pluginManagement&gt; &lt;plugins&gt; &lt;!-- é…ç½®Tomcatæ’ä»¶ --&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt; &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.2&lt;/version&gt; &lt;configuration&gt; &lt;port&gt;8080&lt;/port&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;!-- é…ç½®æ‰“åŒ…æ—¶è·³è¿‡æµ‹è¯• ï¼Œé¦–æ¬¡é…ç½®ä½¿ç”¨çš„æ—¶å€™ä¼šè‡ªåŠ¨è”ç½‘è¿›è¡Œä¸‹è½½ --&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;version&gt;2.12.4&lt;/version&gt; &lt;configuration&gt; &lt;skip&gt;true&lt;/skip&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/pluginManagement&gt; &lt;!-- å­å·¥ç¨‹éœ€è¦è¦†å†™è¿™ä¸ªé…ç½®ï¼Œè¯¥é…ç½®å¹¶ä¸ä¼šç»§æ‰¿åˆ°å­å·¥ç¨‹ã€‚ --&gt; &lt;resources&gt; &lt;!-- è§£å†³å®‰è£…åjavaç›®å½•ä¸‹çš„èµ„æºæ–‡ä»¶ä¸å‘å¸ƒçš„é—®é¢˜ï¼ˆé»˜è®¤mavenæ˜¯åœ¨resourcesä¸‹æ‰¾èµ„æºæ–‡ä»¶ï¼‰ --&gt; &lt;resource&gt; &lt;directory&gt;src/main/java&lt;/directory&gt; &lt;includes&gt; &lt;include&gt;**/*.properties&lt;/include&gt; &lt;include&gt;**/*.xml&lt;/include&gt; &lt;/includes&gt; &lt;filtering&gt;false&lt;/filtering&gt; &lt;/resource&gt; &lt;!-- å¦‚æœé…ç½®æ–‡ä»¶resourcesä¸­ä¹Ÿæœ‰ï¼Œè¿˜éœ€è¦é…ç½®è¿™ä¸ª --&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources &lt;/directory&gt; &lt;includes&gt; &lt;include&gt;**/*.properties&lt;/include&gt; &lt;include&gt;**/*.xml&lt;/include&gt; &lt;/includes&gt; &lt;filtering&gt;false&lt;/filtering&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;/build&gt;&lt;/project&gt; ä¸¾ä¾‹ï¼štaotao-managerçš„pom123456789101112131415161718192021222324252627282930&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;!-- æœåŠ¡å±‚å·¥ç¨‹ã€‚èšåˆå·¥ç¨‹ã€‚Pomå·¥ç¨‹ --&gt; &lt;artifactId&gt;taotao-manager&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;modules&gt; &lt;module&gt;taotao-manager-dao&lt;/module&gt; &lt;module&gt;taotao-manager-pojo&lt;/module&gt; &lt;module&gt;taotao-manager-interface&lt;/module&gt; &lt;module&gt;taotao-manager-service&lt;/module&gt; &lt;/modules&gt; &lt;packaging&gt;pom&lt;/packaging&gt; &lt;parent&gt; &lt;groupId&gt;xyz.taotao&lt;/groupId&gt; &lt;artifactId&gt;taotao-parent&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/parent&gt; &lt;dependencies&gt; &lt;!-- ä¾èµ–é€šç”¨å·¥ç¨‹ --&gt; &lt;dependency&gt; &lt;groupId&gt;xyz.taotao&lt;/groupId&gt; &lt;artifactId&gt;taotao-common&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; taotao-manager-service çš„ pom12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;parent&gt; &lt;artifactId&gt;taotao-manager&lt;/artifactId&gt; &lt;groupId&gt;xyz.taotao&lt;/groupId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/parent&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;artifactId&gt;taotao-manager-service&lt;/artifactId&gt; &lt;!-- serviceæ˜¯ä»¥æœåŠ¡æ¨¡å—å•ç‹¬è·‘æœåŠ¡å™¨çš„ï¼Œéœ€è¦æ‰“æˆwaråº”ç”¨åŒ…ã€‚ --&gt; &lt;packaging&gt;war&lt;/packaging&gt; &lt;dependencies&gt; &lt;!-- éœ€è¦ä¾èµ–daoæ¨¡å— --&gt; &lt;dependency&gt; &lt;groupId&gt;xyz.taotao&lt;/groupId&gt; &lt;artifactId&gt;taotao-manager-dao&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;!-- éœ€è¦ä¾èµ–æ¥å£æ¨¡å— --&gt; &lt;dependency&gt; &lt;groupId&gt;xyz.taotao&lt;/groupId&gt; &lt;artifactId&gt;taotao-manager-interface&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Spring --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;!-- ç‰ˆæœ¬å·²ç»åœ¨parentæ§åˆ¶äº†ï¼Œè¿™é‡Œæ·»åŠ ä¹Ÿæ— æ•ˆï¼ --&gt; &lt;/dependency&gt; ...... &lt;!-- æ·»åŠ dubboä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;dubbo&lt;/artifactId&gt; &lt;!-- æ’é™¤ä¾èµ– --&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;exclusion&gt; &lt;groupId&gt;org.jboss.netty&lt;/groupId&gt; &lt;artifactId&gt;netty&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; ...... &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt; &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.2&lt;/version&gt; &lt;configuration&gt; &lt;port&gt;8081&lt;/port&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; ä½¿ç”¨tomcatçš„Mavenæ’ä»¶å¯åŠ¨123456789101112&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt; &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.2&lt;/version&gt; &lt;configuration&gt; &lt;port&gt;8081&lt;/port&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; &nbsp;&nbsp;æ³¨ï¼šå¯åŠ¨ä¹‹å‰éœ€è¦ç¼–è¯‘+å®‰è£…æ¨¡å—åˆ°æœ¬åœ°ä»“åº“ï¼Œå¹¶ä¸”æ³¨æ„æ ¹æ®æ¨¡å—çš„å±‚çº§å…³ç³»ç¡®ä¿å®‰è£…çš„é¡ºåºï¼ ä¸æƒ³å®‰è£…è¿‡ç¨‹æµ‹è¯•ã€èµ„æºæ–‡ä»¶æ‹·è´ä¸ä¸Šç­‰é…ç½®å‚è€ƒparent pom dubboã€zookepper SOAæ¶æ„ï¼Œè¡¨ç°å±‚å’ŒæœåŠ¡å±‚æ˜¯ä¸åŒçš„å·¥ç¨‹ã€‚æŸäº›éœ€æ±‚çš„å®ç°éœ€è¦ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚Dubboä¾¿æ˜¯è¿™ç±»æ¡†æ¶ä¹‹ä¸€ DUBBOæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ï¼Œè‡´åŠ›äºæä¾›é«˜æ€§èƒ½å’Œé€æ˜åŒ–çš„RPCè¿œç¨‹æœåŠ¡è°ƒç”¨æ–¹æ¡ˆï¼Œæ˜¯é˜¿é‡Œå·´å·´SOAæœåŠ¡åŒ–æ²»ç†æ–¹æ¡ˆçš„æ ¸å¿ƒæ¡†æ¶ã€‚ Dubboæ˜¯èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒçš„ç®¡ç†å·¥å…·ã€‚ Dubbo æ˜¯ç±»ä¼¼äºwebserviceçš„å…³äºç³»ç»Ÿä¹‹é—´é€šä¿¡çš„æ¡†æ¶ï¼Œå¹¶å¯ä»¥ç»Ÿè®¡å’Œç®¡ç†æœåŠ¡ä¹‹é—´çš„è°ƒç”¨æƒ…å†µï¼ˆåŒ…æ‹¬æœåŠ¡è¢«è°è°ƒç”¨äº†ï¼Œè°ƒç”¨çš„æ¬¡æ•°æ˜¯å¦‚ä½•ï¼Œä»¥åŠæœåŠ¡çš„ä½¿ç”¨çŠ¶å†µï¼‰ã€‚ dubboçš„æ¶æ„ Provider: æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ã€‚ Consumer: è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ã€‚ Registry: æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒã€‚ Monitor: ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡è°ƒå’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒã€‚ Container: æœåŠ¡è¿è¡Œå®¹å™¨ã€‚ æ¥å…¥springæä¾›æœåŠ¡ï¼š 1234567891011121314151617181920212223242526&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:context=\"http://www.springframework.org/schema/context\" xmlns:p=\"http://www.springframework.org/schema/p\" xmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:dubbo=\"http://code.alibabatech.com/schema/dubbo\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.2.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.2.xsd\"&gt; &lt;context:component-scan base-package=\"xyz.taotao.service\"&gt;&lt;/context:component-scan&gt; &lt;!-- ä½¿ç”¨ dubbo å‘å¸ƒæœåŠ¡ --&gt; &lt;!-- æä¾›æ–¹åº”ç”¨ä¿¡æ¯ï¼Œç”¨äºè®¡ç®—ä¾èµ–å…³ç³» --&gt; &lt;dubbo:application name=\"taotao-manager\"/&gt; &lt;dubbo:registry protocol=\"zookeeper\" address=\"192.168.184.130:2181\"/&gt; &lt;!-- ç”¨dubboåè®®åœ¨20880ç«¯å£æš´éœ²æœåŠ¡ --&gt; &lt;dubbo:protocol name=\"dubbo\" port=\"20880\"/&gt; &lt;!-- å£°æ˜éœ€è¦æš´éœ²çš„æœåŠ¡æ¥å£ --&gt; &lt;dubbo:service interface=\"xyz.taotao.service.TestService\" ref=\"testServiceImpl\"&gt;&lt;/dubbo:service&gt; &lt;dubbo:service interface=\"xyz.taotao.service.ItemService\" ref=\"itemServiceImpl\"&gt;&lt;/dubbo:service&gt;&lt;/beans&gt; å¼•å…¥æœåŠ¡ï¼š 12345678910111213141516171819202122&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:p=\"http://www.springframework.org/schema/p\" xmlns:context=\"http://www.springframework.org/schema/context\" xmlns:dubbo=\"http://code.alibabatech.com/schema/dubbo\" xmlns:mvc=\"http://www.springframework.org/schema/mvc\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.2.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd\"&gt; &lt;!-- å¼•ç”¨dubboæœåŠ¡ --&gt; &lt;dubbo:application name=\"taotao-manager-web\"/&gt; &lt;dubbo:registry protocol=\"zookeeper\" address=\"192.168.184.130:2181\"/&gt; &lt;!-- å¼•ç”¨æŒ‡å®šçš„æœåŠ¡æ¥å£ --&gt; &lt;dubbo:reference interface=\"xyz.taotao.service.TestService\" id=\"testService\"&gt;&lt;/dubbo:reference&gt; &lt;dubbo:reference interface=\"xyz.taotao.service.ItemService\" id=\"itemService\"&gt;&lt;/dubbo:reference&gt; &lt;dubbo:reference interface=\"xyz.taotao.content.service.ContentService\" id=\"contentService\"&gt;&lt;/dubbo:reference&gt; &lt;dubbo:reference interface=\"xyz.taotao.content.service.ContentCategoryService\" id=\"contentCategoryService\"&gt;&lt;/dubbo:reference&gt;&lt;/beans&gt; æ³¨æ„æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ æ³¨å†Œä¸­å¿ƒ zookepper&nbsp;&nbsp;æ³¨å†Œä¸­å¿ƒè´Ÿè´£æœåŠ¡åœ°å€çš„æ³¨å†Œä¸æŸ¥æ‰¾ï¼Œç›¸å½“äºç›®å½•æœåŠ¡ï¼ŒæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…åªåœ¨å¯åŠ¨æ—¶ä¸æ³¨å†Œä¸­å¿ƒäº¤äº’ï¼Œæ³¨å†Œä¸­å¿ƒä¸è½¬å‘è¯·æ±‚ï¼Œå‹åŠ›è¾ƒå°ã€‚ä½¿ç”¨dubbo-2.3.3ä»¥ä¸Šç‰ˆæœ¬ï¼Œå®˜æ–¹å»ºè®®ä½¿ç”¨zookeeperä½œä¸ºæ³¨å†Œä¸­å¿ƒã€‚ åœ¨linuxä¸­å®‰è£…zookepperç¬¬ä¸€æ­¥ï¼šå®‰è£…jdk ç¬¬äºŒæ­¥ï¼šè§£å‹ç¼©zookeeperå‹ç¼©åŒ… ç¬¬ä¸‰æ­¥ï¼šå°†confæ–‡ä»¶å¤¹ä¸‹zoo_sample.cfgå¤åˆ¶ä¸€ä»½ï¼Œæ”¹åä¸ºzoo.cfg ç¬¬å››æ­¥ï¼šä¿®æ”¹é…ç½®dataDirå±æ€§ï¼ŒæŒ‡å®šä¸€ä¸ªçœŸå®ç›®å½•ï¼ˆè¿›å…¥zookeeperè§£å‹ç›®å½•ï¼Œåˆ›å»ºdataç›®å½•ï¼šmkdir data) ç¬¬äº”æ­¥ï¼š å¯åŠ¨zookeeperï¼šbin/zkServer.sh start å…³é—­zookeeperï¼šbin/zkServer.sh stop æŸ¥çœ‹zookeeperçŠ¶æ€ï¼šbin/zkServer.sh status æ³¨æ„å¼€æ”¾é˜²ç«å¢™çš„ç«¯å£ï¼š æŸ¥çœ‹é˜²ç«å¢™ï¼šservice iptables status æ·»åŠ è§„åˆ™ï¼švim /etc/sysconfig/iptables æ·»åŠ ä¹‹ååˆ·æ–°é…ç½®ï¼šscource /etc/sysconfig/iptables ç›‘æ§ä¸­å¿ƒå®‰è£…&nbsp;&nbsp;å‚è€ƒä¸Šä¸€ç¯‡ï¼šhttps://www.yuzh.xyz/2018/07/06/dubbo%E7%9B%91%E6%8E%A7%E4%B8%AD%E5%BF%83-dubbo-admin-war%E7%9A%84%E6%89%93%E5%8C%85%E5%92%8C%E9%83%A8%E7%BD%B2/ å¤šå·¥ç¨‹ä¹‹é—´çš„æ•´åˆ daoæ¨¡å—ç®¡ç†daoå±‚ï¼Œæ”¾æ˜ å°„æ–‡ä»¶ã€‚ interfaceï¼ˆåˆ†ä¸ºdao-interfaceã€service-interfaceï¼‰æ¨¡å—ç®¡ç†æ¥å£ï¼Œæ”¾æ¥å£ã€‚ serviceæ¨¡å—ç®¡ç†serviceå±‚ï¼Œæ”¾SqlMapConfig.xmlã€è¿æ¥æ± ã€sessionFactoryã€äº‹åŠ¡ã€dobboæœåŠ¡ç­‰ç­‰â€¦ webæ¨¡å—ç®¡ç†controllerå±‚ï¼Œæ”¾web.xmlã€springã€mvcã€dubboç›¸å…³â€¦ MyBatisé€†å‘å·¥ç¨‹å°±æ˜¯å¯¼å…¥ä¸€ä¸ªå·¥ç¨‹ï¼Œé…ç½®ä¸€ä¸‹ï¼Œç”Ÿæˆæ•°æ®åº“ä¸­å¯¹åº”çš„pojoå’Œmapper pom 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;parent&gt; &lt;artifactId&gt;taotao-parent&lt;/artifactId&gt; &lt;groupId&gt;xyz.taotao&lt;/groupId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/parent&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;artifactId&gt;MybatisGenerator&lt;/artifactId&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator-core&lt;/artifactId&gt; &lt;version&gt;1.3.6&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;!-- ç”Ÿæˆæ’ä»¶ --&gt; &lt;plugin&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.3.2&lt;/version&gt; &lt;configuration&gt; &lt;!--é…ç½®æ–‡ä»¶çš„ä½ç½®--&gt; &lt;configurationFile&gt;src/main/resources/generatorConfig.xml&lt;/configurationFile&gt; &lt;verbose&gt;true&lt;/verbose&gt; &lt;overwrite&gt;true&lt;/overwrite&gt; &lt;/configuration&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;Generate MyBatis Artifacts&lt;/id&gt; &lt;goals&gt; &lt;goal&gt;generate&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator-core&lt;/artifactId&gt; &lt;version&gt;1.3.2&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; é…ç½®ç”Ÿæˆè§„åˆ™ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;!DOCTYPE generatorConfiguration PUBLIC \"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN\" \"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd\"&gt;&lt;generatorConfiguration&gt; &lt;!--mysql è¿æ¥æ•°æ®åº“jar è¿™é‡Œé€‰æ‹©è‡ªå·±æœ¬åœ°ä½ç½®--&gt; &lt;classPathEntry location=\"H:/[ åŒ… ] Lib/Other/mysql-connector-java-5.1.7-bin.jar\"/&gt; &lt;context id=\"testTables\" targetRuntime=\"MyBatis3\"&gt; &lt;commentGenerator&gt; &lt;!-- æ˜¯å¦å»é™¤è‡ªåŠ¨ç”Ÿæˆçš„æ³¨é‡Š trueï¼šæ˜¯ ï¼š false:å¦ --&gt; &lt;property name=\"suppressAllComments\" value=\"true\"/&gt; &lt;/commentGenerator&gt; &lt;!--æ•°æ®åº“è¿æ¥çš„ä¿¡æ¯ï¼šé©±åŠ¨ç±»ã€è¿æ¥åœ°å€ã€ç”¨æˆ·åã€å¯†ç  --&gt; &lt;jdbcConnection driverClass=\"com.mysql.jdbc.Driver\" connectionURL=\"jdbc:mysql://localhost:3306/taotao\" userId=\"root\" password=\"admin\"&gt; &lt;/jdbcConnection&gt; &lt;!-- é»˜è®¤falseï¼ŒæŠŠJDBC DECIMAL å’Œ NUMERIC ç±»å‹è§£æä¸º Integerï¼Œä¸º trueæ—¶æŠŠJDBC DECIMAL å’Œ NUMERIC ç±»å‹è§£æä¸ºjava.math.BigDecimal --&gt; &lt;javaTypeResolver&gt; &lt;property name=\"forceBigDecimals\" value=\"false\"/&gt; &lt;/javaTypeResolver&gt; &lt;!-- targetProject:ç”ŸæˆPOç±»çš„ä½ç½® --&gt; &lt;javaModelGenerator targetPackage=\"xyz.yuzh.pojo\" targetProject=\"src/main/java\"&gt; &lt;!-- enableSubPackages:æ˜¯å¦è®©schemaä½œä¸ºåŒ…çš„åç¼€ --&gt; &lt;property name=\"enableSubPackages\" value=\"false\"/&gt; &lt;!-- ä»æ•°æ®åº“è¿”å›çš„å€¼è¢«æ¸…ç†å‰åçš„ç©ºæ ¼ --&gt; &lt;property name=\"trimStrings\" value=\"true\"/&gt; &lt;/javaModelGenerator&gt; &lt;!-- targetProject:mapperæ˜ å°„æ–‡ä»¶ç”Ÿæˆçš„ä½ç½® å¦‚æœmavenå·¥ç¨‹åªæ˜¯å•ç‹¬çš„ä¸€ä¸ªå·¥ç¨‹ï¼ŒtargetProject=\"src/main/java\" è‹¥æœmavenå·¥ç¨‹æ˜¯åˆ†æ¨¡å—çš„å·¥ç¨‹ï¼ŒtargetProject=\"æ‰€å±æ¨¡å—çš„åç§°\"ï¼Œä¾‹å¦‚ï¼š targetProject=\"ecps-manager-mapper\"ï¼Œä¸‹åŒ--&gt; &lt;sqlMapGenerator targetPackage=\"xyz.yuzh.mapper\" targetProject=\"src/main/java\"&gt; &lt;!-- enableSubPackages:æ˜¯å¦è®©schemaä½œä¸ºåŒ…çš„åç¼€ --&gt; &lt;property name=\"enableSubPackages\" value=\"false\"/&gt; &lt;/sqlMapGenerator&gt; &lt;!-- targetPackageï¼šmapperæ¥å£ç”Ÿæˆçš„ä½ç½® --&gt; &lt;javaClientGenerator type=\"XMLMAPPER\" targetPackage=\"xyz.yuzh.mapper\" targetProject=\"src/main/java\"&gt; &lt;!-- enableSubPackages:æ˜¯å¦è®©schemaä½œä¸ºåŒ…çš„åç¼€ --&gt; &lt;property name=\"enableSubPackages\" value=\"false\"/&gt; &lt;/javaClientGenerator&gt; &lt;!-- æŒ‡å®šæ•°æ®åº“è¡¨ --&gt; &lt;table schema=\"\" tableName=\"tb_content\"&gt;&lt;/table&gt; &lt;table schema=\"\" tableName=\"tb_content_category\"&gt;&lt;/table&gt; &lt;table schema=\"\" tableName=\"tb_item\"&gt;&lt;/table&gt; &lt;table schema=\"\" tableName=\"tb_item_cat\"&gt;&lt;/table&gt; &lt;table schema=\"\" tableName=\"tb_item_desc\"&gt;&lt;/table&gt; &lt;table schema=\"\" tableName=\"tb_item_param\"&gt;&lt;/table&gt; &lt;table schema=\"\" tableName=\"tb_item_param_item\"&gt;&lt;/table&gt; &lt;table schema=\"\" tableName=\"tb_order\"&gt;&lt;/table&gt; &lt;table schema=\"\" tableName=\"tb_order_item\"&gt;&lt;/table&gt; &lt;table schema=\"\" tableName=\"tb_order_shipping\"&gt;&lt;/table&gt; &lt;table schema=\"\" tableName=\"tb_user\"&gt;&lt;/table&gt; &lt;/context&gt;&lt;/generatorConfiguration&gt; ç‚¹å‡»æ’ä»¶è¿è¡Œ-&gt;è‡ªåŠ¨ç”Ÿæˆpojoå’Œmapperåœ¨æŒ‡å®šä½ç½®ã€‚ç„¶åå¤åˆ¶åˆ°è‡ªå·±éœ€è¦çš„å·¥ç¨‹é‡Œé¢ï¼Œæ³¨æ„ï¼šæ²¡æœ‰è‡ªåŠ¨å®ç°åºåˆ—åŒ–ã€‚ å‚è€ƒåœ°å€ï¼šhttps://blog.csdn.net/liudongdong0909/article/details/51534735 PageHelperå¯¼åŒ…ä¹‹ååœ¨Mybatisçš„å…¨å±€æ–‡ä»¶ä¸­é…ç½®SqlMapConfig.xmlä¸­é…ç½®æ‹¦æˆªå™¨æ’ä»¶ 123456&lt;plugins&gt; &lt;plugin interceptor=\"com.github.pagehelper.PageHelper\"&gt; &lt;!-- è®¾ç½®æ•°æ®åº“ç±»å‹ Oracle,Mysql,MariaDB,SQLite,Hsqldb,PostgreSQLå…­ç§æ•°æ®åº“--&gt; &lt;property name=\"dialect\" value=\"mysql\"/&gt; &lt;/plugin&gt;&lt;/plugins&gt; æµ‹è¯•ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556package xyz.taotao.pagehelper;import com.github.pagehelper.PageHelper;import com.github.pagehelper.PageInfo;import org.junit.Test;import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import xyz.taotao.mapper.TbItemMapper;import xyz.taotao.pojo.TbItem;import xyz.taotao.pojo.TbItemExample;import java.util.List;/** * Created with IntelliJ IDEA. * * @Author: yu_zh * @DateTime: 2018/07/05 14:36 */public class TestPageHelper { @Test public void testPageHelper() { //åˆå§‹åŒ–springå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(\"spring-dao.xml\"); //è·å–mapperä»£ç†å¯¹è±¡ TbItemMapper tbItemMapper = ac.getBean(TbItemMapper.class); //è®¾ç½®åˆ†é¡µä¿¡æ¯ PageHelper.startPage(3, 100); //è°ƒç”¨mapperæ–¹æ³•æŸ¥è¯¢æ•°æ® //æŸ¥è¯¢æ¡ä»¶å¯¹è±¡ TbItemExample tbItemExample = new TbItemExample(); TbItemExample.Criteria criteria = tbItemExample.createCriteria(); //åˆ›å»ºæ—¶é—´ä¸ä¸ºç©ºæ‰æŸ¥è¯¢ï¼Œå…å»äº†mapperä¸­ç¼–è¾‘sql criteria.andCreatedIsNotNull(); //ç¬¬ä¸€ä¸ªæŸ¥è¯¢åˆ—è¡¨è¢«åˆ†é¡µ List&lt;TbItem&gt; tbItemList = tbItemMapper.selectByExample(tbItemExample); //ç¬¬äºŒä¸ªä¸ä¼šè¢«åˆ†é¡µ List&lt;TbItem&gt; tbItemList2 = tbItemMapper.selectByExample(tbItemExample); //è·å–åˆ†é¡µä¿¡æ¯ PageInfo&lt;TbItem&gt; tbItemPageInfo = new PageInfo&lt;&gt;(tbItemList); //éå†ä¿¡æ¯åˆ—è¡¨ tbItemPageInfo.getList(); System.out.println(\"è¢«åˆ†é¡µåæ¡æ•°ï¼š\"+tbItemPageInfo.getEndRow()); System.out.println(\"æ€»è®°å½•æ•°\"+tbItemPageInfo.getTotal()); System.out.println(\"é¡µæ•°\"+tbItemPageInfo.getPages()); System.out.println(\"å½“å‰é¡µ\"+tbItemPageInfo.getPageNum()); System.out.println(\"é¡µå¤§å°\"+tbItemPageInfo.getPageSize()); int i = 1; for (TbItem item : tbItemList2) { i++; } System.out.println(\"å…¨éƒ¨æ¡æ•°ï¼š\"+i); }} äº†è§£SEO &nbsp;&nbsp;ç™¾åº¦è¿™æ ·çš„æœç´¢å¼•æ“å¯¹äº.htmlåç¼€çš„ç½‘é¡µçš„æœç´¢æ’åä¼˜å…ˆçº§æ˜¯é«˜äºjspçš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸æ”¹å˜ç½‘é¡µæ˜¯jspæ ¼å¼çš„å‰æä¸‹ï¼Œé€šè¿‡æ§åˆ¶springmvcæ‹¦æˆª.htmlè¯·æ±‚è¾¾åˆ°æµè§ˆå™¨å§‹ç»ˆéƒ½æ˜¯.htmlåç¼€æ˜¾ç¤ºçš„æ•ˆæœã€‚ æ¯”å¦‚ï¼š 12345678910111213141516171819&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;web-app xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:web=\"http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\" id=\"WebApp_ID\" version=\"2.5\"&gt; &lt;welcome-file-list&gt; &lt;welcome-file&gt;/index.html&lt;/welcome-file&gt; &lt;/welcome-file-list&gt; &lt;!-- spring-mvc --&gt; &lt;servlet&gt; ...... &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;....&lt;/servlet-name&gt; &lt;!-- ä¼ªé™æ€åŒ–ï¼šSEO æœç´¢å¼•æ“ä¼˜åŒ–--&gt; &lt;url-pattern&gt;*.html&lt;/url-pattern&gt; &lt;/servlet-mapping&gt;&lt;/web-app&gt; 12345é¡µé¢æ§åˆ¶å™¨ï¼š@RequestMapping(value = \"/index\",method = RequestMethod.GET)public String index(){ return \"index\";} è®¿é—®ä¸€ä¸ªç«™ç‚¹çš„ä¸»é¡µï¼Œç”¨æˆ·ä¸€èˆ¬éƒ½æ˜¯ http://www.yuzh.xyz/ æˆ–è€…æœ‰ç»éªŒä¸€ç‚¹çš„ä¼šè¿™æ · http://www.yuzh.xyz/index.html é€šå¸¸æƒ…å†µä¸‹ï¼Œmvcçš„æ‹¦æˆªå½¢å¼æ˜¯ / ï¼Œè¡¨ç¤ºæ‹¦æˆªæ‰€æœ‰é jsp\\htmlçš„èµ„æºè®¿é—®è¯·æ±‚ï¼Œè¿™æ—¶/å’Œ/index.htmlä¸¤è€…çš„æ•ˆæœå¯èƒ½ä¸ä¸€æ ·ã€‚ å¦‚æœä¸»é¡µåœ¨/WEB-INF/ä¸‹ï¼Œ/index.htmlæ˜¯ä¼šæŠ¥404çš„ï¼Œåªæœ‰ä»¥/å½¢å¼é€šè¿‡æ§åˆ¶å™¨è·³è½¬åˆ°ä¸»é¡µã€‚ å›åˆ°ä¼ªé™æ€åŒ–çš„è¯é¢˜ï¼Œæ—¢ç„¶è¦å®ç°ä¼ªé™æ€åŒ–ï¼Œå°±å¿…é¡»æŠŠæ‹¦æˆªå½¢å¼è®¾ä¸º*.htmlï¼Œé‚£ä¹ˆå½“ç”¨æˆ·è¾“å…¥ä¸¤ç§ä¸åŒçš„urlæ˜¯æ€ä¹ˆè·³è½¬åˆ°ä¸»é¡µçš„å‘¢ï¼Ÿ 1ï¼‰å½“è¾“å…¥åœ°å€/ï¼Œmvcæ²¡æœ‰æ‹¦æˆªåˆ°ï¼Œè½¬è€Œæ‰¾æ¬¢è¿é¡µ&lt;welcome-file&gt;/index.html&lt;/welcome-file&gt;ï¼Œäºæ˜¯æ‰¾/index.htmlï¼Œå¦‚æœwebappsä¸‹æœ‰é¡µé¢å°±ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰å°±è¿›å…¥åˆ°mvcï¼ˆæ­¤æ—¶å·²ç»è¢«mvcæ‹¦æˆªåˆ°äº†ï¼‰ï¼Œå‰é¢mvcé…ç½®äº†@RequestMapping(value =&quot;/index&quot;)ï¼Œäºæ˜¯è¿›å…¥äº†æ§åˆ¶å™¨æ–¹æ³•ï¼Œæœ€ç»ˆåœ¨æ§åˆ¶å™¨ä¸­è·³è½¬é¡µé¢ã€‚ 2ï¼‰å½“è¾“å…¥åœ°å€/index.htmlï¼Œç›´æ¥è¢«mvcæ‰€æ‹¦æˆªï¼Œä¸éœ€è¦è¿›æ¬¢è¿é¡µï¼Œç›´æ¥åˆ°äº†æ§åˆ¶å™¨è·³è½¬é¡µé¢ã€‚ 3ï¼‰æ³¨æ„ï¼šé…ç½®ä¼ªé™æ€åŒ–åï¼Œurlåœ°å€å¿…é¡»ä»¥.htmlæ‰èƒ½è®¿é—®èµ„æºã€‚è®¿é—®æ§åˆ¶å™¨çš„æ–¹æ³•éœ€è¦â€æ˜ å°„è·¯å¾„+.htmlâ€œï¼Œæ¯”å¦‚ï¼š@RequestMapping(value = â€œ/getListâ€)ï¼Œè®¿é—®è¿™ä¸ªæ–¹æ³•éœ€è¦â€getList.htmlâ€œçš„å½¢å¼ï¼Œå¾ˆå¥‡æ€ªå“¦~ ä¸ç„¶æ— æ³•è¢«æ‹¦æˆªåˆ°å•Šï¼ å†…å®¹ç®¡ç†ç³»ç»Ÿ â€” æŠ½å–æŠ½è±¡è¡¨è¿åäº†æ•°æ®åº“èŒƒå¼ï¼Œä½†ä»¥ä¾¿äºå¼€å‘ 1) éšç€ç¡¬ä»¶æ°´å¹³çš„è¿…çŒ›å‘å±•ï¼Œç¡¬ä»¶æˆæœ¬çš„é™ä½ï¼Œæ•°æ®åº“èŒƒå¼å’Œå¼€å‘æ•ˆç‡ä¸Šå¤§å¤šæ•°æƒ…å†µä¸‹é€‰æ‹©åè€…ï¼Œç°ä»£ä¼ä¸šå¼€å‘ä¸­ï¼Œé€šå¸¸ä¼šä¸ºäº†ç®€å•æœ‰æ•ˆçš„ç®¡ç†æ•°æ®å’Œåº”ç”¨ç³»ç»Ÿçš„æ•ˆç‡ï¼Œè¿åä¸‰å¤§èŒƒå¼çš„è¦æ±‚ï¼Œä»¥ç©ºé—´æ¢æ—¶é—´ã€‚1) å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆcontent management systemï¼ŒCMSï¼‰æ˜¯ä¸€ç§ä½äºWEB å‰ç«¯ï¼ˆWeb æœåŠ¡å™¨ï¼‰å’Œåç«¯åŠå…¬ç³»ç»Ÿæˆ–æµç¨‹ï¼ˆå†…å®¹åˆ›ä½œã€ç¼–è¾‘ï¼‰ä¹‹é—´çš„è½¯ä»¶ç³»ç»Ÿã€‚å†…å®¹çš„åˆ›ä½œäººå‘˜ã€ç¼–è¾‘äººå‘˜ã€å‘å¸ƒäººå‘˜ä½¿ç”¨å†…å®¹ç®¡ç†ç³»ç»Ÿæ¥æäº¤ã€ä¿®æ”¹ã€å®¡æ‰¹ã€å‘å¸ƒå†…å®¹ã€‚è¿™é‡ŒæŒ‡çš„â€œå†…å®¹â€å¯èƒ½åŒ…æ‹¬æ–‡ä»¶ã€è¡¨æ ¼ã€å›¾ç‰‡ã€æ•°æ®åº“ä¸­çš„æ•°æ®ç”šè‡³è§†é¢‘ç­‰ä¸€åˆ‡ä½ æƒ³è¦å‘å¸ƒåˆ°Internetç½‘ç«™çš„ä¿¡æ¯ã€‚2) å°±æ˜¯åå°ç®¡ç†ç»´æŠ¤å‰å°çš„é¡µé¢å’Œé¡µé¢ä¸­çš„å†…å®¹å¯ä»¥åŠ¨æ€å±•ç¤ºã€‚ æ —å­ï¼šæœ¬å•†åŸçš„é—¨æˆ·ç³»ç»Ÿé¦–é¡µä¸­å­˜åœ¨å¤šä¸ªå°æ¿å—ï¼Œæ¯”å¦‚å¤§å¹¿å‘Šä½ã€æ·˜æ·˜å¿«æŠ¥ã€å•†å“å±•ç¤ºä½â€¦å¦‚æœå¯¹äºæ¯ä¸€ä¸ªå°æ¿å—éƒ½åˆ›å»ºä¸€å¼ è¡¨è¿›è¡Œç»´æŠ¤å°†ä¼šååˆ†çš„éº»çƒ¦ï¼Œå‰å°ä¸€ä¸ªé¡µé¢è°ƒæ•´ï¼ˆå¢åŠ åˆ é™¤ä¿®æ”¹ï¼‰ï¼Œåå°å¯¹åº”å°†ä¼šæ˜¯pojoã€mapperã€daoã€serviceã€controlleréƒ½è¦æ”¹åŠ¨ï¼Œäºæ˜¯è¯•ç€æŠŠè¿™äº›æ‰€æœ‰æ¿å—æŠ½å–ä¸€å¼ ç»Ÿä¸€çš„åˆ†ç±»è¡¨ã€‚ æŠŠé¦–é¡µçš„æ¯ä¸ªå±•ç¤ºåŠŸèƒ½ï¼ˆå¤§å¹¿å‘Šä½ï¼Œæ·˜æ·˜å¿«æŠ¥ç­‰ï¼‰ï¼Œçœ‹ä½œæ˜¯ä¸€ä¸ªåˆ†ç±»ï¼Œæ¯ä¸ªå±•ç¤ºåŠŸèƒ½é‡Œé¢å±•ç¤ºçš„å¤šæ¡ä¿¡æ¯ï¼Œçœ‹ä½œæ˜¯åˆ†ç±»ä¸‹çš„å†…å®¹ã€‚ ä¾‹å¦‚ï¼šé¦–é¡µå¤§å¹¿å‘Šï¼Œå¯¹åº”çš„æ˜¯å¤§å¹¿å‘Šåˆ†ç±»ï¼Œè€Œå¤§å¹¿å‘Šä½å±•ç¤ºçš„å¤šå¼ å›¾ç‰‡ï¼Œå°±æ˜¯å¤§å¹¿å‘Šåˆ†ç±»ä¸‹çš„å†…å®¹ï¼Œå‰å°éœ€è¦è·å–å¤§å¹¿å‘Šçš„å›¾ç‰‡ï¼Œåªéœ€è¦æ ¹æ®å¤§å¹¿å‘Šçš„idæŸ¥è¯¢å¯¹åº”çš„å†…å®¹å³å¯ã€‚ å†…å®¹åˆ†ç±»è¡¨ï¼štb_content_categoryï¼Œéœ€è¦å­˜å‚¨æ ‘å½¢ç»“æ„çš„æ•°æ®ã€‚ï¼ˆå¤§åˆ†ç±»ä¸‹æœ‰å°åˆ†ç±»ï¼‰ å†…å®¹è¡¨ï¼štb_contentï¼Œå°†æ‰€æœ‰ä¿¡æ¯ç»Ÿä¸€åˆ°ä¸€å¼ è¡¨ã€‚ æ¯”å¦‚æœ‰äº›æ¿å—ä¸éœ€è¦`price`è¿™ä¸ªå­—æ®µï¼Œå½“å­—æ®µä¸è¶³æ—¶ï¼Œå°±ç”¨è¯¥å­—æ®µå­˜ç‚¹å…¶ä»–çš„ã€‚ mapperä¸­ä½¿ç”¨â€œä¸»é”®è¿”å›â€åœ¨è‡ªåŠ¨ç”Ÿæˆçš„sqlä¸­æ·»åŠ  &lt;selectKey/&gt; èŠ‚ç‚¹ï¼š 1234567891011&lt;insert id=\"insert\" parameterType=\"xyz.taotao.pojo.TbContentCategory\" &gt; &lt;selectKey keyProperty=\"id\" resultType=\"long\" order=\"AFTER\"&gt; select last_insert_id(); &lt;/selectKey&gt; insert into tb_content_category (id, parent_id, name, status, sort_order, is_parent, created, updated) values (#{id,jdbcType=BIGINT}, #{parentId,jdbcType=BIGINT}, #{name,jdbcType=VARCHAR}, #{status,jdbcType=INTEGER}, #{sortOrder,jdbcType=INTEGER}, #{isParent,jdbcType=BIT}, #{created,jdbcType=TIMESTAMP}, #{updated,jdbcType=TIMESTAMP}) &lt;/insert&gt;","link":"/2018/07/08/åˆ†å¸ƒå¼æŠ€æœ¯å…¥å‘æŒ‡å—ï¼ˆä¸€ï¼‰/"},{"title":"çº¿ç¨‹é«˜çº§","text":"Javaå¹¶å‘ç¼–ç¨‹åŒ… java.util.concurrent çš„å­¦ä¹ ç¬”è®° ç®€ä»‹ åœ¨ Java 5.0 æä¾›äº† java.util.concurrent ï¼ˆç®€ç§°JUC ï¼‰åŒ…ï¼Œåœ¨æ­¤åŒ…ä¸­å¢åŠ äº†åœ¨å¹¶å‘ç¼–ç¨‹ä¸­å¾ˆå¸¸ç”¨çš„å®ç”¨å·¥å…·ç±»ï¼Œç”¨äºå®šä¹‰ç±»ä¼¼äºçº¿ç¨‹çš„è‡ªå®šä¹‰å­ç³»ç»Ÿï¼ŒåŒ…æ‹¬çº¿ç¨‹æ± ã€å¼‚æ­¥ IO å’Œè½»é‡çº§ä»»åŠ¡æ¡†æ¶ã€‚æä¾›å¯è°ƒçš„ã€çµæ´»çš„çº¿ç¨‹æ± ã€‚è¿˜æä¾›äº†è®¾è®¡ç”¨äºå¤šçº¿ç¨‹ä¸Šä¸‹æ–‡ä¸­çš„ Collection å®ç°ç­‰ã€‚ volatile å…³é”®å­—-å†…å­˜å¯è§æ€§ å†…å­˜å¯è§æ€§ï¼ˆMemory Visibilityï¼‰æ˜¯æŒ‡å½“æŸä¸ªçº¿ç¨‹æ­£åœ¨ä½¿ç”¨å¯¹è±¡çŠ¶æ€è€Œå¦ä¸€ä¸ªçº¿ç¨‹åœ¨åŒæ—¶ä¿®æ”¹è¯¥çŠ¶æ€ï¼Œéœ€è¦ç¡®ä¿å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å¯¹è±¡çŠ¶æ€åï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°å‘ç”Ÿçš„çŠ¶æ€å˜åŒ–ã€‚ é€šè¿‡ä¸€ä¸ªç”¨ä¾‹éªŒè¯å¯è§æ€§ï¼šå­çº¿ç¨‹ä¿®æ”¹å…±äº«èµ„æºçš„çŠ¶æ€ï¼ˆå†™æ“ä½œï¼‰ï¼Œä¸»çº¿ç¨‹è®¿é—®å…±äº«èµ„æºï¼ˆè¯»æ“ä½œï¼‰ï¼Œå¦‚æœä¸ºtrueæ‰“å°ä¸€æ®µç¬¦å·å¹¶é€€å‡ºå¾ªç¯ã€‚ 1234567891011121314151617181920212223242526272829public class TestVolatile { public static void main(String[] args) { // çº¿ç¨‹1 ThreadDemo td = new ThreadDemo(); new Thread(td).start(); // ä¸»çº¿ç¨‹å¾ªç¯çš„è®¿é—®å…±äº«èµ„æº while(true){ if(td.isFlag()){ System.out.println(\"------------------\"); break; } } }}class ThreadDemo implements Runnable { private boolean flag = false; // å…±äº«èµ„æº @Override public void run() { try { Thread.sleep(200); } catch (InterruptedException e) { } flag = true; System.out.println(\"flag=\" + isFlag()); }} è¿è¡Œç»“æœï¼š å¯ä»¥çœ‹åˆ°ï¼Œå­çº¿ç¨‹å°†èµ„æºçŠ¶æ€æ”¹ä¸ºtrueä¹‹åï¼Œè€Œä¸»çº¿ç¨‹ä¸€ç›´å¤„åœ¨å¾ªç¯çŠ¶æ€ï¼Œå¹¶æœªæ‰“å°ä¸€æ®µç¬¦å·ï¼Œè¯´æ˜æ­¤æ—¶å…±äº«èµ„æºçŠ¶æ€è¿˜æ˜¯falseï¼Œè€Œå­çº¿ç¨‹æ˜æ˜å°†çŠ¶æ€æ”¹ä¸ºtrueæ¥ç€çš„ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ è®¡ç®—æœºåœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œæ¯æ¡æŒ‡ä»¤éƒ½æ˜¯åœ¨CPUä¸­æ‰§è¡Œçš„ï¼Œè€Œæ‰§è¡ŒæŒ‡ä»¤è¿‡ç¨‹ä¸­ï¼ŒåŠ¿å¿…æ¶‰åŠåˆ°æ•°æ®çš„è¯»å–å’Œå†™å…¥ã€‚ç”±äºç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­çš„ä¸´æ—¶æ•°æ®æ˜¯å­˜æ”¾åœ¨ä¸»å­˜ï¼ˆç‰©ç†å†…å­˜ï¼‰å½“ä¸­çš„ï¼Œè¿™æ—¶å°±å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œç”±äºCPUæ‰§è¡Œé€Ÿåº¦å¾ˆå¿«ï¼Œè€Œä»å†…å­˜è¯»å–æ•°æ®å’Œå‘å†…å­˜å†™å…¥æ•°æ®çš„è¿‡ç¨‹è·ŸCPUæ‰§è¡ŒæŒ‡ä»¤çš„é€Ÿåº¦æ¯”èµ·æ¥è¦æ…¢çš„å¤šï¼Œå› æ­¤å¦‚æœä»»ä½•æ—¶å€™å¯¹æ•°æ®çš„æ“ä½œéƒ½è¦é€šè¿‡å’Œå†…å­˜çš„äº¤äº’æ¥è¿›è¡Œï¼Œä¼šå¤§å¤§é™ä½æŒ‡ä»¤æ‰§è¡Œçš„é€Ÿåº¦ã€‚å› æ­¤åœ¨CPUé‡Œé¢å°±æœ‰äº†é«˜é€Ÿç¼“å­˜ã€‚å½“ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šå°†è¿ç®—éœ€è¦çš„æ•°æ®ä»ä¸»å­˜å¤åˆ¶ä¸€ä»½åˆ°CPUçš„é«˜é€Ÿç¼“å­˜å½“ä¸­ï¼Œé‚£ä¹ˆCPUè¿›è¡Œè®¡ç®—æ—¶å°±å¯ä»¥ç›´æ¥ä»å®ƒçš„é«˜é€Ÿç¼“å­˜è¯»å–æ•°æ®å’Œå‘å…¶ä¸­å†™å…¥æ•°æ®ï¼Œå½“è¿ç®—ç»“æŸä¹‹åï¼Œå†å°†é«˜é€Ÿç¼“å­˜ä¸­çš„æ•°æ®åˆ·æ–°åˆ°ä¸»å­˜å½“ä¸­ã€‚ ç¨‹åºè¿è¡Œæ—¶ï¼ŒJVMä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„ç¼“å­˜æ¥æé«˜æ•ˆç‡ã€‚å…±äº«èµ„æºå­˜æ”¾åœ¨ä¸»å­˜ï¼ˆå †å†…å­˜ã€ç‰©ç†å†…å­˜ï¼‰ä¸­ï¼Œâ€œæ¯ä¸ªçº¿ç¨‹æ“ä½œå…±äº«èµ„æºæ—¶ï¼Œå…ˆä»ä¸»å­˜ä¸­è¯»å–å…±äº«èµ„æºæ”¾å…¥è‡ªå·±çš„ç¼“å­˜åŒºï¼Œåœ¨è‡ªå·±çš„ç¼“å­˜åŒºä¸­å¯¹èµ„æºè¿›è¡Œä¿®æ”¹ï¼Œç„¶åå°†ä¿®æ”¹æ›´æ–°åˆ°ä¸»å­˜ä¸­å»ã€‚â€ ä»ç”¨ä¾‹å¯ä»¥çœ‹å‡ºï¼Œå­çº¿ç¨‹ç¡äº†2sï¼Œæ‰€ä»¥ä¸»çº¿ç¨‹å…ˆæ‰§è¡Œï¼Œè·å¾—äº†èµ„æºçŠ¶æ€ä¸ºfalseã€‚ç„¶åå­çº¿ç¨‹å°†çŠ¶æ€æ”¹ä¸ºtrueå¹¶å°†ä¿®æ”¹æ›´æ–°åˆ°ä¸»å­˜ä¸­ï¼Œä½†æ˜¯ä¸»çº¿ç¨‹ä¸€ç›´å¤„åœ¨å¾ªç¯çŠ¶æ€ï¼Œè¿™æ˜¯å› ä¸ºwhileçš„è¿è¡Œè°ƒç”¨äº†åº•å±‚çš„ä»£ç å¤„ç†éå¸¸ä¹‹å¿«ï¼Œå¿«åˆ°éƒ½æ²¡æœ‰æ¥å¾—åŠæ›´æ–°ä¸»å­˜ä¸­çš„å…±äº«èµ„æºæ•°æ®ã€‚ ç°åœ¨çŸ¥é“æ˜¯å› ä¸ºå­çº¿ç¨‹æ›´æ–°ç¼“å­˜ä¸­çš„å€¼åˆ°ä¸»å­˜å»äº†è€Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹æ²¡æœ‰æ¥å¾—åŠåˆ·æ–°ç¼“å­˜æ¥æ›´æ–°ä¸»å­˜ä¸­çš„æ•°æ®ï¼Œæ‰€ä»¥å¯¼è‡´çš„ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€‚é€šå¸¸ç§°è¿™ç§è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®çš„å˜é‡ä¸ºå…±äº«å˜é‡ã€‚å¦‚æœä¸€ä¸ªå˜é‡åœ¨å¤šä¸ªCPUä¸­éƒ½å­˜åœ¨ç¼“å­˜ï¼ˆä¸€èˆ¬åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹æ—¶æ‰ä¼šå‡ºç°ï¼‰ï¼Œé‚£ä¹ˆå°±å¯èƒ½å­˜åœ¨ç¼“å­˜ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ Javaå†…å­˜æ¨¡å‹è§„å®šæ‰€æœ‰çš„å˜é‡éƒ½æ˜¯å­˜åœ¨ä¸»å­˜å½“ä¸­ï¼ˆç±»ä¼¼äºå‰é¢è¯´çš„ç‰©ç†å†…å­˜ï¼‰ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼ˆç±»ä¼¼äºå‰é¢çš„é«˜é€Ÿç¼“å­˜ï¼‰ã€‚çº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œè€Œä¸èƒ½ç›´æ¥å¯¹ä¸»å­˜è¿›è¡Œæ“ä½œã€‚å¹¶ä¸”æ¯ä¸ªçº¿ç¨‹ä¸èƒ½è®¿é—®å…¶ä»–çº¿ç¨‹çš„å·¥ä½œå†…å­˜ã€‚ å­çº¿ç¨‹å¯¹ä¸»å­˜è¿›è¡Œäº†ä¿®æ”¹ï¼Œä¸»çº¿ç¨‹æ²¡æœ‰ç«‹å³çœ‹åˆ°ï¼Œæ‰€ä»¥å‡ºç°äº†æ¦‚å¿µä¸­çš„å¯è§æ€§é—®é¢˜ã€‚ è§£å†³æ–¹æ¡ˆï¼š æ–¹å¼ä¸€ï¼šä½¿ç”¨synchronizedå’ŒLockï¼ˆåé¢å­¦ï¼‰ä¿è¯å¯è§æ€§ã€‚å®ƒèƒ½ä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹è·å–é”ç„¶åæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œå¹¶ä¸”åœ¨é‡Šæ”¾é”ä¹‹å‰ä¼šå°†å¯¹å˜é‡çš„ä¿®æ”¹åˆ·æ–°åˆ°ä¸»å­˜å½“ä¸­ã€‚ 12345678while (true) { synchronized (td) { if (td.isFlag()) { System.out.println(\"------------------\"); break; } }} æ¯æ¬¡è®¿é—®åŠ é”æ•°æ®éƒ½ä¼šä»ä¸»å­˜ä¸­åˆ·æ–°æ•°æ®ï¼Œæ‰€ä»¥ä¸»çº¿ç¨‹æ­£å¸¸é€€å‡ºã€‚ ä½†æ˜¯ç”±äº synchronized å…³é”®å­—ä¼šæä½çš„å½±å“è¿è¡Œæ•ˆç‡ï¼Œæ‰€ä»¥è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨ volatile å…³é”®å­—ä¿è¯å¯è§æ€§ã€‚å½“ä¸€ä¸ªå…±äº«å˜é‡è¢«volatileä¿®é¥°æ—¶ï¼Œå®ƒä¼šä¿è¯ä¿®æ”¹çš„å€¼ä¼šç«‹å³è¢«æ›´æ–°åˆ°ä¸»å­˜ï¼Œå½“æœ‰å…¶ä»–çº¿ç¨‹éœ€è¦è¯»å–æ—¶ï¼Œå®ƒä¼šå»å†…å­˜ä¸­è¯»å–æ–°å€¼ã€‚ volatile å’Œ synchronized çš„åŒºåˆ«ï¼š volatile ä¸ä¿è¯äº’æ–¥æ€§ã€‚ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºè®¿é—®å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¹Ÿèƒ½è®¿é—®ï¼Œä¸å…·å¤‡äº’æ–¥æ€§ã€‚ volatile ä¸ä¿è¯åŸå­æ€§ã€‚è§ä¸‹ä¸€èŠ‚ synchronized ä¿è¯åŸå­æ€§æ˜¯å› ä¸ºå¯¹å…±äº«èµ„æºåŠ é”ï¼Œæ¯æ¬¡åªèƒ½ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œä¸€ä¸ªçº¿ç¨‹åœ¨åŒæ­¥ä»£ç å—ä¸­æ‰§è¡Œæ“ä½œä¹‹åå¦ä¸€ä¸ªçº¿ç¨‹æ‰ä¼šè¿›å…¥ã€‚ å¼•ç”¨ï¼šJavaå¹¶å‘ç¼–ç¨‹ï¼švolatileå…³é”®å­—è§£æ åŸå­å˜é‡-CASç®—æ³•é¦–å…ˆæ˜ç™½ i++ æ“ä½œæ˜¯ä¸å…·å¤‡åŸå­æ€§çš„ï¼Œi++åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šé¦–å…ˆçº¿ç¨‹ä»ä¸»å­˜ä¸­è·å–å˜é‡içš„å€¼ï¼Œç„¶åæ‰§è¡Œ i + 1ï¼Œå†å°† i+1 èµ‹å€¼ç»™iï¼Œç„¶åå†™å…¥åˆ°çº¿ç¨‹è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œæœ€åå†™å…¥åˆ°ä¸»å­˜ã€‚ å‡å¦‚çº¿ç¨‹1è·å–äº†volatileä¿®é¥°çš„å…±äº«å˜é‡iè¿˜æœªæ¥å¾—åŠæ“ä½œï¼Œä½†æ­¤æ—¶è¢«çº¿ç¨‹2æŠ¢å¤ºäº†æ—¶é—´ç‰‡è¿›è¡Œäº† +1 æ“ä½œå¹¶å†™å…¥åˆ°ä¸»å­˜ï¼Œæ­¤æ—¶ä¸»å­˜çš„ i çš„å€¼å·²è¢«æ›´æ”¹ã€‚ ç”±äºçº¿ç¨‹1åªæ˜¯å¯¹å…±äº«å˜é‡è¿›è¡Œè¯»å–æ“ä½œå¹¶æ²¡æœ‰å¯¹å˜é‡è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šå¯¼è‡´çº¿ç¨‹2çš„å·¥ä½œå†…å­˜ä¸­ç¼“å­˜å˜é‡içš„ç¼“å­˜æ— æ•ˆï¼Œæ‰€ä»¥çº¿ç¨‹2ä¼šç›´æ¥å»ä¸»å­˜è¯»å–içš„å€¼ã€‚ç„¶åçº¿ç¨‹1å¯¹çº¿ç¨‹2ä¿®æ”¹ä¹‹å‰çš„iè¿›è¡Œ+1ä¹‹åå†™å…¥åˆ°ä¸»å­˜ï¼Œæ­¤æ¬¡çš„çº¿ç¨‹2æ›´æ–°çš„å€¼è¢«çº¿ç¨‹1ç»™è¦†ç›–æ‰äº†ã€‚ åŸå­å˜é‡åŸå­å˜é‡æ˜¯ä¿è¯äº†å˜é‡å…·æœ‰åŸå­æ€§çš„ç‰¹å¾ï¼Œå¯¹è¯¥å˜é‡çš„æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚åŸå­å˜é‡é€šè¿‡ä»¥ä¸‹ä¸¤ç‚¹ä¿è¯å˜é‡çš„åŸå­æ€§ã€‚ ä½¿ç”¨ volatile ä¿®é¥°ç¬¦ä¿è¯å˜é‡çš„å†…å­˜å¯è§æ€§ ä½¿ç”¨ CAS ç®—æ³•é€šè¿‡å†…å­˜å€¼å’Œé¢„ä¼°å€¼çš„æ¯”å¯¹å®ç°åŸå­æ€§ java.util.concurrent åŒ…ä¸­å¸¸è§åŸå­å˜é‡åŠAPIï¼š ç±» å¯¹åº”ç±»å‹ AtomicBoolean boolean AtomicInteger int AtomicLong long AtomicReference å‚æ•°åŒ–ç±»å‹ T AtomicIntegerArray int[] AtomicLongArray long[] AtomicMarkableReference Pair AtomicReferenceArray T[] AtomicStampedReference Pair æ ¸å¿ƒæ–¹æ³•ï¼šboolean compareAndSet(expectedValue, updateValue) CASç®—æ³•CAS (Compare-And-Swap) æ˜¯ä¸€ç§ç¡¬ä»¶å¯¹å¹¶å‘çš„æ”¯æŒï¼Œé’ˆå¯¹å¤šå¤„ç†å™¨æ“ä½œè€Œè®¾è®¡çš„å¤„ç†å™¨ä¸­çš„ä¸€ç§ç‰¹æ®ŠæŒ‡ä»¤ï¼Œç”¨äºç®¡ç†å¯¹å…±äº«æ•°æ®çš„å¹¶è®¿é—®ã€‚ CAS æ˜¯ä¸€ç§æ— é”çš„éé˜»å¡ç®—æ³•çš„å®ç°ã€‚ CAS åŒ…å«äº† 3 ä¸ªæ“ä½œæ•°ï¼š éœ€è¦è¯»å†™çš„å†…å­˜å€¼ V è¿›è¡Œæ¯”è¾ƒçš„å€¼ A æ‹Ÿå†™å…¥çš„æ–°å€¼ B å½“ä¸”ä»…å½“ V çš„å€¼ç­‰äº A æ—¶ï¼ŒCAS é€šè¿‡åŸå­æ–¹å¼ç”¨æ–°å€¼ B æ¥æ›´æ–° V çš„å€¼ï¼Œå¦åˆ™ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œã€‚ é‡ç°i++æ“ä½œï¼šåˆå§‹åŒ–æ—¶ i=0, çº¿ç¨‹2ä»ä¸»å­˜ä¸­è·å–åˆ°å…±äº«å˜é‡iï¼Œå†…å­˜å€¼V=0ï¼›æ­¤æ—¶çº¿ç¨‹1æŠ¢å¤ºåˆ°äº†æ—¶é—´ç‰‡ä¹Ÿä»ä¸»å­˜ä¸­è·å–åˆ°å…±äº«å˜é‡iï¼Œå†…å­˜å€¼V=0ï¼›å¹¶ä¸”è¿›è¡Œ+1æ“ä½œï¼Œ+1æ—¶CASç®—æ³•å†æ¬¡è¯»å–ä¸»å­˜çš„å€¼å‘ç°iæ²¡å˜ï¼Œæ‰€ä»¥æ¯”è¾ƒå€¼A=0ï¼Œå¯¹æ¯”V == Aä¸ºtrue åˆ™ä»¥B=1æ›´æ–°Vï¼Œå†™å…¥åˆ°çº¿ç¨‹1çš„å·¥ä½œå†…å­˜ï¼Œå†å†™å…¥åˆ°ä¸»å­˜ã€‚ æ­¤æ—¶ä¸»å­˜ä¸­çš„å€¼i=1ï¼Œä½†æ˜¯çº¿ç¨‹2åœ¨çº¿ç¨‹1ä¿®æ”¹ä¹‹å‰å°±è¯»å–åˆ°äº† i çš„å€¼ï¼ŒV=0ï¼Œç„¶åè¿›è¡Œ+1æ“ä½œï¼ŒCASç®—æ³•å†æ¬¡ä»ä¸»å­˜è·å–iå€¼å‘ç°å·²ç»å˜åŒ–äº†ï¼šA=1ï¼Œæ­¤æ—¶ V == A ä¸ºfalseï¼Œåˆ™å–æ¶ˆæ›´æ–°ã€‚ ConcurrentHashMap é”åˆ†æ®µæœºåˆ¶ Java 5.0 åœ¨ java.util.concurrent åŒ…ä¸­æä¾›äº†å¤šç§å¹¶å‘å®¹å™¨ç±»æ¥æ”¹è¿›åŒæ­¥å®¹å™¨çš„æ€§èƒ½ã€‚ConcurrentHashMap åŒæ­¥å®¹å™¨ç±»æ˜¯Java 5 å¢åŠ çš„ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å“ˆå¸Œè¡¨ã€‚å¯¹ä¸å¤šçº¿ç¨‹çš„æ“ä½œï¼Œä»‹äº HashMap ä¸ Hashtable ä¹‹é—´ã€‚å†…éƒ¨é‡‡ç”¨â€œé”åˆ†æ®µâ€æœºåˆ¶æ›¿ä»£ Hashtable çš„ç‹¬å é”ã€‚è¿›è€Œæé«˜æ€§èƒ½ã€‚ å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä½¿ç”¨ HashMap æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚ä¸ºäº†ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨Collectinosé›†åˆå·¥å…·ç±»ä¸­çš„synchronizedæ–¹æ³•æ¥å°†éçº¿ç¨‹å®‰å…¨çš„å®¹å™¨ç±»è½¬ä¸ºå¯¹åº”çº¿ç¨‹å®‰å…¨çš„å®¹å™¨ç±»ã€‚å…¶å†…éƒ¨å°±æ˜¯ç»™æ¯ä¸ªæ–¹æ³•åŠ äº†ä¸€æŠŠsynchronizedé”ã€‚å¦å¤–ä¸€ç§æ–¹å¼å°±æ˜¯ä½¿ç”¨ HashMap çš„çº¿ç¨‹å®‰å…¨ç±» Hashtableã€‚ Hashtable é‡‡ç”¨äº†è¡¨é”æœºåˆ¶ï¼Œä»»ä½•ä¸€ä¸ªçº¿ç¨‹å¯¹å®¹å™¨è®¿é—®å…¶ä»–çº¿ç¨‹ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ã€‚ç”±äºHashtable ä¸ºæ¯ä¸ªæ–¹æ³•ä½¿ç”¨äº†åŒä¸€æŠŠé”ï¼ˆæ¯ä¸€ä¸ªè¢«synchronizedä¿®é¥°çš„æ–¹æ³•éƒ½æ˜¯ä½¿ç”¨çš„javaå†…ç½®é”ï¼Œé”çš„æ˜¯æ–¹æ³•æ‰€å±å¯¹è±¡æœ¬èº«ï¼‰ï¼Œä¸€ä¸ªçº¿ç¨‹è·å¾—äº†é”è¿›å…¥æŸä¸ªåŒæ­¥æ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹éƒ½ä¸èƒ½è¿›å…¥è¢«è¯¥é”ä¿®é¥°çš„å…¶ä»–åŒæ­¥æ–¹æ³•ï¼Œé™¤éé”è¢«é‡Šæ”¾æŠ¢åˆ°äº†é”ã€‚åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œæä½çš„é™ä½äº†æ•ˆç‡ã€‚ å¦å¤– Hashtable è¿™ç§è¡¨é”æœºåˆ¶ï¼ˆæ¯ä¸ªåŒæ­¥æ–¹æ³•ä½¿ç”¨åŒä¸€æŠŠé”ï¼‰åœ¨å¹¶å‘çš„å¤åˆæ“ä½œä¸­ä¼šäº§ç”Ÿå¼‚å¸¸ã€‚ä¾‹å¦‚ï¼šåœ¨è¿­ä»£æ“ä½œä¸­ï¼Œçº¿ç¨‹1è°ƒç”¨äº†åŒæ­¥çš„ hashNext() æ–¹æ³•å‘ç°æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ å‡†å¤‡è°ƒç”¨åŒæ­¥çš„ next() æ–¹æ³•è·å–å…ƒç´ æ—¶ï¼Œæ—¶é—´ç‰‡è¢«çº¿ç¨‹2æŠ¢å¤ºè¿‡å»å°†æŸä¸ªå…ƒç´ ä¿®æ”¹äº†ï¼Œæ­¤æ—¶ä¼šæŠ›å‡ºå¹¶å‘å¼‚å¸¸ConcurrentModificationExceptionã€‚å¤šä¸ªåŒæ­¥æ–¹æ³•ç»„æˆçš„æ“ä½œä¸æ˜¯åŒæ­¥æ“ä½œäº†ã€‚ ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜äºæ˜¯æœ‰äº†é”åˆ†æ®µæœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶å°†å®¹å™¨ä¸­çš„æ•°æ®åˆ†ä¸ºä¸€æ®µä¸€æ®µå­˜å‚¨ï¼Œä¸ºæ¯ä¸€æ®µåŠ ä¸€æŠŠé”ï¼Œä¸åŒçš„é”ä¹‹é—´äº’ä¸å¹²æ‰°ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å ç”¨å…¶ä¸­ä¸€æ®µæ•°æ®çš„æ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®å¦ä¸€æ®µçš„æ•°æ®ã€‚ä»¥æ­¤æé«˜äº†å¹¶å‘æ•ˆç‡ã€‚ ä»¥ä¸‹æ˜¯å¸¸ç”¨å¹¶å‘å®¹å™¨ç±»å¯¹åº”çš„æœªåŠ åŒæ­¥çš„å®¹å™¨ç±»ï¼š å¹¶å‘å®¹å™¨ç±» éåŒæ­¥å®¹å™¨ç±» ConcurrentHashMap HashMap ConcurrentSkipListMap TreeMap ConcurrentSkipListSet TreeSet CopyOnWriteArrayList ArrayList CopyOnWriteArraySet Set å½“å¸Œæœ›è®¸å¤šçº¿ç¨‹è®¿é—®ä¸€ä¸ªå®¹å™¨ç±»çš„æ—¶å€™ï¼ŒConcurrentHashMap é€šå¸¸ä¼˜äºåŒæ­¥çš„ HashMapã€‚ConcurrentSkipListMap é€šå¸¸ä¼˜äºåŒæ­¥çš„TreeMapã€‚å½“æœŸæœ›çš„è¯»æ•°å’Œéå†è¿œè¿œå¤§äºåˆ—è¡¨çš„æ›´æ–°æ•°æ—¶ï¼ŒCopyOnWriteArrayList ä¼˜äºåŒæ­¥çš„ ArrayListã€‚ CountDownLatch é—­é”CountDownLatch ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»ï¼Œåœ¨å®Œæˆä¸€ç»„æ­£åœ¨å…¶ä»–çº¿ç¨‹ä¸­æ‰§è¡Œçš„æ“ä½œä¹‹å‰ï¼Œå®ƒå…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ä¸€ç›´ç­‰å¾…ã€‚ é—­é”å¯ä»¥å»¶è¿Ÿçº¿ç¨‹çš„è¿›åº¦ç›´åˆ°å…¶åˆ°è¾¾ç»ˆæ­¢çŠ¶æ€ï¼Œé—­é”å¯ä»¥ç”¨æ¥ç¡®ä¿æŸäº›æ´»åŠ¨ç›´åˆ°å…¶ä»–æ´»åŠ¨éƒ½å®Œæˆæ‰ç»§ç»­æ‰§è¡Œï¼š ç¡®ä¿æŸä¸ªè®¡ç®—åœ¨å…¶éœ€è¦çš„æ‰€æœ‰èµ„æºéƒ½è¢«åˆå§‹åŒ–ä¹‹åæ‰ç»§ç»­æ‰§è¡Œ; ç¡®ä¿æŸä¸ªæœåŠ¡åœ¨å…¶ä¾èµ–çš„æ‰€æœ‰å…¶ä»–æœåŠ¡éƒ½å·²ç»å¯åŠ¨ä¹‹åæ‰å¯åŠ¨; ç­‰å¾…ç›´åˆ°æŸä¸ªæ“ä½œæ‰€æœ‰å‚ä¸è€…éƒ½å‡†å¤‡å°±ç»ªå†ç»§ç»­æ‰§è¡Œ ä¸€ä¸ªç®€å•çš„ç”¨ä¾‹ï¼Œç»Ÿè®¡æ‰€æœ‰çº¿ç¨‹æ‰§è¡ŒæŸä¸ªåŒæ­¥æ“ä½œçš„æ€»è®¡æ—¶é—´ã€‚ä¸»çº¿ç¨‹éœ€è¦åœ¨å…¶ä»–çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹å‰ç­‰å¾…ï¼Œç›´è‡³é—­é”è®¡æ•°å™¨ä¸º0è§£é™¤ç­‰å¾…çŠ¶æ€ã€‚ 12345678910111213141516171819202122232425262728293031323334353637public class TestCountDownLatch { public static void main(String[] args) { final CountDownLatch latch = new CountDownLatch(50); // åˆ›å»ºä¸€ä¸ªé—­é”å¯¹è±¡ LatchDemo ld = new LatchDemo(latch); long start = System.currentTimeMillis(); for (int i = 0; i &lt; 50; i++) { new Thread(ld).start(); // æ¯ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€æ¬¡è¿ç®— } try { latch.await(); // ä¸»çº¿ç¨‹è¿›å…¥ç­‰å¾…ï¼Œç›´è‡³é—­é”è®¡ç®—å™¨ä¸º0ï¼Œè§£é™¤ç­‰å¾…çŠ¶æ€ã€‚ } catch (InterruptedException e) { } long end = System.currentTimeMillis(); System.out.println(\"è€—è´¹æ—¶é—´ä¸ºï¼š\" + (end - start)); // å…¶ä»–çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•ç»Ÿè®¡æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œçš„æ€»æ—¶é—´ }}class LatchDemo implements Runnable { private CountDownLatch latch; // ç»´æŠ¤ä¸€ä¸ªé—­é”å¯¹è±¡ public LatchDemo(CountDownLatch latch) { this.latch = latch; } @Override public void run() { try { for (int i = 0; i &lt; 50000; i++) { if (i % 2 == 0) { System.out.println(i); } } } finally { latch.countDown(); // æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•è®¡æ•°å™¨-1 } }} å®ç° Callable æ¥å£åˆ›å»ºçº¿ç¨‹çš„ç¬¬ä¸‰ç§æ–¹å¼ï¼šå®ç° Callable æ¥å£ï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¦æ³›å‹çš„æ¥å£ï¼Œå®ç°è¿™ä¸ªæ¥å£çš„çº¿ç¨‹å¯ä»¥è¿”å›æ³›å‹å‚æ•°çš„å€¼å¹¶å¯ä»¥æŠ›å‡ºå¼‚å¸¸ã€‚ 12345678910111213141516171819202122232425public class TestCallable { public static void main(String[] args) { ThreadDemo td = new ThreadDemo(); // çº¿ç¨‹å¯¹è±¡ FutureTask&lt;Integer&gt; result = new FutureTask&lt;&gt;(td); // ç”¨äºæ¥æ”¶çº¿ç¨‹ç»“æœçš„å¯¹è±¡ new Thread(result).start(); // å¯åŠ¨ try { Integer sum = result.get(); //FutureTaskæ²¡æœ‰è·å–åˆ°ç»“æœä¹‹å‰ï¼Œçº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå› æ­¤ä¹Ÿå¯ç”¨äºé—­é”ã€‚ System.out.println(sum); System.out.println(\"------------------------------------\"); } catch (InterruptedException | ExecutionException e) { e.printStackTrace(); } }}class ThreadDemo implements Callable&lt;Integer&gt; { @Override public Integer call() throws Exception { int sum = 0; for (int i = 0; i &lt;= 100000; i++) { sum += i; } return sum; }} Lock åŒæ­¥é” åœ¨ Java 5.0 ä¹‹å‰ï¼Œåè°ƒå…±äº«å¯¹è±¡çš„è®¿é—®æ—¶å¯ä»¥ä½¿ç”¨çš„æœºåˆ¶åªæœ‰ synchronized å’Œ volatile ã€‚Java 5.0 åå¢åŠ äº†ä¸€äº›æ–°çš„æœºåˆ¶ï¼Œä½†å¹¶ä¸æ˜¯ä¸€ç§æ›¿ä»£å†…ç½®é”çš„æ–¹æ³•ï¼Œè€Œæ˜¯å½“å†…ç½®é”ä¸é€‚ç”¨æ—¶ï¼Œä½œä¸ºä¸€ç§å¯é€‰æ‹©çš„é«˜çº§åŠŸèƒ½ã€‚ReentrantLock å®ç°äº† Lock æ¥å£ï¼Œå¹¶æä¾›äº†ä¸synchronized ç›¸åŒçš„äº’æ–¥æ€§å’Œå†…å­˜å¯è§æ€§ã€‚ä½†ç›¸è¾ƒäºsynchronized æä¾›äº†æ›´é«˜çš„å¤„ç†é”çš„çµæ´»æ€§ã€‚ è§£å†³å¤šçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ŒåŠ é”çš„ç¬¬äºŒç§æ–¹å¼ã€‚ç›¸å¯¹äº synchronized ä¸Šé”ä½¿ç”¨ lock å¯æ›´å…·æœ‰çµæ´»æ€§ï¼Œå¹¶ä¸”æ˜¯æ˜¾å¼é”ï¼Œä¸Šé”å’Œé‡Šæ”¾é”éœ€è¦æ‰‹åŠ¨å®Œæˆã€‚éœ€è¦æ³¨æ„çš„æ˜¯å½“åŒæ­¥ä»£ç å‡ºç°å¼‚å¸¸å¿…é¡»ä¿è¯ unlock æ“ä½œä¸€å®šä¼šæ‰§è¡Œï¼Œå¦åˆ™ç”±äºæ²¡é‡Šæ”¾é”å…¶ä»–çº¿ç¨‹ä¼šä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ã€‚ 12345678910111213141516171819202122232425262728293031public class TestLock { public static void main(String[] args) { Ticket ticket = new Ticket(); new Thread(ticket, \"1å·çª—å£\").start(); new Thread(ticket, \"2å·çª—å£\").start(); new Thread(ticket, \"3å·çª—å£\").start(); }}class Ticket implements Runnable { private int tick = 100; private Lock lock = new ReentrantLock(); @Override public void run() { while (true) { lock.lock(); //ä¸Šé” try { if (tick &gt; 0) { try { Thread.sleep(200); } catch (InterruptedException e) { } System.out.println(Thread.currentThread().getName() + \" å®Œæˆå”®ç¥¨ï¼Œä½™ç¥¨ä¸ºï¼š\" + --tick); } } finally { lock.unlock(); //é‡Šæ”¾é” } } }} Condition æ§åˆ¶çº¿ç¨‹é€šä¿¡é¦–å…ˆå›é¡¾ä¸€ä¸‹ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ï¼Œç›´æ¥ä¸Šä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071public class TestProducerAndConsumer { public static void main(String[] args) { Clerk clerk = new Clerk(); Producer producer = new Producer(); producer.setClerk(clerk); Consumer consumer = new Consumer(); consumer.setClerk(clerk); new Thread(producer,\"ç”Ÿäº§è€…Aï¼š\").start(); new Thread(consumer,\"æ¶ˆè´¹è€…Bï¼š\").start(); }}// åº—å‘˜ï¼ˆç»´æŠ¤å…±äº«èµ„æºâ€”â€”äº§å“ï¼Œç”Ÿäº§å’Œæ¶ˆè´¹ï¼‰@Dataclass Clerk { private int product; public synchronized void production(){ if (product &gt;= 10) { System.out.println(\"å·²æ»¡ï¼\"); try { this.wait(); } catch (InterruptedException e) { } } else { System.out.println(Thread.currentThread().getName()+\"ç”Ÿäº§äº†ï¼š\" + ++product); this.notifyAll(); } } public synchronized void consumption(){ if (product &lt;= 0) { System.out.println(\"ç¼ºè´§ï¼\"); try { this.wait(); } catch (InterruptedException e) { } } else { System.out.println(Thread.currentThread().getName()+\"æ¶ˆè´¹äº†ï¼š\" + product--); this.notifyAll(); } }}// ç”Ÿäº§è€…@Dataclass Producer implements Runnable{ private Clerk clerk; @Override public void run() { for (int i = 0; i &lt; 20; i++){ clerk.production(); } }}// æ¶ˆè´¹è€…@Dataclass Consumer implements Runnable{ private Clerk clerk; @Override public void run() { for (int i = 0; i &lt; 20; i++){ clerk.consumption(); } }} è¿è¡Œç»“æœéƒ¨åˆ†æˆªå›¾ï¼š ä»¥ä¸Šç»“æœçœ‹ä¼¼äº¤æ›¿æœ‰åºçš„æ‰§è¡Œï¼Œä½†æ˜¯å­˜åœ¨ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ã€‚å½“æˆ‘ä»¬å°†ä»“åº“å®¹é‡è®¾ä¸º1ï¼Œåº“å­˜æœ‰äº†ä¸€ä¸ªäº§å“å°±æ»¡äº†ï¼Œç”Ÿäº§è€…æŒ‚èµ·ï¼Œé€šçŸ¥æ¶ˆè´¹è€…è¿è¡Œã€‚ if (product &gt;= 1) { System.out.println(&quot;å·²æ»¡ï¼&quot;); try { this.wait(); } catch (InterruptedException e) { } } else { System.out.println(Thread.currentThread().getName()+&quot;ç”Ÿäº§äº†ï¼š&quot; + ++product); this.notifyAll(); } å†è®©ç”Ÿäº§è€…æ¯æ¬¡ç”Ÿäº§ä¹‹å‰ç¡ä¸€ç§’ï¼š for (int i = 0; i &lt; 20; i++){ try { Thread.sleep(200); } catch (InterruptedException e) { } clerk.production(); } çœ‹çœ‹è¿è¡Œæƒ…å†µâ€¦ å‘ç°ç¨‹åºæ²¡æœ‰æ­£å¸¸åœæ­¢ ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿé¦–å…ˆï¼šç”Ÿäº§è€…æ¯æ¬¡ç”Ÿäº§ä¹‹å‰éƒ½ä¼šç¡ä¸Šä¸€ç§’ï¼Œè¿™å°±æ„å‘³ç€æ—¶é—´ç‰‡æ€»æ˜¯è¢«æ¶ˆè´¹è€…å…ˆæŠ¢å»äº†ï¼Œæ¯æ¬¡éƒ½æ˜¯æ¶ˆè´¹è€…æ²¡è´§äº†è¿›å…¥é˜»å¡çŠ¶æ€ä¹‹åç”Ÿäº§è€…æ‰æ…¢ååçš„æŠ¢åˆ°äº†æ—¶é—´ç‰‡è¿›è¡Œç”Ÿäº§ã€‚ å†çœ‹ä¸€æ¬¡æ¶ˆè´¹è€…çš„ä»£ç ï¼š public synchronized void consumption() { if (product &lt;= 0) { System.out.println(&quot;ç¼ºè´§ï¼&quot;); try { this.wait(); } catch (InterruptedException e) { } } else { System.out.println(Thread.currentThread().getName() + &quot;æ¶ˆè´¹äº†ï¼š&quot; + product--); this.notifyAll(); } } æ³¨æ„ï¼šè¿™ä¸ª else æ˜¯é—®é¢˜çš„å…³é”®ç‚¹ã€‚ ç”Ÿäº§è€…æ¶ˆè´¹è€…åŒæ—¶å¼€æŠ¢ï¼Œç”±äºç”Ÿäº§è€…0è¦ç¡ä¸Šä¸€ä¼šï¼Œäºæ˜¯æ¯«ä¸æ„å¤–çš„è¢«æ¶ˆè´¹è€…0æŠ¢åˆ°æ—¶é—´ç‰‡ï¼Œè¿›å…¥ç¼ºè´§åˆ†æ”¯é‡Œé¢é™·å…¥äº†ç­‰å¾…çŠ¶æ€ï¼Œæ­¤æ—¶ç”Ÿäº§è€…0 ç¡å®Œ1ç§’ç”Ÿäº§äº†ä¸€ä¸ªäº§å“ï¼Œå”¤é†’æ‰€æœ‰çº¿ç¨‹ã€‚æ¶ˆè´¹è€…0ç”±äºå·²ç»åœ¨æ¶ˆè´¹çš„åŒæ­¥ä»£ç å—é‡Œé¢æ‰€ä»¥ç»§ç»­æ‰§è¡Œé€€å‡ºäº†æœ¬æ¬¡å¾ªç¯ï¼Œè¯¥æ¶ˆè´¹è€…0æ²¡æœ‰æ¶ˆè´¹äº§å“ã€‚ æ¥ç€ï¼Œç”Ÿäº§è€…1å’Œæ¶ˆè´¹è€…1æŠ¢æ—¶é—´ç‰‡ï¼Œç”Ÿäº§è€…æ¯æ¬¡éƒ½è¦ç¡è§‰æ€ä¹ˆæŠ¢çš„è¿‡æ¶ˆè´¹è€…ï¼Œäºæ˜¯æ¶ˆè´¹è€…1æŠ¢åˆ°äº†ï¼Œå‘ç°æœ‰è´§ï¼é€šçŸ¥æ‰€æœ‰çº¿ç¨‹ï¼Œæ¶ˆè´¹è€…2åˆæŠ¢åˆ°äº†æ—¶é—´ï¼Œå‘ç°æ²¡è´§ï¼Œæ­¤æ—¶ç”Ÿäº§1æ‰â€œè¢«è¿«â€æ‹¿åˆ°æ—¶é—´ç‰‡ç”Ÿäº§ä¸€ä¸ªäº§å“ï¼Œé€šçŸ¥æ‰€æœ‰çº¿ç¨‹ã€‚ç”±äºç”Ÿäº§è€…æ¯æ¬¡éƒ½è¦ç­‰å¾…æ‰€ä»¥æ¯æ¬¡éƒ½è¢«æ¶ˆè´¹è€…æŠ¢åˆ°æ—¶é—´ï¼Œæ¶ˆè´¹è€…2æ‰§è¡Œå®Œæ¯•ã€‚æ¶ˆè´¹è€…2æ²¡æœ‰æ¶ˆè´¹å°±ç»“æŸã€‚ ç”Ÿäº§è€…2ä¸æ¶ˆè´¹è€…3å¼€æŠ¢ï¼Œæ¶ˆè´¹è€…3èƒœã€‚æœ‰è´§ï¼æ¶ˆè´¹å®Œæ¯•é€šçŸ¥æ‰€æœ‰çº¿ç¨‹ï¼Œæ¶ˆè´¹è€…4åˆæŠ¢åˆ°äº†ï¼Œæ²¡è´§ã€‚æ­¤æ—¶ç”Ÿäº§è€…2åˆâ€œè¢«è¿«â€ç”Ÿäº§äº†ä¸€ä¸ªï¼Œé€šçŸ¥æ‰€æœ‰çº¿ç¨‹â€¦ å¥½å§ï¼Œæ¶ˆè´¹è€…5æŠ¢åˆ°äº†ï¼Œæ¶ˆè´¹å®Œç¾æ»‹æ»‹ã€‚æ¶ˆè´¹è€…6åˆæ¥äº†ï¼Œç¼ºè´§ï¼ç”Ÿäº§è€…3â€œè¢«è¿«â€ç”Ÿäº§â€¦â€¦ æ¯æ¬¡éƒ½æ˜¯æ¶ˆè´¹è€…æŠ¢åˆ°CPUæ—¶é—´ç‰‡æ‰§è¡Œæƒï¼Œè€Œç”Ÿäº§è€…æ¯æ¬¡éƒ½æ˜¯åœ¨æ¶ˆè´¹è€…æ²¡è´§æ—¶ç­‰å¾…çŠ¶æ€ä¸‹æ‰æœ‰æœºä¼šæ‰§è¡Œï¼Œè€Œç”±äºå­˜åœ¨elseåˆ†æ”¯å¯¼è‡´æœ‰äº›æ¶ˆè´¹è€…å¹¶æ²¡æœ‰æ¶ˆè´¹äº§å“å°±ç»“æŸäº†ã€‚ æœ€åçš„ç»“æœæ˜¯æ¶ˆè´¹è€…æ—©æ—©çš„éå†å®Œ20æ¬¡ï¼Œè€Œç”Ÿäº§è€…è¿Ÿè¿Ÿæ²¡æœ‰éå†å®Œ20æ¬¡ï¼Œæ…¢æ…¢ååçš„â€¦ æœ€å…³é”®çš„ï¼š ç”±äºæ¶ˆè´¹è€…æ—©å°±æ¶ˆè´¹å®Œäº†ï¼Œç”Ÿäº§è€…ç”Ÿäº§äº†ä¸€ä¸ªå”¤é†’æ‰€æœ‰ï¼Œåªæœ‰è‡ªå·±è¢«å”¤é†’æ²¡äººå’Œå®ƒæŠ¢ï¼Œå°±åˆè¿›å…¥äº†ç”Ÿäº§è€…æ–¹æ³•ï¼Œå‘ç°åº“å­˜æ»¡äº†ï¼äºæ˜¯ä¹ï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹å”¤é†’è‡ªå·±ï¼Œç„¶è€Œæ²¡æœ‰å…¶ä»–çº¿ç¨‹äº†ï¼Œå°±æ²¡äººå”¤é†’è‡ªå·±äº†â€¦ è§£å†³åŠæ³•ï¼šå»æ‰elseåˆ†æ”¯ public synchronized void production() { if (product &gt;= 1) { System.out.println(&quot;å·²æ»¡ï¼&quot;); try { this.wait(); } catch (InterruptedException e) { } } System.out.println(Thread.currentThread().getName() + &quot;ç”Ÿäº§äº†ï¼š&quot; + ++product); this.notifyAll(); } public synchronized void consumption() { if (product &lt;= 0) { System.out.println(&quot;ç¼ºè´§ï¼&quot;); try { this.wait(); } catch (InterruptedException e) { } } System.out.println(Thread.currentThread().getName() + &quot;æ¶ˆè´¹äº†ï¼š&quot; + product--); this.notifyAll(); } è¿™æ ·ä¿è¯äº†æ¯æ¬¡æ¶ˆè´¹è€…éƒ½èƒ½æ¶ˆè´¹åˆ°äº§å“ï¼Œç„¶è€Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…å’Œä¸€ä¸ªç”Ÿäº§è€…çš„æƒ…å†µä¸‹æ˜¯æ²¡é—®é¢˜çš„ï¼Œå½“åˆ†åˆ«æœ‰ä¸¤ä¸ªå‘¢ï¼Ÿ ä¹±å¥—äº†â€¦ è¿™ä¸ªç¨å¾®æƒ³æƒ³å¾ˆå¥½ç†è§£ï¼Œæ¯”å¦‚åˆšå¼€å§‹ç¬¬ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹æŠ¢åˆ°äº†æ—¶é—´è¿›å…¥ç¼ºè´§åˆ†æ”¯é™·å…¥ç­‰å¾…ï¼Œäºæ˜¯ç”Ÿäº§è€…ç”Ÿäº§äº†ä¸€ä¸ªï¼Œå¼€å§‹æŠ¢å¤ºæ—¶é—´ï¼Œå‡å¦‚æ­¤æ—¶è¢«ç¬¬äºŒä¸ªæ¶ˆè´¹è€…çº¿ç¨‹æŠ¢åˆ°æ—¶é—´è¿›å…¥äº†æ¶ˆè´¹ä»£ç å—ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªæ¶ˆè´¹çº¿ç¨‹å·²ç»è¿›å…¥äº†å®ƒå°±ä¼šç»§ç»­æ‰§è¡Œå®Œæ¯•ï¼Œäºæ˜¯ä¹ä¸¤ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹æ¶ˆè´¹äº†åŒä¸€ä»½äº§å“ã€‚ è¿™å°±æ˜¯ è™šå‡å”¤é†’ ï¼Œé‚£ä¹ˆæ€ä¹ˆè§£å†³å‘¢ï¼ŸçœŸæ˜¯ä»¤äººå¤´å¤§â€¦ å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°†ç”Ÿäº§æ¶ˆè´¹çš„åŒæ­¥ä»£ç å—ä¸­ç”± if æ”¹ä¸º whileå°±è¡Œäº†ã€‚ public synchronized void production() { while (product &gt;= 1) { System.out.println(&quot;å·²æ»¡ï¼&quot;); try { this.wait(); } catch (InterruptedException e) { } } System.out.println(Thread.currentThread().getName() + &quot;ç”Ÿäº§äº†ï¼š&quot; + ++product); this.notifyAll(); } public synchronized void consumption() { while (product &lt;= 0) { System.out.println(&quot;ç¼ºè´§ï¼&quot;); try { this.wait(); } catch (InterruptedException e) { } } System.out.println(Thread.currentThread().getName() + &quot;æ¶ˆè´¹äº†ï¼š&quot; + product--); this.notifyAll(); } ä¸€æ¬¡ç­‰å¾…ä¹‹åï¼Œå½“è¦ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå†æ¬¡åˆ¤æ–­ä¸€æ¬¡æ˜¯å¦æœ‰è´§ï¼Œæœ‰æ‰æ¶ˆè´¹ï¼Œæ²¡æœ‰å°±ç»§ç»­ç­‰å¾…ã€‚ è‡³æ­¤ï¼Œçº¿ç¨‹é—´é€šä¿¡çš„æ½œåœ¨é—®é¢˜åŠè™šå‡å”¤é†’é—®é¢˜å®Œç¾è§£å†³äº†ã€‚ æ¥ä¸‹æ¥å°±æ˜¯é€šè¿‡ä½¿ç”¨Locké”å–ä»£Synchronizedé”ï¼Œè€ŒCondictionåˆ™æ˜¯å¯¹çº¿ç¨‹é€šä¿¡è¿›è¡Œæ§åˆ¶çš„æ¡ä»¶å˜é‡çš„å¯¹è±¡ã€‚ Condition æ¥å£æè¿°äº†å¯èƒ½ä¼šä¸é”æœ‰å…³è”çš„æ¡ä»¶å˜é‡ã€‚è¿™äº›å˜é‡åœ¨ç”¨æ³•ä¸Šä¸ä½¿ç”¨ Object.wait è®¿é—®çš„éšå¼ç›‘è§†å™¨ç±»ä¼¼ï¼Œä½†æä¾›äº†æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚éœ€è¦ç‰¹åˆ«æŒ‡å‡ºçš„æ˜¯ï¼Œå•ä¸ª Lock å¯èƒ½ä¸å¤šä¸ª Condition å¯¹è±¡å…³è”ã€‚ä¸ºäº†é¿å…å…¼å®¹æ€§é—®é¢˜ï¼ŒCondition æ–¹æ³•çš„åç§°ä¸å¯¹åº”çš„ Object ç‰ˆæœ¬ä¸­çš„ä¸åŒã€‚åœ¨ Condition å¯¹è±¡ä¸­ï¼Œä¸ waitã€notifyå’ŒnotifyAll æ–¹æ³•å¯¹åº”çš„åˆ†åˆ«æ˜¯awaitã€signal å’Œ signalAllã€‚Condition å®ä¾‹å®è´¨ä¸Šè¢«ç»‘å®šåˆ°ä¸€ä¸ªé”ä¸Šã€‚è¦ä¸ºç‰¹å®š Lock å®ä¾‹è·å¾—Condition å®ä¾‹ï¼Œè¯·ä½¿ç”¨å…¶ newCondition() æ–¹æ³•ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839class Clerk1 { private int product; private Lock lock = new ReentrantLock(); // åŠ  Lock é” Condition condition = lock.newCondition(); // é€šè¿‡ lock è·å¾—é”å…³è”å˜é‡å¯¹è±¡ public void production() { lock.lock(); try { while (product &gt;= 1) { System.out.println(\"å·²æ»¡ï¼\"); try { condition.await(); } catch (InterruptedException e) { } } System.out.println(Thread.currentThread().getName() + \"ç”Ÿäº§äº†ï¼š\" + ++product); condition.signalAll(); } finally { lock.unlock(); } } public void consumption() { lock.lock(); try { while (product &lt;= 0) { System.out.println(\"ç¼ºè´§ï¼\"); try { condition.await(); } catch (InterruptedException e) { } } System.out.println(Thread.currentThread().getName() + \"æ¶ˆè´¹äº†ï¼š\" + product--); condition.signalAll(); } finally { lock.unlock(); } }} çº¿ç¨‹æŒ‰åºäº¤æ›¿ ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œå¼€å¯ 3 ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸‰ä¸ªçº¿ç¨‹çš„ ID åˆ†åˆ«ä¸ºAã€Bã€Cï¼Œæ¯ä¸ªçº¿ç¨‹å°†è‡ªå·±çš„ ID åœ¨å±å¹•ä¸Šæ‰“å° 10 éï¼Œè¦æ±‚è¾“å‡ºçš„ç»“æœå¿…é¡»æŒ‰é¡ºåºæ˜¾ç¤ºã€‚å¦‚ï¼šABCABCABCâ€¦â€¦ ä¾æ¬¡é€’å½’ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091public class TestABCAlternate { public static void main(String[] args) { ABCAlternate alternate = new ABCAlternate(); new Thread(new Runnable() { @Override public void run() { for (int i = 0; i &lt; 10; i++) { alternate.printA(); } } },\"A\").start(); new Thread(new Runnable() { @Override public void run() { for (int i = 0; i &lt; 10; i++) { alternate.printB(); } } },\"B\").start(); new Thread(new Runnable() { @Override public void run() { for (int i = 0; i &lt; 10; i++) { alternate.printC(); } } },\"C\").start(); }}class ABCAlternate { private int num = 1; Lock lock = new ReentrantLock(); Condition con1 = lock.newCondition(); Condition con2 = lock.newCondition(); Condition con3 = lock.newCondition(); public void printA() { lock.lock(); try { if (num != 1) { try { con1.await(); } catch (InterruptedException e) { } } System.out.print(Thread.currentThread().getName()); num = 2; con2.signal(); } finally { lock.unlock(); } } public void printB() { lock.lock(); try { if (num != 2) { try { con2.await(); } catch (InterruptedException e) { } } System.out.print(Thread.currentThread().getName()); num = 3; con3.signal(); } finally { lock.unlock(); } } public void printC() { lock.lock(); try { if (num != 3) { try { con3.await(); } catch (InterruptedException e) { } } System.out.print(Thread.currentThread().getName()); num = 1; con1.signal(); } finally { lock.unlock(); } }} ReadWriteLock è¯»å†™é”ReadWriteLock ç»´æŠ¤äº†ä¸€å¯¹ç›¸å…³çš„é”ï¼Œä¸€ä¸ªç”¨äºåªè¯»æ“ä½œï¼Œå¦ä¸€ä¸ªç”¨äºå†™å…¥æ“ä½œã€‚åªè¦æ²¡æœ‰ writerï¼Œè¯»å–é”å¯ä»¥ç”±å¤šä¸ª reader çº¿ç¨‹åŒæ—¶ä¿æŒã€‚å†™å…¥é”æ˜¯ç‹¬å çš„ã€‚ ReadWriteLock è¯»å–æ“ä½œé€šå¸¸ä¸ä¼šæ”¹å˜å…±äº«èµ„æºï¼Œä½†æ‰§è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œå¿…é¡»ç‹¬å æ–¹å¼æ¥è·å–é”ã€‚å¯¹äºè¯»å–æ“ä½œå å¤šæ•°çš„æ•°æ®ç»“æ„ã€‚ ReadWriteLock èƒ½æä¾›æ¯”ç‹¬å é”æ›´é«˜çš„å¹¶å‘æ€§ã€‚è€Œå¯¹äºåªè¯»çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­åŒ…å«çš„ä¸å˜æ€§å¯ä»¥å®Œå…¨ä¸éœ€è¦è€ƒè™‘åŠ é”æ“ä½œ ç”¨ä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445public class TestReadWriterLock { public static void main(String[] args) { ReadWriterLock rwLock = new ReadWriterLock(); new Thread(new Runnable() { @Override public void run() { for (int i = 0; i &lt; 100; i++) { rwLock.read(); } } }, \"ReadLock:\").start(); new Thread(new Runnable() { @Override public void run() { rwLock.writer(233); } }, \"WriterLock:\").start(); }}class ReadWriterLock { private int resource; private ReadWriteLock rwLock = new ReentrantReadWriteLock(); public void read() { try { rwLock.readLock().lock(); System.out.println(Thread.currentThread().getName() + resource); } finally { rwLock.readLock().unlock(); } } public void writer(int n) { try { rwLock.writeLock().lock(); resource = n; System.out.println(Thread.currentThread().getName() + resource); } finally { rwLock.writeLock().unlock(); } }} è¿è¡Œç»“æœéƒ¨åˆ†æˆªå›¾ï¼š çº¿ç¨‹å…«é”çº¿ç¨‹å…«é”ï¼Œå®é™…ä¸Šæ˜¯å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ç»å¸¸é‡åˆ°çš„å…«ç§æƒ…å†µã€‚é€šè¿‡å…«ç§åœºæ™¯å­¦ä¹ æ€»ç»“çº¿ç¨‹é”çš„ç‰¹æ€§ã€‚ åœºæ™¯ä¸€ï¼šä¸¤ä¸ªæ™®é€šåŒæ­¥æ–¹æ³•ï¼Œä¸¤ä¸ªçº¿ç¨‹ï¼Œæ˜¯åŒä¸€æŠŠé”ï¼ˆthisé”ï¼‰ï¼Œå­˜åœ¨äº’æ–¥å…³ç³»ã€‚ 123456789101112131415161718192021222324252627282930public class TestThread8Monitor { public static void main(String[] args) { Number number = new Number(); new Thread(new Runnable() { @Override public void run() { number.one(); } }).start(); new Thread(new Runnable() { @Override public void run() { number.two(); } }).start(); }}class Number { public synchronized void one() { System.out.println(\"one\"); } public synchronized void two() { System.out.println(\"two\"); }} è¿è¡Œç»“æœï¼š one two åœºæ™¯äºŒï¼šè®©åŒæ­¥æ–¹æ³• one() ç¡3ç§’ï¼Œè§‚å¯Ÿç»“æœã€‚åŒä¸€æŠŠé”ï¼Œå­˜åœ¨äº’æ–¥å…³ç³»ï¼Œä¸€ä¸ªåŒæ­¥æ–¹æ³•æ²¡æœ‰é‡Šæ”¾é”å…¶ä»–æ‰€æœ‰åŒæ­¥æ–¹æ³•é˜»å¡ã€‚ public synchronized void one() { try { Thread.sleep(3000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(&quot;one&quot;); } è¿è¡Œç»“æœï¼š one two åœºæ™¯ä¸‰ï¼šæ–°å¢ä¸€ä¸ªåŒæ­¥æ–¹æ³• three()ï¼Œä¸‰ä¸ªåŒæ­¥æ–¹æ³•ï¼Œä¸‰ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œç«äº‰æ‰“å°ã€‚ public synchronized void one() { System.out.println(&quot;one&quot;); } public synchronized void two() { System.out.println(&quot;two&quot;); } public synchronized void three() { System.out.println(&quot;three&quot;); } è¿è¡Œç»“æœï¼š one three two åœºæ™¯å››ï¼šæ–°å¢ä¸€ä¸ª Number å¯¹è±¡ã€‚ä¸¤ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œä¸¤ä¸ªåŒæ­¥æ–¹æ³•ã€‚ä¸åŒé”ä¹‹é—´ï¼ˆä¸¤ä¸ªthisä¸æ˜¯åŒä¸€ä¸ªthisï¼‰çš„åŒæ­¥æ–¹æ³•ä¸å­˜åœ¨äº’æ–¥ã€‚ public static void main(String[] args) { Number number = new Number(); Number number2 = new Number(); new Thread(new Runnable() { @Override public void run() { number.one(); } }).start(); new Thread(new Runnable() { @Override public void run() { number2.two(); } }).start(); } ä¸¤ä¸ªåŒæ­¥æ–¹æ³•ï¼š public synchronized void one() { try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(&quot;one&quot;); } public synchronized void two() { System.out.println(&quot;two&quot;); } è¿è¡Œç»“æœï¼š two one åœºæ™¯äº”ï¼šåŒä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œä¸€ä¸ªé™æ€åŒæ­¥æ–¹æ³•ï¼Œä¸€ä¸ªéé™æ€åŒæ­¥æ–¹æ³•ã€‚ä¸åŒé”ä¹‹é—´çš„åŒæ­¥æ–¹æ³•ä¸å­˜åœ¨äº’æ–¥ã€‚ public static synchronized void one() { try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(&quot;one&quot;); } public synchronized void two() { System.out.println(&quot;two&quot;); } è¿è¡Œç»“æœï¼š two one åœºæ™¯å…­ï¼šåŒä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œä¸¤ä¸ªé™æ€åŒæ­¥æ–¹æ³•ï¼Œæ˜¯ç›¸åŒçš„é”ï¼ˆClassé”ï¼‰ï¼Œå­˜åœ¨äº’æ–¥ã€‚ public static synchronized void one() { try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(&quot;one&quot;); } public static synchronized void two() { System.out.println(&quot;two&quot;); } è¿è¡Œç»“æœï¼š one two åœºæ™¯ä¸ƒï¼šæ–°å¢ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ã€‚ä¸¤ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œä¸¤ä¸ªé™æ€åŒæ­¥æ–¹æ³•ã€‚åŒä¸€æŠŠé”å­˜åœ¨äº’æ–¥æ€§ã€‚ public static void main(String[] args) { Number number = new Number(); Number number2 = new Number(); new Thread(new Runnable() { @Override public void run() { number.one(); } }).start(); new Thread(new Runnable() { @Override public void run() { number2.two(); } }).start(); } é™æ€åŒæ­¥æ–¹æ³•ï¼š public static synchronized void one() { try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(&quot;one&quot;); } public static synchronized void two() { System.out.println(&quot;two&quot;); } è¿è¡Œç»“æœï¼š one two åœºæ™¯å…«ï¼šæ–°å¢ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ã€‚ä¸¤ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œä¸€ä¸ªé™æ€åŒæ­¥æ–¹æ³•ï¼Œä¸€ä¸ªéé™æ€åŒæ­¥æ–¹æ³•ã€‚éåŒä¸€æŠŠé”ä¸å­˜åœ¨ç«äº‰ public static synchronized void one() { try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(&quot;one&quot;); } public synchronized void two() { System.out.println(&quot;two&quot;); } è¿è¡Œç»“æœï¼š two one ç»“è®ºï¼š é™æ€åŒæ­¥æ–¹æ³•çš„é”æ˜¯ Class é”ï¼Œéé™æ€åŒæ­¥æ–¹æ³•çš„é”æ˜¯ this é”ï¼Œä¸åŒçš„å¯¹è±¡æ˜¯ä¸åŒçš„ this é”ã€‚ æŸä¸€ä¸ªæ—¶åˆ»å†…ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æŒæœ‰é”ï¼Œæ— è®ºå‡ ä¸ªæ–¹æ³•ã€‚ç›¸åŒçš„é”ï¼Œä¸€ä¸ªçº¿ç¨‹è·å¾—é”ï¼Œå…¶ä»–çº¿ç¨‹éƒ½å¾—ç­‰å¾…ã€‚ çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹çš„ç¬¬å››ç§æ–¹å¼ï¼Œçº¿ç¨‹æ± ï¼šæä¾›äº†ä¸€ä¸ªçº¿ç¨‹é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­ä¿å­˜ç€æ‰€æœ‰ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ã€‚é¿å…äº†åˆ›å»ºä¸é”€æ¯é¢å¤–å¼€é”€ï¼Œæé«˜äº†å“åº”çš„é€Ÿåº¦ã€‚ çº¿ç¨‹æ± çš„ä½“ç³»ç»“æ„ï¼š java.util.concurrent.Executor : è´Ÿè´£çº¿ç¨‹çš„ä½¿ç”¨ä¸è°ƒåº¦çš„æ ¹æ¥å£ |--**ExecutorService å­æ¥å£: çº¿ç¨‹æ± çš„ä¸»è¦æ¥å£ |--ThreadPoolExecutor çº¿ç¨‹æ± çš„å®ç°ç±» |--ScheduledExecutorService å­æ¥å£ï¼šè´Ÿè´£çº¿ç¨‹çš„è°ƒåº¦ |--ScheduledThreadPoolExecutor ï¼šç»§æ‰¿ThreadPoolExecutorï¼Œå®ç°ScheduledExecutorService ThreadPoolExecutorå’ŒScheduledThreadPoolExecutorå¯ä»¥åˆ›å»ºè¿æ¥æ± å¯¹è±¡ï¼Œä½†æ˜¯ä½¿ç”¨å·¥å‚è·å¾—å¯¹è±¡æ˜¯æœ€å¥½çš„æ–¹å¼ã€‚å·¥å…·ç±» Executors çš„å¸¸ç”¨APIåŠæè¿°ï¼š æ–¹æ³• æè¿° ExecutorService newFixedThreadPool() åˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹æ±  ExecutorService newCachedThreadPool() ç¼“å­˜çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± çš„æ•°é‡ä¸å›ºå®šï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚è‡ªåŠ¨çš„æ›´æ”¹æ•°é‡ï¼Œå¯ä»¥è‡ªåŠ¨è¿›è¡Œçº¿ç¨‹å›æ”¶ ExecutorService newSingleThreadExecutor() åˆ›å»ºå•ä¸ªçº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± ä¸­åªæœ‰ä¸€ä¸ªçº¿ç¨‹ ScheduledExecutorService newScheduledThreadPool() åˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹ï¼Œå¯ä»¥å»¶è¿Ÿæˆ–å®šæ—¶çš„æ‰§è¡Œä»»åŠ¡ ç”¨ä¾‹è¯´æ˜ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344public class TestThreadPool { public static void main(String[] args) throws Exception { //åˆ›å»ºçº¿ç¨‹æ±  ExecutorService pool = Executors.newFixedThreadPool(5); ThreadPoolDemo tpd = new ThreadPoolDemo(); //5ä¸ªçº¿ç¨‹æ‰§è¡Œ10ä¸ªä»»åŠ¡ï¼ŒæŸäº›çº¿ç¨‹ä¼šè¢«å›æ”¶ for (int i = 0; i &lt; 10; i++) { pool.submit(tpd); // å¯ä¼  Callable å’Œ Runnableæ¥å£ä½œä¸ºä»»åŠ¡å¯¹è±¡ } //å…³é—­çº¿ç¨‹æ±  pool.shutdown(); /** ä»¥ Callable ä½œä¸ºä»»åŠ¡ **/ List&lt;Future&lt;Integer&gt;&gt; list = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 10; i++) { Future&lt;Integer&gt; future = pool.submit(new Callable&lt;Integer&gt;() { @Override public Integer call() throws Exception { int sum = 0; for (int i = 0; i &lt;= 100; i++) { sum += i; } return sum; } }); list.add(future); } pool.shutdown(); for (Future&lt;Integer&gt; future : list) { System.out.println(future.get()); } }}class ThreadPoolDemo implements Runnable { private int i = 0; @Override public void run() { while (i &lt;= 100) { System.out.println(Thread.currentThread().getName() + \" : \" + i++); } }} çº¿ç¨‹è°ƒåº¦ä¸€ä¸ª ExecutorServiceï¼Œå¯å®‰æ’åœ¨ç»™å®šçš„å»¶è¿Ÿåè¿è¡Œæˆ–å®šæœŸæ‰§è¡Œçš„å‘½ä»¤ã€‚ 123456789101112131415161718192021222324public class TestScheduledThreadPool { public static void main(String[] args) throws ExecutionException, InterruptedException { // çº¿ç¨‹æ± çš„ä»»åŠ¡è°ƒåº¦ ScheduledExecutorService pool = Executors.newScheduledThreadPool(5); // åä¸ªä»»åŠ¡ for (int i = 0; i &lt; 5; i++) { /** * å‚æ•°ä¸€ï¼šä»»åŠ¡ * å‚æ•°äºŒï¼šå»¶è¿Ÿæ—¶é—´ * å‚æ•°ä¸€ï¼šæ—¶é—´å•ä½ */ ScheduledFuture&lt;Integer&gt; future = pool.schedule(new Callable&lt;Integer&gt;() { @Override public Integer call() throws Exception { int num = new Random().nextInt(100); return num; } }, 1, TimeUnit.SECONDS); System.out.println(future.get()); } // å…³é—­çº¿ç¨‹æ±  pool.shutdown(); }} ForkJoinPool åˆ†æ”¯/åˆå¹¶æ¡†æ¶ å·¥ä½œçªƒå–Fork/Join æ¡†æ¶ï¼šå°±æ˜¯åœ¨å¿…è¦çš„æƒ…å†µä¸‹ï¼Œå°†ä¸€ä¸ªå¤§ä»»åŠ¡ï¼Œè¿›è¡Œæ‹†åˆ†(fork)æˆè‹¥å¹²ä¸ªå°ä»»åŠ¡ï¼ˆæ‹†åˆ°ä¸å¯å†æ‹†æ—¶ï¼‰ï¼Œå†å°†ä¸€ä¸ªä¸ªçš„å°ä»»åŠ¡è¿ç®—çš„ç»“æœè¿›è¡Œ join æ±‡æ€»ã€‚ å‰é¢å­¦è¿‡ å½’å¹¶æ’åºï¼Œå®é™…ä¸Šè¿™ç§æ€æƒ³å’Œå½’å¹¶æ’åºæ˜¯ä¸€æ ·çš„ã€‚ é‡‡ç”¨ â€œå·¥ä½œçªƒå–â€æ¨¡å¼ï¼ˆwork-stealingï¼‰ï¼šå½“æ‰§è¡Œæ–°çš„ä»»åŠ¡æ—¶å®ƒå¯ä»¥å°†å…¶æ‹†åˆ†åˆ†æˆæ›´å°çš„ä»»åŠ¡æ‰§è¡Œï¼Œå¹¶å°†å°ä»»åŠ¡åŠ åˆ°çº¿ç¨‹é˜Ÿåˆ—ä¸­ï¼Œç„¶åå†ä»ä¸€ä¸ªéšæœºçº¿ç¨‹çš„é˜Ÿåˆ—ä¸­å·ä¸€ä¸ªå¹¶æŠŠå®ƒæ”¾åœ¨è‡ªå·±çš„é˜Ÿåˆ—ä¸­ã€‚ ç›¸å¯¹äºä¸€èˆ¬çš„çº¿ç¨‹æ± å®ç°ï¼Œfork/joinæ¡†æ¶çš„ä¼˜åŠ¿ä½“ç°åœ¨å¯¹å…¶ä¸­åŒ…å«çš„ä»»åŠ¡çš„å¤„ç†æ–¹å¼ä¸Š.åœ¨ä¸€èˆ¬çš„çº¿ç¨‹æ± ä¸­ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ç”±äºæŸäº›åŸå› æ— æ³•ç»§ç»­è¿è¡Œï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹ä¼šå¤„äºç­‰å¾…çŠ¶æ€ã€‚è€Œåœ¨fork/joinæ¡†æ¶å®ç°ä¸­ï¼Œå¦‚æœæŸä¸ªå­é—®é¢˜ç”±äºç­‰å¾…å¦å¤–ä¸€ä¸ªå­é—®é¢˜çš„å®Œæˆè€Œæ— æ³•ç»§ç»­è¿è¡Œã€‚é‚£ä¹ˆå¤„ç†è¯¥å­é—®é¢˜çš„çº¿ç¨‹ä¼šä¸»åŠ¨å¯»æ‰¾å…¶ä»–å°šæœªè¿è¡Œçš„å­é—®é¢˜æ¥æ‰§è¡Œ.è¿™ç§æ–¹å¼å‡å°‘äº†çº¿ç¨‹çš„ç­‰å¾…æ—¶é—´ï¼Œæé«˜äº†æ€§èƒ½ã€‚ æ¨¡æ‹Ÿæ‹†åˆ†ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748public class TestForkJoinPool { public static void main(String[] args) { // åˆ›å»ºfork/joinå¯¹è±¡ ForkJoinPool pool = new ForkJoinPool(); // åˆ›å»ºä»»åŠ¡å¯¹è±¡ ForkJoinTask&lt;Long&gt; task = new ForkJoinSumCalculate(0L, 100000000L); // æ‰§è¡Œä»»åŠ¡ Long sum = pool.invoke(task); System.out.println(sum); }}// åˆ›å»ºè‡ªå·±çš„fork/joinä»»åŠ¡ï¼Œè®¡ç®—ä»startå¼€å§‹endä¸ªæ•°çš„å’Œã€‚éœ€è¦ç»§æ‰¿é€’å½’ä»»åŠ¡ç±»ã€‚class ForkJoinSumCalculate extends RecursiveTask&lt;Long&gt; { private long start; private long end; /** * æ‹†åˆ†ä¸´ç•Œå€¼ï¼šå®šä¹‰å­ä»»åŠ¡ï¼ˆå­çº¿ç¨‹é˜Ÿåˆ—ï¼‰åˆ°å¤šå¤§æ—¶ä¸å†æ‹†åˆ†ï¼Œå¼€å§‹è®¡ç®—æ¯ä¸ªå­ä»»åŠ¡çš„å€¼ã€‚ * - å¦‚æœä¸´ç•Œå€¼ = ä»»åŠ¡æ€»å¤§å°ï¼Œå°±ä¸ä¼šæ‹†åˆ†ï¼Œç›´æ¥å¾ªç¯è®¡ç®—æ‰€æœ‰å€¼ã€‚ * - å¦‚æœä¸´ç•Œå€¼ = 1Lï¼Œå°±æ‹†åˆ°æ¯ä¸ªå­çº¿ç¨‹é˜Ÿåˆ—å¤§å°ä¸º1æ—¶åœæ­¢æ‹†åˆ† */ private static final long THURSHOLD = 10000L; public ForkJoinSumCalculate(long start, long end) { this.start = start; this.end = end; } @Override protected Long compute() { long len = end - start; if (len &lt;= THURSHOLD) { long sum = 0L; for (long i = start; i &lt;= end; i++) { sum += i; } return sum; } else { long mid = (end + start) / 2; ForkJoinSumCalculate left = new ForkJoinSumCalculate(start, mid); left.fork(); ForkJoinSumCalculate right = new ForkJoinSumCalculate(mid + 1, end); right.fork(); return left.join() + right.join(); } }}","link":"/2018/09/01/çº¿ç¨‹é«˜çº§/"},{"title":"åŸºäº Spring Boot æŠ€æœ¯æ ˆæ„å»ºä¼ä¸šçº§åšå®¢ç³»ç»Ÿçš„å¼€å‘è®°å½•","text":"åŸºäº Spring Boot æŠ€æœ¯æ ˆæ„å»ºä¼ä¸šçº§åšå®¢ç³»ç»Ÿçš„å¼€å‘è®°å½•- è¯¥é¡¹ç›®æ„å»ºåŸºäº Gradleï¼Œç›®çš„åœ¨äºé€šè¿‡åšå®¢ç³»ç»Ÿçš„å¼€å‘äº†è§£ä¼ä¸šçº§å¼€å‘çš„å®Œæ•´æµç¨‹ï¼Œå­¦ä¹ æŒæ¡ Spring Boot åŠå…¶å‘¨è¾¹å‰æ²¿æŠ€æœ¯ã€‚- previewï¼šhttp://blog.yuzh.xyz å‰ç«¯ BootStrap æ ·å¼æ¡†æ¶ Thymeleaf æ¨¡æ¿å¼•æ“ JQuery js å‡½æ•°åº“ HTML5 é¡µé¢ç»“æ„ JavaScript è„šæœ¬ CSS æ ·å¼ åç«¯ Spring è§£è€¦åˆ Spring MVC æ§åˆ¶å±‚æ¡†æ¶ Spring Boot å¿«æ·å¼€å‘ï¼Œæ•´åˆ Spring å…¨å®¶æ¡¶ Spring Data æŒä¹…å±‚æ¡†æ¶ï¼Œç®€åŒ–æ•°æ®åº“æ“ä½œ Spring Security å®‰å…¨æƒé™æ§åˆ¶ Hibernate éµå¾ª JPA è§„èŒƒçš„æŒä¹…å±‚å®ç° æ•°æ®å­˜å‚¨ MySql å…³ç³»å‹æ•°æ®åº“ H2 å†…å­˜æ•°æ®åº“ MongoDB æ–‡ä»¶å­˜å‚¨ å…¶ä»– Elastic Search å…¨æ–‡æ£€ç´¢ Gradle é¡¹ç›®æ„å»º æ’ä»¶ catalog-generator.js åšå®¢ç›®å½•ç”Ÿæˆæ’ä»¶ tether.js ä¸‹æ‹‰æ¡†æ’ä»¶ thinker-md.vendor.js markdown ç¼–è¾‘å™¨ toastr.min.js æç¤ºæ¡† cropbox.js å›¾ç‰‡è£å‰ª â€¦ â€¦ ä¸€ã€ ä½¿ç”¨ Gradle / Spring Initializer æ­å»º Spring Boot è¿è¡Œç¯å¢ƒ1.1 å®‰è£… Gradle ç¯å¢ƒä¸‹è½½ gradle äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè§£å‹åˆ°æŒ‡å®šç›®å½•ï¼› é…ç½® GRADLE_HOME ç¯å¢ƒå˜é‡ï¼Œå€¼ä¸ºè§£å‹è·¯å¾„ï¼› æ·»åŠ  %GRADLE_HOME%/bin åˆ° Path å˜é‡ã€‚ å‘½ä»¤è¡Œ gradle -v æŸ¥çœ‹ç‰ˆæœ¬ï¼š 1.2 ä½¿ç”¨ Spring Initializer å¿«é€Ÿç”Ÿæˆ Spring Boot åº”ç”¨ä½¿ç”¨ Spring å¿«é€Ÿå¼€å§‹å‘å¯¼ï¼Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®å¹¶ä¸‹è½½åˆ°æœ¬åœ°ã€‚ ä½¿ç”¨ gradle ç¼–è¯‘é¡¹ç›®ï¼Œè¿›å…¥æ ¹ç›®å½•æ‰§è¡Œï¼š 1gradle build ç¼–è¯‘å®Œæˆä¹‹åä¼šåœ¨ç›®å½•ç”Ÿæˆä¸€ä¸ª build æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾ç€ç¼–è¯‘åçš„æ–‡ä»¶ä»¥åŠå®‰è£…çš„jarã€‚ è¿è¡Œè¿™ä¸ª jar ï¼š 1java -jar spring-boot-blog-0.0.1-SNAPSHOT.jar ä¸€ä¸ªç®€å•çš„ spring boot åº”ç”¨å¯åŠ¨èµ·æ¥äº†ï¼Œæ¥ä¸‹æ¥å¯ä»¥æ­£å¸¸è®¿é—®ã€‚ 1.3 é¡¹ç›®ç»“æ„ .gradle gradle è¿è¡Œæ—¶ç›¸å…³é…ç½®æ–‡ä»¶ï¼Œä¸ç”¨å¤šè¯´äº†ã€‚ æ–‡ä»¶å¤¹ build é¡¹ç›®ç¼–è¯‘åè·¯å¾„ æ–‡ä»¶å¤¹ gradle æ–‡ä»¶å¤¹ wrapper ç»Ÿä¸€ç®¡ç† gradle ç‰ˆæœ¬ï¼Œä¼˜ç‚¹æ˜¯å³ä½¿æ²¡æœ‰è£… gradle ç¯å¢ƒå¯ä»¥è¿è¡Œé‡Œé¢çš„ jar ç›´æ¥æ„å»ºé¡¹ç›®ã€‚ build.gradle gradleçš„ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼ˆæ„å»ºè„šæœ¬ï¼‰ï¼Œç›¸å½“äº maven çš„ pom.xml. gradlew gradle ç¯å¢ƒæ­å»ºçš„è„šæœ¬ï¼ˆlinuxï¼‰ gradlew.bat gradle ç¯å¢ƒæ­å»ºçš„è„šæœ¬ï¼ˆwindowsï¼‰ settings.gradle å…¶ä»–ç”¨æˆ·é…ç½® 1.4 è‡ªå®šä¹‰å­˜å‚¨ä»“åº“æ›´æ”¹ build.gradle é…ç½®æ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556// buildscript ä»£ç å—ä¸­è„šæœ¬ä¼˜å…ˆæ‰§è¡Œbuildscript { // ext ç”¨äºå®šä¹‰åŠ¨æ€å±æ€§ ext { springBootVersion = '1.5.17.BUILD-SNAPSHOT' } // ä½¿ç”¨äº† Maven çš„ä¸­å¤®ä»“åº“ï¼ˆä¹Ÿå¯ä»¥æŒ‡å®šå…¶ä»–ä»“åº“ï¼‰ repositories { mavenCentral() maven { url \"https://repo.spring.io/snapshot\" } maven { url \"https://repo.spring.io/milestone\" } // ä½¿ç”¨ aliyun é•œåƒä»“åº“// maven { url 'http://maven.aliyun.com/nexus/content/groups/public/' } } // ä¾èµ–å…³ç³» dependencies { // classpath å£°æ˜è¯´æ˜äº†åœ¨æ‰§è¡Œå…¶ä½™çš„è„šæœ¬æ—¶ï¼ŒClassLoader å¯ä»¥ä½¿ç”¨è¿™äº›ä¾èµ–é¡¹ classpath(\"org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}\") }}// ä½¿ç”¨æ’ä»¶apply plugin: 'java'apply plugin: 'eclipse'apply plugin: 'org.springframework.boot'group = 'xyz.yuzh.spring.boot.blog'// æ‰“åŒ…çš„ç±»å‹ä¸º jarï¼Œå¹¶æŒ‡å®šäº†ç”Ÿæˆçš„æ‰“åŒ…çš„æ–‡ä»¶åç§°å’Œç‰ˆæœ¬jar { baseName = 'hello-world' version = '0.0.1-SNAPSHOT'}version = '0.0.1-SNAPSHOT'// æŒ‡å®šç¼–è¯‘ .java æ–‡ä»¶çš„ JDK ç‰ˆæœ¬sourceCompatibility = 1.8// é»˜è®¤ä½¿ç”¨äº† Maven çš„ä¸­å¤®ä»“åº“ã€‚repositories { mavenCentral() maven { url \"https://repo.spring.io/snapshot\" } maven { url \"https://repo.spring.io/milestone\" }// maven { url 'http://maven.aliyun.com/nexus/content/groups/public/' }}// ä¾èµ–å…³ç³»dependencies { // è¯¥ä¾èµ–å¯¹äºç¼–è¯‘å‘è¡Œæ˜¯å¿…é¡»çš„ compile('org.springframework.boot:spring-boot-starter-web') // è¯¥ä¾èµ–å¯¹äºç¼–è¯‘æµ‹è¯•æ˜¯å¿…é¡»çš„ï¼Œé»˜è®¤åŒ…å«ç¼–è¯‘äº§å“ä¾èµ–å’Œç¼–è¯‘æ—¶ä¾ testCompile('org.springframework.boot:spring-boot-starter-test')} 1.5 ç¼–å†™ç¨‹åºä»£ç åŠæµ‹è¯•ç”¨ä¾‹æ§åˆ¶å±‚ï¼š 1234567@RestControllerpublic class HelloController { @RequestMapping(value = \"/hello\") public String hello(){ return \"hello gradle!\"; }} ç”¨ä¾‹ä»£ç ï¼šä½¿ç”¨äº† Spring Mvc å•å…ƒæµ‹è¯•ç±» MockMVCï¼Œè¯¦è§£å‚è€ƒ 123456789101112131415161718@RunWith(SpringRunner.class)@SpringBootTest@AutoConfigureMockMvcpublic class SpringBootBlogApplicationTests { @Autowired private MockMvc mockMvc; @Test public void testHello() throws Exception { ResultActions actions = mockMvc.perform(MockMvcRequestBuilders.get(\"/hello\"). accept(MediaType.APPLICATION_JSON)); // æŒ‡å®šå®¢æˆ·ç«¯èƒ½å¤Ÿæ¥æ”¶çš„å†…å®¹ç±»å‹ actions.andExpect(status().isOk()); // æ·»åŠ æ–­è¨€, æ·»åŠ ResultMatcheréªŒè¯è§„åˆ™ï¼ŒéªŒè¯æ§åˆ¶å™¨æ‰§è¡Œå®Œæˆåç»“æœæ˜¯å¦æ­£ç¡®. actions.andExpect(content().string(equalTo(\"hello gradle!\"))); // æ·»åŠ æ–­è¨€,è¿”å›ç»“æœå†…å®¹æ˜¯å¦æ˜¯æŒ‡å®šçš„. actions.andDo(MockMvcResultHandlers.print()); // æ·»åŠ ä¸€ä¸ªç»“æœå¤„ç†å™¨ï¼Œè¾“å‡ºæ•´ä¸ªå“åº”ç»“æœä¿¡æ¯. actions.andReturn(); // æ‰§è¡Œå®Œæ¯•è¿”å›ç›¸åº”çš„ç»“æœ }} 1.6 ä»¥ Gradle / Wrapper ç¼–è¯‘é¡¹ç›®å½“æœ¬åœ°æ²¡æœ‰è£… gradle ç¯å¢ƒæ—¶ï¼Œå¯ä»¥é€šè¿‡ wrapper æ„å»ºé¡¹ç›®ï¼Œåªéœ€åœ¨æ ¹ç›®å½•æ‰§è¡Œå³å¯æ‰“åŒ…ï¼š 1gradlew build è¿è¡Œï¼š 1.7 Gradle é¡¹ç›®è¿è¡Œçš„ä¸‰ç§æ–¹å¼1). ä½¿ç”¨ java -jar 2). é€šè¿‡ SpringApplication.run() 3). ä½¿ç”¨ Spring Boot Gradle æ’ä»¶ 1gradle bootRun / gradlew bootRun (wrapper æ–¹å¼) äºŒã€ Thymeleaf æ¨¡æ¿å¼•æ“2.1 Thymeleafå®˜æ–¹æ–‡æ¡£ Java æ¨¡æ¿å¼•æ“ã€‚èƒ½å¤Ÿå¤„ç† Html / XML / JavaScript / CSS / ç”šè‡³çº¯æ–‡æœ¬ ã€‚ç±»ä¼¼äº JSP / FreeMarker è‡ªç„¶æ¨¡æ¿ã€‚åŸå‹å³é¡µé¢ è¯­æ³•ä¼˜é›…æ˜“æ‡‚ã€‚æ”¯æŒ OGNL / SpringEL éµä» Web æ ‡å‡†ã€‚æ”¯æŒ HTML5 2.2 æ ‡å‡†æ–¹è¨€ï¼ˆè¯­æ³•ï¼‰åç§°ç©ºé—´ &lt;span th:text=&quot;â€¦&quot;&gt; éœ€è¦å¼•å…¥å‘½åç©ºé—´: &lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt; æˆ– &lt;span data-th-text=&quot;â€¦&quot;&gt; ç¬¦åˆhtml5æ ‡å‡†ï¼Œä¸éœ€è¦å¼•å…¥å‘½åç©ºé—´ å˜é‡è¡¨è¾¾å¼ - ${â€¦} &lt;span th:text=&quot;${book.author.name}&quot;&gt; æ¶ˆæ¯è¡¨è¾¾å¼ï¼ˆi8n / å›½é™…åŒ–ï¼‰- #{â€¦} &lt;th th:text=&quot;#{header.address.city}&quot;&gt;â€¦&lt;/th&gt; &lt;th th:text=&quot;#{header.address.country}&quot;&gt;â€¦&lt;/th&gt; é€‰æ‹©è¡¨è¾¾å¼ - *{â€¦} &lt;div th:object=&quot;${book}&quot;&gt; ... &lt;span th:text=&quot;*{title}&quot;&gt;...&lt;/span&gt; ... &lt;/div&gt; ä¸å˜é‡è¡¨è¾¾å¼çš„åŒºåˆ«ï¼šå®ƒæ˜¯åœ¨å½“å‰é€‰æ‹©çš„å¯¹è±¡è€Œä¸æ˜¯æ•´ä¸ªä¸Šä¸‹æ–‡å˜é‡æ˜ å°„ä¸Šæ‰§è¡Œã€‚${book} å–çš„æ˜¯æ•´ä¸ªä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ï¼Œè€Œ *{title} æ˜¯åœ¨å½“å‰ ${book} é‡Œè¾¹çš„å˜é‡ã€‚å› æ­¤å˜é‡è¡¨è¾¾å¼ä¸€å®šç¨‹åº¦ä¸Šæé«˜äº†æ•ˆç‡ã€‚ é“¾æ¥è¡¨è¾¾å¼ - @{â€¦} é“¾æ¥è¡¨è¾¾å¼å¯ä»¥æ˜¯ç›¸å¯¹çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡å°†ä¸ä¼šä½œä¸º URL çš„å‰ç¼€ &lt;a th:href=&quot;@{../documents/report}&quot;&gt;â€¦&lt;/a&gt; ä¹Ÿå¯ä»¥æ˜¯æœåŠ¡å™¨ç›¸å¯¹çš„ï¼ŒåŒæ ·ä¹Ÿæ²¡æœ‰åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡å‰ç¼€ &lt;a th:href=&quot;@{~/contents/main}&quot;&gt;â€¦&lt;/a&gt; åè®®ç›¸å¯¹çš„ï¼ˆç±»ä¼¼ç»å¯¹ URLï¼Œä½†æµè§ˆå™¨å°†ä½¿ç”¨åœ¨æ˜¾ç¤ºçš„é¡µé¢ä¸­ä½¿ç”¨çš„ç›¸åŒçš„ HTTP æˆ– HTTPS åè®®ï¼‰ &lt;a th:href=&quot;@{//static.mycompany.com/res/initial}&quot;&gt;â€¦&lt;/a&gt; ä¹Ÿå¯ä»¥æ˜¯ç»å¯¹çš„ &lt;a th:href=&quot;@{http://static.mycompany.com/main}&quot;&gt;â€¦&lt;/a&gt; æ¨¡æ¿å¸ƒå±€ th:insert å°†å…¬å…±ç‰‡æ®µæ•´ä¸ªæ’å…¥åˆ°å£°æ˜å¼•å…¥çš„å…ƒç´ ä¸­ th:replace å°†å£°æ˜å¼•å…¥çš„å…ƒç´ æ›¿æ¢ä¸ºå…¬å…±ç‰‡æ®µ th:include å°†è¢«å¼•å…¥çš„ç‰‡æ®µçš„å†…å®¹åŒ…å«è¿›è¿™ä¸ªæ ‡ç­¾ &lt;footer th:fragment=&quot;copy&quot;&gt; &amp;copy; 2011 The Good Thymes Virtual Grocery &lt;/footer&gt; å¼•å…¥æ–¹å¼ &lt;div th:insert=&quot;footer :: copy&quot;&gt;&lt;/div&gt; &lt;div th:replace=&quot;footer :: copy&quot;&gt;&lt;/div&gt; &lt;div th:include=&quot;footer :: copy&quot;&gt;&lt;/div&gt; æ•ˆæœ &lt;div&gt; &lt;footer&gt; &amp;copy; 2011 The Good Thymes Virtual Grocery &lt;/footer&gt; &lt;/div&gt; &lt;footer&gt; &amp;copy; 2011 The Good Thymes Virtual Grocery &lt;/footer&gt; &lt;div&gt; &amp;copy; 2011 The Good Thymes Virtual Grocery &lt;/div&gt; ä¹Ÿå¯ä»¥ä½¿ç”¨æŒ‡å®šçš„ id æ¥æ›¿ä»£ th:fragment=&quot;copy&quot; å¼•ç”¨æ—¶æŒ‡å®š #id å­—é¢é‡ æ–‡æœ¬ &lt;span th:text=&quot;'web application'&quot;&gt; å•å¼•å·åŒ…è£¹ æ•°å­— &lt;span th:text=&quot;2015&quot;&gt; or &lt;span th:text=&quot;2980 + 3&quot;&gt; å¸ƒå°”ï¼š&lt;span th:if=&quot;${user.isAdmin()} == false&quot;&gt; or &lt;span th:if=&quot;${user.name} == null ç®—æœ¯æ“ä½œ (+ ã€-ã€*ã€/ã€%)ï¼š&lt;span th:with=&quot;isEven=(${prodStat.count} % 2 == 0)&quot;&gt; æ¯”è¾ƒå’Œç­‰ä»·ï¼š&gt; ã€&lt; ã€&gt;= ã€ &lt;= ï¼ˆgtã€ltã€geã€leï¼‰ ç­‰ä»·ï¼š == ã€ != (eqã€ne) æ¡ä»¶è¿ç®— &lt;span th:class=&quot;${row.even} ? â€˜even&apos; : â€˜odd&apos; &quot;&gt;&lt;/span&gt; æ— æ“ä½œ - __ &lt;span th:text=&quot;${user.name} ? : __&quot;&gt;no user authenticated&lt;/span&gt; ç”¨æˆ·åä¸å­˜åœ¨å–æ— æ“ä½œè¿ç®—ç¬¦ï¼Œä¿ç•™åŸå§‹æ–‡æœ¬å€¼ã€‚ è®¾ç½®å±æ€§å€¼ è®¾ç½®ä»»æ„å±æ€§å€¼ th:attr th:attr=&quot;action=@{/subsctibe}&quot; è®¾ç½®actionå±æ€§å€¼ è®¾ç½®æŒ‡å®šå±æ€§å€¼ï¼Œæ¯”å¦‚: th:action / th:value / th:text å›ºå®šå¸ƒå°”å±æ€§ï¼Œ th:checked=&quot;${user.active}&quot; å¦‚æœç»“æœä¸º true è®¾ç½®ä¸ºé€‰ä¸­çŠ¶æ€ è¿­ä»£å™¨ åŸºæœ¬è¿­ä»£ th:each &lt;li th:each=â€œbook : ${books}â€ th:text=â€œ${book.title}â€&gt;En las Orillas del Sar&lt;/li&gt; çŠ¶æ€å˜é‡ï¼šindexï¼ˆ0å¼€å§‹ï¼‰ã€countï¼ˆ1å¼€å§‹ï¼‰ã€sizeã€currentã€even/oddã€firstã€last æ¡ä»¶è¯­å¥ th:if / th:unless ï¼ˆæˆç«‹æ—¶ / ä¸æˆç«‹æ—¶ï¼‰ th:switch &lt;div th:switch=&quot;${user.role}&quot;&gt; &lt;p th:case=&quot;&apos;admin&apos;&quot;&gt;user is an administrator&lt;/p&gt; &lt;p th:case=&quot;${roles.manager}&quot;&gt;user is an manager&lt;/p&gt; &lt;p th:case=&quot;*&quot;&gt;user is some other thing&lt;/p&gt; &lt;/div&gt; æ³¨é‡Š 1). æ ‡å‡†çš„ html æ³¨é‡Š &lt;!-- --&gt; 2). thymeleaf è§£æå™¨æ³¨é‡Šå— &lt;!--/* */--&gt; åˆ é™¤ &lt;!--/* å’Œ */--&gt; ä¹‹é—´çš„æ‰€æœ‰å†…å®¹ &lt;!--/*--&gt; &lt;div&gt;you can see me only before thymeleaf processes me!&lt;/div&gt; &lt;!--*/--&gt; 3). åŸå‹æ³¨é‡Šå—ï¼šå½“æ¨¡æ¿é™æ€æ‰“å¼€æ—¶ï¼ˆæ¯”å¦‚åŸå‹è®¾è®¡ï¼‰ï¼ŒåŸå‹æ³¨é‡Šå—æ‰€æ³¨é‡Šçš„ä»£ç å°†è¢«æ³¨é‡Šï¼Œè€Œåœ¨æ¨¡æ¿æ‰§è¡Œæ—¶ï¼Œè¿™äº›æ³¨é‡Šçš„ä»£ç ï¼Œä¼šè¢«æ˜¾ç¤ºå‡ºæ¥ã€‚ åŸå‹è®¾è®¡ä»£ç ï¼š &lt;span&gt;hello&lt;/span&gt; &lt;!--/*/ &lt;div th:th:text=&quot;${...}&quot;&gt; ... &lt;/div&gt; /*/--&gt; &lt;span&gt;goodbye!&lt;/span&gt; æ¨¡æ¿æ¸²æŸ“æ‰§è¡Œåï¼š &lt;span&gt;hello&lt;/span&gt; &lt;div th:th:text=&quot;${...}&quot;&gt; ... &lt;/div&gt; &lt;span&gt;goodbye!&lt;/span&gt; å†…è”è¡¨è¾¾å¼ [[â€¦]] æˆ– [(â€¦)] åˆ†åˆ«å¯¹åº”äº th:textï¼ˆä¼šè½¬è¯‘ç‰¹æ®Šå­—ç¬¦ï¼‰ å’Œ th:utextï¼ˆä¸ä¼šè½¬è¯‘ç‰¹æ®Šå­—ç¬¦ï¼‰ ç¦ç”¨å†…è”ï¼šth:inline=&quot;none&quot; Javascript å†…è”ï¼šth:inline=&quot;JavaScript&quot; CSS å†…è”ï¼šth:inline=&quot;css&quot; 2.3 è¡¨è¾¾å¼åŸºæœ¬å¯¹è±¡#ctxï¼šä¸Šä¸‹æ–‡å¯¹è±¡ã€‚æ˜¯ org.thymeleaf.context.IContext æˆ–è€… org.thymeleaf.context.IWebContext çš„å®ç°ã€‚ #localeï¼š ç›´æ¥è®¿é—®ä¸ java.util.Locale å…³è”çš„å½“å‰çš„è¯·æ±‚ã€‚ ${#ctx.locale} ${#ctx.bariableNames} ${#ctx.request} ${#ctx.response} ${#ctx.session} ${#ctx.servletContext} ${#locale} Request/session ç­‰å±æ€§ paramï¼šç”¨äºæ£€ç´¢è¯·æ±‚å‚æ•° sessionï¼šç”¨äºæ£€ç´¢sessionå±æ€§ applicationï¼šç”¨äºæ£€ç´¢application/servletä¸Šä¸‹æ–‡å±æ€§ ${#param.foo} ${#param.size()} ${#param.isEmpty()} ${#param.containsKey(&apos;foo&apos;)} ${#session.foo} ${#session.size()} ${#session.isEmpty()} ${#session.containsKey(&apos;foo&apos;)} ${#application.foo} ${#application.size()} ${#application.isEmpty()} ${#application.containsKey(&apos;foo&apos;)} Webä¸Šä¸‹æ–‡å¯¹è±¡ #requestï¼šç›´æ¥è®¿é—®ä¸å½“å‰è¯·æ±‚å…³è”çš„ HttpServletRequest å¯¹è±¡ #sessionï¼šç›´æ¥è®¿é—®ä¸å½“å‰è¯·æ±‚å…³è”çš„ HttpSession å¯¹è±¡ #servletContextï¼šç›´æ¥è®¿é—®ä¸å½“å‰è¯·æ±‚å…³è”çš„ servletContext å¯¹è±¡ ${#request.getAttribute(&apos;foo&apos;)} ${#request.getParameter(&apos;foo&apos;)} ${#request.getContextPath()} ${#request.getRequestName())} ${#session.getAttribute(&apos;foo&apos;)} ${#session.id} ${#session.lastAccessedTime} ${#servletContext.getAttribute(&apos;foo&apos;)} ${#servletContext.contextPath} 2.4 é›†æˆ Spring Bootä¿®æ”¹ buid.gradleã€‚æ·»åŠ å¯¹ Thymeleaf çš„ä¾èµ–ï¼Œè‡ªå®šä¹‰ Thymeleaf å’Œ Thyme leaf Layout Dialect çš„ç‰ˆæœ¬ã€‚ 123456789101112131415161718buildscript { // ext ç”¨äºå®šä¹‰åŠ¨æ€å±æ€§ï¼ˆç»Ÿä¸€ç®¡ç†ç‰ˆæœ¬ï¼‰ ext { springBootVersion = '1.5.17.BUILD-SNAPSHOT' } // æŒ‡å®š Thymeleaf å’Œ Thymeleaf Layout Dialect çš„ç‰ˆæœ¬ ext['thymeleaf.version'] = '3.0.3.RELEASE' ext['thymeleaf-layout-dialect.version'] = '2.2.0' ......}......// ä¾èµ–å…³ç³»dependencies { ...... // æ·»åŠ  Thymeleaf ä¾èµ– testCompile('org.springframework.boot:spring-boot-starter-thymeleaf')} ä¿®æ”¹ Spring Boot çš„ application.propertiesï¼ˆæˆ– application.yml ï¼‰ 123456spring: thymeleaf: encoding: UTF-8 cache: false # ä½¿ç”¨ HTML5 æ ‡å‡† mode: HTML5 2.5 Thymeleaf å®æˆ˜æ¥å£è®¾è®¡ æ¥å£ æè¿° GET /users è¿”å›ç”¨äºå±•ç¤ºç”¨æˆ·åˆ—è¡¨çš„ list.html GET /users/{id} è¿”å›ç”¨äºå±•ç¤ºç”¨æˆ·çš„ view.html GET /users/form è¿”å›ç”¨äºæ–°å¢æˆ–è€…ä¿®æ”¹ç”¨æˆ·çš„ form.html POST /users æ–°å¢æˆ–ä¿®æ”¹ç”¨æˆ·ï¼ŒæˆåŠŸåé‡å®šå‘åˆ° list.html GET /users/delete/{id} æ ¹æ® id åˆ é™¤ç›¸åº”çš„ç”¨æˆ·æ•°æ®ï¼ŒæˆåŠŸåé‡å®šå‘åˆ° list.html GET /users/modify/{id} æ ¹æ® id è·å–ç›¸åº”çš„ç”¨æˆ·æ•°æ®ï¼Œå¹¶è¿”å› form.html ç”¨æ¥æ‰§è¡Œä¿®æ”¹ åå°ç¼–ç  1234567891011121314151617181920212223242526272829303132333435363738@Repositorypublic class UserRepositoryImpl implements UserRepository { /** * ç´¯åŠ å™¨ */ private static AtomicLong counter = new AtomicLong(); /** * æš‚å­˜æ•°æ® */ ConcurrentMap&lt;Long, User&gt; userMap = new ConcurrentHashMap&lt;&gt;(); @Override public User saveOrUpdateUser(User user) { Long id = user.getId(); if (id &lt;= 0) { id = counter.incrementAndGet(); user.setId(id); } userMap.put(id, user); return null; } @Override public void deleteUser(Long id) { userMap.remove(id); } @Override public User getUserById(Long id) { return userMap.get(id); } @Override public List&lt;User&gt; listUser() { return new ArrayList&lt;&gt;(userMap.values()); }} 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475@RestController@RequestMapping(value = \"/users\")public class UserController { @Autowired private UserRepository userRepository; public List&lt;User&gt; getUserList() { return userRepository.listUser(); } /** * æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· [ GET /users ] * */ @GetMapping public ModelAndView list(ModelMap map) { map.addAttribute(\"users\", getUserList()); map.addAttribute(\"title\", \"ç”¨æˆ·ç®¡ç†\"); return new ModelAndView(\"users/list\", \"userModel\", map); } /** * æ ¹æ® id æŸ¥è¯¢ç”¨æˆ· [ GET /users/{id} ] */ @GetMapping(value = \"/{id}\") public ModelAndView getUserById(@PathVariable(\"id\") Long id, ModelMap map) { User user = userRepository.getUserById(id); System.out.println(user); map.addAttribute(\"user\", user); map.addAttribute(\"title\", \"æŸ¥çœ‹ç”¨æˆ·\"); return new ModelAndView(\"users/view\", \"userModel\", map); } /** * è·³è½¬åˆ°æ–°å»ºç”¨æˆ· [ GET /users/form ] */ @GetMapping(value = \"/form\") public ModelAndView createForm(ModelMap map) { map.addAttribute(\"user\", new User()); map.addAttribute(\"title\", \"åˆ›å»ºç”¨æˆ·\"); return new ModelAndView(\"users/form\", \"userModel\", map); } /** * æ–°å»ºåŠä¿®æ”¹ [ POST /users ] */ @PostMapping public ModelAndView create(User user) { userRepository.saveOrUpdateUser(user); return new ModelAndView(\"redirect:/users\"); } /** * åˆ é™¤ç”¨æˆ· [ GET /users/delete/{id} ] */ @GetMapping(value = \"delete/{id}\") public ModelAndView delete(@PathVariable(\"id\") Long id, ModelMap map) { userRepository.deleteUser(id); map.addAttribute(\"users\", getUserList()); return new ModelAndView(\"redirect:/users\"); } /** * è·³è½¬ä¿®æ”¹é¡µé¢ [ GET /users/modify/{id} ] */ @GetMapping(value = \"modify/{id}\") public ModelAndView update(@PathVariable(\"id\") Long id, ModelMap map) { User user = userRepository.getUserById(id); map.addAttribute(\"user\", user); map.addAttribute(\"title\", \"ä¿®æ”¹ç”¨æˆ·\"); return new ModelAndView(\"users/form\", \"userModel\", map); }} å‰å°è®¾è®¡ fragment/header.htmlï¼šå…±ç”¨çš„å¤´éƒ¨é¡µé¢ 1234567891011121314&lt;!DOCTYPE html&gt;&lt;html lang=\"en\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:layout=\"http://www.ultraq.net.nz/thymeleaf/layout\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Thymeleaf in action&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div th:fragment=\"header\"&gt; &lt;h1&gt;Thymeleaf in action&lt;/h1&gt; &lt;a th:href=\"@{~/users}\"&gt;é¦–é¡µ&lt;/a&gt; &lt;a th:href=\"@{~/users/form}\"&gt;æ–°å¢&lt;/a&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; fragment/footer.htmlï¼šå…±ç”¨çš„åº•éƒ¨é¡µé¢ 123&lt;div th:fragment=\"footer\"&gt; &lt;a th:href=\"@{http://blog.yuzh.xyz}\"&gt;welcome to blog.yuzh.xyz&lt;/a&gt;&lt;/div&gt; users/form.html æ–°å¢/ä¿®æ”¹ 12345678910111213141516171819&lt;!DOCTYPE html&gt;&lt;html lang=\"en\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:layout=\"http://www.ultraq.net.nz/thymeleaf/layout\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Thymeleaf in action&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div th:replace=\"~{fragments/header::header}\"&gt;&lt;/div&gt;&lt;h3 th:text=\"${userModel.title}\"&gt;&lt;/h3&gt;&lt;form th:action=\"@{~/users}\" method=\"post\"&gt; &lt;input type=\"text\" name=\"name\" th:value=\"${userModel!=null}?${userModel.user.name}\" placeholder=\"name\"&gt; &lt;input type=\"email\" name=\"email\" th:value=\"${userModel!=null}?${userModel.user.email}\" placeholder=\"email\"&gt; &lt;input type=\"text\" name=\"age\" th:value=\"${userModel!=null}?${userModel.user.age}\" placeholder=\"age\"&gt; &lt;input type=\"submit\" th:value=\"${userModel.title=='åˆ›å»ºç”¨æˆ·'} ? 'register' : 'modify'\"&gt; &lt;input type=\"hidden\" name=\"id\" th:if=\"${userModel.title=='ä¿®æ”¹ç”¨æˆ·'}\" th:value=\"${userModel.user.id}\"&gt;&lt;/form&gt;&lt;div th:replace=\"~{fragments/footer::footer}\"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; users/list.html åˆ—è¡¨å±•ç¤º 1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html lang=\"en\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:layout=\"http://www.ultraq.net.nz/thymeleaf/layout\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Thymeleaf in action&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div th:replace=\"~{fragments/header :: header}\"&gt;&lt;/div&gt;&lt;h3 th:text=\"${userModel!=null}?${userModel.title}\"&gt;yuzh&lt;/h3&gt;&lt;table border=\"1\"&gt; &lt;thead&gt; &lt;tr&gt; &lt;th&gt;ID&lt;/th&gt; &lt;th&gt;Email&lt;/th&gt; &lt;th&gt;Name&lt;/th&gt; &lt;th&gt;Age&lt;/th&gt; &lt;th&gt;æ“ä½œ&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &lt;tr th:if=\"${userModel.users.size()}==0\"&gt; &lt;td colspan=\"5\"&gt;æ²¡æœ‰ç”¨æˆ·ä¿¡æ¯ï¼&lt;/td&gt; &lt;/tr&gt; &lt;tr th:each=\"user:${userModel.users}\"&gt; &lt;td th:text=\"${user.id}\"&gt;&lt;/td&gt; &lt;td th:text=\"${user.email}\"&gt;&lt;/td&gt; &lt;td th:text=\"${user.name}\"&gt;&lt;/td&gt; &lt;td th:text=\"${user.age}\"&gt;&lt;/td&gt; &lt;td&gt; &lt;a href=\"\" th:href=\"@{~/users/}+${user.id}\"&gt;ä¿®æ”¹&lt;/a&gt; &lt;a href=\"\" th:href=\"@{~/users/delete/}+${user.id}\"&gt;åˆ é™¤&lt;/a&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt;&lt;/table&gt;&lt;div th:replace=\"~{fragments/footer::footer}\"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; users/view æŸ¥çœ‹ç”¨æˆ· 1234567891011121314151617&lt;!DOCTYPE html&gt;&lt;html lang=\"en\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:layout=\"http://www.ultraq.net.nz/thymeleaf/layout\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Thymeleaf in action&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div th:replace=\"~{fragments/header :: header}\"&gt;&lt;/div&gt;&lt;h3&gt;[[${userModel.title}]]&lt;/h3&gt;&lt;a th:href=\"@{~/users/modify/}+${userModel.user.id}\"&gt;ä¿®æ”¹ä¿¡æ¯&lt;/a&gt;&lt;p&gt;IDï¼š[[${userModel.user.id}]]&lt;/p&gt;&lt;p&gt;Nameï¼š[[${userModel.user.name}]]&lt;/p&gt;&lt;p&gt;Emailï¼š[[${userModel.user.email}]]&lt;/p&gt;&lt;p&gt;Ageï¼š[[${userModel.user.age}]]&lt;/p&gt;&lt;div th:replace=\"~{fragments/footer :: footer}\"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸‰ã€ Spring Data JPA æ•°æ®æŒä¹…åŒ–3.1 JPA ç®€ä»‹JPA (Java Persistence API) æ˜¯ç”¨äºç®¡ç† JavaEE å’Œ JavaSEç¯å¢ƒä¸­çš„æŒä¹…åŒ–ï¼Œä»¥åŠå¯¹è±¡/å…³ç³»æ˜ å°„çš„ Java APIã€‚ JPA æ˜¯ç”¨äºå¤„ç†æ•°æ®æŒä¹…åŒ–çš„æ¥å£ï¼ˆè§„èŒƒï¼‰ï¼ŒåŸºäº JPA è§„èŒƒçš„å®ç°æœ‰ EclipiseLinkã€Hibernateã€Apache OpenJPA 3.2 JPA æ ¸å¿ƒæ¦‚å¿µç†è§£ jpa çš„æ ¸å¿ƒæ¦‚å¿µï¼Œæ‰èƒ½æ›´å¥½çš„ä½¿ç”¨ jpa æŒä¹…åŒ–ã€‚æ²¡æœ‰ç¬¦åˆä»»æ„ä¸€é¡¹éƒ½ä¸èƒ½æˆåŠŸå®ŒæˆæŒä¹…åŒ–ï¼ å®ä½“ å®ä½“è¡¨ç¤ºå…³ç³»å‹æ•°æ®åº“ä¸­è¡¨ æ¯ä¸ªå®ä½“å®ä¾‹å¯¹åº”äºè¡¨ä¸­çš„è¡Œ ç±»å¿…é¡»ä½¿ç”¨ javax.persistence.Entity æ³¨è§£ ç±»å¿…é¡»æœ‰ä¸€ä¸ª public æˆ– protected çš„æ— å‚æ•°æ„é€ å™¨ å®ä½“å®ä¾‹è¢«å½“ä½œä»¥åˆ†ç¦»å¯¹è±¡æ–¹å¼è¿›è¡Œä¼ é€’ï¼ˆä¾‹å¦‚é€šè¿‡ä¼šè¯ bean çš„è¿œç¨‹ä¸šåŠ¡æ¥å£ï¼‰ï¼Œåˆ™è¯¥ç±»å¿…é¡»å®ç° Serializable æ¥å£ å¿…é¡»è¦æœ‰å”¯ä¸€çš„å¯¹è±¡æ ‡è¯†ç¬¦ï¼šç®€å•ä¸»é”®ï¼ˆjavax.persistence.Idï¼‰ã€å¤åˆä¸»é”®ï¼ˆjavax.persistence.Embeddedld å’Œ javax.persistence.IdClassï¼‰ å…³ç³» ä¸€å¯¹ä¸€ï¼š@OneToOne ä¸€å¯¹å¤šï¼š@OneToMany å¤šå¯¹ä¸€ï¼š@ManyToOne å¤šå¯¹å¤šï¼š@ManyToMany EntityManager (ç®¡ç†å®ä½“çš„æ¥å£ ç®¡ç†å®ä½“çš„æ¥å£ å®šä¹‰ç”¨äºä¸æŒä¹…åŒ–ä¸Šä¸‹æ–‡è¿›è¡Œäº¤äº’çš„æ–¹æ³• åˆ›å»ºå’Œåˆ é™¤æŒä¹…å®ä½“å®ä¾‹ï¼Œé€šè¿‡å®ä½“çš„ä¸»é”®æŸ¥æ‰¾å®ä½“ å…è®¸åœ¨å®ä½“ä¸Šè¿è¡ŒæŸ¥è¯¢ è·å– EntityManager å®ä¾‹ 12345678910111213141516@PersistenceUnit EntityManagerFactory emf; // ç”¨äºåˆ›å»º EntityManager çš„å·¥å‚ç±»EntityManager em;@ResourceUserTransaction utx; // äº‹åŠ¡...em = emf.createEmtityManager(); // åˆ›å»º EntityManager try{ utx.begin(); // äº‹åŠ¡å¼€å§‹ em.persist(SomeEntity); // é€šè¿‡å®ä½“ç®¡ç†å™¨æŒä¹…åŒ–ä¸€ä¸ªå®ä½“å¯¹è±¡ em.merge(AnotherEntity); // é€šè¿‡å®ä½“ç®¡ç†å™¨åˆå¹¶ä¸€ä¸ªå®ä½“å¯¹è±¡ em.remove(ThirdEntity); // é€šè¿‡å®ä½“ç®¡ç†å™¨ç§»é™¤ä¸€ä¸ªå®ä½“å¯¹è±¡ utx.commit(); // äº‹åŠ¡æäº¤} catch (Exception e){ utx.rollback(); // å›æ»š} æŸ¥æ‰¾å®ä½“ 1234567@PersistenceContextEntityManager em;public void enterOrder(int custID, CustomerOrder newOrder){ Customer cust = em.find(Customer.class, custID); // é€šè¿‡å®ä½“ç®¡ç†å™¨æŸ¥æ‰¾æŒ‡å®šç±»å‹çš„å®ä½“ cust.getOrders().add(newOrder); newOrder.setCustomer(cust);} 3.3 Spring Data JPA ä½¿ç”¨æ¦‚æ‹¬ä»€ä¹ˆæ˜¯ Spring Data JPAï¼š Spring Data å®¶æ—çš„ä¸€éƒ¨åˆ† å¯¹åŸºäº JPA çš„æ•°æ®è®¿é—®å±‚çš„å¢å¼ºæ”¯æŒ æ›´å®¹æ˜“æ„å»ºåŸºäºä½¿ç”¨ Spring çš„æ•°æ®è®¿é—®æŠ€æœ¯æ ˆçš„åº”ç”¨ç¨‹åº å¸¸ç”¨æ¥å£ï¼š CrudRepository å®šä¹‰äº†ä¸€äº›å¢åˆ æ”¹æŸ¥çš„é€šç”¨æ¥å£ PagingAndSortingRepository ç”¨äºåˆ†é¡µå’Œæ’åºçš„æ¥å£ï¼Œæ‰©å±•äº CrudRepository è‡ªå®šä¹‰æ¥å£ï¼šç»§æ‰¿ Repository åŠå­ç±» 3.4. Spring Data JPA / Hibernate / Spring Boot é›†æˆä¿®æ”¹ build.gradle 12345678910111213141516171819buildscript { ...... // è‡ªå®šä¹‰ Hibernate çš„ç‰ˆæœ¬ ext['hibernate.version'] = '5.2.8.Final' ......}// ä¾èµ–å…³ç³»dependencies { ...... // æ·»åŠ  Spring Data JPA çš„ä¾èµ– compile('org.springframework.boot:spring-boot-starter-data-jpa') // æ·»åŠ  MySQLè¿æ¥é©±åŠ¨ çš„ä¾èµ– compile('mysql:mysql-connector-java:6.0.5') // æ·»åŠ  H2 çš„ä¾èµ– å†…å­˜æ•°æ®åº“ runtime('com.h2database:h2:1.4.193') ......} 3.5 æ•°æ®æŒä¹…åŒ–å®æˆ˜3.5.1 H2 å†…å­˜æ•°æ®åº“åå°ç¼–ç  å®ä½“ User èµ„æºåº“ UserRepository æ§åˆ¶å™¨ UserController ä¿®æ”¹å®ä½“ï¼šå®ç° Serializable æ¥å£ã€æ·»åŠ  @Entity ã€è®¾ç½®ä¸»é”® @Id å’Œè‡ªå¢ç­–ç•¥ @GeneratedValue 123456789101112131415161718192021222324252627282930@Entity // å®ä½“public class User implements Serializable { @Id // ä¸»é”® @GeneratedValue(strategy = GenerationType.IDENTITY) // è‡ªå¢ç­–ç•¥ private long id; private String name; private String email; private int age; protected User() { // JPA çš„è§„èŒƒè¦æ±‚æ— å‚æ„é€ å‡½æ•°ï¼›è®¾ä¸º protected é˜²æ­¢ç›´æ¥ä½¿ç”¨ } public User(long id, String name, String email, int age) { this.id = id; this.name = name; this.email = email; this.age = age; } @Override public String toString() { return \"User{\" + \"id=\" + id + \", name='\" + name + '\\'' + \", email='\" + email + '\\'' + \", age=\" + age + '}'; }} ä¿®æ”¹èµ„æºåº“ï¼šåˆ é™¤è‡ªå·±çš„å®ç°ã€ç»§æ‰¿ JPA çš„ @Repository æ¥å£ 1234567/** * @author yu.zh [yuzh233@gmail.com] 2018/09/25 21:57 * &lt;p&gt; * CrudRepository æä¾›äº†å¸¸ç”¨æ¥å£ï¼Œè‡ªå·±æ— éœ€ç¼–å†™æ¥å£ã€‚ */public interface UserRepository extends CrudRepository&lt;User, Long&gt; {} ä¿®æ”¹æ§åˆ¶å™¨ï¼šå°†è‡ªå·±çš„å®ç°æ–¹æ³•çš„è°ƒç”¨æ”¹ä¸º JPA çš„å¸¸ç”¨ apiï¼Œå¦‚ï¼šfindAll() / findOne(id) / save(user) / delete(id) è®¿é—®ä¸éªŒè¯æ•°æ® èƒ½æ­£å¸¸è®¿é—®ä¸æ“ä½œï¼Œæ•°æ®å­˜å‚¨åœ¨äº† å†…å­˜æ•°æ®åº“ H2 ,ä½¿ç”¨ h2 çš„ æ§åˆ¶å° è®¿é—®æ•°æ®ã€‚ è®¾ç½®æ˜¾ç¤º h2 æ§åˆ¶å°ï¼š 123spring: # ä½¿ç”¨ H2 æ§åˆ¶å° h2.console.enabled: true è®¿é—®æ§åˆ¶å°ï¼š http://localhost:8080/h2-console/ æ³¨æ„ï¼šJDBC URL éœ€è¦æ‰‹åŠ¨æ›´æ”¹ä¸º jdbc:h2:mem:testdb æ‰èƒ½æ­£å¸¸è®¿é—®ï¼Œå¦åˆ™çœ‹ä¸åˆ°ä¿å­˜çš„è¡¨ã€‚æ¥ç€ç‚¹å‡» connect å¯ä»¥çœ‹åˆ° JPA åœ¨å†…å­˜å‹æ•°æ®ä¸­è‡ªåŠ¨ä¿å­˜äº†ä¸€å¼  USER è¡¨ï¼Œå°±æ˜¯ User å®ä½“æ‰€æ˜ å°„çš„è¡¨ï¼Œå¹¶ä¸”æ ¹æ®ä¸»é”®å…³ç³»ä¸å®ä½“å±æ€§æ˜ å°„äº†æ·»åŠ çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ä½¿ç”¨å…³ç³»å‹æ•°æ®åº“ä¸€æ ·çš„æ–¹å¼å¯¹å†…å­˜å‹æ•°æ®åº“æ‰§è¡Œ SQL æ“ä½œã€‚ 3.5.2 MySql ç‰©ç†æ•°æ®åº“ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š 1234567891011121314151617181920212223spring: # æ¨¡æ¿å¼•æ“ thymeleaf: encoding: UTF-8 cache: false mode: HTML5 # ä½¿ç”¨ H2 æ§åˆ¶å° h2.console.enabled: true # æ•°æ®æº datasource: url: jdbc:mysql://localhost/blog?characterEncoding=utf-8&amp;useSSL=false&amp;serverTimezone=UTC username: root password: admin driver-class-name: com.mysql.cj.jdbc.Driver # JPA jpa: show-sql: true hibernate: # æ¯æ¬¡å¯åŠ¨éƒ½ä¼šåˆ é™¤ä¹‹å‰çš„è¡¨ç»“æ„å’Œæ•°æ®å¹¶é‡æ–°ç”Ÿæˆæ–°çš„è¡¨ç»“æ„ ddl-auto: create-drop å¯åŠ¨é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ° hibernate è‡ªåŠ¨åˆ›å»ºäº†è¡¨ç»“æ„ï¼Œå­—æ®µå’Œå®ä½“å±æ€§ä¸€ä¸€å¯¹åº”ã€‚ æµè§ˆå™¨å­˜å…¥äº†ä¸¤æ¡æ•°æ®ä¹‹åï¼ŒæŸ¥çœ‹æ•°æ®åº“ï¼š æ•°æ®æˆåŠŸå­˜å…¥ï¼Œå¹¶ä¸” h2 æ•°æ®åº“æ²¡æœ‰å­˜å…¥ï¼Œè¯´æ˜æŒ‡å®šäº† mysql ä½œä¸ºæ•°æ®æºï¼Œ h2 çš„é…ç½®å¯æœ‰å¯æ— äº†ã€‚ åœ¨å®é™…åœºæ™¯ä¸­ä½¿ç”¨ MySql è¿™ç§å¤§å‹æ•°æ®åº“ï¼Œåœ¨å¼€å‘æµ‹è¯•è¿‡ç¨‹ä¸­å»ºè®®ä½¿ç”¨ H2 è¿™ç§å†…å­˜æ•°æ®åº“ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚ å››ã€Elastic Search å…¨æ–‡æœç´¢æ¦‚å¿µï¼šå…¨æ–‡æœç´¢æ˜¯ä¸€ç§å°†æ–‡ä»¶ä¸­æ‰€æœ‰æ–‡æœ¬ä¸æœç´¢é¡¹åŒ¹é…çš„æ–‡å­—èµ„æ–™æ£€ç´¢æ–¹æ³• å®ç°åŸç†ï¼š å»ºç«‹æ–‡æœ¬åº“ï¼šæœç´¢çš„æ•°æ®æº å»ºç«‹ç´¢å¼•ï¼šæå–è§„å¾‹ï¼Œä»¥ä¾¿å¿«é€ŸæŸ¥æ‰¾ã€‚ æ‰§è¡Œæœç´¢ï¼šç”¨æˆ·è¯·æ±‚ è¿‡æ»¤ç»“æœï¼šå¯¹æœç´¢ç»“æœå¤„ç† Elastic Search æ˜¯ä»€ä¹ˆï¼š é«˜åº¦å¯æ‰©å±•çš„å¼€æºå…¨æ–‡æœç´¢å’Œåˆ†æå¼•æ“ å¿«é€Ÿã€è¿‘å®æ—¶åœ°å¯¹å¤§æ•°æ®è¿›è¡Œå­˜å‚¨ã€æœç´¢å’Œåˆ†æ ç”¨æ¥æ”¯æŒåˆå¤æ‚çš„æ•°æ®æœç´¢éœ€æ±‚çš„ä¼ä¸šçº§åº”ç”¨ Elastic Search ç‰¹ç‚¹ï¼š åˆ†å¸ƒå¼ é«˜å¯ç”¨ å¤š API é¢å‘æ–‡æ¡£ å¼‚æ­¥å†™å…¥ è¿‘å®æ—¶ åŸºäº Lucene æœç´¢å¼•æ“ éµå¾ª Apache åè®® Elastic Search æ ¸å¿ƒæ¦‚å¿µï¼š è¿‘å®æ—¶ï¼šæ ¹æ®åˆ·æ–°ç­–ç•¥å®šæœŸåˆ·æ–°ç´¢å¼•åˆ°ç´¢å¼•åº“ï¼Œåœ¨å­˜å…¥ç´¢å¼•åº“å’Œè¯»å–ç´¢å¼•åº“æ•°æ®æ•ˆç‡ä¹‹é—´æŠ˜ä¸­ã€‚ é›†ç¾¤ï¼šä¸€ä¸ªæˆ–å¤šä¸ªçš„èŠ‚ç‚¹çš„é›†åˆï¼Œç”¨äºä¿å­˜åº”ç”¨çš„å…¨éƒ¨æ•°æ®å¹¶æä¾›åŸºäºå…¨éƒ¨èŠ‚ç‚¹çš„é›†æˆå¼æœç´¢åŠŸèƒ½ã€‚ èŠ‚ç‚¹ï¼šé›†ç¾¤ä¸­çš„å•å°æœåŠ¡å™¨ï¼Œç”¨æ¥ä¿å­˜æ•°æ®å¹¶å‚ä¸é›†ç¾¤ä¿å­˜å’Œæœç´¢æ•°æ®çš„æ“ä½œã€‚ ç´¢å¼•ï¼šç”¨äºåŠ å¿«æœç´¢é€Ÿåº¦ï¼Œåœ¨ ES ä¸­ï¼Œç´¢å¼•æ˜¯ç›¸ä¼¼æ–‡æ¡£çš„é›†åˆã€‚ ç±»å‹ï¼šå¯¹ç´¢å¼•ä¸­åŒ…å«æ–‡æ¡£çš„ç»†åˆ†ï¼ŒåŒºåˆ†ä¸åŒç±»å‹çš„ç´¢å¼•ã€‚ æ–‡æ¡£ï¼šè¿›è¡Œç´¢å¼•çš„åŸºæœ¬å•ä½ï¼Œä¸ç´¢å¼•ä¸­çš„ç±»å‹æ˜¯ç›¸å¯¹åº”çš„ã€‚æ¯ä¸€ä¸ªå…·ä½“çš„ç´¢å¼•æœ‰ä¸€ä¸ªæ–‡æ¡£ä¸ä¹‹å¯¹åº”ï¼Œä½¿ç”¨ json æ ¼å¼è¡¨ç¤ºã€‚æ–‡æ¡£çš„å®ä¾‹å°±æ˜¯å¯¹åº”å…³ç³»å‹æ•°æ®ä¸­çš„å®ä½“ï¼ˆå…·ä½“çš„æ•°æ®ï¼‰ã€‚ åˆ†ç‰‡ï¼šå½“ç´¢å¼•è¶…å‡ºå•ä¸ªèŠ‚ç‚¹æ‰€èƒ½æ‰¿å—çš„èŒƒå›´ï¼Œå¯ä»¥ä½¿ç”¨åˆ†ç‰‡æ¥å­˜å‚¨ç´¢å¼•çš„éƒ¨åˆ†æ•°æ®ï¼ŒES ä¼šè‡ªåŠ¨å¤„ç†ç´¢å¼•çš„åˆ†ç‰‡ä¸èšåˆã€‚ å‰¯æœ¬ï¼šåˆ†ç‰‡çš„å‰¯æœ¬ï¼Œæœ‰åˆ©äºæé«˜æœç´¢æ•ˆç‡å’Œååé‡ã€‚é»˜è®¤ ES ä¸ºæ¯ä¸ªç´¢å¼•åˆ†é… 5 ä¸ªåˆ†ç‰‡å’Œä¸€ä¸ªå‰¯æœ¬ã€‚ 4.1 é›†æˆ Spring Bootç¯å¢ƒï¼š Elastic Search 2.4.4 Spring Data Elastic Search 2.1.4.RELEASE â€“ Spring Boot å¯¹ ES çš„æ”¯æŒæ¨¡å— JNA 4.3.0 â€“ ES ä¾èµ–æ¨¡å— ä¾èµ–ï¼š 123456dependencies { // æ·»åŠ  Spring Data Elasticsearch çš„ä¾èµ– compile('org.springframework.boot:spring-boot-starter-data-elasticsearch') // æ·»åŠ  JNA çš„ä¾èµ– compile('net.java.dev.jna:jna:4.3.0')} é…ç½®ï¼š 1234567891011spring: data: elasticsearch: # æœåŠ¡åœ°å€ cluster-nodes: localhost:9300 # è¿æ¥è¶…æ—¶æ—¶é—´ properties: transport: tcp: connect_timeoutï¼š120 å¼€å¯ Elastic Searchï¼š ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶ï¼šå®˜ç½‘ è§£å‹åˆ°æŒ‡å®šç›®å½• è¿›å…¥ binï¼Œæ ¹æ®ç³»ç»Ÿå¹³å°æ‰§è¡Œ elasticsearch å‘½ä»¤ åå°ç¼–ç ï¼š ç´¢å¼•åº“å®ä½“ï¼šEsBlog èµ„æºåº“ï¼šEsBlogRepository æµ‹è¯•ç”¨ä¾‹ï¼šEsBlogRepositoryTest æ§åˆ¶å™¨ï¼šBlogController æ–‡æ¡£åº“å®ä½“ï¼š123456789101112131415@Document(indexName = \"blog\", type = \"blog\") // æ ‡æ³¨ä¸ºæ–‡æ¡£å®ä½“ç±»public class EsBlog implements Serializable { @Id private String id; private String title; private String summary; // å…³é”®å­— private String content; // éµå¾ª JPA è§„èŒƒ protected EsBlog() { } ......} èµ„æºåº“ï¼š123456789101112public interface EsBlogRepository extends ElasticsearchRepository&lt;EsBlog, String&gt; { /** * åˆ†é¡µæŸ¥è¯¢åšå®¢ï¼ˆå»é‡ï¼‰ * JPA è‡ªåŠ¨æ ¹æ®æ–¹æ³•åæ‰§è¡ŒæŸ¥è¯¢ */ Page&lt;EsBlog&gt; findDistinctEsBlogByTitleContainingOrSummaryContainingOrContentContaining( String title, String summary, String content, Pageable pageable);} æµ‹è¯•ç”¨ä¾‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738@RunWith(SpringRunner.class)@SpringBootTestpublic class TestEsBlogRepository { @Autowired private EsBlogRepository esBlogRepository; /** * æµ‹è¯•æ–‡æ¡£åº“ä¹‹å‰å­˜å…¥æ•°æ® */ @Before public void initEsBlogRepository() { esBlogRepository.deleteAll(); esBlogRepository.save(new EsBlog(\"ç™»é¹¤é›€æ¥¼\", \"ç‹ä¹‹æ¶£çš„ç™»é¹¤é›€æ¥¼\", \"ç™½æ—¥ä¾å±±å°½ï¼Œé»„æ²³å…¥æµ·æµã€‚æ¬²ç©·åƒé‡Œç›®ï¼Œæ›´ä¸Šä¸€å±‚æ¥¼ã€‚\")); esBlogRepository.save(new EsBlog(\"ç›¸æ€\", \"ç‹ç»´çš„ç›¸æ€\", \"çº¢è±†ç”Ÿå—å›½ï¼Œæ˜¥æ¥å‘å‡ æã€‚æ„¿å›å¤šé‡‡é¢‰ï¼Œæ­¤ç‰©æœ€ç›¸æ€ã€‚\")); esBlogRepository.save(new EsBlog(\"é™å¤œæ€\", \"æç™½çš„é™å¤œæ€\", \"åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚\")); } @Test public void testFindDistinctEsBlogByTitleContainingOrSummaryContainingOrContentContaining() { Pageable pageRequest = new PageRequest(0, 20); // æœç´¢æ¡ä»¶ String title = \"æ€\"; String summary = \"æ€\"; String content = \"ç›¸æ€\"; Page&lt;EsBlog&gt; page = esBlogRepository.findDistinctEsBlogByTitleContainingOrSummaryContainingOrContentContaining( title, summary, content, pageRequest); // æ–­è¨€æ ¹æ®æŒ‡å®šçš„ titleã€summaryã€content æ¥æœç´¢ è®°å½•æœ‰ä¸¤æ¡ assertThat(page.getTotalElements()).isEqualTo(2); // æ‰“å°ç»“æœ for (EsBlog blog : page.getContent()){ System.out.println(blog); } }} æ§åˆ¶å™¨ï¼š123456789101112131415161718192021@RestController@RequestMapping(\"/\")public class BlogController { @Autowired private EsBlogRepository esBlogRepository; @RequestMapping(value = \"/blogs\") public List&lt;EsBlog&gt; list(@RequestParam(value = \"title\") String title, @RequestParam(value = \"summary\") String summary, @RequestParam(value = \"content\") String content, @RequestParam(value = \"pageIndex\", defaultValue = \"0\") int pageIndex, @RequestParam(value = \"pageSize\", defaultValue = \"10\") int pageSize ) { Pageable pageable = new PageRequest(0, 10); Page&lt;EsBlog&gt; page = esBlogRepository.findDistinctEsBlogByTitleContainingOrSummaryContainingOrContentContaining( title, summary, content, pageable); return page.getContent(); }} è®¿é—®ï¼š äº”ã€é›†æˆ BootStrapæ˜¯ä»€ä¹ˆï¼š åŸºäº HTMLã€CSSã€JavaScript å“åº”å¼å¸ƒå±€ ç§»åŠ¨è®¾å¤‡ä¼˜å…ˆ å¦‚ä½•å®ç°ï¼š æ–‡æ¡£å¿…é¡»æ˜¯ HTML5 è®¾ç½®å“åº”å¼çš„ meta æ ‡ç­¾ &lt;meta bane=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt; é€šè¿‡ Normalize.css è¾¾åˆ°æµè§ˆå™¨ä¸€è‡´æ€§é€‚é… ä½¿ç”¨ Normalize å»ºç«‹è·¨æµè§ˆå™¨çš„ä¸€è‡´æ€§ é¢å¤–æ”¯æŒçš„ Reboot æ ¸å¿ƒæ¦‚å¿µï¼š ç§»åŠ¨è®¾å¤‡ä¼˜å…ˆç­–ç•¥ åŸºç¡€çš„ CSS æ˜¯ç§»åŠ¨ä¼˜å…ˆã€‚ä¼˜å…ˆè®¾è®¡æ›´å°çš„å®½åº¦ åª’ä½“æŸ¥è¯¢ã€‚é’ˆå¯¹å¹³æ¿ç”µè„‘ã€å°å¼ç”µè„‘å†åšå®½å±é€‚é… æ¸è¿›å¢å¼ºã€‚éšç€å±å¹•å¤§å°çš„å¢åŠ è€Œæ·»åŠ å…ƒç´  ç½‘æ ¼ç³»ç»Ÿ å“åº”å¼ï¼šviewport å°ºå¯¸çš„å¢åŠ ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†ä¸ºæœ€å¤š 12 æ ¼ï¼š å®ä¾‹ï¼š12345678910111213141516171819202122&lt;!-- æ­¤ä¸ºä¸€è¡Œï¼Œè¯¥è¡Œä¸­æœ‰ä¸¤åˆ— --&gt;&lt;div class=\"row\"&gt; &lt;!-- æ­¤ä¸ºä¸€åˆ—ï¼šç§»åŠ¨è®¾å¤‡ä¸‹å æ»¡ 12 æ ¼ï¼Œä¸­å‹PCä¸‹å  8 æ ¼ --&gt; &lt;div class=\"col-xs-12 col-md-8\"&gt;.col-xs-12 col-md-8 .col-xs-12 col-md-8&lt;/div&gt; &lt;div class=\"col-xs-6 col-md-4\"&gt;.col-xs-6 .col-md-4&lt;/div&gt;&lt;/div&gt;&lt;!-- ä¸€è¡Œä¸­æœ‰ä¸‰åˆ— --&gt;&lt;div class=\"row\"&gt; &lt;!-- ä¸‰åˆ—å„å ç½‘æ ¼çš„ 4 æ ¼åˆšå¥½å æ»¡ä¸€è¡Œ --&gt; &lt;div class=\"col-xs-6 col-md-4\"&gt;.col-xs-6 .col-md-4&lt;/div&gt; &lt;div class=\"col-xs-6 col-md-4\"&gt;.col-xs-6 .col-md-4&lt;/div&gt; &lt;div class=\"col-xs-6 col-md-4\"&gt;.col-xs-6 .col-md-4&lt;/div&gt;&lt;/div&gt;&lt;!-- ä¸€è¡Œä¸­æœ‰ä¸¤åˆ— --&gt;&lt;div class=\"row\"&gt; &lt;!-- è¯¥è¡Œä¸­æœ‰ä¸¤åˆ—ï¼Œæ¯åˆ—å  6 æ ¼åˆšå¥½å æ»¡ä¸€è¡Œ --&gt; &lt;div class=\"col-xs-6\"&gt;.col-xs-6&lt;/div&gt; &lt;div class=\"col-xs-6\"&gt;.col-xs-6&lt;/div&gt;&lt;/div&gt;&lt;!-- --&gt; æ•ˆæœï¼š å¸¸ç”¨ç»„ä»¶ã€æ ·å¼ Typography å¤„ç†å°åˆ· Table Form Button Dropdown ä¸‹æ‹‰æ¡† ButtonGroup InputGroup Bavbar Pagination åˆ†é¡µ Tag Alert æç¤ºæ¡† Modal Dialog æ¨¡æ€æ¡† Progress Bar è¿›åº¦æ¡ List Group åˆ—è¡¨ Card å¡ç‰‡ Tooltip æç¤º å…­ã€Spring Security å®‰å…¨æƒé™æ¡†æ¶è§’è‰² ä»£è¡¨ä¸€ç³»åˆ—è¡Œä¸ºæˆ–è´£ä»»çš„å®ä½“ é™å®šèƒ½åšä»€ä¹ˆã€ä¸èƒ½åšä»€ä¹ˆ ç”¨æˆ·è´¦å·å¾€å¾€ä¸è§’è‰²ç›¸å…³è” RBAC åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRole-Base Access Controlï¼‰ éšå¼è®¿é—®æ§åˆ¶ï¼šä¸è§’è‰²å…³è”çš„è®¿é—®æ§åˆ¶ æ˜¾å¼è®¿é—®æ§åˆ¶ï¼šä¸æƒé™å…³è”çš„è®¿é—®æ§åˆ¶ï¼ˆæ›´çµæ´»ï¼‰ å®‰å…¨é¢†åŸŸæ ¸å¿ƒæ¦‚å¿µ è®¤è¯ï¼ˆauthenticationï¼‰ï¼šâ€œè®¤è¯â€æ˜¯å»ºç«‹ä¸»ä½“ï¼ˆprincipalï¼‰çš„è¿‡ç¨‹ã€‚â€œä¸»ä½“â€é€šå¸¸æ˜¯æŒ‡å¯ä»¥åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­æ‰§è¡Œæ“ä½œçš„ç”¨æˆ·ã€è®¾å¤‡æˆ–å…¶ä»–ç³»ç»Ÿã€‚ æˆæƒï¼ˆauthorizationï¼‰ï¼šæˆ–ç§°ä¸ºï¼šâ€œè®¿é—®æ§åˆ¶ï¼ˆaccess-controlï¼‰â€ï¼Œâ€œæˆæƒâ€æ˜¯æŒ‡å†³å®šæ˜¯å¦å…è®¸ä¸»ä½“åœ¨åº”ç”¨ç¨‹åºä¸­æ‰§è¡Œæ“ä½œã€‚ æ”¯æŒçš„èº«ä»½éªŒè¯åŠŸèƒ½ HTTP BASIC HTTP Digest HTTP X.509 LDAP åŸºäºè¡¨å•çš„è®¤è¯ OpenID å•ç‚¹ç™»é™† Remmenber-Me åŒ¿åèº«ä»½éªŒè¯ Run-ad JAAS JavaEE å®¹å™¨è®¤è¯ æä¾›çš„æ¨¡å— Core - Spring-security-core.jar â€”â€” æ ¸å¿ƒæ¨¡å— Remoting - spring-security-remoting.jar â€”â€” ä¸ Spring Remoting æ•´åˆåŒ… Web - spring-security-web.jar â€”â€” web æ”¯æŒ Config - spring-security-config.jar â€”â€” å®‰å…¨é…ç½® LDAP - spring-security-idap.jar â€”â€” ç”¨äº LDAP è®¤è¯åŠé…ç½® ACL - spring-secutiry-acl.jar â€”â€” è®¿é—®æ§åˆ¶åˆ—è¡¨çš„å®ç°ï¼Œå¯¹ç‰¹å®šå¯¹è±¡çš„å®ä¾‹è¿›è¡Œå®‰å…¨é…ç½® CAS - spring-secutiry-cas.jar â€”â€” å¯ä½œä¸ºå•ç‚¹ç™»é™†æœåŠ¡å™¨ OpenID - spring-secutiry-openid.jar Test - spring-secutiry-test.jar ä¸ Spring Boot é›†æˆ ç¯å¢ƒï¼š Spring Secutiry 4.2.2.RELEASE Thymeleaf Spring Secutiry 3.0.2.RELEASE ä¾èµ–ï¼š 123456dependencies { // æ·»åŠ  Spring Security ä¾èµ– compile('org.springframework.boot:spring-boot-starter-security') // æ·»åŠ  Thymeleaf Spring Security ä¾èµ–ï¼Œä¸ Thymeleaf ç‰ˆæœ¬ä¸€è‡´éƒ½æ˜¯ 3.x compile('org.thymeleaf.extras:thymeleaf-extras-springsecurity4:3.0.2.RELEASE')} åå°ç¼–ç ï¼š å®‰å…¨é…ç½®ç±» æ§åˆ¶å™¨ å‰å°ç¼–ç ï¼š index.html header.html login.html 123456789101112131415161718192021222324252627282930@EnableWebSecuritypublic class SpringSecurityConfig extends WebSecurityConfigurerAdapter { /** * è‡ªå®šä¹‰é…ç½® */ @Override protected void configure(HttpSecurity http) throws Exception { http .authorizeRequests() .antMatchers(\"/css/**\", \"/js/**\", \"/fonts/**\", \"/index\").permitAll() // éƒ½å¯ä»¥è®¿é—® .antMatchers(\"/users/**\").hasRole(\"ADMIN\") // éœ€è¦ç›¸åº”çš„è§’è‰²æ‰èƒ½è®¿é—® .and() .formLogin() // åŸºäº Form è¡¨å•ç™»å½•éªŒè¯ .loginPage(\"/login\") // è·³è½¬åˆ°ç™»é™†åœ°å€ .failureUrl(\"/login-error\"); // ç™»é™†å¤±è´¥è·³è½¬åœ°å€ } /** * è®¤è¯ä¿¡æ¯ç®¡ç† * * @param auth * @throws Exception */ @Autowired public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception { auth.inMemoryAuthentication() // è®¤è¯ä¿¡æ¯å­˜å‚¨å†…å­˜ä¸­ .withUser(\"yuzh\").password(\"admin\").roles(\"ADMIN\"); // ç¡¬ç¼–ç æµ‹è¯• }} ä¸ƒã€ç”¨æˆ·ç®¡ç†éœ€æ±‚/æ ¸å¿ƒåŠŸèƒ½ éœ€æ±‚åˆ†æ æ³¨å†Œ /registerï¼š[GET] è·å–æ³¨å†Œé¡µé¢ /registerï¼š[POST] æ³¨å†ŒæˆåŠŸï¼Œè·³è½¬ç™»é™†é¡µé¢ User ç”¨æˆ·å¯¹è±¡ ç™»é™†: /login: [get] è·å–ç™»é™†é¡µé¢ /login: [post] ç™»é™† username password remember-me æ˜¯å¦è®°ä½æˆ‘ ç”¨æˆ·ç®¡ç† /users: [get] ç”¨æˆ·åˆ—è¡¨ async pageIndex pageSize name ç”¨æˆ·åç§°å…³é”®å­— /users/add: [get] è·å–æ·»åŠ ç”¨æˆ·é¡µé¢ /users/add: [post] ä¿å­˜æ·»åŠ çš„ç”¨æˆ· User authorityId è§’è‰²ID /users/{id}: [delete] åˆ é™¤ç”¨æˆ· id /users/edit/{id}: [get] è·å–æŸä¸ªå…·ä½“ç”¨æˆ·ç¼–è¾‘é¡µé¢ id æµç¨‹å›¾ é¦–é¡µç”¨æˆ·æ³¨å†Œï¼š åå°ç®¡ç†-ä¿®æ”¹ç”¨æˆ·ï¼š åå°å®ç° åŸæœ‰åŸºç¡€ä¸Šæ·»åŠ ä¾èµ–ï¼š // æ·»åŠ  Apache Commons Lang ä¾èµ– compile(&apos;org.apache.commons:commons-lang3:3.5&apos;) å¯¹ User å®ä½“æ·»åŠ æŒä¹…åŒ–å’Œæ ¡éªŒæ³¨è§£ï¼š 123456789101112131415161718192021222324252627282930313233343536@Data@Entitypublic class User implements Serializable { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private long id; @NotEmpty(message = \"å§“åä¸èƒ½ä¸ºç©º\") @Size(min=2, max=20) @Column(nullable = false, length = 20) // æ˜ å°„ä¸ºå­—æ®µï¼Œå€¼ä¸èƒ½ä¸ºç©º private String name; @NotEmpty(message = \"é‚®ç®±ä¸èƒ½ä¸ºç©º\") @Size(max=50) @Email(message= \"é‚®ç®±æ ¼å¼ä¸å¯¹\" ) @Column(nullable = false, length = 50, unique = true) private String email; @NotEmpty(message = \"è´¦å·ä¸èƒ½ä¸ºç©º\") @Size(min=3, max=20) @Column(nullable = false, length = 20, unique = true) private String username; // ç”¨æˆ·è´¦å·ï¼Œç”¨æˆ·ç™»å½•æ—¶çš„å”¯ä¸€æ ‡è¯† @NotEmpty(message = \"å¯†ç ä¸èƒ½ä¸ºç©º\") @Size(max=100) @Column(length = 100) private String password; // ç™»å½•æ—¶å¯†ç  @Column(length = 200) private String avatar; // å¤´åƒå›¾ç‰‡åœ°å€ private int age; protected User() { }} å®ç° JpaRepository æ¥å£ï¼Œæ ¹æ®è§„èŒƒçš„æ–¹æ³•åæ‰§è¡ŒæŸ¥è¯¢ï¼š 123456789101112131415161718192021222324252627282930public interface UserRepository extends JpaRepository&lt;User, Long&gt; { /** * æ ¹æ®ç”¨æˆ·ååˆ†é¡µæŸ¥è¯¢åˆ—è¡¨ * * @param name * @param pageable * @return */ Page&lt;User&gt; findByNameLike(String name, Pageable pageable); /** * æ ¹æ®ç”¨æˆ·è´¦å·æŸ¥è¯¢ç”¨æˆ· * * @param username * @return */ User findByUsername(String username); /** * æŸ¥æ‰¾ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨ */ boolean existsByUsername(String primaryKey); /** * æŸ¥æ‰¾é‚®ç®±æ˜¯å¦è¢«å ç”¨ */ boolean existsByEmail(String primaryKey);} UserService æ¥å£åŠå®ç° xyz.yuzh.spring.boot.blog.vo.Response å…¨å±€å“åº”ç»“æœå¯¹è±¡ AdminController åå°ç®¡ç†æ§åˆ¶å™¨ â€”â€” è·³è½¬åå°ç®¡ç†é¡µé¢ UserController åå°ç®¡ç†ç”¨æˆ·ç®¡ç†æ§åˆ¶å™¨ â€”â€” å¢åˆ æ”¹æŸ¥ UserOperationExcption ç”¨æˆ·æ“ä½œå¼‚å¸¸ç±» GlobalExceptionHandler å…¨å±€å¼‚å¸¸å¤„ç†ç±» å‰å°å®ç° login.html register.html /users/*.html /admins/*.html js/admins/*.js js/users/*.js é—®é¢˜è§£å†³ å¦‚ä½•ç»™é€šè¿‡è„šæœ¬æ·»åŠ çš„å…ƒç´ æ³¨å†Œäº‹ä»¶ è§£å†³ä½¿ç”¨ bootstrap æ›´æ–°æ“ä½œæ—¶ â€”â€” æ¨¡æ€æ¡†å›æ˜¾ä¼ å€¼é—®é¢˜ å…«ã€è§’è‰²æƒé™ç®¡ç†éœ€æ±‚åˆ†æ User å¯¹è±¡å®ç° UserDetails æ¥å£ å®ç° getAuthorities æ–¹æ³•ï¼Œè¿”å›æƒé™å®ä½“é›†åˆï¼ˆéœ€è¦è‡ªå®šä¹‰çš„ Authority è½¬ä¸º SimpleGrantedAuthorityï¼‰ UserServiceImpl å®ç° UserDetailsService å®ç° security é»˜è®¤æ–¹æ³• loadUserByUsernameï¼Œè¿”å›æ•°æ®åº“æŸ¥åˆ°çš„ç”¨æˆ·å®ä½“ SecurityConfig 123456789101112131415161718192021222324252627282930313233343536373839404142434445@EnableWebSecurity@EnableGlobalMethodSecurity(prePostEnabled = true)public class SecurityConfig extends WebSecurityConfigurerAdapter { private static final String KEY = \"yuzh.xyz\"; @Autowired private UserDetailsService userDetailsService; @Bean public AuthenticationProvider authenticationProvider() { DaoAuthenticationProvider authenticationProvider = new DaoAuthenticationProvider(); authenticationProvider.setUserDetailsService(userDetailsService); return authenticationProvider; } @Override protected void configure(HttpSecurity http) throws Exception { http .authorizeRequests() .antMatchers(\"/css/**\", \"/js/**\", \"/fonts/**\", \"/\", \"/index\").permitAll() .antMatchers(\"/h2-console/**\").permitAll() // æ•°æ®åº“ä¸­çš„å­—æ®µå› è¯¥æ˜¯ ROLE_ADMIN ï¼Œè¿™é‡Œä¸éœ€è¦å†™ ROLE_ å‰ç¼€ã€‚ .antMatchers(\" /admins/**\").hasRole(\"ADMIN\") .and() .formLogin() .loginPage(\"/login\") .failureUrl(\"/login-error\") .and() .rememberMe().key(KEY) .and() .exceptionHandling().accessDeniedPage(\"/403\"); http.csrf().ignoringAntMatchers(\"/h2-console/**\"); http.headers().frameOptions().sameOrigin(); } @Autowired public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception { auth.userDetailsService(userDetailsService); auth.authenticationProvider(authenticationProvider()); }} æ•°æ®åº“çš„æƒé™å­˜å…¥çš„æ ¼å¼ä¾‹å¦‚ ROLE_ADMIN / ROLE_USER ç»™éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„æ–¹æ³•æˆæƒ ç»™ç±»æˆæƒï¼š@PreAuthorize(&quot;hasAuthority('ROLE_ADMIN')&quot;) // æŒ‡å®šè§’è‰²æƒé™æ‰èƒ½æ“ä½œæ–¹æ³• ç»™æ–¹æ³•æˆæƒï¼šå¦‚å½“è¯·æ±‚å‚æ•°ä¸­çš„ username è¢«æŸ¥è¯¢åˆ°å·²è®¤è¯æ‰å…è®¸è¿›å…¥æ–¹æ³• 12@PostMapping(\"/{username}/blogs/edit\")@PreAuthorize(\"authentication.name.equals(#username)\") å½“è¡¨å•å‘èµ· /login çš„ post è¯·æ±‚å¹¶æºå¸¦å›ºå®šåç§°çš„ usernameã€password å‚æ•°ï¼Œsecurity ä¼šè‡ªåŠ¨å¤„ç†ç™»é™†ï¼Œè‹¥ç™»é™†å¤±è´¥ï¼Œè·³åˆ°é…ç½®å¥½çš„ç™»é™†å¤±è´¥é¡µé¢ã€‚ ä¹ã€åšå®¢ç®¡ç†éœ€æ±‚åˆ†æ ç”¨æˆ·ä¸»é¡µå®ç° ä¸ªäººèµ„æ–™è®¾ç½® ä¸ªäººå¤´åƒæ›´æ¢ user space APIï¼šç”¨æˆ·ä¸»é¡µç©ºé—´æ¥å£ /blogs: [get] orderï¼šæ’åºç±»å‹ï¼Œnew/hotï¼Œé»˜è®¤æ˜¯ new keywordï¼šæœç´¢å…³é”®å­—ã€‚åšå®¢çš„æ ‡ç­¾ï¼Œå³ä¸ºå…³é”®å­—ã€‚ asyncï¼šæ˜¯å¦ä¸ºå¼‚æ­¥è¯·æ±‚é¡µé¢ pageIndex pageSize /u/{username}: [get] å…·ä½“æŸä¸ªç”¨æˆ·çš„ä¸»é¡µ username ç”¨æˆ·è´¦å· /u/{username}/profile: [get] è·å–ä¸ªäººè®¾ç½®é¡µé¢ username ç”¨æˆ·è´¦å· /u/{username}/profile: [post] ä¿å­˜ä¸ªäººè®¾ç½®é¡µé¢ username ç”¨æˆ·è´¦å· User å¾…ä¿å­˜çš„å¯¹è±¡ /u/{username}/avatar: [get] è·å–ä¸ªäººå¤´åƒ username ç”¨æˆ·è´¦å· /u/{username}/avatar: [post] ä¿å­˜ä¸ªäººå¤´åƒ username ç”¨æˆ·è´¦å· /u/{username}/blogs: [get] æŸ¥è¯¢ç”¨æˆ·åšå®¢ orderï¼šæ’åºç±»å‹ï¼Œnew/hotï¼Œé»˜è®¤æ˜¯ new catalogï¼šåšå®¢åˆ†ç±» IDï¼Œé»˜è®¤ä¸ºç©º keywordï¼šæœç´¢å…³é”®å­—ã€‚åšå®¢çš„æ ‡ç­¾ï¼Œå³ä¸ºå…³é”®å­—ã€‚ asyncï¼šæ˜¯å¦ä¸ºå¼‚æ­¥è¯·æ±‚é¡µé¢ pageIndex pageSize /u/{username}/blogs/edits: [get] è·å–æ–°å¢åšå®¢é¡µé¢ username ç”¨æˆ·è´¦å· /u/{username}/blogs/edit/{id}: [get] è·å–ç¼–è¾‘åšå®¢çš„é¡µé¢ username ç”¨æˆ·è´¦å· id åšå®¢ID /u/{username}/blogs/edit: [post] ä¿å­˜åšå®¢ username ç”¨æˆ·è´¦å· Blog å¾…ä¿å­˜çš„åšå®¢å¯¹è±¡ /u/{username}/blogs/delete/{id}: [delete] åˆ é™¤åšå®¢ username ç”¨æˆ·è´¦å· id åšå®¢ID /u/{username}/blogs/{id}: [get] è·å–åšå®¢å±•ç¤ºé¡µé¢ username ç”¨æˆ·è´¦å· id åšå®¢ID åå°å®ç° æ·»åŠ  markdown è§£æå™¨çš„ä¾èµ–ï¼š 1compile('es.nitaur.markdown:txtmark:0.16') MongoDB File Server æ–‡ä»¶æœåŠ¡å™¨ https://github.com/waylau/mongodb-file-server ç”¨æˆ·ä¸ªäººè®¾ç½® åã€è¯„è®ºç®¡ç†éœ€æ±‚åˆ†æ comments APIï¼šè¯„è®ºç®¡ç†æ¥å£ /comments: [get] è·å–è¯„è®ºåˆ—è¡¨ blogid åšå®¢id /comments: [post] ä¿å­˜è¯„è®º blogid åšå®¢idcommentContent è¯„è®ºå†…å®¹ /comments/{id}: [delete] åˆ é™¤è¯„è®º blogid åšå®¢id id è¯„è®ºid åä¸€ã€ç‚¹èµç®¡ç†éœ€æ±‚åˆ†æ votes APIï¼šç‚¹èµç®¡ç†æ¥å£ /votes: [post] ä¿å­˜ç‚¹èµ blogid åšå®¢id /votes/{id}: [delete] åˆ é™¤ç‚¹èµ blogid åšå®¢id id ç‚¹èµid åäºŒã€åˆ†ç±»ç®¡ç†éœ€æ±‚åˆ†æ catalogs APIï¼šåˆ†ç±»ç®¡ç†æ¥å£ /catalogs: [get] è·å–ç”¨æˆ·åšå®¢çš„åˆ†ç±»åˆ—è¡¨ username ç”¨æˆ·è´¦å· /catalogs: [post] ä¿å­˜ç”¨æˆ·åšå®¢çš„åˆ†ç±» username ç”¨æˆ·è´¦å· CatalogVO åŒ…å« usernameã€Catalog /catalogs/edit: [get] è·å–ç¼–è¾‘åˆ†ç±»ç•Œé¢ /catalogs/edit/{id}: [get] è·å–æŸIDåˆ†ç±»ç¼–è¾‘çš„åˆ†ç±»ç•Œé¢ /catalogs/{id}: [delete] åˆ é™¤åˆ†ç±» id åˆ†ç±»ID username ç”¨æˆ·è´¦å· åä¸‰ã€æ ‡ç­¾ç®¡ç†éœ€æ±‚åˆ†æ ä½¿ç”¨æ’ä»¶ï¼šJquery Tags Input 1.3.6 http://xoxco.com/projects/code/tagsinput åå››ã€é¦–é¡µæœç´¢éœ€æ±‚åˆ†æ index APIï¼šåŒ…å«æœ€æ–°ã€æœ€çƒ­æ–‡ç« ã€æœ€çƒ­æ ‡ç­¾ã€æœ€çƒ­ç”¨æˆ·ç­‰ /blogs: [get] orderï¼šæ’åºç±»å‹ï¼Œnew/hot keywordï¼šæœç´¢å…³é”®å­—ï¼ˆåŒ…å«åšå®¢æ ‡ç­¾ï¼‰ asyncï¼šæ˜¯å¦å¼‚æ­¥ pageIndex pageSize ç¯å¢ƒï¼š Elastic Search 2.4.4 Spring Data Elastic Search 2.1.4.RELEASE â€“ Spring Boot å¯¹ ES çš„æ”¯æŒæ¨¡å— JNA 4.3.0 â€“ ES ä¾èµ–æ¨¡å— åäº”ã€éƒ¨ç½²ç›¸å…³15.1 ä½¿ç”¨å¤–éƒ¨ MongoDB å­˜å‚¨æ–‡ä»¶æœåŠ¡å™¨æ•°æ®ä¹‹å‰ä½¿ç”¨çš„æ˜¯æ–‡ä»¶æœåŠ¡å™¨å†…åµŒçš„ mongoDBï¼Œé¡¹ç›®åœæ­¢ä¹‹åå›¾ç‰‡æ•°æ®ä¸ä¼šä¿å­˜ã€‚æ›´æ¢å¤–éƒ¨ mongoDBï¼š window ä¸‹ ä¸‹è½½ mongoDB https://www.mongodb.com/download-center#community é€‰æ‹© msi æ–‡ä»¶ä¸‹è½½å®‰è£… MongoDBå°†æ•°æ®ç›®å½•å­˜å‚¨åœ¨ db ç›®å½•ä¸‹ã€‚ä½†æ˜¯è¿™ä¸ªæ•°æ®ç›®å½•ä¸ä¼šä¸»åŠ¨åˆ›å»ºï¼Œéœ€è¦æ‰‹åŠ¨åˆ›å»ºã€‚ï¼ˆå¦‚ï¼šd:/mongoData/dbï¼‰ ä¿®æ”¹æ–‡ä»¶æœåŠ¡å™¨ build.gradle æ–‡ä»¶ï¼Œå–æ¶ˆä½¿ç”¨å†…åµŒ mongoDB 12// æ·»åŠ  Embedded MongoDB çš„ä¾èµ–ç”¨äºæµ‹è¯•// compile('de.flapdoodle.embed:de.flapdoodle.embed.mongo') ä¿®æ”¹æ–‡ä»¶æœåŠ¡å™¨ application.yml æ–‡ä»¶ï¼Œè¿æ¥ç‹¬ç«‹çš„ MongoDB 12# independent MongoDB serverspring.data.mongodb.uri=mongodb://localhost:27017/test ä» MongoDB ç›®å½•çš„ bin ç›®å½•ä¸­æ‰§è¡Œ mongod.exe æ–‡ä»¶ 1å¦‚ï¼šC:\\mongodb\\bin\\mongod --dbpath d:\\mongoData\\db è¿è¡Œ mongo.exe å‘½ä»¤å³å¯è¿æ¥ MongoDB æ›´å¤šç»†èŠ‚è§ï¼šhttp://www.runoob.com/mongodb/mongodb-window-install.html linux ä¸‹ 1234567891011121314curl -O https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.0.6.tgz # ä¸‹è½½tar -zxvf mongodb-linux-x86_64-3.0.6.tgz # è§£å‹mv mongodb-linux-x86_64-3.0.6.tgz mongodb # é‡å‘½åvim /etc/profile # é…ç½®ç¯å¢ƒå˜é‡---------------------export PATH=/opt/mongodb/bin:${PATH}---------------------resource /etc/profile # åˆ·æ–°ç¯å¢ƒå˜é‡cd /opt/mongodbmkdir data &amp; cd data &amp; mkdir db # åˆ›å»ºæ–‡ä»¶å­˜æ”¾ç›®å½•mongod --dbpath=/opt/mongodb/data/db # å¯åŠ¨ mongodb 15.2 åº”ç”¨å¯åŠ¨åå°è¿è¡Œï¼šnohup cmd &amp; å¯åŠ¨ mongoDB å¯åŠ¨æ–‡ä»¶æœåŠ¡å™¨ï¼ˆgradlew bootRunï¼‰ è¿›å…¥ elastic searchï¼Œåˆ é™¤ data æ–‡ä»¶ï¼ˆæµ‹è¯•ç¯å¢ƒä¸‹ï¼‰ï¼Œæ‰§è¡Œ ./elasticsearch å¯åŠ¨ blog-full ï¼ˆgradlew bootRunï¼‰","link":"/2018/10/28/åŸºäº Spring Boot æŠ€æœ¯æ ˆæ„å»ºä¼ä¸šçº§åšå®¢ç³»ç»Ÿçš„å¼€å‘è®°å½•/"},{"title":"Docker è¡¥æ•‘æŒ‡å—ï¼ˆä¸€ï¼‰â€”â€” åŸºç¡€ä½¿ç”¨","text":"é…ç½®é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿé˜¿é‡Œäº‘ä¸»é¡µæœç´¢ å®¹å™¨é•œåƒæœåŠ¡ï¼Œè¿›å…¥ã€Œé•œåƒä»“åº“ç®¡ç†æ§åˆ¶å°ã€ï¼Œæ ¹æ®è¯´æ˜æ–‡æ¡£æ“ä½œå³å¯ã€‚ å­¦ä¼šä½¿ç”¨å¸®åŠ©å‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬ï¼š 1docker version æŸ¥çœ‹dockerå®‰è£…ä¿¡æ¯ï¼š 1docker info æŸ¥çœ‹å‘½ä»¤è¯´æ˜ï¼š 1docker --help ä½¿ç”¨æ–¹å¼ï¼šdocker COMMAND --help å¦‚ï¼šdocker logs --help 12345678910111213Usage: docker logs [OPTIONS] CONTAINERFetch the logs of a containerOptions: --details Show extra details provided to logs -f, --follow Follow log output --since string Show logs since timestamp (e.g. 2013-01-02T13:23:37) or relative (e.g. 42m for 42 minutes) --tail string Number of lines to show from the end of the logs (default \"all\") -t, --timestamps Show timestamps --until string Show logs before a timestamp (e.g. 2013-01-02T13:23:37) or relative (e.g. 42m for 42 minutes) é•œåƒæŸ¥çœ‹æœ¬åœ°é•œåƒdocker images / docker image ls å‚æ•°ï¼š -a åˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼ˆåŒ…å«æ‰€æœ‰ä¸­é—´å±‚é•œåƒï¼‰ -q åªæ˜¾ç¤ºé•œåƒID â€“digests æ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯ï¼ˆä¼šå¤šä¸€ä¸ªGUGESTå±•ç¤ºå­—æ®µï¼Œç›¸å½“äºä¸€ä¸ªé•œåƒçš„å¤‡æ³¨ä¿¡æ¯ï¼Œæœ‰äº›é•œåƒæ²¡æœ‰ã€‚ï¼‰ â€“no-trunc æ˜¾ç¤ºå®Œæ•´çš„é•œåƒä¿¡æ¯ ä» Docker Hub æŸ¥è¯¢é•œåƒdocker search é•œåƒå å¦‚ï¼šdocker search tomcat 1234567891011121314151617181920212223242526NAME DESCRIPTION STARS OFFICIAL AUTOMATEDtomcat Apache Tomcat is an open source implementatiâ€¦ 2345 [OK]tomee Apache TomEE is an all-Apache Java EE certifâ€¦ 64 [OK]dordoka/tomcat Ubuntu 14.04, Oracle JDK 8 and Tomcat 8 baseâ€¦ 53 [OK]davidcaste/alpine-tomcat Apache Tomcat 7/8 using Oracle Java 7/8 withâ€¦ 34 [OK]bitnami/tomcat Bitnami Tomcat Docker Image 28 [OK]cloudesire/tomcat Tomcat server, 6/7/8 14 [OK]meirwa/spring-boot-tomcat-mysql-app a sample spring-boot app using tomcat and Myâ€¦ 12 [OK]tutum/tomcat Base docker image to run a Tomcat applicatioâ€¦ 11aallam/tomcat-mysql Debian, Oracle JDK, Tomcat &amp; MySQL 11 [OK]jeanblanchard/tomcat Minimal Docker image with Apache Tomcat 8arm32v7/tomcat Apache Tomcat is an open source implementatiâ€¦ 6rightctrl/tomcat CentOS , Oracle Java, tomcat application sslâ€¦ 4 [OK]maluuba/tomcat7-java8 Tomcat7 with java8. 3amd64/tomcat Apache Tomcat is an open source implementatiâ€¦ 2arm64v8/tomcat Apache Tomcat is an open source implementatiâ€¦ 2fabric8/tomcat-8 Fabric8 Tomcat 8 Image 2 [OK]camptocamp/tomcat-logback Docker image for tomcat with logback integraâ€¦ 1 [OK]99taxis/tomcat7 Tomcat7 1 [OK]s390x/tomcat Apache Tomcat is an open source implementatiâ€¦ 0picoded/tomcat7 tomcat7 with jre8 and MANAGER_USER / MANAGERâ€¦ 0 [OK]oobsri/tomcat8 Testing CI Jobs with different names. 0cfje/tomcat-resource Tomcat Concourse Resource 01and1internet/debian-9-java-8-tomcat-8.5 Our tomcat 8.5 image 0 [OK]jelastic/tomcat An image of the Tomcat Java application servâ€¦ 0swisstopo/service-print-tomcat backend tomcat for service-print the true, â€¦ 0 å‚æ•°ï¼š -s [æ•°å­—]ï¼š åˆ—å‡º star ä¸å°äºæŒ‡å®šæ•°å€¼çš„é•œåƒ 1234# æŸ¥è¯¢æ˜Ÿæ˜Ÿæ•°ä¸å°äº 30 ä¸ªçš„ tomcat é•œåƒdocker search -s 30 tomcat# -s å‚æ•°å·²åºŸå¼ƒï¼Œå¯ç”¨ --filter æ›¿ä»£docker search --filter=stars=30 tomcat â€“no-truncï¼š æ˜¾ç¤ºå®Œæ•´çš„é•œåƒæè¿°ä¿¡æ¯ â€“automatedï¼šåªåˆ—å‡º automated build ç±»å‹çš„é•œåƒ æ‹‰å–é•œåƒdocker pull é•œåƒå:ç‰ˆæœ¬å· ä¸åŠ ç‰ˆæœ¬å·é»˜è®¤ :latest åˆ é™¤æœ¬åœ°é•œåƒdocker rmi é•œåƒåå­—æˆ–ID å‚æ•°ï¼š-f åˆ é™¤ä¸­é—´å±‚é•œåƒ åˆ é™¤å•ä¸ª 1docker rmi -f é•œåƒID åˆ é™¤å¤šä¸ª 1docker rmi -f é•œåƒ1:TAG é•œåƒ2:TAG åˆ é™¤å…¨éƒ¨ 12# å‘½ä»¤çš„ç»„åˆä½¿ç”¨ï¼Œå°† $(docker image ls -qa) çš„ç»“æœä½œä¸º å‰ä¸€ä¸ªå‘½ä»¤çš„å‚æ•°ã€‚ `docker image ls -qa` çš„ç»“æœå°±æ˜¯ä¸€ä¸²é•œåƒIDæ•°ç»„ docker rmi -f $(docker image ls -qa) æœ‰å®¹å™¨æ­£åœ¨ä½¿ç”¨æ­¤é•œåƒï¼Œä¸èƒ½åˆ é™¤æ€ä¹ˆåŠï¼Ÿ docker rmi -f XXX åˆ é™¤é•œåƒçš„é«˜çº§ç”¨æ³•ï¼ˆè¿‡æ»¤ï¼‰åœºæ™¯ï¼šå·¥ä½œå’Œè‡ªå·±å­¦ä¹ æ—¶äº§ç”Ÿäº†å¤§é‡é•œåƒï¼Œä¸ºäº†æ–¹ä¾¿å­¦ä¹ ã€‚éœ€è¦å°†å·¥ä½œä¸­çš„é•œåƒåˆ é™¤ï¼Œå…ˆçœ‹ä¸€ä¸‹åˆ—è¡¨ï¼š æˆ‘éœ€è¦æŠŠå·¥ä½œä¸­çš„é•œåƒåˆ é™¤ï¼Œä¸€ä¸ªä¸ªå¤åˆ¶é•œåƒIDåˆ é™¤ä¸å…æœ‰äº›éº»çƒ¦ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦æŠ½å–å…±æ€§ï¼Œåˆç†è¿ç”¨å‘½ä»¤äº†ã€‚ 1ï¼‰å…ˆè¿‡æ»¤æ‰å­¦ä¹ é•œåƒï¼Œåªå±•ç¤ºå·¥ä½œé•œåƒã€‚ 12# ä»”ç»†è§‚å¯Ÿï¼Œå‘ç°å·¥ä½œé•œåƒä¸Šä¼ çš„é•œåƒæœåŠ¡åœ°å€éƒ½æ˜¯ä¸Šæµ·çš„åŒºåŸŸï¼Œå¯ä»¥ä»¥æ­¤ä½œä¸ºæ¡ä»¶è¿‡æ»¤ä¸€æ¬¡ã€‚docker image ls | grep 'shanghai' 2ï¼‰è¿‡æ»¤äº†ä¸éœ€è¦åˆ é™¤çš„é•œåƒï¼Œæ¥ä¸‹æ¥å°±æ˜¯æå–å…¶ä¸­çš„ image idä½œä¸ºåˆ é™¤é•œåƒçš„å‚æ•°äº† 12# awk '{print $n}'å¤„ç†æ–‡æœ¬ã€è¡¨æ ¼æ•°æ®çš„å¼ºå¤§linuxå‘½ä»¤ é€šè¿‡è¿™ä¸ªå‘½ä»¤ï¼Œå°†åˆ—è¡¨çš„é•œåƒIDæå–ï¼šdocker image ls | grep â€˜shanghaiâ€™ | awk â€˜{print $3}â€™ 3ï¼‰åˆ é™¤ docker rmi -f $(docker image ls | grep â€˜shanghaiâ€™ | awk â€˜{print $3}â€™) ä¿å­˜é•œåƒdocker save -o æ–‡ä»¶å.tar é•œåƒID 123456Usage: docker save [OPTIONS] IMAGE [IMAGE...]Save one or more images to a tar archive (streamed to STDOUT by default)Options: -o, --output string Write to a file, instead of STDOUT ã€Œæ¼”ç¤ºã€ å°† izhiliu/centos:v2 è¿™ä¸ªé•œåƒä¿å­˜å¹¶é‡æ–°åŠ è½½ 12345# mkdir image &amp;&amp; cd images# docker save -o centos2.tar cf18ff34c415~/Learning/docker-note/images(master*) Â» ll harry@192total 964608-rw------- 1 harry staff 458M May 12 16:47 centos2.tar åˆ é™¤è¿™ä¸ªé•œåƒï¼š 1docker rmi cf18ff34c415 åŠ è½½é•œåƒdocker load -i æ–‡ä»¶.tar 1234567Usage: docker load [OPTIONS]Load an image from a tar archive or STDINOptions: -i, --input string Read from tar archive file, instead of STDIN -q, --quiet Suppress the load output ã€ŒåŠ è½½åˆšåˆšåˆ é™¤çš„é•œåƒã€ 123# docker load -i centos2.tar6e7dbd1f6260: Loading layer [==================================================&gt;] 55.3kB/55.3kBLoaded image ID: sha256:cf18ff34c415b8ca05494a3d6faa276a0b1229cffb5563cffbb8f0af533b6f47 å®¹å™¨ä»¥ CentOS å®¹å™¨ä¸ºä¾‹ æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨docker run [options] image [command] [agsâ€¦] options: â€“name=â€å®¹å™¨åâ€ï¼šä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§° -dï¼šåå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼Œä¹Ÿå³ï¼šå¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨ -iï¼šä»¥äº¤äº’å¼æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ -tï¼šä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ -Pï¼šéšæœºç«¯å£åˆ†é… -pï¼šæŒ‡å®šç«¯å£æ˜ å°„ï¼Œæœ‰ä¸€ä¸‹å››ç§æ ¼å¼ï¼š ip:hostPort:containerPort ip::containerPort hostPort:containerPort containerPort ç®€å•å¯åŠ¨ï¼š 1docker run -it centos å¸¦å®¹å™¨åå¯åŠ¨ï¼š 1docker run -it --name=\"my-centos\" centos æŸ¥çœ‹å½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨docker ps [options] options: -aï¼šåˆ—å‡ºå½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ + å†å²ä¸Šè¿è¡Œè¿‡çš„ -lï¼šæ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨ -nï¼šæ˜¾ç¤ºæœ€è¿‘ n ä¸ªåˆ›å»ºçš„å®¹å™¨ -qï¼šé™é»˜æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå®¹å™¨ç¼–å·ï¼ˆä¸åŠ å…¶ä»–å‚æ•°é»˜è®¤æ˜¾ç¤ºå½“å‰è¿è¡Œçš„æ‰€æœ‰å®¹å™¨çš„IDï¼‰ â€“no-truncï¼šä¸æˆªæ–­è¾“å‡º ç»“åˆ -a/-q å‚æ•°ï¼Œå¯ä»¥å®ç°åˆ é™¤æ‰€æœ‰å®¹å™¨ï¼š 123456# åˆ é™¤æœ€è¿‘çš„ä¸€ä¸ªå®¹å™¨docker rm $(docker ps -lq)# å¼ºåˆ¶åˆ é™¤æœ€è¿‘çš„ä¸€ä¸ªå®¹å™¨ï¼ˆè‹¥æœ€è¿‘çš„ä¸€ä¸ªå®¹å™¨æ­£åœ¨è¿è¡Œï¼‰docker rm -f $(docker ps -lq)# åˆ é™¤å†å²æ‰€æœ‰çš„å®¹å™¨ï¼ŒåŒ…å«æ­£åœ¨è¿è¡Œçš„docker rm -f $(docker ps -aq) é€€å‡ºå®¹å™¨ä¸€ï¼‰exitï¼šé€€å‡ºå¹¶åœæ­¢ ä½¿ç”¨ docker run -it --name=&quot;my-centos&quot; centos çš„æ–¹å¼å¯åŠ¨å®¹å™¨ä¼šä»¥ä¸€ä¸ªäº¤äº’å¼ç»ˆç«¯å½¢å¼è¿›å…¥åˆ°å®¹å™¨å†…éƒ¨ï¼Œå½“æ‰§è¡Œ exit æ—¶å®¹å™¨å°±è‡ªåŠ¨åœæ­¢äº†ã€‚ 123# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES037deff7ded9 centos \"/bin/bash\" 14 seconds ago **Exited (0) 5 seconds ago** my-centos äºŒï¼‰Control + P + Qï¼šé€€å‡ºä¸åœæ­¢ é‡æ–°è¿è¡Œå®¹å™¨ï¼Œå¹¶åœ¨é‡å¯å†…æ‰§è¡Œå¿«æ·é”®ä¹‹åï¼š 123# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESf654ef93ea3f centos \"/bin/bash\" About a minute ago **Up About a minute** practical_sinoussi å½“ä¸åœæ­¢é€€å‡ºäº†ï¼Œå¦‚ä½•é‡æ–°è¿›å»å‘¢ï¼Ÿ æŸ¥çœ‹ä¸‹é¢çš„ã€Œè¿›å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€ç« èŠ‚ å¯åŠ¨å®¹å™¨docker start å®¹å™¨ID/å®¹å™¨å é‡å¯å®¹å™¨docker restart å®¹å™¨ID/å®¹å™¨å åœæ­¢å®¹å™¨docker stop å®¹å™¨ID/å®¹å™¨å å¼ºåˆ¶åœæ­¢å®¹å™¨docker kill å®¹å™¨ID/å®¹å™¨å åˆ é™¤å·²åœæ­¢çš„å®¹å™¨docker rm å®¹å™¨ID ä¸€æ¬¡æ€§åˆ é™¤å¤šä¸ªå®¹å™¨ï¼Ÿå‰é¢å·²ç»ä½¿ç”¨äº†ä¸€ç§æ–¹å¼ï¼šdocker rm -f $(docker ps -aq) è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼š12# åˆ©ç”¨ linux çš„ç®¡é“ç¬¦å¯å˜å‚æ•° xargsï¼Œå°† | å‰é¢çš„å‘½ä»¤ç»“æœä½œä¸ºå‚æ•°ä½œä¸º | åé¢å‘½ä»¤çš„å…¥å‚docker ps -aq | xargs docker rm -f å®¹å™¨é‡è¦çŸ¥è¯†ç‚¹å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨docker run -d å®¹å™¨å/å®¹å™¨ID ä»¥å®ˆæŠ¤å¼æ–¹å¼å¯åŠ¨å®¹å™¨åæŸ¥çœ‹å®¹å™¨è¿›ç¨‹ï¼š 1234# docker run -d centos4de40688015eaec0a015f5d408117d938459828e2379dec4268ae88a298a7704# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES å‘ç°å¹¶æ²¡æœ‰æ˜¾ç¤ºæ­£åœ¨è¿è¡Œçš„å®¹å™¨è¿›ç¨‹ï¼Œä¸ºå•¥ï¼Ÿå†çœ‹ä¸€ä¸‹å®¹å™¨å†å²è¿è¡Œè®°å½•è¯•è¯•ã€‚ã€‚ã€‚ 123# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES4de40688015e centos \"/bin/bash\" 4 minutes ago Exited (0) 4 minutes ago pedantic_benz å‘ç°åˆšåˆšä»¥ å®ˆæŠ¤å¼æ–¹å¼ å¯åŠ¨çš„å®¹å™¨ï¼Œå¯åŠ¨ä¹‹åå°±ç«‹é©¬åœæ­¢äº†ï¼ Docker å®¹å™¨åå°è¿è¡Œï¼Œå°±å¿…é¡»è¦æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹ã€‚\\ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå¦‚æœå®¹å™¨è¿è¡Œçš„å‘½ä»¤ä¸æ˜¯é‚£äº› ä¸€ç›´æŒ‚èµ· çš„å‘½ä»¤ï¼ˆå¦‚ï¼štopã€tailï¼‰ï¼Œå®¹å™¨æ˜¯ä¼šè‡ªåŠ¨é€€å‡ºçš„ã€‚\\è¿™æ˜¯ç”±äº dockerçš„æœºåˆ¶é—®é¢˜ï¼Œä¾‹å¦‚ä½¿ç”¨ nginxï¼Œå¯åŠ¨ nginx æœåŠ¡çš„å‘½ä»¤æ˜¯ï¼šservice nginx startï¼Œè¿™æ˜¯ä¸€ä¸ªåå°å‘½ä»¤ï¼Œåœ¨ linux ä¸­ä¼šä¸€ç›´åœ¨åå°è¿è¡Œç€ã€‚ä½†æ˜¯åœ¨ docker ä¸­ï¼Œnginxå®¹å™¨ä¸ºåå°æ¨¡å¼è¿è¡Œæ¨¡å¼ï¼Œå¯¼è‡´ docker çš„ nginx å®¹å™¨å‰å°æ²¡æœ‰è¿è¡Œçš„åº”ç”¨ã€‚æ‰€ä»¥å®¹å™¨å¯åŠ¨åä¼šç«‹å³è‡ªåŠ¨åœæ­¢ï¼Œå› ä¸ºè¿™ä¸ªå®¹å™¨è§‰å¾—è‡ªå·±æ²¡æœ‰äº‹æƒ…å¯åšï¼ğŸ˜…\\æœ€ä½³è§£å†³æ–¹æ¡ˆæ˜¯ï¼šå°†è¦è¿è¡Œçš„ç¨‹åºä»¥å‰å°çš„æ–¹å¼è¿è¡Œï¼ é‚£ä¹ˆæ€ä¹ˆè®©å®¹å™¨ä»¥å®ˆæŠ¤å¼å®¹å™¨å¯åŠ¨ï¼Œä½†æ˜¯é¿å…å‰å°æ²¡äº‹å¯åšå¯¼è‡´å®¹å™¨è‡ªåŠ¨å…³é—­å‘¢ï¼Ÿç®€å•çš„æ–¹å¼æœ‰ï¼šè®©åå°è¿è¡Œçš„å®¹å™¨å‰å°ä¸€ç›´æ‰“å°æ—¥å¿—ï¼Œè¿™æ ·å°±é¿å…äº†å‰å°æ²¡äº‹å¯åšå¯¼è‡´å®¹å™¨é€€å‡ºğŸ˜‚ã€‚ 12345# docker run -d centos /bin/bash -c \"while true; do echo hello harry!; sleep 1; done\"2b8e4a0014ab7cb435ecc19f171daf027c1291fa24b77ae52132ba9c225962d8# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES2b8e4a0014ab centos \"/bin/bash -c 'whileâ€¦\" 3 seconds ago Up 3 seconds angry_aryabhata å¯ä»¥çœ‹åˆ°æ­¤æ—¶å®¹å™¨æ­£åœ¨ä»¥åå°è¿è¡Œï¼Œä½†æ˜¯æ²¡æœ‰å…³é—­ã€‚è§£é‡Šä¸€ä¸‹ /bin/bashï¼Œ 1å¦‚æœ -c é€‰é¡¹å­˜åœ¨ï¼Œå‘½ä»¤å°±ä»å­—ç¬¦ä¸²ä¸­è¯»å–ã€‚å¦‚æœå­—ç¬¦ä¸²åæœ‰å‚æ•°ï¼Œä»–ä»¬å°†ä¼šè¢«åˆ†é…åˆ°å‚æ•°çš„ä½ç½®ä¸Šï¼Œä»$0å¼€å§‹ã€‚ æŸ¥çœ‹å®¹å™¨æ—¥å¿—docker logs -f -t â€“tail å®¹å™¨ID optinsï¼š -tï¼šåŠ å…¥æ—¶é—´æˆ³ -fï¼šè·Ÿéšæœ€æ–°æ—¥å¿—æ‰“å° â€“tail æ•°å­—ï¼šæ˜¾ç¤ºæœ€åå¤šå°‘æ¡ æŸ¥çœ‹åˆšåˆšä»¥å®ˆæŠ¤å®¹å™¨è¿è¡Œçš„è¿›ç¨‹ï¼š 1234567891011121314151617# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES04b01b87b990 centos \"/bin/bash -c 'whileâ€¦\" 5 seconds ago Up 4 seconds modest_chaplygin# docker logs -t -f --tail 10 04b01b87b990 ä»å€’æ•°ç¬¬ 10 æ¡æ—¥å¿—å¼€å§‹æŸ¥çœ‹ï¼Œä¸åœçš„è¿½åŠ ï¼Œå¹¶ä¸”æ˜¾ç¤ºæ—¥å¿—æ‰“å°çš„æ—¶é—´ã€‚2019-04-14T10:56:11.635841663Z hello harry!2019-04-14T10:56:12.638348360Z hello harry!2019-04-14T10:56:13.645537151Z hello harry!2019-04-14T10:56:14.651628446Z hello harry!2019-04-14T10:56:15.654658791Z hello harry!2019-04-14T10:56:16.658972279Z hello harry!2019-04-14T10:56:17.664596508Z hello harry!2019-04-14T10:56:18.668527236Z hello harry!2019-04-14T10:56:19.671418530Z hello harry!2019-04-14T10:56:20.676871204Z hello harry!2019-04-14T10:56:21.682418501Z hello harry!2019-04-14T10:56:22.683835449Z hello harry!2019-04-14T10:56:23.688968112Z hello harry! æŸ¥çœ‹å®¹å™¨å†…è¿è¡Œçš„è¿›ç¨‹docker top å®¹å™¨ID æŸ¥çœ‹åˆšåˆšå®ˆæŠ¤å¼è¿è¡Œçš„å®¹å™¨çš„å†…éƒ¨è¿›ç¨‹ï¼š 1234# docker top 04b01b87b990PID USER TIME COMMAND8568 root 0:00 /bin/bash -c while true; do echo hello harry!; sleep 1; done8921 root 0:00 sleep 1 æŸ¥çœ‹å®¹å™¨å†…éƒ¨ç»†èŠ‚docker inspect å®¹å™¨ID è¿›å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨å¹¶ä»¥å‘½ä»¤è¡Œäº¤äº’å‰é¢å­¦åˆ°è¿‡ ä¸å…³é—­å®¹å™¨å¹¶é€€å‡º çš„å¿«æ·é”®æ˜¯ï¼šcontrl + p + qï¼Œé‚£ä¹ˆé€€å‡ºä¹‹åæ€ä¹ˆé‡æ–°è¿›å…¥å‘¢ï¼Ÿæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ã€‚ docker attach å®¹å™¨IDã€Œæ¼”ç¤ºã€ 12345678910111213141516171819202122232425262728# docker rm -f $(docker ps -aq) å…ˆæŠŠæ‰€æœ‰å®¹å™¨æ€æ­»# docker run -it --name='my-centos' centos ä»¥äº¤äº’å¼ç»ˆç«¯å¯åŠ¨å®¹å™¨[root@b7324d8b56b9 /]# pwd/[root@b7324d8b56b9 /]# lltotal 56-rw-r--r-- 1 root root 12082 Mar 5 17:36 anaconda-post.loglrwxrwxrwx 1 root root 7 Mar 5 17:34 bin -&gt; usr/bindrwxr-xr-x 5 root root 360 Apr 14 11:24 devdrwxr-xr-x 1 root root 4096 Apr 14 11:24 etcdrwxr-xr-x 2 root root 4096 Apr 11 2018 homelrwxrwxrwx 1 root root 7 Mar 5 17:34 lib -&gt; usr/liblrwxrwxrwx 1 root root 9 Mar 5 17:34 lib64 -&gt; usr/lib64drwxr-xr-x 2 root root 4096 Apr 11 2018 media......# ä½¿ç”¨å¿«æ·é”® control + p + q ä¸å…³é—­å®¹å™¨å¹¶é€€å‡º[root@b7324d8b56b9 /]# %# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESb7324d8b56b9 centos \"/bin/bash\" About a minute ago Up About a minute my-centos# å¯ä»¥çœ‹åˆ°å®¹å™¨ä¾ç„¶åœ¨è¿è¡Œï¼Œæ‰§è¡Œå‘½ä»¤ docker attach b7324d8b56b9 é‡æ–°è¿›å…¥ã€‚[root@b7324d8b56b9 /]# pwd/[root@b7324d8b56b9 /]# lsanaconda-post.log bin dev etc home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var docker exec -it å®¹å™¨ID bashShellã€Œæ¼”ç¤ºã€ è¿›å…¥å®¹å™¨å†…éƒ¨æ‰§è¡Œå‘½ä»¤ï¼š123456789101112131415161718# å…ˆä¸å…³é—­é€€å‡ºå®¹å™¨ control + p + q# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESb7324d8b56b9 centos \"/bin/bash\" 7 minutes ago Up 7 minutes my-centos# docker exec -it b7324d8b56b9 /bin/bash ä¸€æ ·è¿›å…¥äº†å®¹å™¨[root@60711933f7dd /]# pwd/[root@60711933f7dd /]# lsanaconda-post.log bin dev etc home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var# æ‰§è¡Œ exit å‘½ä»¤é€€å‡ºå®¹å™¨ï¼ŒPSï¼šè¿™é‡Œå®¹å™¨ä¼šå…³é—­å—ï¼Ÿ[root@60711933f7dd /]# exitexit# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES60711933f7dd centos \"/bin/bash\" 2 minutes ago Up 2 minutes my-centos# å¯ä»¥çœ‹åˆ°ï¼Œä»¥ exec æ–¹å¼è¿›å…¥çš„å®¹å™¨æ‰§è¡Œ exit å¹¶ä¸ä¼šå…³é—­å®¹å™¨ã€‚ ä¸è¿›å…¥å®¹å™¨ï¼Œåœ¨å®¿ä¸»æœºæ‰§è¡Œå®¹å™¨å†…éƒ¨å‘½ä»¤ï¼š12345678910111213141516# docker exec -it 60711933f7dd ls -l /usrtotal 68dr-xr-xr-x 2 root root 16384 Mar 5 17:36 bindrwxr-xr-x 2 root root 4096 Apr 11 2018 etcdrwxr-xr-x 2 root root 4096 Apr 11 2018 gamesdrwxr-xr-x 3 root root 4096 Mar 5 17:35 includedr-xr-xr-x 19 root root 4096 Mar 5 17:36 libdr-xr-xr-x 24 root root 16384 Mar 5 17:36 lib64drwxr-xr-x 11 root root 4096 Mar 5 17:36 libexecdrwxr-xr-x 12 root root 4096 Mar 5 17:34 localdr-xr-xr-x 2 root root 4096 Mar 5 17:36 sbindrwxr-xr-x 52 root root 4096 Mar 5 17:36 sharedrwxr-xr-x 4 root root 4096 Mar 5 17:34 srclrwxrwxrwx 1 root root 10 Mar 5 17:34 tmp -&gt; ../var/tmpharry@192 ~/Learning/docker-note# è¿™é‡Œä»¥ linux ä¸­çš„ `ls -l /usr` å‘½ä»¤ä»£æ›¿ä¸Šé¢çš„ `/bin/bash` å‘½ä»¤æŸ¥çœ‹äº†å®¹å™¨ centos ä¸­çš„ /usr ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿”å›çš„ç»“æœç›´æ¥å±•ç¤ºåˆ°äº†å®¿ä¸»æœºä¸Šï¼ˆå³ï¼šæœ¬æœºMacOSï¼‰ ä¸¤è€…çš„åŒºåˆ«ï¼š attachï¼šç›´æ¥è¿›å…¥å®¹å™¨å¯åŠ¨å‘½ä»¤çš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„è¿›ç¨‹ã€‚ execï¼šæ˜¯åœ¨å®¹å™¨ä¸­æ‰“å¼€æ–°çš„ç»ˆç«¯ï¼Œå¹¶ä¸”å¯ä»¥å¯åŠ¨æ–°çš„è¿›ç¨‹ã€‚ ä»å®¹å™¨å†…æ‹·è´æ–‡ä»¶åˆ°ä¸»æœºä¸Šdocker cp å®¹å™¨ID:å®¹å™¨å†…è·¯å¾„ å®¿ä¸»æœºè·¯å¾„ å®¹å™¨å…³é—­å…¶è¿è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ•°æ®æ–‡ä»¶éƒ½ä¼šä¸¢å¤±ï¼Œæ‰€ä»¥éœ€è¦æŠŠå®¹å™¨ä¸­çš„æ•°æ®æ–‡ä»¶æ‹·è´åˆ°å®¿ä¸»æœºä¸Šã€‚ 123456789101112131415# docker attach 60711933f7dd è¿›å…¥å®¹å™¨[root@60711933f7dd /]# lltotal 56-rw-r--r-- 1 root root 12082 Mar 5 17:36 anaconda-post.log# çœ‹åˆ°æœ‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œå°†å…¶å¤åˆ¶åˆ°å®¿ä¸»æœºï¼Œå…ˆå®¿ä¸»æœºå½“å‰æ–‡ä»¶ï¼šharry@192 ~/Learning/docker-note lltotal 40-rw-r--r--@ 1 harry staff 17K 4 14 19:56 Dockerç¬”è®°.md# å¯ä»¥çœ‹åˆ°å½“å‰å®¿ä¸»å¥åªæœ‰ä¸€ä¸ªæ–‡ä»¶ã€‚å°†å®¹å™¨ä¸­çš„ anaconda-post.log å¤åˆ¶åˆ°å½“å‰æ–‡ä»¶å¤¹ ~/Learning/docker-note# control + p + q éœ€è¦å…ˆé€€å‡ºå®¹å™¨# docker cp 60711933f7dd:/anaconda-post.log ./ å¤åˆ¶åˆ°å½“å‰ç›®å½•ä¸‹# ll æŸ¥çœ‹å½“å‰å®¿ä¸»æœºæ–‡ä»¶total 64-rw-r--r--@ 1 harry staff 17K 4 14 20:01 Dockerç¬”è®°.md-rw-r--r-- 1 harry staff 12K 3 6 01:36 anaconda-post.log é•œåƒåŸç†æ˜¯ä»€ä¹ˆ é•œåƒæ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œç”¨æ¥æ‰“åŒ…è½¯ä»¶è¿è¡Œç¯å¢ƒå’ŒåŸºäºè¿è¡Œç¯å¢ƒå¼€å‘çš„è½¯ä»¶ã€‚å®ƒåŒ…å«è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»£ç ã€åº“ã€ç¯å¢ƒã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚ UnionFSï¼ˆè”åˆæ–‡ä»¶ç³»ç»Ÿï¼‰ unionFS æ˜¯ä¸€ç§åˆ†å±‚ã€è½»é‡çº§å¹¶ä¸”é«˜æ€§èƒ½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæ”¯æŒ å¯¹æ–‡ä»¶ç³»ç»Ÿçš„ä¿®æ”¹ä½œä¸ºä¸€æ¬¡æäº¤æ¥ä¸€å±‚å±‚çš„å åŠ ï¼ŒåŒæ—¶å¯ä»¥å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸‹ã€‚\\è”åˆæ–‡ä»¶ç³»ç»Ÿæ˜¯ Docker é•œåƒçš„åŸºç¡€ã€‚é•œåƒå¯ä»¥é€šè¿‡åˆ†å±‚æ¥ç»§æ‰¿ï¼ŒåŸºäºåŸºç¡€é•œåƒï¼ˆæ²¡æœ‰çˆ¶é•œåƒï¼‰ï¼Œå¯ä»¥åˆ¶ä½œå„ç§å…·ä½“çš„é•œåƒã€‚ ç‰¹æ€§ï¼šä¸€æ¬¡åŒæ—¶åŠ è½½å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä½†ä»å¤–é¢çœ‹æ¥ï¼Œåªèƒ½çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚è”åˆåŠ è½½ä¼šæŠŠå„å±‚æ–‡ä»¶ç³»ç»Ÿå åŠ èµ·æ¥ï¼Œè¿™æ ·æœ€ç»ˆçš„æ–‡ä»¶ç³»ç»Ÿä¼šåŒ…å«æ‰€æœ‰åº•å±‚çš„æ–‡ä»¶å’Œç›®å½•ã€‚ Docker é•œåƒåŠ è½½åŸç†ä¸ºä»€ä¹ˆ Docker é•œåƒè¦é‡‡ç”¨åˆ†å±‚çš„ç»“æ„å…±äº«èµ„æºã€‚å¦‚ï¼šæœ‰å¤šä¸ªé•œåƒéƒ½æ˜¯ä»ç›¸åŒçš„ base é•œåƒæ„å»ºè€Œæ¥ï¼Œé‚£ä¹ˆå®¿ä¸»æœºåªéœ€è¦åœ¨ç£ç›˜ä¸Šä¿å­˜ä¸€ä»½ base é•œåƒã€‚åŒæ—¶å†…å­˜ä¸­ä¹Ÿç¥éœ€è¦åŠ è½½ä¸€ä»½ base é•œåƒï¼Œå°±å¯ä»¥ä¸ºæ‰€æœ‰çš„å®¹å™¨æœåŠ¡äº†ã€‚è€Œä¸”é•œåƒçš„æ¯ä¸€å±‚éƒ½å¯ä»¥å…±äº«ã€‚ ç‰¹ç‚¹Docker é•œåƒéƒ½æ˜¯åªè¯»çš„ã€‚å½“å®¹å™¨å¯åŠ¨æ—¶ï¼Œä¸€ä¸ªæ–°çš„å¯å†™å±‚è¢«åŠ è½½åˆ°é•œåƒçš„é¡¶éƒ¨ã€‚è¿™ä¸€å±‚é€šå¸¸è¢«ç§°ä¸ºã€Œå®¹å™¨å±‚ã€ï¼Œå®¹å™¨å±‚ä¹‹ä¸‹çš„éƒ½å«åšã€Œé•œåƒå±‚ã€ã€‚ é•œåƒçš„ commit æ“ä½œdocker commit æäº¤å®¹å™¨å‰¯æœ¬ä½¿ä¹‹æˆä¸ºä¸€ä¸ªæ–°çš„é•œåƒ docker commit -m=â€æäº¤çš„æè¿°ä¿¡æ¯â€ -a=â€ä½œè€…â€ å®¹å™¨ID è¦åˆ›å»ºçš„é•œåƒå[:æ ‡ç­¾å] ã€Œæ¼”ç¤ºã€ 1. ä» DockerHub ä¸Šä¸‹è½½ tomcat é•œåƒåˆ°æœ¬åœ°å¹¶æˆåŠŸè¿è¡Œ 1234567891011121314151617181920212223# docker pull tomcatUsing default tag: latestlatest: Pulling from library/tomcate79bb959ec00: Pull completed4b7902036fe: Pull complete1b2a72d4e030: Pull completede423484a946: Pull completeceaac3b844f7: Pull complete88f01b722a52: Pull completec23be56a9ac1: Pull completed852ffd6d31f: Pull complete11775a3d792d: Pull complete13fdd17462ac: Pull complete2092995a1e54: Pull completeDigest: sha256:409501d73062ab508930eab827fcb19d7d3f7e9bbe63bc6d587114c6af4bee12Status: Downloaded newer image for tomcat:latest# ä»¥äº¤äº’å¼ç»ˆç«¯å¹¶ã€Œæ˜ å°„å®¹å™¨ç«¯å£åˆ°å®¿ä¸»æœºæŒ‡å®šç«¯å£ã€è¿è¡Œ tomcat# docker run -it -p 8888:8080 --name='my-tomcat' tomcat# æ—¥å¿—å¤ªå¤šä¸å±•ç¤ºäº†ï¼Œæ‰§è¡Œã€Œé€€å‡ºä¸å…³é—­å®¹å™¨ control + p + qã€ã€‚# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESc492f4bbce3e tomcat \"catalina.sh run\" About a minute ago Up About a minute 0.0.0.0:8888-&gt;8080/tcp my-tomcat# å¯ä»¥çœ‹åˆ°å®¹å™¨ä¸­çš„ 8080 ç«¯å£å·²ç»æ˜ å°„åˆ°äº†å®¿ä¸»æœºä¸Šçš„ 8888 ç«¯å£ï¼Œè®¿é—® http://localhost:8888 å¯ä»¥æ­£å¸¸è®¿é—®ã€‚ PSï¼šè¿è¡Œ tomcat ä¸ä»¥äº¤äº’å¼ç»ˆç«¯ -it ä¹Ÿå¯ä»¥ï¼Œå› ä¸ºå…¶æœ‰å‰å°è¿›ç¨‹è¿è¡Œï¼ˆæ—¥å¿—æ‰“å°ï¼‰ï¼Œæ‰€ä»¥å®¹å™¨ä¸ä¼šé€€å‡ºã€‚ 123456789# docker rm -f $(docker ps -aq) å…ˆåˆ é™¤åŸæœ‰å®¹å™¨# docker run -d -p 8888:8080 --name='my-tomcat' tomcat96dad0f6272538e8a1c3359a42d0a6493814f1972c8adf86087dbd322d1033e6# docker logs -f -t --tail 10 96dad0f62725 æŸ¥çœ‹æ—¥å¿—ï¼šé€æ¡è¿½åŠ ï¼Œæ˜¾ç¤ºæ—¥æœŸï¼Œä»å€’æ•°ç¬¬ 10 æ¡å¼€å§‹ã€‚......org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/usr/local/tomcat/webapps/manager] has finished in [18] ms2019-04-14T16:44:25.733314600Z 14-Apr-2019 16:44:25.732 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [\"http-nio-8080\"]2019-04-14T16:44:25.749280600Z 14-Apr-2019 16:44:25.748 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [\"ajp-nio-8009\"]2019-04-14T16:44:25.754519300Z 14-Apr-2019 16:44:25.754 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in 889 ms ä½¿ç”¨ -P å‚æ•°å°†ä¼šéšæœºåˆ†é…å®¿ä¸»æœºç«¯å£æ˜ å°„ç»™å®¹å™¨ã€‚ 2. æ•…æ„åˆ é™¤ä¸Šä¸€æ­¥é•œåƒç”Ÿäº§ tomcat å®¹å™¨çš„æ–‡æ¡£ å…ˆè®¿é—® http://localhost:8888 æŸ¥çœ‹ document é¡µé¢ï¼š ç‚¹å‡» Documentationï¼Œå¯ä»¥æ­£å¸¸çœ‹åˆ°é¡µé¢: 1234567# é‡æ–°è¿›å…¥ä¸Šé¢å¯åŠ¨çš„ tomcat å®¹å™¨# docker exec -it 96dad0f62725 /bin/bashroot@96dad0f62725:/usr/local/tomcat# pwd/usr/local/tomcat# åˆ é™¤å½“å‰ tomcat åº”ç”¨çš„ document æ–‡æ¡£é¡µé¢root@96dad0f62725:/usr/local/tomcat# rm -rf webapps/docs/root@96dad0f62725:/usr/local/tomcat# åˆ·æ–°æ–‡æ¡£é¡µé¢å†æ¬¡æŸ¥çœ‹ï¼š PSï¼šè¿™åªæ˜¯ä¿®æ”¹äº†å½“å‰å®¹å™¨çš„ tomcatï¼Œå¹¶æ²¡æœ‰ commit ä½œä¸ºä¸€ä¸ªæ–°å®¹å™¨ã€‚æ‰€ä»¥å½“å½“å‰å®¹å™¨è¢«åˆ é™¤ä¹‹åä¿®æ”¹çš„å†…å®¹ä¹Ÿéšç€è¢«åˆ é™¤äº†ï¼Œå¦‚éœ€è¦ä¿å­˜ä¿®æ”¹åçš„å†…å®¹ï¼Œå¯ä»¥ commit è¿™ä¸ªå®¹å™¨ä½œä¸ºä¸€ä¸ªæ–°çš„é•œåƒã€‚ 3. ä¹Ÿå³å½“å‰çš„ tomcat è¿è¡Œå®ä¾‹æ˜¯ä¸€ä¸ªæ²¡æœ‰æ–‡æ¡£å†…å®¹çš„å®¹å™¨ã€‚ä»¥å®ƒä¸ºæ¨¡ç‰ˆ commit ä¸€ä¸ªæ²¡æœ‰ doc çš„ tommcat æ–°é•œåƒ my-tomcat 12345678910111213# docker exec -it 1b498158b4ee7fc71d80d9da9ba30d890fa5cddcffb7d1edbffbbfe21b4d2317 /bin/bashroot@1b498158b4ee:/usr/local/tomcat# pwd/usr/local/tomcatroot@1b498158b4ee:/usr/local/tomcat# rm -rf webapps/docs/root@1b498158b4ee:/usr/local/tomcat# exitexit # è¿™é‡Œåªæ˜¯é€€å‡ºæ–°å¼€çš„ç»ˆç«¯è¿›ç¨‹ï¼Œå®é™…ä¸Šæ²¡æœ‰é€€å‡º tomcat çš„è¿›ç¨‹ã€‚# æ‰§è¡Œ docker commit -m=\"del tomcat documentation\" -a=\"harry\" 1b498158b izhiliu/tomcat2:v2# é•œåƒåè§„èŒƒï¼šç»„ç»‡å/é•œåƒå:TAGsha256:cf18ff34c415b8ca05494a3d6faa276a0b1229cffb5563cffbb8f0af533b6f47# å¯ä»¥çœ‹åˆ°æ‰§è¡ŒæˆåŠŸä¹‹åè¿”å›äº†æ–°çš„é•œåƒçš„å”¯ä¸€æ ‡è¯†ï¼Œå†æŸ¥çœ‹ä¸€ä¸‹é•œåƒï¼šdocker image ls | grep tomcatizhiliu/tomcat2 v2 cf18ff34c415 About a minute ago 465MBtomcat latest 5a069ba3df4d 41 hours ago 465MB# åˆšåˆšæ–°å»ºçš„é•œåƒå·²ç»å­˜åœ¨äº†ï¼Œå¯åŠ¨ä¸€ä¸‹çœ‹çœ‹ï¼šdocker run -d -p 8080:8080 izhiliu/tomcat2:v2 å¯ä»¥çœ‹åˆ°æ–°çš„å®¹å™¨å·²ç»æ²¡æœ‰ documentation é¡µé¢äº†ã€‚ 4. å¯åŠ¨æˆ‘ä»¬ commit åçš„æ–°æ™¯è±¡å¹¶å’ŒåŸæ¥çš„å¯¹æ¯” å®˜æ–¹çš„ tomcat:latest æœ‰ Documentation é¡µé¢ è‡ªå®šä¹‰çš„ izhiliu/tomcat:v2 æ²¡æœ‰ Documentation é¡µé¢ å®¹å™¨æ•°æ®å· Docker çš„ç†å¿µ å°†åº”ç”¨ä¸è¿è¡Œçš„ç¯å¢ƒæ‰“åŒ…å½¢æˆå®¹å™¨è¿è¡Œï¼Œè¿è¡Œå¯ä»¥ä¼´éšç€å®¹å™¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯¹æ•°æ®çš„è¦æ±‚æ˜¯æŒä¹…åŒ–çš„ã€‚ å®¹å™¨ä¹‹é—´å¸Œæœ›æœ‰å¯èƒ½å…±äº«æ•°æ® Docker å®¹å™¨è¿è¡Œæ—¶äº§ç”Ÿçš„æ•°æ®ï¼Œå¦‚æœä¸é€šè¿‡ docker commit ç”Ÿæˆæ–°çš„é•œåƒï¼Œä½¿å¾—æ•°æ®ä½œä¸ºé•œåƒçš„ä¸€éƒ¨åˆ†ä¿å­˜ä¸‹æ¥ï¼Œé‚£ä¹ˆå½“å®¹å™¨åˆ é™¤åï¼Œæ•°æ®è‡ªç„¶ä¹Ÿå°±æ²¡æœ‰äº†ã€‚ ä¹‹å‰å­¦åˆ°è¿‡ä¸€ä¸ªå‘½ä»¤ã€Œä»å®¹å™¨æ‹·è´æ•°æ®åˆ°å®¿ä¸»æœºã€ï¼šdocker cp å®¹å™¨ID:å®¹å™¨è·¯å¾„ å®¿ä¸»æœºè·¯å¾„ ä½†æ˜¯è¿™åªèƒ½å®ç°å°†æ•°æ®æ‰‹åŠ¨ä¿å­˜ï¼Œå¹¶ä¸èƒ½å®ç°å®¹å™¨ä¹‹é—´çš„æ•°æ®å…±äº«ã€‚è§£å†³è¿™ç§éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ docker çš„æ•°æ®å· ä½œç”¨ä¸€ï¼‰å®¹å™¨æŒä¹…åŒ– äºŒï¼‰å®¹å™¨é—´ç»§æ‰¿ + æ•°æ®å…±äº« æ¦‚å¿µ å·å°±æ˜¯ç›®å½•æˆ–æ–‡ä»¶ï¼Œå­˜åœ¨äºä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ä¸­ï¼Œç”± Docker æŒ‚è½½åˆ°å®¹å™¨ï¼Œä½†ä¸å±äºè”åˆæ–‡ä»¶ç³»ç»Ÿï¼Œå› æ­¤å¯ä»¥èƒ½å¤Ÿç»•è¿‡ UnionFS æä¾›çš„ä¸€äº›ç”¨äºæŒä¹…å­˜å‚¨æˆ–å…±äº«æ•°æ®çš„ç‰¹æ€§ã€‚\\å·è®¾è®¡çš„ç›®çš„å°±æ˜¯æ•°æ®çš„æŒä¹…åŒ–ï¼Œå®Œå…¨ç‹¬ç«‹äºå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œå› æ­¤ Docker ä¸ä¼šåœ¨åˆ é™¤å®¹å™¨æ—¶åˆ é™¤å…¶æŒ‚è½½çš„æ•°æ®å·ã€‚ ç‰¹ç‚¹ï¼š æ•°æ®å·å¯åœ¨å®¹å™¨ä¹‹é—´å…±äº«æˆ–é‡ç”¨æ•°æ® å·ä¸­çš„æ›´æ”¹å¯ä»¥ç›´æ¥ç”Ÿæ•ˆ æ•°æ®å·ä¸­çš„æ›´æ”¹ä¸ä¼šåŒ…å«åœ¨é•œåƒçš„æ›´æ–°ä¸­ æ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­å¤§æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä¸ºæ­¢ ä½¿ç”¨ä¸€ï¼šå‘½ä»¤æ–¹å¼æŒ‚è½½æ•°æ®å·docker run -it -v /å®¿ä¸»æœºæ–‡ä»¶ç»å¯¹è·¯å¾„:/å®¹å™¨å†…è·¯å¾„ é•œåƒå ã€Œæ¼”ç¤ºï¼šæŸ¥çœ‹æ•°æ®å·æŒ‚è½½æ˜¯å¦æˆåŠŸã€ 12345678910111213141516171819202122232425262728# ä»¥æ•°æ®å·æŒ‚è½½æ–¹å¼é‡æ–°å¯åŠ¨å®¹å™¨# -----------------------------------------------------------------# docker run -it -v ~/Learning/docker-note/host-data-volumes:/container-data-volumes centos# PSï¼šä¸€å®šè¦ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œå®¿ä¸»æœºç›®å½•å’Œå®¹å™¨ç›®å½•è‹¥ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º# æŸ¥çœ‹å®¿ä¸»æœºæ–‡ä»¶# -----------------------------------------------------------------# pwd/Users/harry/Learning/docker-note# lltotal 80-rw-r--r--@ 1 harry staff 26K 4 15 21:12 README.md-rw-r--r-- 1 harry staff 12K 3 6 01:36 anaconda-post.logdrwxr-xr-x 2 harry staff 64B 4 15 21:11 host-data-volumes # è¢«æ–°åˆ›å»ºçš„æ–‡ä»¶å¤¹drwxr-xr-x 5 harry staff 160B 4 15 01:14 img# æŸ¥çœ‹å®¹å™¨æ–‡ä»¶# -----------------------------------------------------------------# pwd/# lltotal 56-rw-r--r-- 1 root root 12082 Mar 5 17:36 anaconda-post.loglrwxrwxrwx 1 root root 7 Mar 5 17:34 bin -&gt; usr/bindrwxr-xr-x 2 root root 64 Apr 15 13:11 container-data-volumes # è¢«åˆ›å»ºçš„æ–‡ä»¶å¤¹drwxr-xr-x 5 root root 360 Apr 15 13:11 devdrwxr-xr-x 1 root root 4096 Apr 15 13:11 etc...... 1ä½¿ç”¨ ã€Œdocker inspect å®¹å™¨IDã€ æŸ¥çœ‹å®¹å™¨æ˜¯å¦æŒ‚è½½æˆåŠŸ ã€Œæ¼”ç¤ºï¼šå®¹å™¨ä¸å®¿ä¸»æœºä¹‹é—´å…±äº«æ•°æ®ã€ 1234567891011121314151617181920212223242526# æŸ¥çœ‹å®¿ä¸»æœºæ•°æ®å·ç»‘å®šæ–‡ä»¶è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶# pwd/Users/harry/Learning/docker-note/host-data-volumes# lltotal 0# -----------------------------------------------------# æŸ¥çœ‹å®¹å™¨ä¸­æ•°æ®å·ç»‘å®šæ–‡ä»¶è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶# pwd/container-data-volumes# lltotal 0# -----------------------------------------------------# åˆ†åˆ«åœ¨å®¿ä¸»æœºå’Œå®¹å™¨æ•°æ®å·ç»‘å®šçš„ç›®å½•ä¸­åˆ›å»ºä¸åŒçš„æ–‡ä»¶ï¼Œè§‚å¯Ÿæ–‡ä»¶æ˜¯å¦åŒæ­¥è¿‡å»äº†# åœ¨å®¿ä¸»æœºåˆ›å»ºæ–‡ä»¶ touch host.txt &amp;&amp; ll-rw-r--r-- 1 harry staff 0B 4 15 21:25 host.txt# åœ¨å®¹å™¨ä¸­åˆ›å»ºæ–‡ä»¶ touch contianer.txt &amp;&amp; ll-rw-r--r-- 1 root root 0 Apr 15 13:26 contianer.txt # å®¹å™¨åˆ›å»ºçš„-rw-r--r-- 1 root root 0 Apr 15 13:25 host.txt # å‰é¢å®¿ä¸»æœºåˆ›å»ºçš„# å¯ä»¥çœ‹åˆ°ï¼Œæ–‡ä»¶åˆ›å»ºæˆåŠŸäº†å¹¶ä¸”åˆšåˆšåœ¨å®¿ä¸»æœºåˆ›å»ºçš„æ–‡ä»¶å·²ç»åŒæ­¥åˆ°äº†å®¹å™¨ä¸­ã€‚# å†è§‚å¯Ÿå®¿ä¸»æœºæœ‰æ²¡æœ‰åŒæ­¥å®¹å™¨çš„æ–‡ä»¶è¿‡æ¥ ll-rw-r--r-- 1 harry staff 0B 4 15 21:26 contianer.txt-rw-r--r-- 1 harry staff 0B 4 15 21:25 host.txt ã€Œæ¼”ç¤ºï¼šå®¹å™¨åœæ­¢åï¼Œä¸»æœºä¿®æ”¹åçš„æ•°æ®æ˜¯å¦ä¼šåŒæ­¥åˆ°å®¹å™¨ä¸­ã€ 123456789101112# åœæ­¢å®¹å™¨ / æˆ–è€…åˆ é™¤å®¹å™¨é‡æ–°å»ºç«‹æ•°æ®å·ï¼ˆå®¿ä¸»æœºçš„ç›®å½•ä¸å˜ï¼‰# exit# å®¿ä¸»æœºä¿®æ”¹æ–‡ä»¶ï¼š echo 'host update' &gt;&gt; host.txt &amp;&amp; cat host.txthost update# å¯åŠ¨å®¹å™¨ï¼ŒæŸ¥çœ‹æ–‡ä»¶å†…å®¹# docker start 30a574c0dbe1# docker attach 30a574c0dbe1# cd container-data-volumes/ &amp;&amp; cat host.txthost update# å¯ä»¥çœ‹åˆ°å†…å®¹ä¿®æ”¹æˆåŠŸåŒæ­¥è¿‡æ¥ï¼Œé‡æ–°åˆ›å»ºçš„å®¹å™¨æ–‡ä»¶ä¹Ÿæ˜¯ä¸€æ ·çš„ä¼šè¢«åŒæ­¥è¿‡æ¥ã€‚ ã€Œæ¼”ç¤ºï¼šä½¿ç”¨å¸¦æƒé™çš„æŒ‚è½½å‘½ä»¤ã€ docker run -it -v /å®¿ä¸»æœºæ–‡ä»¶ç»å¯¹è·¯å¾„:/å®¹å™¨å†…è·¯å¾„:ro é•œåƒå :ro read only 123456789101112# åˆ é™¤åˆšåˆšåˆ›å»ºçš„å®¹å™¨# docker rm -f $(docker ps -aq)# å¸¦æƒé™çš„æŒ‚è½½æ•°æ®å·# docker run -it -v ~/Learning/docker-note/host-data-volumes/:/container-data-volumes:ro centos# ä¾æ—§æŸ¥çœ‹å®¿ä¸»æœºæ–‡ä»¶æ˜¯å¦åŒæ­¥åˆ°ä½# cd container-data-volumes/ &amp;&amp; ll-rw-r--r-- 1 root root 0 Apr 15 13:26 contianer.txt-rw-r--r-- 1 root root 12 Apr 15 13:32 host.txt# é‡ç‚¹æ¥äº†ï¼Œå®¹å™¨ä¿®æ”¹å…±äº«æ–‡ä»¶å¤¹ï¼ˆæ•°æ®å·ï¼‰çš„æ•°æ®# touch modify.txttouch: cannot touch 'modify.txt': Read-only file system :vo é™åˆ¶äº†å®¹å™¨å¯¹æ•°æ®å·çš„å†™æƒé™ï¼Œä½¿å¾—å®¹å™¨åªèƒ½å¤Ÿè¯»æ•°æ®ã€‚æŸ¥çœ‹ docker inspect 75b1409b8a9e: ä½¿ç”¨äºŒï¼š DockerFile æŒ‚è½½æ•°æ®å·DockerFile çš„æ¦‚å¿µå…ˆä¸è®¨è®ºï¼Œé‡ç‚¹åœ¨äºæ€ä¹ˆä½¿ç”¨ DockerFile å®ç°å®¿ä¸»æœºä¸å®¹å™¨ä¹‹é—´çš„ç›®å½•æŒ‚è½½ã€‚ ã€Œæ­¥éª¤ã€ 1ï¼‰åˆ›å»º DockerFile æ‰€å±ç›®å½• 1234567mkdir dockerfile-volumes &amp;&amp; lltotal 88-rw-r--r--@ 1 harry staff 29K 4 17 23:46 README.md-rw-r--r-- 1 harry staff 12K 3 6 01:36 anaconda-post.logdrwxr-xr-x 2 harry staff 64B 4 17 23:48 dockerfile-volumes # å­˜æ”¾ DockerFile çš„æ–‡ä»¶å¤¹drwxr-xr-x 4 harry staff 128B 4 17 23:22 host-data-volumesdrwxr-xr-x 7 harry staff 224B 4 15 21:47 img 2ï¼‰ ç¼–å†™ Dockerfile æ–‡ä»¶ï¼Œåœ¨ DockerFile ä¸­é€šè¿‡ VOLUME æŒ‡ä»¤ç»™é•œåƒæ·»åŠ ã€Œä¸€ä¸ªæˆ–å¤šä¸ªã€æ•°æ®å·ã€‚ 1PS: ä»¥å‘½ä»¤æ–¹å¼åªèƒ½æŒ‚è½½ä¸€ä¸ªæ•°æ®å· cd dockerfile-volumes &amp;&amp; touch Dockerfile æ·»åŠ ä»¥ä¸‹å†…å®¹123456# Volume Dockerfile æ–¹å¼æŒ‚è½½æ•°æ®å·æµ‹è¯•FROM centos# æŒ‚è½½å‘½ä»¤VOLUME [\"/data-volumes-container1\",\"/data-volumes-container2\"]CMD echo \"image is building...\"CMD /bin/bash PSï¼šVOLUMEå‘½ä»¤æŒ‡å®šäº†åˆ†åˆ«åœ¨å®¹å™¨ä¸ŠæŒ‚è½½ä¸¤ä¸ªç›®å½•ï¼š/data-volumes-container1 / /data-volumes-container2ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‡å®šå®¿ä¸»æœºç›®å½•ã€‚è¿™æ˜¯å› ä¸ºä¸€ä¸ªé•œåƒä¼šè¢«ä¸åŒçš„å®¿ä¸»æœºè¿è¡Œï¼Œä½†æ˜¯å®¿ä¸»æœºè·¯å¾„ä¸æ˜¯æ¯ä¸ªæ‰§è¡Œé•œåƒçš„å®¿ä¸»æœºéƒ½æ˜¯ç›¸åŒçš„ã€‚é€šè¿‡ DockerFile æŒ‚è½½çš„æ•°æ®å·å®¿ä¸»æœºç›®å½•ä¼šè¢«é»˜è®¤åˆ†é…ã€‚ 3ï¼‰æ‰§è¡Œæ„å»ºå‘½ä»¤ docker build -f /Dockerfileåï¼ˆè·¯å¾„ï¼‰ -t é•œåƒå:TAG . -fï¼šæŒ‡å®š Dockerfile åï¼ˆè·¯å¾„ï¼‰ï¼Œå¦‚æœå°±åœ¨å½“å‰ç›®å½•æ‰§è¡Œå¯ä»¥ä¸åŠ ã€‚ -tï¼šæŒ‡å®šé•œåƒå 12345678910111213141516171819202122232425262728# docker build -f ~/Learning/docker-note/dockerfile-volumes/Dockerfile -t yuzh/centos:v1 .Sending build context to Docker daemon 2.048kBStep 1/4 : FROM centos ---&gt; 9f38484d220fStep 2/4 : VOLUME ['/data-volumes-container1','data-volumes-container2'] # æŒ‚è½½å‘½ä»¤ ---&gt; Running in 0ad66b7ad4f9Removing intermediate container 0ad66b7ad4f9 ---&gt; 1fad13e698d5Step 3/4 : CMD echo \"image is building...\" ---&gt; Running in 2a90e6187e24Removing intermediate container 2a90e6187e24 ---&gt; fc3713190c97Step 4/4 : CMD /bin/bash ---&gt; Running in 2a361cb58947Removing intermediate container 2a361cb58947 ---&gt; 31f766043abfSuccessfully built 31f766043abfSuccessfully tagged yuzh/centos:v1# docker image lsREPOSITORY TAG IMAGE ID CREATED SIZEyuzh/centos v1 31f766043abf 33 seconds ago 202MBizhiliu/tomcat2 v2 cf18ff34c415 2 days ago 465MB# docker run -it yuzh/centos:v1 è¿è¡Œæ„å»ºçš„é•œåƒæŸ¥çœ‹æ•°æ®å·æ˜¯å¦å­˜åœ¨# lldrwxr-xr-x 2 root root 4096 Apr 17 16:24 data-volumes-container1drwxr-xr-x 2 root root 4096 Apr 17 16:24 data-volumes-container2 4ï¼‰docker inspect å®¹å™¨ID æŸ¥çœ‹å®¿ä¸»æœºä½ç½®ï¼ŒéªŒè¯æ•°æ®å…±äº« ä½¿ç”¨ä¸‰ï¼šä½¿ç”¨æ•°æ®å·å®¹å™¨å®ç°æ•°æ®å…±äº«å®ç°å®¹å™¨é—´æ•°æ®å…±äº«çš„ç¬¬ä¸‰ç§æ–¹å¼ï¼Œä½¿ç”¨å‘½ä»¤ï¼š docker run -it â€“volumes-from çˆ¶å®¹å™¨ID é•œåƒID ã€Œæ¼”ç¤ºã€ æ²¿ç”¨ä¹‹å‰é€šè¿‡ Dockerfile åˆ›å»ºçš„é•œåƒ ä¸€ï¼‰ç»§æ‰¿ä¸è¢«ç»§æ‰¿å®¹å™¨ä¹‹é—´çš„æ•°æ®å…±äº«ï¼š 1234567891011121314151617181920# å¯åŠ¨ç¬¬ä¸€ä¸ªå®¹å™¨ï¼Œä½œä¸ºçˆ¶å®¹å™¨# docker run -it --name container01 yuzh/centos:v1# ll è‡ªç„¶è€Œç„¶çš„å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªæ•°æ®å·æ–‡ä»¶drwxr-xr-x 2 root root 4096 Apr 18 16:19 data-volumes-container1drwxr-xr-x 2 root root 4096 Apr 18 16:19 data-volumes-container2# è¿›å» data-volumes-container1ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶# touch container01.txt &amp;&amp; ll-rw-r--r-- 1 root root 0 Apr 18 16:21 container01.txt# ä¸åœæ­¢é€€å‡ºï¼Œåˆ›å»ºç¬¬äºŒä¸ªå®¹å™¨ï¼Œç»§æ‰¿ç¬¬ä¸€ä¸ªå®¹å™¨ä½œä¸ºæ•°æ®å·å®¹å™¨# docker run -it --name container02 --volumes-from container01 yuzh/centos:v1# cd data-volumes-container1 &amp;&amp; ll-rw-r--r-- 1 root root 0 Apr 18 16:21 container01.txt# å¯ä»¥çœ‹åˆ°å®¹å™¨1åˆ›å»ºçš„æ–‡ä»¶åŒæ­¥è¿‡æ¥äº†ï¼Œåœ¨å®¹å™¨2åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè§‚å¯Ÿå®¹å™¨1æ˜¯å¦åŒæ­¥ï¼š# touch container01.txt# docker attach container01# cd data-volumes-container1 &amp;&amp; ll-rw-r--r-- 1 root root 0 Apr 18 16:27 container01.txt-rw-r--r-- 1 root root 0 Apr 18 16:27 container02.txt äºŒï¼‰ç›¸åŒçˆ¶å®¹å™¨çš„ä¸åŒå­å®¹å™¨ä¹‹é—´çš„æ•°æ®å…±äº« 12345678910111213141516171819202122# åˆ›å»ºç¬¬ä¸‰ä¸ªå®¹å™¨ï¼Œç»§æ‰¿å®¹å™¨1ï¼Œæ“ä½œå®¹å™¨3ï¼Œè§‚å¯Ÿå®¹å™¨1ã€2æ˜¯å¦éƒ½æœ‰æ•°æ®# docker run -it --name container03 --volumes-from container01 yuzh/centos:v1# cd data-volumes-container1 &amp;&amp; ll-rw-r--r-- 1 root root 0 Apr 18 16:27 container01.txt-rw-r--r-- 1 root root 0 Apr 18 16:27 container02.txt# è‡ªç„¶çš„çœ‹åˆ°äº†å®¹å™¨1ã€2ä¹‹é—´å…±äº«çš„æ•°æ®ï¼Œåœ¨å®¹å™¨3åˆ›å»ºæ–‡ä»¶ï¼š# touch container03.txt# å®¹å™¨1è‚¯å®šæ˜¯æœ‰æ­¤æ–‡ä»¶çš„ï¼Œå› ä¸ºå®¹å™¨3æ˜¯æŒ‚è½½åœ¨å®¹å™¨1ä¹‹ä¸Šçš„ã€‚# docker attach container01# cd data-volumes-container1 &amp;&amp; ll-rw-r--r-- 1 root root 0 Apr 18 16:27 container01.txt-rw-r--r-- 1 root root 0 Apr 18 16:27 container02.txt-rw-r--r-- 1 root root 0 Apr 18 16:34 container03.txt# é—®é¢˜æ¥äº†ï¼šå®¹å™¨2ä¼šæœ‰ container03.txt å—ï¼Ÿ# docker attach container02# cd data-volumes-container1 &amp;&amp; ll-rw-r--r-- 1 root root 0 Apr 18 16:27 container01.txt-rw-r--r-- 1 root root 0 Apr 18 16:27 container02.txt-rw-r--r-- 1 root root 0 Apr 18 16:34 container03.txt# ä¹Ÿæ˜¯æœ‰çš„ ä¸‰ï¼‰åˆ é™¤çˆ¶å®¹å™¨ï¼Œä¸¤ä¸ªå­å®¹å™¨ä¹‹é—´çš„æ•°æ®è¿˜ä¼šå…±äº«å—ï¼Ÿ 1234567891011121314151617181920212223242526# docker ps0bce4751cdf2 yuzh/centos:v1 \"/bin/sh -c /bin/bash\" 7 minutes ago Up 7 minutes container0398d3db76ca2c yuzh/centos:v1 \"/bin/sh -c /bin/bash\" 16 minutes ago Up 16 minutes container02fb12544f689b yuzh/centos:v1 \"/bin/sh -c /bin/bash\" 21 minutes ago Up 21 minutes container0# docker rm -f 0bce4751cdf20bce4751cdf2# è¿›å…¥å®¹å™¨2ï¼Œä¿®æ”¹æ–‡ä»¶ã€‚# docker attach container02# touch container02-update.txt &amp;&amp; ll-rw-r--r-- 1 root root 0 Apr 18 16:27 container01.txt-rw-r--r-- 1 root root 0 Apr 18 16:42 container02-update.txt-rw-r--r-- 1 root root 0 Apr 18 16:27 container02.txt-rw-r--r-- 1 root root 0 Apr 18 16:34 container03.txt# okï¼Œè¿›å…¥å®¹å™¨3ï¼Œè§‚å¯Ÿæ˜¯å¦æœ‰ container02-update.txt# [control + p + q]# docker exec -it fb12544f689b /bin/bash# cd data-volumes-container1 &amp;&amp; ll-rw-r--r-- 1 root root 0 Apr 18 16:27 container01.txt-rw-r--r-- 1 root root 0 Apr 18 16:42 container02-update.txt # å®¹å™¨2åˆ›å»ºçš„-rw-r--r-- 1 root root 0 Apr 18 16:27 container02.txt-rw-r--r-- 1 root root 0 Apr 18 16:34 container03.txt# å—¯ï¼Œæœ‰ç‚¹ä¸œè¥¿ï½# å®¹å™¨3ä¿®æ”¹æ–‡ä»¶è¿›å»å®¹å™¨2æŸ¥çœ‹ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„ä¼šè¢«åŒæ­¥ï¼Œä¸é‡å¤äº†ã€‚ã€‚ã€‚ ç»“è®ºï¼šå®¹å™¨ä¹‹é—´é…ç½®ä¿¡æ¯çš„ä¼ é€’ï¼Œæ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä¸ºæ­¢ã€‚ DockerFile DockerFile æ˜¯ç”¨æ¥æ„å»º Docker é•œåƒçš„æ„å»ºæ–‡ä»¶ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—å‚æ•°å’Œå‘½ä»¤æ„æˆçš„è„šæœ¬ã€‚ DockerFile è§„åˆ™ æ¯æ¡ä¿ç•™å­—æŒ‡ä»¤éƒ½å¿…é¡»ä¸ºå¤§å†™å­—æ¯ä¸”åé¢è¦è‡³å°‘åŒ…å«ä¸€ä¸ªå‚æ•° æŒ‡ä»¤æŒ‰ç…§ä»ä¸Šå¾€ä¸‹ï¼Œé¡ºåºæ‰§è¡Œã€‚ æ¯æ¡æŒ‡ä»¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒå±‚ï¼Œå¹¶å¯¹é•œåƒè¿›è¡Œæäº¤ã€‚ DockerFile æ‰§è¡Œæµç¨‹ docker ä»åŸºç¡€é•œåƒè¿è¡Œä¸€ä¸ªå®¹å™¨ æ‰§è¡Œä¸€æ¡æŒ‡ä»¤å¹¶å¯¹å®¹å™¨ä½œå‡ºä¿®æ”¹ æ‰§è¡Œç±»ä¼¼äº docker commit çš„æ“ä½œæäº¤ä¸€ä¸ªæ–°é•œåƒå±‚ docker å†åŸºäºåˆšæäº¤çš„é•œåƒè¿è¡Œä¸€ä¸ªæ–°å®¹å™¨ æ‰§è¡Œ dockerfile ä¸­çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ç›´åˆ°æ‰€æœ‰æŒ‡ä»¤éƒ½æ‰§è¡Œå®Œæˆ ä»åº”ç”¨è½¯ä»¶çš„è§’åº¦æ¥çœ‹ï¼ŒDockerFileã€Docker é•œåƒã€Docker å®¹å™¨åˆ†åˆ«ä»£è¡¨è½¯ä»¶çš„ä¸‰ä¸ªä¸åŒé˜¶æ®µ DockerFile æ˜¯è½¯ä»¶çš„åŸææ–™ Docker é•œåƒæ—¶è½¯ä»¶çš„äº¤ä»˜å“ Docker å®¹å™¨åˆ™å¯ä»¥è®¤ä¸ºæ˜¯è½¯ä»¶çš„è¿è¡Œæ€ DockerFile é¢å‘å¼€å‘ï¼ŒDocker é•œåƒæˆä¸ºäº¤ä»˜æ ‡å‡†ï¼ŒDocker å®¹å™¨è®¾è®¡éƒ¨ç½²ä¸è¿ç»´ã€‚ä¸‰è€…ç¼ºä¸€ä¸å¯ï¼ŒåˆåŠ›å……å½“ Docker ä½“ç³»çš„åŸºçŸ³ã€‚ DockerFile æŒ‡ä»¤FROM åŸºç¡€é•œåƒï¼Œå½“å‰æ–°é•œåƒæ˜¯åŸºäºå“ªä¸ªé•œåƒçš„ã€‚ LABLE ç”¨äºä¸ºé•œåƒæ·»åŠ åŸæ•°æ® LABLE key1=value1 key2=value2 â€¦ MAINTAINER é•œåƒç»´æŠ¤è€…çš„å§“åå’Œé‚®ç®±åœ°å€ å·²è¿‡æ—¶ï¼Œå»ºè®®ä½¿ç”¨ LABLE å½¢å¼ï¼šLABLE maintainer=&quot;harry&quot; RUN å®¹å™¨æ„å»ºæ—¶éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ EXPOSE å½“å‰å®¹å™¨å¯¹å¤–æš´éœ²çš„ç«¯å£å·ï¼Œéšæœºç«¯å£æ˜ å°„å°†ä¼šè‡ªåŠ¨æ˜ å°„æ­¤ç«¯å£ã€‚ WORKDIR æŒ‡å®šåœ¨å®¹å™¨åˆ›å»ºåï¼Œç»ˆç«¯ç™»é™†è¿›æ¥åé»˜è®¤çš„å·¥ä½œç›®å½•ï¼Œä¸€ä¸ªè½è„šç‚¹ã€‚ ENV åœ¨æ„å»ºæ—¶è®¾ç½®ç¯å¢ƒå˜é‡ 12345ENV MY_PATH /usr/mytestè¿™ä¸ªç¯å¢ƒå˜é‡å¯ä»¥åœ¨åç»­çš„ä»»ä½• RUN æŒ‡ä»¤ä¸­ä½¿ç”¨ï¼Œå¦‚åŒåœ¨å‘½ä»¤å‰é¢æŒ‡å®šäº†ç¯å¢ƒå˜é‡å‰ç¼€ä¸€æ ·ã€‚ä¹Ÿå¯ä»¥åœ¨å…¶ä»–æŒ‡ä»¤ä¸­ç›´æ¥ä½¿ç”¨è¿™äº›ç¯å¢ƒå˜é‡ï¼Œå¦‚ï¼šWORKDIR ${MY_PATH} ADD å°†å®¿ä¸»æœºä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸” ADD å‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç† URL å’Œè§£å‹ tar å‹ç¼©åŒ… COPY ç±»ä¼¼äº ADDï¼Œæ‹·è´æ–‡ä»¶å’Œç›®å½•åˆ°é•œåƒä¸­ã€‚ å°†ä»ã€Œæ„å»ºä¸Šä¸‹æ–‡ã€ç›®å½•ä¸­çš„æ–‡ä»¶/ç›®å½•ï¼Œå¤åˆ¶åˆ°æ–°çš„ä¸€å±‚é•œåƒçš„ç›®å½•ä¸­ 12COPY source target # shell æ ¼å¼COPY ['source','target'] # exec æ ¼å¼ VOLUME å®¹å™¨æ•°æ®å·ï¼Œç”¨äºæ•°æ®ä¿å­˜å’ŒæŒä¹…åŒ–ã€‚ CMD æŒ‡å®šä¸€ä¸ªå®¹å™¨ã€Œå¯åŠ¨ã€æ—¶è¦è¿è¡Œçš„å‘½ä»¤ 12CMD &lt;å‘½ä»¤&gt; # shellCMD ['å¯æ‰§è¡Œæ–‡ä»¶','å‚æ•°1','å‚æ•°2'...] # exec DockerFile ä¸­å¯ä»¥æœ‰å¤šä¸ª CMD å‘½ä»¤ï¼Œä½†åªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚CMD ä¼šè¢« docker run ä¹‹åçš„å‚æ•°æ›¿æ¢ã€‚ ENTERPOINT æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼ŒENTRYPOINT çš„ç›®çš„å’Œ CMD ä¸€æ ·ï¼Œéƒ½æ˜¯æŒ‡å®šå®¹å™¨å¯åŠ¨å‘½ä»¤å’Œå‚æ•°ã€‚ ENTRYPOINT ä¸ CMD çš„åŒºåˆ«åœ¨äºï¼šè‹¥å­˜åœ¨å¤šä¸ª CMD æŒ‡ä»¤ï¼Œdocker build æ—¶åªä¼šä»¥æœ€åä¸€æ¡ CMD ä¸ºå‡†ï¼Œè€Œ ENTRYPOINT åˆ™æ˜¯è¿½åŠ ã€‚ ONBUILD å¦‚æœå½“å‰é•œåƒæ˜¯ä¸€ä¸ªçˆ¶é•œåƒï¼Œå¹¶ä¸” DockerFile ä¸­å­˜åœ¨ ONBUILD æŒ‡ä»¤ï¼Œé‚£ä¹ˆå­é•œåƒ build åä¼šã€Œè§¦å‘ã€çˆ¶é•œåƒçš„ ONBUILD æŒ‡ä»¤ï¼Œç›¸å½“äºçˆ¶é•œåƒæ‰§è¡Œä¸€äº›å­é•œåƒæ„å»ºä¹‹åçš„æ”¶å°¾æ“ä½œã€‚ EXPOSE\b\b ä¸ -p çš„åŒºåˆ«EXPOSE æš´éœ²ç«¯å£ï¼Œæ›´å®¹æ˜“ç†è§£çš„è¯´æ³•æ˜¯ã€Œå£°æ˜ç«¯å£ã€ã€‚å£°æ˜å®¹å™¨è¿è¡Œæ—¶æä¾›çš„æœåŠ¡ç«¯å£ï¼Œæ³¨æ„ï¼šè¿™åªæ˜¯ä¸€ä¸ªå£°æ˜ï¼Œå®¹å™¨å¹¶ä¸ä¼š\bå› ä¸ºæ­¤å£°æ˜å°±ä¼šå¼€å¯\bè¿™ä¸ªç«¯å£çš„æœåŠ¡ã€‚ä½¿ç”¨æ­¤å‘½ä»¤æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š å¸®åŠ©é•œåƒçš„ä½¿ç”¨è€…ç†è§£è¿™ä¸ªé•œåƒçš„å®ˆæŠ¤ç«¯å£ï¼Œä»¥æ–¹ä¾¿æ˜ å°„é…ç½® å®¹å™¨è¿è¡Œæ—¶çš„éšæœºç«¯å£ -p åˆ†é…ä¼šè‡ªåŠ¨æ˜ å°„ EXPOSE çš„ç«¯å£ã€‚ æ¡ˆä¾‹Baseé•œåƒï¼ˆscratchï¼‰Docker Hub ä¸­ 99% çš„é•œåƒéƒ½æ˜¯é€šè¿‡åœ¨ base é•œåƒä¸­å®‰è£…å’Œé…ç½®éœ€è¦çš„è½¯ä»¶æ„å»ºå‡ºæ¥çš„ã€‚ è‡ªå®šä¹‰é•œåƒ my-centosç›®çš„ï¼šç»ƒä¹ åŸºç¡€æŒ‡ä»¤ éœ€æ±‚ï¼šè¿›å…¥ centos é•œåƒä¸­ï¼Œä¼šå‘ç°ï¼š å·¥ä½œç›®å½•æ˜¯ / æ ¹ç›®å½• ä¸æ”¯æŒ vim å‘½ä»¤ ä¸æ”¯æŒ ifconfig å‘½ä»¤ è¿™æ˜¯å› ä¸º centos é•œåƒæ˜¯ä¸€ä¸ªæœ€åŸºç¡€çš„é•œåƒï¼Œå…±ç”¨æœ¬æœºç³»ç»Ÿå†…æ ¸ï¼Œå»é™¤äº†ä¸æ˜¯å¿…é¡»çš„ä¸€äº›è½¯ä»¶åŠå‘½ä»¤æˆ–åŠŸèƒ½ã€‚æˆ‘ä»¬çš„éœ€æ±‚æ˜¯è‡ªå·±æ„å»ºä¸€ä¸ª centos é•œåƒï¼Œä½¿å…¶é»˜è®¤è¿›å…¥æˆ‘ä»¬æŒ‡å®šçš„å·¥ä½œç›®å½•ï¼Œå¹¶æ”¯æŒä»¥ä¸Šä¸¤ä¸ªå‘½ä»¤ã€‚ 1234# pwd/Users/harry/Learning/docker-note/docker-file# touch DockerFile &amp;&amp; ll-rw-r--r-- 1 harry staff 0B 4 24 00:33 DockerFile ã€Œç¼–å†™ DockerFileã€ 1234567891011121314# vim DockerFileFROM centos # æŒ‡å®šåŸºç¡€é•œåƒMAINTAINER harry&lt;yuzh233@gmail.com&gt; # è®¾ç½®é•œåƒæ„å»ºè€…ä¿¡æ¯ENV MY_PATH /usr/local # è®¾ç½®ä¸€ä¸ªç¯å¢ƒå˜é‡WORKDIR $MY_PATH # æŒ‡å®šå·¥ä½œç›®å½•ï¼Œä½¿ç”¨ç¯å¢ƒå˜é‡RUN yum -y install vim # æ‰§è¡Œå‘½ä»¤ï¼šå®‰è£… vimRUN yum -y install net-tools # æ‰§è¡Œå‘½ä»¤ï¼šå®‰è£… net-toolsEXPOSE 8088 # æš´éœ²ç«¯å£CMD echo 'my workdir is $MY_PATH' # å®¹å™¨å¯åŠ¨æ‰§è¡Œï¼šæ‰“å°å­—ç¬¦ä¸²CMD /bin/bash # å®¹å™¨å¯åŠ¨çœŸæ­£æ‰§è¡Œçš„å‘½ä»¤ ã€Œæ‰§è¡Œæ„å»ºã€ docker build -f è·¯å¾„ -t é•œåƒå:TAG . 123456789101112131415161718192021222324252627282930313233343536373839404142434445# docker build -f DockerFile -t izhiliu/centos:v1 .# DockerFile å°±åœ¨å½“å‰è·¯å¾„ä¸‹ï¼Œä¸ç”¨æŒ‡å®šç›®å½•Sending build context to Docker daemon 2.048kB# å¯ä»¥çœ‹åˆ°ï¼Œæœ‰å‡ è¡Œ DockerFile å°±æ„å»ºå‡ å±‚é•œåƒã€‚Step 1/9 : FROM centos ---&gt; 9f38484d220fStep 2/9 : MAINTAINER harry&lt;yuzh233@gmail.com&gt; ---&gt; Running in 4966da40f5e8Removing intermediate container 4966da40f5e8 ---&gt; 32eb4f4c77baStep 3/9 : ENV MY_PATH /usr/local ---&gt; Running in 8b4d372d1404Removing intermediate container 8b4d372d1404 ---&gt; b412c79d5a02Step 4/9 : WORKDIR $MY_PATH ---&gt; Running in 42d2d2df5804Removing intermediate container 42d2d2df5804 ---&gt; 082bb5098dbfStep 5/9 : RUN yum -y install vim# ......å¼€å§‹å®‰è£… vim v......Complete!Removing intermediate container 3536627f1160 ---&gt; 58f9bbd23b2eStep 6/9 : RUN yum -y install net-tools ---&gt; Running in 3a6d39924e48# ...... å¼€å§‹å®‰è£… net-tools ......Complete!Removing intermediate container 3a6d39924e48 ---&gt; 2065a365b531Step 7/9 : EXPOSE 8088 ---&gt; Running in b836df8bcfb6Removing intermediate container b836df8bcfb6 ---&gt; 190f68eeb2d8Step 8/9 : CMD echo 'my workdir is $MY_PATH' ---&gt; Running in cadea312695eRemoving intermediate container cadea312695e ---&gt; 8d6c248e24c9Step 9/9 : CMD /bin/bash ---&gt; Running in e5ff383a4407Removing intermediate container e5ff383a4407 ---&gt; a8a7bed31bd7# å‡ºç°ä¸‹é¢ä¸¤è¡Œä»£è¡¨æ„å»ºæˆåŠŸSuccessfully built a8a7bed31bd7Successfully tagged izhiliu/centos:v1 ã€ŒéªŒè¯æ–°é•œåƒã€ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEizhiliu/centos v1 87ebc03d1d90 32 seconds ago 425MB# &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; é•œåƒæ„å»ºæˆåŠŸï¼# docker run -it 87ebc03d1d90[root@1bd54814f9c5 local]# pwd/usr/local# &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; æ ¹ç›®å½•æŒ‡å®šæˆåŠŸï¼# touch file# vim file -&gt; æœ‰æ•ˆ# &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; vim å®‰è£…æˆåŠŸï¼# ifconfigeth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 172.17.0.2 netmask 255.255.0.0 broadcast 172.17.255.255 ether 02:42:ac:11:00:02 txqueuelen 0 (Ethernet) RX packets 12 bytes 968 (968.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 0 bytes 0 (0.0 B) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt; mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 loop txqueuelen 1 (Local Loopback) RX packets 0 bytes 0 (0.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 0 bytes 0 (0.0 B) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0# &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; net-tools å®‰è£…æˆåŠŸï¼# docker history izhiliu/centos:v1# æ‰§è¡Œè¿™æ¡å‘½ä»¤å¯ä»¥çœ‹åˆ°æŸä¸ªé•œåƒçš„æ„å»ºè¿‡ç¨‹ï¼Œå¯ä»¥çœ‹åˆ°é•œåƒä»å¤´åˆ°å°¾æ„å»ºï¼Œæ˜¾ç¤ºæ ¹æ®æ„å»ºæ—¶é—´å€’åºå±•ç¤ºã€‚IMAGE CREATED CREATED BY SIZE COMMENT87ebc03d1d90 14 minutes ago /bin/sh -c #(nop) CMD [\"/bin/sh\" \"-c\" \"/binâ€¦ 0Bddc2e1121ff8 14 minutes ago /bin/sh -c #(nop) CMD [\"/bin/sh\" \"-c\" \"echoâ€¦ 0Ba1010b933008 14 minutes ago /bin/sh -c #(nop) EXPOSE 8088 0B670892d19e9f 14 minutes ago /bin/sh -c yum -y install net-tools 84.1MBfb03334297ef 14 minutes ago /bin/sh -c yum -y install vim 139MBdaceee7c426b 15 minutes ago /bin/sh -c #(nop) WORKDIR /usr/local 0Bf39af63b22d3 15 minutes ago /bin/sh -c #(nop) ENV MY_PATH=/usr/local 0Bef7f5536cec3 15 minutes ago /bin/sh -c #(nop) MAINTAINER harry&lt;yuzh233@â€¦ 0B# docker inspect izhiliu/centos:v1 æŸ¥çœ‹å®¹å™¨ä¿¡æ¯......\"Author\": \"harry&lt;yuzh233@gmail.com&gt;\",...... CMD/ENTERPOINT é•œåƒæ¡ˆä¾‹ä¸€ï¼‰DockerFile ä¸­å¯ä»¥æœ‰ä¸å¤šä¸ª CMD æŒ‡ä»¤ï¼Œä½†åªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚å¹¶ä¸”æœ€åä¸€ä¸ª CMD æŒ‡ä»¤ä¼šè¢« docker run ä¹‹åçš„å‚æ•°æ›¿æ¢ï¼ˆå¦‚æœæœ‰ï¼‰ ã€Œæ¼”ç¤ºã€ 1234567891011121314151617181920212223242526# æŸ¥çœ‹ tomcat å®˜æ–¹ DockerFileï¼Œæœ€åä¸€è¡Œï¼šCMD [\"catalina.sh\", \"run\"]# tomcat å®¹å™¨å°±æ˜¯é€šè¿‡è¿™è¡Œå‘½ä»¤å¯åŠ¨èµ·æ¥çš„ï¼Œæˆ‘ä»¬è¯•ç€åœ¨å¯åŠ¨æ—¶æŒ‡å®šå…¶ä»–å‘½ä»¤ï¼šdocker run -it --name cat -p 7070:8080 tomcat ls -l# æˆ‘ä»¬ç”¨ ls -l å‘½ä»¤æ›¿æ¢æ‰äº† [\"catalina.sh\", \"run\"]total 152-rw-r--r-- 1 root root 19539 Apr 10 14:33 BUILDING.txt-rw-r--r-- 1 root root 6090 Apr 10 14:33 CONTRIBUTING.md-rw-r--r-- 1 root root 57092 Apr 10 14:33 LICENSE-rw-r--r-- 1 root root 1726 Apr 10 14:33 NOTICE-rw-r--r-- 1 root root 3255 Apr 10 14:33 README.md-rw-r--r-- 1 root root 7139 Apr 10 14:33 RELEASE-NOTES-rw-r--r-- 1 root root 16262 Apr 10 14:33 RUNNING.txtdrwxr-xr-x 2 root root 4096 Apr 13 00:10 bindrwxr-sr-x 2 root root 4096 Apr 10 14:33 confdrwxr-sr-x 2 root staff 4096 Apr 13 00:10 includedrwxr-xr-x 2 root root 4096 Apr 13 00:09 libdrwxrwxrwx 2 root root 4096 Apr 10 14:31 logsdrwxr-sr-x 3 root staff 4096 Apr 13 00:10 native-jni-libdrwxr-xr-x 2 root root 4096 Apr 13 00:09 tempdrwxr-xr-x 7 root root 4096 Apr 10 14:31 webappsdrwxrwxrwx 2 root root 4096 Apr 10 14:31 work# å¯ä»¥çœ‹åˆ°æœ€åä¸€è¡Œå‘½ä»¤æ‰§è¡ŒæˆåŠŸäº†ï¼ŒæŸ¥çœ‹å®¹å™¨è¿›ç¨‹ï¼šdocker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES202be91cd7ec tomcat \"ls -l\" About a minute ago Exited (0) About a minute ago cat# tomcat æ²¡æœ‰å¯åŠ¨èµ·æ¥ï¼ŒåŸå› æ˜¯æˆ‘ä»¬ç”¨ ls -a å‘½ä»¤ä»£æ›¿äº†å¯åŠ¨ tomcat çš„å‘½ä»¤ äºŒï¼‰docker run ä¹‹åçš„å‚æ•°ä¼šè¢«å½“ä½œå‚æ•°ä¼ é€’ç»™ ENTRYPOINTï¼Œå½¢æˆæ–°çš„å‘½ä»¤ç»„åˆã€‚ å®šåˆ¶ä¸€ä¸ªæŸ¥çœ‹å½“å‰ ip ä¿¡æ¯çš„å®¹å™¨ï¼ŒDockerFileå¦‚ä¸‹ï¼š 1234567# å®‰è£… curl å·¥å…·ï¼Œå‘èµ·è¯·æ±‚åˆ°æŸ¥ipçš„ç½‘ç«™æŸ¥è¯¢è¿”å›ä¿¡æ¯# curl å‘½ä»¤å¯ä»¥ç”¨æ¥æ‰§è¡Œä¸‹è½½ã€å‘é€å„ç§ HTTP è¯·æ±‚ï¼ŒæŒ‡å®š HTTP å¤´éƒ¨ç­‰æ“ä½œã€‚FROM centosRUN yum install -y curl # æ‰§è¡Œå®‰è£…CMD [\"curl\",\"-s\",\"http://ip.cn\"]# æ‰§è¡Œæ„å»ºdocker build -f DockerFile2 -t show-ip . å¯åŠ¨å®¹å™¨ï¼Œä¼šçœ‹åˆ° http://ip.cn çš„ç›¸åº”ä¿¡æ¯å±•ç¤ºåˆ°äº†æ§åˆ¶å°ï¼Œcurl -s xxx å‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚ä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦åœ¨å®¹å™¨å¯åŠ¨æ—¶å˜æ›´å¯åŠ¨ä¸­çš„å‚æ•°æ—¶ï¼ŒCMDå°±ä¸èµ·ä½œç”¨äº†ã€‚ å¦‚æˆ‘ä»¬å¸Œæœ›åœ¨å®¹å™¨è¿è¡Œæ—¶ç»™ curl -s http://ip.cn åŠ ä¸€ä¸ª -i å‚æ•°ç”¨æ¥æ˜¾ç¤ºå®Œæ•´çš„ç›¸åº”å¤´ä¿¡æ¯ï¼Œæ­¤æ—¶ä¼šæŠ¥é”™è¯´æ‰¾ä¸åˆ°å‘½ä»¤ï¼ŒåŸå› æ˜¯å°† -i å½“ä½œä¸€ä¸ªå‘½ä»¤å»æ›¿æ¢æ‰äº† curl -s http://ip.cn å‘½ä»¤ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³çœ‹åˆ°çš„ã€‚ è¿™ç§æƒ…å†µå¯ä»¥ä½¿ç”¨ ENTRYPOINTï¼Œåªéœ€åœ¨ DockerFile ä¸­æ›¿æ¢ CMD æŒ‡ä»¤ä¸º ENTRYPOINT å³å¯ã€‚ENTRYPOINT [&quot;curl&quot;,&quot;-s&quot;,&quot;xxxx&quot;]ï¼Œæ­¤æ—¶æˆ‘ä»¬åœ¨å®¹å™¨å¯åŠ¨æ—¶æŒ‡å®šçš„å‚æ•°ä¼šä»¥å‚æ•°çš„å½¢å¼è¿½åŠ åˆ° curl -s http://ip.cn åé¢è€Œä¸æ˜¯æ›¿æ¢åŸæ¥å‘½ä»¤äº†ã€‚ è‡ªå®šä¹‰é•œåƒ Tomcatè‡ªå®šä¹‰ä¸€ä¸ª tomcat çš„é•œåƒï¼Œä½¿å…¶å¯åŠ¨å°±æ˜¯è¿è¡Œäº†ä¸€ä¸ª tomcatï¼Œå®é™…ä¸Šå°±æ˜¯ä»¥ centos ä¸ºåŸºç¡€é•œåƒå®‰è£…äº† jdk å’Œ tomcat çš„ç¯å¢ƒï¼Œå¹¶è®¾ç½®ä¸ºå¯åŠ¨è€Œå·²ã€‚ ã€Œæ­¥éª¤ã€ åˆ›å»º DockerFile æ‰€åœ¨ç›®å½•ï¼Œå‡†å¤‡é•œåƒæ‰€éœ€è¦çš„ jdk å’Œ tomcat å®‰è£…åŒ…ã€‚ 12345678------------------------------------------------------------~/Learning/docker-note/docker-file/my-tomcat(master*) Â» pwd &amp;&amp; ll harry@192/Users/harry/Learning/docker-note/docker-file/my-tomcattotal 375368-rw-r--r-- 1 harry staff 0B 5 2 21:35 Dockerfile-rwxr-xr-x@ 1 harry staff 8.5M 6 5 2018 apache-tomcat-7.0.75.tar.gz-rwxr-xr-x@ 1 harry staff 175M 6 5 2018 jdk-8u121-linux-x64.tar.gz------------------------------------------------------------ ç¼–å†™ DockerFile 12345678910111213141516171819202122232425262728~/Learning/docker-note/docker-file(master*) Â» cd my-tomcat harry@192FROM centosMAINTAINER harry&lt;yuzh233@gmail.com&gt;ADD apache-tomcat-7.0.75.tar.gz /usr/localADD jdk-8u121-linux-x64.tar.gz /usr/localRUN yum -y install vimENV WORK_PATH /usr/localWORKDIR $WORK_PATH# è®¾ç½® java ç¯å¢ƒç›®å½•ï¼Œæ­¤æ–‡ä»¶å¤¹åå¯ä»¥åœ¨æœ¬åœ°å°† jdk-8u121-linux-x64.tar.gz å¾—åˆ°ENV JAVA_HOME /usr/local/jdk1.8.0_121ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jarENV CATALINA_HOME /usr/local/apache-tomcat-7.0.75ENV CATALINA_BASE /usr/local/apache-tomcat-7.0.75ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/binEXPOSE 8080# ENTRYPOINT [\"/usr/local/apache-tomcat-7.0.75/bin/startup.sh\"]# CMD [\"/usr/local/apache-tomcat-7.0.75/bin/startup.sh\",\"run\"]# tail å‘½ä»¤ï¼šæŸ¥çœ‹æ–‡ä»¶æœ€åæŒ‡å®šè¡Œï¼Œ-f å‚æ•°ä¸åœçš„è¯»å–ã€‚CMD /usr/local/apache-tomcat-7.0.75/bin/startup.sh \\ &amp;&amp; tail -f /usr/local/c/logs/catalina.out PSï¼šå®¹å™¨å¯åŠ¨å‘½ä»¤åŠ ä¸Š tail æ˜¯ä½¿å…¶è¾“å‡ºæ—¥å¿—ä»¥å…ä»¥ -d åå°è¿è¡Œæ—¶ç”±äºå‰å°è¿›ç¨‹æ— äº‹å¯åšè‡ªåŠ¨åœæ­¢å®¹å™¨ã€‚ æ„å»ºé•œåƒ docker build -f Dockerfile -t yuzh/lovely-cat . 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455Sending build context to Docker daemon 192.2MBStep 1/14 : FROM centos ---&gt; 9f38484d220fStep 2/14 : MAINTAINER harry&lt;yuzh233@gmail.com&gt; ---&gt; Using cache ---&gt; ef7f5536cec3Step 3/14 : ADD apache-tomcat-7.0.75.tar.gz /usr/local ---&gt; ce38ea3cc5bfStep 4/14 : ADD jdk-8u121-linux-x64.tar.gz /usr/local ---&gt; 9bb44d59445fStep 5/14 : RUN yum -y install vim ---&gt; Running in 4e44d91a2a47# ......Complete!Removing intermediate container 4e44d91a2a47 ---&gt; 5dfdd1d562eeStep 6/14 : ENV WORK_PATH /usr/local ---&gt; Running in 11087250850aRemoving intermediate container 11087250850a ---&gt; 81440053e1c9Step 7/14 : WORKDIR $WORK_PATH ---&gt; Running in dbc004146319Removing intermediate container dbc004146319 ---&gt; 240cc0a13f09Step 8/14 : ENV JAVA_HOME /usr/local/jdk1.8.0_121 ---&gt; Running in 9c1f3a418a1fRemoving intermediate container 9c1f3a418a1f ---&gt; 1a27a3df60abStep 9/14 : ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar ---&gt; Running in 0f8cc5d9ea9cRemoving intermediate container 0f8cc5d9ea9c ---&gt; 35126d06a7caStep 10/14 : ENV CATALINA_HOME /usr/local/apache-tomcat-7.0.75 ---&gt; Running in 0e015a7542f0Removing intermediate container 0e015a7542f0 ---&gt; 22af3e7209e9Step 11/14 : ENV CATALINA_BASE /usr/local/apache-tomcat-7.0.75 ---&gt; Running in 0dc6317ab454Removing intermediate container 0dc6317ab454 ---&gt; cfd95a85a2d3Step 12/14 : ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin ---&gt; Running in b1b9a6a3e859Removing intermediate container b1b9a6a3e859 ---&gt; f03c22aef15dStep 13/14 : EXPOSE 8080 ---&gt; Running in 61a077e13bdeRemoving intermediate container 61a077e13bde ---&gt; afc175ba3243Step 14/14 : ENTRYPOINT [\"/usr/local/apache-tomcat-7.0.75/bin/startup.sh\"] ---&gt; Running in 753701ca8f2bRemoving intermediate container 753701ca8f2b ---&gt; 9a7ad3e1deb1Successfully built 9a7ad3e1deb1Successfully tagged yuzh/lovely-cat:latest------------------------------------------------------------ è¿è¡Œæ–°å»ºçš„å®¹å™¨ 12345678910~/Learning/docker-note/docker-file/my-tomcat(master*) Â» docker image ls harry@192REPOSITORY TAG IMAGE ID CREATED SIZEyuzh/lovely-cat latest 4d2b3d59f957 2 minutes ago 731MB------------------------------------------------------------~/Learning/docker-note/docker-file/my-tomcat(master*) Â» docker run -d -p 8080:8080 4d2b3d59f957 harry@192------------------------------------------------------------~/Learning/docker-note/docker-file/my-tomcat(master*) Â» docker ps harry@192CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESe3b5a9979497 4d2b3d59f957 \"/bin/sh -c '/usr/loâ€¦\" 5 minutes ago Up 5 minutes 0.0.0.0:8080-&gt;8080/tcp sleepy_hopper------------------------------------------------------------ éªŒè¯ 12345678910111213141516171819202122232425~/Learning/docker-note/docker-file/my-tomcat(master*) Â» docker exec -it e3b5a9979497 /bin/bash harry@192# éªŒè¯ï¼šå·¥ä½œç›®å½•# [root@e3b5a9979497 local] # pwd/usr/local# éªŒè¯ï¼švim# [root@e3b5a9979497 local]# vim apache-tomcat-7.0.75/logs/catalina.outMay 02, 2019 2:21:19 PM org.apache.catalina.startup.VersionLoggerListener logINFO: Server version: Apache Tomcat/7.0.75May 02, 2019 2:21:19 PM org.apache.catalina.startup.VersionLoggerListener logINFO: Server built: Jan 18 2017 20:54:42 UTCMay 02, 2019 2:21:19 PM org.apache.catalina.startup.VersionLoggerListener logINFO: Server number: 7.0.75.0May 02, 2019 2:21:19 PM org.apache.catalina.startup.VersionLoggerListener logINFO: OS Name: LinuxMay 02, 2019 2:21:19 PM org.apache.catalina.startup.VersionLoggerListener logINFO: OS Version: 4.9.125-linuxkitMay 02, 2019 2:21:19 PM org.apache.catalina.startup.VersionLoggerListener log......# éªŒè¯ jdk------------------------------------------------------------~/Learning/docker-note/docker-file/my-tomcat(master*) Â» docker exec -it e3b5a9979497 java -version harry@192java version \"1.8.0_121\"Java(TM) SE Runtime Environment (build 1.8.0_121-b13)Java HotSpot(TM) 64-Bit Server VM (build 25.121-b13, mixed mode)------------------------------------------------------------ å‘å¸ƒ Web åº”ç”¨ æŒ‚è½½æ•°æ®å·ï¼Œé‡æ–°å¯åŠ¨å®¹å™¨ã€‚ è¿™æ ·åšçš„å¥½å¤„æ˜¯ä¸ç”¨è¿›å…¥å®¹å™¨æŸ¥çœ‹æ—¥å¿—ï¼Œç›´æ¥æŸ¥çœ‹ä¸»æœºä¸å®¹å™¨å…±äº«çš„æ–‡ä»¶ã€‚å‘å¸ƒ web åº”ç”¨åªéœ€è¦åœ¨æœ¬åœ°å°† war åŒ…æ”¾åˆ°å…±äº«æ–‡ä»¶å¤¹ï¼Œé‡å¯å®¹å™¨å³å¯ã€‚ 1234# docker run -it -p 8888:8080 \\# -v ~/Learning/docker-note/docker-file/my-tomcat/webapp:/usr/local/apache-tomcat-7.0.75/webapps \\# -v ~/Learning/docker-note/docker-file/my-tomcat/logs:/usr/local/apache-tomcat-7.0.75/logs \\# 4d2b3d59f957 æ–°å»º web é¡¹ç›®ï¼Œå°† web åŒ…å¤åˆ¶åˆ°å®¹å™¨çš„ webapp ç›®å½•ä¸‹ã€‚å®¹å™¨ tomcat å³å¯ã€‚ å®‰è£… MySqlMysql DockerHub å®˜æ–¹æ–‡æ¡£ ã€Œæ€»ä½“æ­¥éª¤ã€ docker search â€“filter=stars=30 mysql docker pull mysql:latest docker run -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag è¿›å…¥åˆ°äº† mysql å®¹å™¨ï¼Œé€šè¿‡å‘½ä»¤è¡Œè¿æ¥åˆ° mysql å®¢æˆ·ç«¯ï¼šmysql -u root -p â€¦â€¦ ã€Œè¾“å…¥å¯†ç ã€ â€¦â€¦ æ•°æ®åº“æ“ä½œï¼ˆshow databases; use mysql; show tables; select * from user; â€¦â€¦ï¼‰ ä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶ï¼š Mysql é»˜è®¤çš„é…ç½®æ–‡ä»¶åœ¨ï¼š/etc/mysql/my.cnfï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®¹å™¨å¯åŠ¨æ—¶ä»¥æ•°æ®å·çš„æ–¹å¼æŒ‚è½½è‡ªå·±çš„é…ç½®æ–‡ä»¶åˆ°å®¹å™¨ä¸Šï¼š 12# å‡å¦‚ /my/custom æ˜¯æˆ‘ä»¬çš„è‡ªå®šä¹‰é…ç½®æ–‡ä»¶docker run -v /my/custom:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag è¿™å°†ä¼šä»¥ /etc/mysql/my.cnf å’Œ /my/custom ç»„åˆé…ç½®çš„æ–¹å¼æ–°å¯åŠ¨ä¸€ä¸ªå®¹å™¨å®ä¾‹ï¼Œåè€…ä¼˜å…ˆçº§å¤§äºå‰è€…ã€‚ ä¸ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤å‚æ•°é…ç½® Mysql é€šè¿‡å‘½ä»¤æ ‡å¿—çš„å½¢å¼ä¼ é€’ç»™ mysqldï¼Œå¯ä»¥ä½¿æˆ‘ä»¬æ›´åŠ çµæ´»çš„é…ç½® mysql è€Œä¸éœ€è¦é…ç½®æ–‡ä»¶ã€‚å¦‚ï¼šä¿®æ”¹æ‰€æœ‰è¡¨çš„ç¼–ç æ–¹å¼åªéœ€åœ¨å®¹å™¨å¯åŠ¨æ—¶æ·»åŠ ä»¥ä¸‹å‚æ•° 1docker run -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci å­˜å‚¨æ•°æ® æœ‰ä¸¤ç§æ–¹å¼å­˜å‚¨åº”ç”¨ç¨‹åºåœ¨ Docker å®¹å™¨è¿è¡Œä¸­äº§ç”Ÿçš„æ•°æ®ã€‚ è®© Docker ä½¿ç”¨è‡ªå·±çš„æ•°æ®å·ç®¡ç†æ–¹å¼å­˜å‚¨å°†æ•°æ®åº“æ–‡ä»¶å†™å…¥åˆ°ä¸»æœºï¼Œè¿™ç§æ–¹å¼æœ€æ–¹ä¾¿å¿«æ·ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯æ•°æ®æ–‡ä»¶ä¸æ–¹ä¾¿æ‰¾åˆ°å’Œç®¡ç†ã€‚ è‡ªå·±åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œä½¿å…¶æŒ‚è½½åˆ° mysql çš„æ•°æ®æ–‡ä»¶ã€‚ 1docker run -v /my/own/datadir:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag å¤‡ä»½æ•°æ® 1docker exec some-mysql sh -c 'exec mysqldump --all-databases -uroot -p\"$MYSQL_ROOT_PASSWORD\"' &amp;gt; /some/path/on/your/host/all-databases.sql Docker Compose å¯åŠ¨ Mysql æœ€ç®€å•çš„ä¾‹å­ï¼š 1234567891011121314151617# Use root/example as user/password credentialsversion: '3.1'services: db: image: mysql command: --default-authentication-plugin=mysql_native_password restart: always environment: MYSQL_ROOT_PASSWORD: admin ports: - 3336:3306 adminer: image: adminer restart: always ports: - 8080:8080 å¦‚ä½•\båœ¨ä¸»æœºå®¢æˆ·ç«¯è¿æ¥å®¹å™¨ä¸­çš„ Mysql æœåŠ¡ç«¯ Compose ä¸­çš„åº”ç”¨\bå±äºè‡ªå·±çš„ç½‘ç»œï¼Œå¤–ç•Œä¸èƒ½è®¿é—®ã€‚é¦–å…ˆéœ€è¦\bæš´éœ²ç«¯å£ï¼Œæ³¨æ„ï¼šå°½é‡ä¸è¦ä½¿ç”¨ 3306ï¼Œå› ä¸ºä¸»æœºå¤§å¤šæ•°å®‰è£…äº†Mysqlï¼Œæ­¤ç«¯å£ä¼šè¢«\bå ç”¨ã€‚ å…¶æ¬¡ï¼Œè¿æ¥å‘½ä»¤ç±»ä¼¼äºå¦‚ä¸‹ï¼š 12# note: -P æ˜¯æŒ‡å®šç«¯å£ï¼Œ-p æ˜¯æŒ‡å®šå¯†ç mysql -h localhost -P 3336 --protocol=tcp -u root -p éœ€è¦é¢å¤–æŒ‡å®šå‚æ•°ï¼š--protocol=tcpï¼Œå› ä¸ºæˆ‘ä»¬çš„ Mysql åœ¨\b Docker é‡Œé¢ï¼Œsocket å°†ä¸å¯ç”¨ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡ TCP è¿æ¥å®ƒï¼Œåœ¨ MySQL å‘½ä»¤ä¸­è®¾ç½®â€œ-protocolâ€å°†æ”¹å˜è¿™ä¸€ç‚¹ã€‚ å¼•ç”¨ï¼šhttps://stackoverflow.com/questions/33001750/connect-to-mysql-in-a-docker-container-from-the-host å®‰è£… RedisRedis DockerHub å®˜æ–¹æ–‡æ¡£ redis å‘½ä»¤æ‰‹å†Œ docker pull redis å¯åŠ¨ redis æœåŠ¡ç«¯ï¼šdocker run -d -p 6379:6379 -v ~/Learning/docker-note/redis/data:/data redis redis-server â€“appendonly yesæš´éœ²ç«¯å£ï¼ŒæŒ‚è½½æœ¬åœ°æ–‡ä»¶åˆ° redis çš„æŒä¹…åŒ–æ–‡ä»¶ã€‚é¿å…å®¹å™¨åˆ é™¤ key ä¸¢å¤±ã€‚ ä¸Šé¢åªæ˜¯å¯åŠ¨äº†æœåŠ¡ç«¯ï¼Œå®¹å™¨è¿è¡Œåéœ€è¦æˆ‘ä»¬è¿›å…¥å®¹å™¨æ‰‹åŠ¨å¯åŠ¨ redis å®¢æˆ·ç«¯è¿›è¡Œæµ‹è¯•ã€‚ 1234å¦‚ä½•æ‰¾åˆ° redis å‘½ä»¤åœ°å€ï¼Ÿå¯ä»¥é€šè¿‡æŸ¥çœ‹ DockerHub ä¸Š Redis çš„ DockerFileæ–‡ä»¶å¾—çŸ¥åœ¨ï¼š`/usr/local/bin/`ã€‚cd /usr/local/bin/ &amp;&amp; ./redis-cli# exec redis commend ...... ã€Œæµ‹è¯•æŒä¹…åŒ–ã€ 12345678910111213141516171819# åœ¨å½“å‰å®¹å™¨è®¾ç½®äº†ä¸‰ä¸ª key127.0.0.1:6379&gt; keys *1) \"k2\"2) \"k1\"3) \"k3\"# æŸ¥çœ‹å®¿ä¸»æœºæŒä¹…åŒ–æ–‡ä»¶ï¼š------------------------------------------------------------~/Learning/docker-note/redis/data(master*) Â» pwd harry@192/Users/harry/Learning/docker-note/redis/data------------------------------------------------------------~/Learning/docker-note/redis/data(master*) Â» cat appendonly.aof harry@192*2$6SELECT$10*3...... è¯æ˜æ˜¯æŒ‚è½½æˆåŠŸçš„ï¼Œç„¶ååˆ é™¤å®¹å™¨ï¼Œé‡æ–°å¯åŠ¨ä¸€ä¸ªæ–°å®¹å™¨ï¼Œçœ‹æ•°æ®æ˜¯å¦åŒæ­¥è¿‡å»äº†ã€‚ å®¿ä¸»æœºè¿æ¥ docker ä¸­çš„ redisï¼š è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ å®šåˆ¶ DockerFile çš„å½¢å¼ 123FROM redisCOPY redis.conf /usr/local/etc/redis/redis.confCMD [ \"redis-server\", \"/usr/local/etc/redis/redis.conf\" ] å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šï¼Œçµæ´»ï¼Œæ¨èã€‚ 1docker run -v /myredis/conf/redis.conf:/usr/local/etc/redis/redis.conf redis redis-server /usr/local/etc/redis/redis.conf ç»ƒä¹ ï¼šSpring Boot å•ä½“åº”ç”¨å®¹å™¨åŒ–ä½¿ç”¨ä¸Šé¢çš„ test-dockerfile é¡¹ç›®ï¼Œæ„å»ºä¸€ä¸ªé•œåƒï¼Œé€šè¿‡å®¹å™¨è¿è¡Œå¹¶è®¿é—®ã€‚ æ·»åŠ ä¸€ä¸ªæœ€ç®€å•çš„ Dockerfile 123456FROM tomcat:latestENV WORK_PATH /usr/local/tomcatADD /target/test-dockerfile-0.0.1-SNAPSHOT.jar ${WORK_PATH}/webapps/test-dockerfile-0.0.1-SNAPSHOT.jarEXPOSE 8081# PSï¼šENTRYPOINT [\"\",\"${WORK_PATH}\"] è¿™ç§æ–¹å¼æ˜¯ exec çš„å½¢å¼æ‰§è¡Œï¼Œä¸ä¼šè§£æç¯å¢ƒå˜é‡ã€‚é™¤éä½¿ç”¨ shell çš„æ–¹å¼ã€‚ENTRYPOINT java -jar ${WORK_PATH}/webapps/test-dockerfile-0.0.1-SNAPSHOT.jar åœ¨é¡¹ç›®æ ¹è·¯å¾„ä¸‹æ‰§è¡Œï¼šdocker build -f Dockerfile -t my-webapp:latest . è¿è¡Œï¼šdocker run -it -p 8081:8080 my-webapp:latest è®¿é—®ï¼šhttp://localhost:8081/api/hello-docker PSï¼šIDEA 2019 ç‰ˆé›†æˆäº† Docker å·¥å…·ï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯ä½¿ç”¨å‘½ä»¤å§ğŸ˜‚ã€‚ ä»“åº“å­¦ä¼šä½¿ç”¨ã€Œå®¹å™¨é•œåƒæœåŠ¡ã€ï¼Œå®˜æ–¹æœ‰è¯¦ç»†æ–‡æ¡£è¯´æ˜ï¼Œè¿™é‡Œåªè®°å½•ä¸»è¦æ­¥éª¤åŠé—®é¢˜ã€‚ 1ï¼‰åˆ›å»ºé•œåƒä»“åº“ï¼ŒæŒ‡å®šä»£ç æº 2) ç™»é™†ç§æœ‰é•œåƒä»“åº“ 1docker login --username=yuzh233 registry.cn-hangzhou.aliyuncs.com PSï¼šä¿®æ”¹å¯†ç å…¥å£ï¼šå®¹å™¨æœåŠ¡é¦–é¡µ -&gt; è®¿é—®å‡­è¯ 3ï¼‰ ä¸Šä¼ é•œåƒåˆ°ç§æœ‰ä»“åº“ 1234567docker login --username=yuzh233 registry.cn-hangzhou.aliyuncs.com# docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/yuzh/test-dockerfile:[é•œåƒç‰ˆæœ¬å·]# ImageId å°±æ˜¯æœ¬åœ°æ„å»ºå¥½éœ€è¦ä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“çš„é•œåƒIDdocker tag fccdeb7abef7 registry.cn-hangzhou.aliyuncs.com/yuzh/test-dockerfile:latestdocker push registry.cn-hangzhou.aliyuncs.com/yuzh/test-dockerfile:[é•œåƒç‰ˆæœ¬å·] 4ï¼‰ ä»ç§æœ‰ä»“åº“æ‹‰å–é•œåƒ 1docker pull registry.cn-hangzhou.aliyuncs.com/yuzh/test-dockerfile:[é•œåƒç‰ˆæœ¬å·] 5ï¼‰ç™»å‡ºè¿œç¨‹ä»“åº“ docker logout [ä»“åº“åœ°å€] 1e.g: docker logout registry.cn-shanghai.aliyuncs.com","link":"/2019/05/11/Docker è¡¥æ•‘æŒ‡å—ï¼ˆä¸€ï¼‰â€”â€” åŸºç¡€ä½¿ç”¨/"},{"title":"Linux - SSH-ä¿æŒè¿æ¥","text":"æ–¹å¼ä¸€ï¼šæœåŠ¡ç«¯é…ç½®vim /etc/ssh/sshd_configä¿®æ”¹å‚æ•°ï¼š 123ClientAliveInterval 60 # æœåŠ¡ç«¯æ¯ 60s å‘å®¢æˆ·ç«¯å‘èµ·\bä¸€æ¬¡å“åº”ClientAliveCountMax 10 # å¦‚æœå®¢æˆ·ç«¯è¶…è¿‡ 10 æ¬¡æ¯å“åº”åˆ™\bææ–­è¿æ¥restart ssh / service ssh reload æ–¹å¼äºŒï¼šå®¢æˆ·ç«¯é…ç½®ï¼ˆæ¨èï¼‰/etc/ssh/ssh_config æˆ–è€… ~/ssh/config æ·»åŠ ï¼š 12Host *ServerAliveInterval 60 then: 1chmod 600 ~/.ssh/config","link":"/2019/06/21/SSH-ä¿æŒè¿æ¥/"},{"title":"Linux - SSH-åˆ«åç™»é™†","text":"ç¼–è¾‘ ~/.ssh/configï¼Œæ·»åŠ ï¼š 123456789101112# è®¾ç½®åˆ«åç™»é™†Host harry # ä¸»æœºåœ°å€ HostName 120.78.69.82 # ç«¯å£ï¼Œéå¿…å¡« Port 22 # ç”¨æˆ·å User root # ç™»é™†çš„å…¬é’¥æ–‡ä»¶ï¼Œéå¿…é¡» # IdentityFile ~/.ssh/id_rsa.pub # åªæ¥å— SSH Key ç™»é™† IdentitiesOnly yes","link":"/2019/06/22/SSH-åˆ«åç™»é™†/"},{"title":"20190528 Announcing GitHub Sponsors ğŸ’–","text":"Hi @yuzh233 ,Weâ€™re thrilled to announce the beta of GitHub Sponsors, a tool to financially support the developers who build the open source software you use every day. These extraordinary developers can now receive funding from the community that depends on their work, seamlessly through their GitHub profiles.Learn more To kick start this new program and boost community funding, weâ€™re also launching the GitHub Sponsors Matching Fund. For each dollar that a developer contributes, GitHub will double that sponsorship for each sponsored developerâ€™s first year in the program. GitHub Sponsors is launching small and simple, but our mission is vast: to expand the opportunities to participate in and build on open source. Weâ€™re here to serve the developer community, and weâ€™re eagerly listening for your input about what else youâ€™d like to see in GitHub Sponsors. Todayâ€™s launch is just the beginning.Read the blog Hi yuzh233:æˆ‘ä»¬å¾ˆé«˜å…´å®£å¸ƒï¼ˆannounceï¼‰ Github èµåŠ©å•†ï¼ˆSponsorsï¼‰çš„æµ‹è¯•ç‰ˆï¼Œè¯¥å·¥å…·ä»ç»æµä¸Šï¼ˆfinanciallyï¼‰æ”¯æŒå¼€å‘è€…æ„å»ºæ‚¨æ¯å¤©ä½¿ç”¨çš„å¼€æºè½¯ä»¶ã€‚ è¿™äº›æ°å‡ºçš„ï¼ˆextraordinaryï¼‰çš„å¼€å‘äººå‘˜å¯ä»¥ä»–ä»¬çš„å·¥ä½œä»å¼€æºç¤¾åŒºæ¥å—èµ„åŠ©ï¼ˆreceive fundingï¼‰ã€‚é€šè¿‡ä»–ä»¬çš„githubèµ„æ–™æ— ç¼ï¼ˆseamlesslyï¼‰å®Œæˆï¼ˆæåŠ©ï¼‰ã€‚ å¯åŠ¨è¿™ä¸ªï¼ˆto kick start thisï¼‰æ–°çš„é¡¹ç›®å¹¶å¢åŠ ï¼ˆbootsï¼‰ç¤¾åŒºèµ„é‡‘ï¼Œæˆ‘ä»¬è¿˜å¯åŠ¨äº†ã€Œgithub èµåŠ©å•†åŒ¹é…åŸºé‡‘ã€ã€‚å¼€å‘è€…è´¡çŒ®çš„æ¯ä¸€ï¼ˆfor eachï¼‰ç¾å…ƒï¼ŒGITHUB å°†ä¸ºæ¯ä¸€ä¸ªå—èµåŠ©çš„å¼€å‘è€…åœ¨è¯¥é¡¹ç›®çš„ç¬¬ä¸€å¹´ä¸­æä¾›åŒå€çš„èµåŠ©èµ„é‡‘ã€‚ GitHub èµåŠ©å•†æ­£æ¨å‡ºï¼ˆis launchingå‘è¡Œï¼‰å°å‹å’Œç®€å•çš„ï¼Œä½†æˆ‘ä»¬çš„ä½¿å‘½ï¼ˆmissionï¼‰æ˜¯å·¨å¤§ï¼ˆvastï¼‰çš„ï¼šæ‰©å¤§ï¼ˆexpandï¼‰å‚ä¸ï¼ˆopporunitiesï¼‰æœºä¼šï¼ˆparticipateï¼‰å’Œæ„å»ºå¼€æºç¤¾åŒºã€‚æˆ‘ä»¬æ˜¯ä¸ºå¼€æºç¤¾åŒºæœåŠ¡çš„ï¼Œæˆ‘ä»¬çƒ­åˆ‡åœ°ï¼ˆeagerlyï¼‰å€¾å¬æ‚¨çš„å»ºè®®å’Œå…³äºæ‚¨è¿˜å¸Œæœ›åœ¨GitHubè´¡çŒ®å•†çœ‹åˆ°ä»€ä¹ˆã€‚ä»Šå¤©çš„æ¨è¡Œåªæ˜¯ä¸€ä¸ªå¼€å§‹ã€‚","link":"/2019/05/28/[20190528] Announcing GitHub Sponsors ğŸ’–/"},{"title":"20190529 dockerfile-plugin | authentication","text":"https://github.com/spotify/dockerfile-maven/blob/master/docs/authentication.md Authentication and private Docker registry supportSince version 1.3.0, the plugin will automatically use any configuration in your ~/.dockercfg or ~/.docker/config.json file when pulling, pushing, or building images to private registriesAdditionally the plugin will enable support for Google Container Registry if it is able to successfully load Googleâ€™s â€œApplication Default Credentialsâ€. The plugin will also load Google credentials from the file pointed to by the environment variable DOCKER_GOOGLE_CREDENTIALS if it is defined. Since GCR authentication requires retrieving short-lived access codes for the given credentials, support for this registry is baked into the underlying docker-client rather than having to first populate the docker config file before running the plugin. GCR users may need to initialize their Application Default Credentials via gcloud. Depending on where the plugin will run, they may wish to use their Google identity by running the following command 1gcloud auth application-default login or create a service account instead. Authenticating with maven settings.xmlSince version 1.3.6, you can authenticate using your maven settings.xml instead of docker configuration. Just add configuration similar to: 12345&lt;configuration&gt; &lt;repository&gt;docker-repo.example.com:8080/organization/image&lt;/repository&gt; &lt;tag&gt;latest&lt;/tag&gt; &lt;useMavenSettingsForAuth&gt;true&lt;/useMavenSettingsForAuth&gt;&lt;/configuration&gt; You can also use -Ddockerfile.useMavenSettingsForAuth=true on the command line.Then, in your maven settings file, add configuration for the server: 1234567&lt;servers&gt; &lt;server&gt; &lt;id&gt;docker-repo.example.com:8080&lt;/id&gt; &lt;username&gt;me&lt;/username&gt; &lt;password&gt;mypassword&lt;/password&gt; &lt;/server&gt;&lt;/servers&gt; exactly as you would for any other server configuration. Since version 1.4.3, using an encrypted password in the Maven settings file is supported. For more information about encrypting server passwords in settings.xml, read the documentation here. Authenticating with maven pom.xmlSince version 1.3.XX, you can authenticate using config from the pom itself. Just add configuration similar to: 12345678910111213 &lt;plugin&gt; &lt;groupId&gt;com.spotify&lt;/groupId&gt; &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt; &lt;version&gt;${version}&lt;/version&gt; &lt;configuration&gt; &lt;username&gt;repoUserName&lt;/username&gt; &lt;password&gt;repoPassword&lt;/password&gt; &lt;repository&gt;${docker.image.prefix}/${project.artifactId}&lt;/repository&gt; &lt;buildArgs&gt; &lt;JAR_FILE&gt;target/${project.build.finalName}.jar&lt;/JAR_FILE&gt; &lt;/buildArgs&gt; &lt;/configuration&gt;&lt;/plugin&gt; or simpler, 1234567891011&lt;plugin&gt; &lt;groupId&gt;com.spotify&lt;/groupId&gt; &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt; &lt;version&gt;${version}&lt;/version&gt; &lt;configuration&gt; &lt;repository&gt;${docker.image.prefix}/${project.artifactId}&lt;/repository&gt; &lt;buildArgs&gt; &lt;JAR_FILE&gt;target/${project.build.finalName}.jar&lt;/JAR_FILE&gt; &lt;/buildArgs&gt; &lt;/configuration&gt;&lt;/plugin&gt; with this command line call 1mvn goal -Ddockerfile.username=... -Ddockerfile.password=... è®¤è¯èº«ä»½è®¤è¯å’Œç§æœ‰ Docker ä»“åº“æ”¯æŒä» 1.3.0 ç‰ˆæœ¬èµ·ï¼ˆsince è‡ªâ€¦ä»¥æ¥ï¼Œç”±äºï¼Œå› ä¸ºï¼‰ï¼Œè¯¥æ’ä»¶åŠ¨æ€ï¼ˆautomaticallyï¼‰ä½¿ç”¨æ‚¨çš„é…ç½®æ–‡ä»¶ï¼š~/.dockercfg æˆ– ~/.docker/config.json å…¶ä¸­çš„ä¸€ç§å½“æ‹‰å–ã€æ¨é€ã€æ„å»ºé•œåƒåˆ°ç§æœ‰ä»“åº“æ—¶ã€‚ æ­¤å¤–ï¼ˆAdditionallyï¼‰ï¼Œè¯¥æ’ä»¶å°†æ”¯æŒã€Œè°·æ­Œçš„å®¹å™¨æ³¨å†Œã€ï¼Œå¦‚æœå®ƒèƒ½å¤ŸæˆåŠŸï¼ˆif it is able to successfullyï¼‰åœ°åŠ è½½è°·æ­Œçš„â€œåº”ç”¨ç¨‹åºé»˜è®¤å‡­æ®â€ã€‚å¦‚æœå®šä¹‰äº†ç¯å¢ƒå˜é‡ DOCKER_GOOGLE_CREDENTIALS ï¼Œè¯¥æ’ä»¶ä¹Ÿå¯ä»¥ä»ç¯å¢ƒå˜é‡ DOCKER_GOOGLE_CREDENTIALS æŒ‡å‘çš„æ–‡ä»¶ä¸­ï¼ˆfrom the file pointed to by ä»ä»€ä¹ˆæŒ‡å‘çš„æ–‡ä»¶ï¼‰åŠ è½½è°·æ­Œå‡­è¯ã€‚ç”±äº GCR è®¤è¯éœ€è¦ä»ç»™å®šçš„å‡­è¯ä¸­æ£€ç´¢ï¼ˆretrievingï¼‰çŸ­æ•ˆè®¿é—®ç ï¼Œå¯¹è¿™ä¸ªå®¹å™¨æ³¨å†Œï¼ˆæœåŠ¡ï¼‰çš„æ”¯æŒè¢«åˆæˆï¼ˆbaked intoï¼‰åˆ°åº•å±‚ï¼ˆunderlyingï¼‰çš„ docker-client ï¼Œè€Œä¸æ˜¯ï¼ˆrather thanï¼‰åœ¨å®¹å™¨æ’ä»¶è¿è¡Œä¹‹å‰ç¬¬ä¸€æ—¶é—´å¡«å……ï¼ˆhaving to first populateï¼‰ docker é…ç½®æ–‡ä»¶ã€‚ GCR ç”¨æˆ·å¯èƒ½éœ€è¦é€šè¿‡ gcloud åˆå§‹åŒ–ä»–ä»¬çš„åº”ç”¨é»˜è®¤å‡­è¯ï¼Œè¿™å–å†³äºï¼ˆdepending on ä¾é ã€ä¾èµ–ã€å–å†³äºï¼‰æ’ä»¶è¿è¡Œçš„ä½ç½®ï¼Œä»–ä»¬å¯èƒ½å¸Œæœ›é€šè¿‡è¿è¡Œä¸€ä¸‹å‘½ä»¤ä½¿ç”¨ä»–ä»¬çš„ Google identity 1gcloud auth application-default login æˆ–è€… create a service account ä½œä¸ºæ›¿ä»£. ç”¨ maven settings.xml è®¤è¯ä» 1.3.6 ç‰ˆæœ¬å¼€å§‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ä½ çš„ maven setting.xml æ–‡ä»¶è®¤è¯ä½œä¸º docker é…ç½®æ–‡ä»¶çš„æ›¿ä»£ã€‚åªéœ€è¦æ·»åŠ ä»¥ä¸‹ç±»ä¼¼çš„ï¼ˆsimilar toï¼‰é…ç½®ï¼š 12345&lt;configuration&gt; &lt;repository&gt;docker-repo.example.com:8080/organization/image&lt;/repository&gt; &lt;tag&gt;latest&lt;/tag&gt; &lt;useMavenSettingsForAuth&gt;true&lt;/useMavenSettingsForAuth&gt;&lt;/configuration&gt; ä½ åŒæ ·å¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œå‘½ä»¤ -Ddockerfile.useMavenSettingsForAuth=true ï¼ˆæ›¿ä»£ true ï¼‰ç„¶åï¼Œåœ¨æ‚¨çš„ maven setting æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹æœåŠ¡é…ç½®ï¼š 1234567&lt;servers&gt; &lt;server&gt; &lt;id&gt;docker-repo.example.com:8080&lt;/id&gt; &lt;username&gt;me&lt;/username&gt; &lt;password&gt;mypassword&lt;/password&gt; &lt;/server&gt;&lt;/servers&gt; å¯¹äºå…¶ä»–ä»»æ„ï¼ˆfor any otherï¼‰çš„æœåŠ¡å™¨ä½ ä¼šä½¿ç”¨å®Œå…¨ä¸€æ ·ï¼ˆexactly asï¼‰çš„é…ç½®ã€‚ä» 1.4.3 ç‰ˆæœ¬å¼€å§‹ï¼Œmaven setting æ–‡ä»¶ä¸­æ”¯æŒä½¿ç”¨åŠ å¯†å¯†ç ï¼Œå…³äºæ›´å¤šåœ¨ setting.xml ä¸­åŠ å¯†æœåŠ¡å™¨å¯†ç çš„ä¿¡æ¯ï¼Œread the documentation here. ç”¨ maven pom.xml è®¤è¯ä» 1.3.X å¼€å§‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ pom æœ¬èº«çš„é…ç½®è®¤è¯ï¼Œåªéœ€è¦æ·»åŠ ä»¥ä¸‹ç±»ä¼¼çš„é…ç½®ï¼š 12345678910111213 &lt;plugin&gt; &lt;groupId&gt;com.spotify&lt;/groupId&gt; &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt; &lt;version&gt;${version}&lt;/version&gt; &lt;configuration&gt; &lt;username&gt;repoUserName&lt;/username&gt; &lt;password&gt;repoPassword&lt;/password&gt; &lt;repository&gt;${docker.image.prefix}/${project.artifactId}&lt;/repository&gt; &lt;buildArgs&gt; &lt;JAR_FILE&gt;target/${project.build.finalName}.jar&lt;/JAR_FILE&gt; &lt;/buildArgs&gt; &lt;/configuration&gt;&lt;/plugin&gt; æˆ–è€…æ›´ç®€å•çš„, 1234567891011&lt;plugin&gt; &lt;groupId&gt;com.spotify&lt;/groupId&gt; &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt; &lt;version&gt;${version}&lt;/version&gt; &lt;configuration&gt; &lt;repository&gt;${docker.image.prefix}/${project.artifactId}&lt;/repository&gt; &lt;buildArgs&gt; &lt;JAR_FILE&gt;target/${project.build.finalName}.jar&lt;/JAR_FILE&gt; &lt;/buildArgs&gt; &lt;/configuration&gt;&lt;/plugin&gt; ä½¿ç”¨æ­¤å‘½ä»¤è¡Œè°ƒç”¨ï¼š 1mvn goal -Ddockerfile.username=... -Ddockerfile.password=...","link":"/2019/05/29/[20190529] dockerfile-plugin | authentication/"},{"title":"20190531 maven | password encryption","text":"referenceï¼šhttps://maven.apache.org/guides/mini/guide-encryption.html Introduction How to create a master password How to encrypt server passwords How to keep the master password on removable drive Tips IntroductionMaven 2.1.0+ now supports server password encryption. The main use case, addressed by this solution is: multiple users share the same build machine (server, CI box) some users have the privilege to deploy Maven artifacts to repositories, some donâ€™t. this applies to any server operations, requiring authorization, not only deployment settings.xml is shared between users The implemented solution adds the following capabilities: authorized users have an additional settings-security.xml file in their ${user.home}/.m2 folder this file either contains encrypted master password, used to encrypt other passwords or it can contain a relocation - reference to another file, possibly on removable storage this password is created first via CLI for now server entries in the settings.xml have passwords and/or keystore passphrases encrypted for now - this is done via CLI after master password has been created and stored in appropriate location How to create a master passwordUse the following command line: 1mvn --encrypt-master-password &lt;password&gt; Note: Since Maven 3.2.1 the password argument should no longer be used (see Tips below for more information). Maven will prompt for the password. Earlier versions of Maven will not prompt for a password, so it must be typed on the command-line in plaintext. This command will produce an encrypted version of the password, something like 1{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+9EF1iFQyJQ=} Store this password in the ${user.home}/.m2/settings-security.xml; it should look like 123&lt;settingsSecurity&gt; &lt;master&gt;{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+9EF1iFQyJQ=}&lt;/master&gt;&lt;/settingsSecurity&gt; When this is done, you can start encrypting existing server passwords. How to encrypt server passwordsYou will have to use the following command line: 1mvn --encrypt-password &lt;password&gt; Note:Just like --encrypt-master-password the password argument should no longer be used since Maven 3.2.1 (see Tips below for more information.). This command will produce an encrypted version of it, something like 1{COQLCE6DU6GtcS5P=} Cut-n-paste it into your settings.xml file in the server section. This will look like: 12345678910111213&lt;settings&gt;... &lt;servers&gt;... &lt;server&gt; &lt;id&gt;my.server&lt;/id&gt; &lt;username&gt;foo&lt;/username&gt; &lt;password&gt;{COQLCE6DU6GtcS5P=}&lt;/password&gt; &lt;/server&gt;... &lt;/servers&gt;...&lt;/settings&gt; Please note that password can contain any information outside of the curly brackets, so that the following will still work: 12345678910111213&lt;settings&gt;... &lt;servers&gt;... &lt;server&gt; &lt;id&gt;my.server&lt;/id&gt; &lt;username&gt;foo&lt;/username&gt; &lt;password&gt;Oleg reset this password on 2009-03-11, expires on 2009-04-11 {COQLCE6DU6GtcS5P=}&lt;/password&gt; &lt;/server&gt;... &lt;/servers&gt;...&lt;/settings&gt; Then you can use, say, deploy plugin, to write to this server: 123mvn deploy:deploy-file -Durl=https://maven.corp.com/repo \\ -DrepositoryId=my.server \\ -Dfile=your-artifact-1.0.jar \\ How to keep the master password on removable driveCreate the master password exactly as described above, and store it on a removable drive, for instance on OSX, my USB drive mounts as /Volumes/mySecureUsb, so I store 123&lt;settingsSecurity&gt; &lt;master&gt;{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+9EF1iFQyJQ=}&lt;/master&gt;&lt;/settingsSecurity&gt; in the file /Volumes/mySecureUsb/secure/settings-security.xml And then I create ${user.home}/.m2/settings-security.xml with the following content: 123&lt;settingsSecurity&gt; &lt;relocation&gt;/Volumes/mySecureUsb/secure/settings-security.xml&lt;/relocation&gt;&lt;/settingsSecurity&gt; This assures that encryption will only work when the usb drive is mounted by OS. This addresses a use case where only certain people are authorized to deploy and are issued these devices. TipsEscaping curly-brace literals in your password (Since: Maven 2.2.0)At times, you might find that your password (or the encrypted form of it) may actually contain â€˜{â€˜ or â€˜}â€™ as a literal value. If you added such a password as-is to your settings.xml file, you would find that Maven does strange things with it. Specifically, Maven will treat all the characters preceding the â€˜{â€˜ literal, and all the characters after the â€˜}â€™ literal, as comments. Obviously, this is not the behavior you want in such a situation. What you really need is a way of escaping the curly-brace literals in your password. Starting in Maven 2.2.0, you can do just this, with the widely used â€˜\\â€˜ escape character. If your password looks like this: 1jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+{EF1iFQyJQ= Then, the value you would add to your settings.xml would look like this: 1{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+\\{EF1iFQyJQ=} Password SecurityEditing settings.xml and running the above commands can still leave your password stored locally in plaintext. You may want to check the following locations: Shell history (e.g. by running history). You may want to clear your history after encrypting the above passwords Editor caches (e.g. ~/.viminfo) Also note that the encrypted passwords can be decrypted by someone that has the master password and settings security file. Keep this file secure (or stored separately) if you expect the possibility that the settings.xml file may be retrieved. Password Escaping on different platformsOn some platforms it might be neccessary to quote your password based on the content of your password in particular having special characters like %, !, $ etc. in there. For example on Windows you have to be carefull about things like the following: The following example will not work on Windows: 1mvn --encrypt-master-password a!$%^b whereas the following will work on Windows: 1mvn --encrypt-master-password \"a!$%^b\" If you are on a linux/unix platform you should use single quotes for the above master password otherwise you will be astonished that the usage of the master-password will not work (caused by the dollar sign and furthermore the exclamation mark). Prompting for PasswordIn Maven before version 3.2.1 you have to give the password on command line as argument which means you might need to escape your password. In addition usually the shell stores the full history of commands you have entered, therefore anyone with access to your computer could restore the password from the shell`s history. Starting with Maven 3.2.1 the password is an optional argument which means if you omit the password you will be prompted for it which prevents all the issues mentioned above. Therefore we strongly recommend to use Maven 3.2.1 and above to prevent problems with escaping special characters and of course security issues related to bash history or environment issues in relationship with the password. å¯¼è¨€ï¼ˆ\bintroductionï¼‰ å¦‚ä½•åˆ›å»ºä¸»å¯†ç  å¦‚ä½•åŠ å¯†æœåŠ¡å¯†ç  å¦‚ä½•åœ¨å¯ç§»åŠ¨è®¾å¤‡ï¼ˆon removable driverï¼‰ä¸Šä¿å­˜ä¸»å¯†ç  å°è´´å£« å¯¼è¨€ï¼ˆ\bintroductionï¼‰Maven 2.1.0+ å¼€å§‹æ”¯æŒæœåŠ¡å¯†ç åŠ å¯†ã€‚ä¸»è¦ç”¨ä¾‹ï¼Œ\bè§£å†³æ–¹æ¡ˆï¼ˆaddressed by solutionï¼‰æ˜¯ï¼š æ‰€æœ‰ç”¨æˆ·å…±äº«ç›¸åŒï¼ˆsameï¼‰çš„æ„å»ºæœºå™¨ï¼ˆserverï¼ŒCI boxï¼‰ ä¸€äº›ç”¨æˆ·æ‹¥æœ‰éƒ¨ç½² maven åˆ¶å“ï¼ˆartifactsï¼‰åˆ°ä»“åº“çš„ç‰¹æƒï¼ˆprivilegeï¼‰ã€‚è€Œä¸€äº›äººä¸èƒ½ è¿™é€‚ç”¨äºï¼ˆthis applies toï¼‰ä»»ä½•éœ€è¦æˆæƒçš„æœåŠ¡å™¨æ“ä½œï¼Œè€Œä¸ä»…ä»…æ˜¯\béƒ¨ç½²ã€‚ setting.xml åœ¨ç”¨æˆ·ä¹‹é—´åˆ†äº« å®ç°çš„ï¼ˆimplementedï¼‰è§£å†³æ–¹æ¡ˆæ·»åŠ äº†ä»¥ä¸‹åŠŸèƒ½ï¼ˆcapablitiesï¼‰ï¼š è®¤è¯çš„ç”¨æˆ·æ‹¥æœ‰é¢å¤–çš„ï¼ˆadditionalï¼‰setting-security.xml æ–‡ä»¶åœ¨ä»–ä»¬çš„ ${user.home}/.m2 ç›®å½• è¿™ä¸ªæ–‡ä»¶è¦ä¹ˆåŒ…å«ï¼ˆeither containsï¼‰\båŠ å¯†çš„ä¸»å¯†ç ï¼Œç”¨äºåŠ å¯†å…¶ä»–å¯†ç  æˆ–è€…å®ƒå¯ä»¥åŒ…å«ä¸€ä¸ªè¿ç§»ï¼ˆrelocatonï¼‰- å¼•ç”¨åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ï¼Œä¹Ÿè®¸åœ¨å¯ç§»åŠ¨å­˜å‚¨è®¾å¤‡ä¸Š è¿™ä¸ªå¯†ç å…ˆé€šè¿‡ï¼ˆfirst viaï¼‰ CLI åˆ›å»º setting.xml ä¸­çš„æœåŠ¡æ¡ç›®åŠ å¯†äº†å¯†ç  æˆ– \bå¯†é’¥ä»“åº“å¯†ç  ç°åœ¨ï¼Œä¸»å¯†ç è¢«åˆ›å»ºå¹¶å­˜å‚¨åˆ°äº†åˆé€‚ï¼ˆappropriateï¼‰çš„ä½ç½®ï¼Œè¿™æ˜¯é€šè¿‡ CLI å®Œæˆçš„ã€‚ å¦‚ä½•åˆ›å»ºä¸»å¯†ç ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ 1mvn --encrypt-master-password &lt;password&gt; 1æ³¨æ„ï¼šä» maven 3.2.1 å¼€å§‹è¿™ä¸ªå¯†ç å‚æ•°ä¸å†ï¼ˆshould no longerï¼‰ä½¿ç”¨ï¼ˆæŸ¥çœ‹ä»¥ä¸‹çš„æç¤ºè·å¾—æ›´å¤šä¿¡æ¯ï¼‰ã€‚maven å°†æç¤ºï¼ˆpromptï¼‰è¾“å…¥å¯†ç ã€‚æ—©æœŸï¼ˆEarlierï¼‰ç‰ˆæœ¬çš„ maven ä¸ä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œæ‰€ä»¥å¿…é¡»åœ¨\bå‘½ä»¤è¡Œè¾“å…¥\bæ˜æ–‡å¯†ç ã€‚ è¿™ä¸ªå‘½ä»¤å°†ä¼š\bäº§ç”Ÿä¸€ä¸ªå¯†ç åŠ å¯†ä¹‹åçš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼š 1{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+9EF1iFQyJQ=} åœ¨ ${user.home}/.m2/settings-security.xml ä¸­å­˜å‚¨è¯¥å¯†ç ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š \bè¯‘æ³¨ï¼šå¦‚æœæ²¡æœ‰ settings-security.xml æ–‡ä»¶è‡ªå·±åˆ›å»ºå³å¯ã€‚æŠŠå†…å®¹å¤åˆ¶è¿›å»ã€‚ 123&lt;settingsSecurity&gt; &lt;master&gt;{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+9EF1iFQyJQ=}&lt;/master&gt;&lt;/settingsSecurity&gt; å½“ä¸Šè¿°æ­¥éª¤å®Œæˆä¹‹åï¼Œä½ å¯ä»¥å¼€å§‹åŠ å¯†\bæœåŠ¡å™¨å¯†ç äº†ã€‚ å¦‚ä½•åŠ å¯†æœåŠ¡å¯†ç ä½ å¿…é¡»ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š 1mvn --encrypt-password &lt;password&gt; 1æç¤ºï¼šå°±åƒ mvn --encrypt-master-password ä¸€æ ·ã€‚è¿™ä¸ªå¯†ç å‚æ•°ä» maven 3.2.1 å¼€å§‹\bä¸å†ä½¿ç”¨ï¼ˆè§æ–‡æ¡£ï¼‰ è¿™ä¸ªå‘½ä»¤ä¼šäº§ç”Ÿä¸€ä¸ªå¯†ç åŠ å¯†åçš„ç‰ˆæœ¬ï¼Œå¦‚ï¼š 1{COQLCE6DU6GtcS5P=} å‰ªåˆ‡ç²˜è´´åˆ°æ‚¨ \bsetting.xml æ–‡ä»¶çš„æœåŠ¡èŠ‚ç‚¹ï¼Œå¦‚ä¸‹ï¼š 12345678910111213&lt;settings&gt;... &lt;servers&gt;... &lt;server&gt; &lt;id&gt;my.server&lt;/id&gt; &lt;username&gt;foo&lt;/username&gt; &lt;password&gt;{COQLCE6DU6GtcS5P=}&lt;/password&gt; &lt;/server&gt;... &lt;/servers&gt;...&lt;/settings&gt; è¯·æ³¨æ„ï¼šå¯†ç å¯ä»¥åœ¨èŠ±æ‹¬å·å¤–ï¼ˆoutside of the curly bracketsï¼‰åŒ…å«ä»»æ„ä¿¡æ¯ã€‚æ‰€ä»¥ä»¥ä¸‹ä»ç„¶å¯ä»¥\bå·¥ä½œï¼š 12345678910111213&lt;settings&gt;... &lt;servers&gt;... &lt;server&gt; &lt;id&gt;my.server&lt;/id&gt; &lt;username&gt;foo&lt;/username&gt; &lt;password&gt;Oleg reset this password on 2009-03-11, expires on 2009-04-11 {COQLCE6DU6GtcS5P=}&lt;/password&gt; &lt;/server&gt;... &lt;/servers&gt;...&lt;/settings&gt; ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ï¼Œæ¯”å¦‚è¯´ï¼Œéƒ¨ç½²æ’ä»¶ã€‚è¦å†™å…¥æ­¤æœåŠ¡å™¨ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œ: 123mvn deploy:deploy-file -Durl=https://maven.corp.com/repo \\ -DrepositoryId=my.server \\ -Dfile=your-artifact-1.0.jar \\ å¦‚ä½•åœ¨å¯ç§»åŠ¨è®¾å¤‡ä¸Šä¿å­˜ä¸»å¯†ç \bå’Œä¸Šæ–‡æ‰€è¿°ï¼ˆdescribed aboveï¼‰çš„ä¸€æ ·ï¼ˆexactly asï¼‰åˆ›å»ºä¸»å¯†ç ï¼Œç„¶åå­˜å‚¨åˆ°å¯ç§»åŠ¨è®¾å¤‡ä¸­ï¼Œä»¥ OSX ä¸ºä¾‹ï¼Œæˆ‘çš„ USB é©±åŠ¨æŒ‚è½½åœ¨ /Volumes/mySecureUsbï¼Œæ‰€ä»¥æˆ‘å­˜å‚¨ï¼ˆä»¥ä¸‹å†…å®¹ï¼‰ï¼š 123&lt;settingsSecurity&gt; &lt;master&gt;{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+9EF1iFQyJQ=}&lt;/master&gt;&lt;/settingsSecurity&gt; åˆ° /Volumes/mySecureUsb/secure/settings-security.xml ç„¶åæˆ‘åˆ›å»º ${user.home}/.m2/settings-security.xml ï¼Œå†…å®¹å¦‚ä¸‹ï¼š 123&lt;settingsSecurity&gt; &lt;relocation&gt;/Volumes/mySecureUsb/secure/settings-security.xml&lt;/relocation&gt;&lt;/settingsSecurity&gt; è¿™ä¿è¯äº†åªæœ‰å½“ usb é©±åŠ¨æŒ‚è½½åˆ°äº†æ“ä½œç³»ç»Ÿä¸Šï¼ˆOSï¼‰ä¸Šï¼ŒåŠ å¯†æ‰èƒ½å·¥ä½œã€‚è¿™è§£å†³äº†ï¼ˆthis addresses aï¼‰ä¸€ä¸ªç”¨ä¾‹ï¼Œå…¶ä¸­åªæœ‰ç‰¹å®šï¼ˆcertainï¼‰çš„äººè¢«æˆæƒéƒ¨ç½²å’Œå‘å¸ƒï¼ˆissuedï¼‰è¿™äº›è®¾å¤‡ã€‚ å°æç¤ºåœ¨æ‚¨çš„å¯†ç ä¸­è½¬ä¹‰ï¼ˆescapingï¼‰\bèŠ±æ‹¬å·ï¼ˆcurly-braceï¼‰æ–‡æœ¬ï¼ˆliteralsï¼‰ æœ‰æ—¶ï¼ˆas timeï¼‰ï¼Œä½ å¯èƒ½å‘ç°ä½ çš„å¯†ç ï¼ˆæˆ–ä»¥æ­¤åŠ å¯†çš„ï¼‰å¯èƒ½ç¡®å®åŒ…å« { æˆ– } ä½œä¸ºæ–‡å­—å€¼ã€‚ è¯‘æ³¨ï¼šmaven åŠ å¯†çš„å¯†ç æœ€å¤–å±‚éƒ½æœ‰èŠ±æ‹¬å·åŒ…å›´ï¼Œé€šå¸¸æˆ‘ä»¬åŠ å¯†åçš„å¯†ç éƒ½æ˜¯ï¼š{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+EF1iFQyJQ==} çš„å½¢å¼ï¼Œå¯†ç æ˜¯ jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+EF1iFQyJQ==ã€‚\\ä½†å¯èƒ½ä¸æ’é™¤æœ‰è¿™æ ·çš„å¯†ç ï¼Œä»–ä»¬å¯†ç ä¸­é—´å°±åŒ…å«äº†èŠ±æ‹¬å·ï¼šjSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+{EF1iFQyJQ=ï¼Œå¤–é¢å†è¢«ä¸€ä¸ªå¤§æ‹¬å·åŒ…å›´ï¼Œå°±æˆäº†è¿™æ ·ï¼š{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+{EF1iFQyJQ=} å¦‚æœä½ å°†è¿™æ ·ï¼ˆsuch aï¼‰çš„å¯†ç åŸæ ·ï¼ˆas-isï¼‰çš„æ”¾åœ¨ä½ çš„ settings.xml ä¸­ï¼Œä½ ä¼šå‘ç° maven å¯¹æ­¤åšäº†ä¸€äº›å¥‡æ€ªï¼ˆstrangeï¼‰çš„äº‹æƒ…ã€‚å…·ä½“çš„è¯´ï¼ˆSpecificallyï¼‰ï¼Œmaven ä¼šå¤„ç†ï¼ˆtreatï¼‰ { å­—é¢ç¬¦\bä¹‹å‰\bï¼ˆprecedingï¼‰æ‰€æœ‰çš„æ–‡æœ¬ï¼ˆLiteralsï¼‰ï¼Œå’Œå¤„ç† } å­—é¢ç¬¦ä¹‹åçš„æ‰€æœ‰å­—ç¬¦ã€‚ä½œä¸ºè¯„è®ºï¼Œå¾ˆæ˜æ˜¾çš„ï¼ˆObviuslyï¼‰ï¼Œè¿™ç§æƒ…å†µï¼ˆsush a siluationï¼‰ä¸‹ï¼Œè¿™ä¸æ˜¯æ‚¨æƒ³è¦çš„è¡Œä¸ºï¼ˆbehaviorï¼‰ã€‚ä½ çœŸæ­£éœ€è¦çš„æ˜¯ä¸€ç§è½¬ä¹‰ï¼ˆescapingï¼‰ä½ å¯†ç ä¸­çš„èŠ±æ‹¬å·çš„æ–¹æ³•ã€‚ ä» maven 2.2.0 èµ·ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼Œä¸å¹¿æ³›ä½¿ç”¨çš„ï¼ˆwidely usedï¼‰çš„ \\ è½¬ä¹‰å­—ç¬¦ï¼ˆescape \bcharacterï¼‰ã€‚å¦‚æœä½ çš„å¯†ç çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š 1jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+{EF1iFQyJQ= \bé‚£ä¹ˆï¼Œä½ å¯ä»¥åƒè¿™æ ·æ·»åŠ \bå€¼åˆ°ä½ çš„ settings.xml ä¸­: 1{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+\\{EF1iFQyJQ=} å¯†ç å®‰å…¨ ç¼–è¾‘ settings.xml å¹¶è¿è¡Œä»¥ä¸Šå‘½ä»¤ä¾ç„¶å¯ä»¥ä»¥æ˜æ–‡ï¼ˆplaintextï¼‰çš„å½¢å¼ä¿å­˜ï¼ˆleaveï¼‰ä½ çš„å¯†ç åˆ°æœ¬åœ°ï¼Œä½ å¯èƒ½éœ€è¦æ£€æŸ¥ä»¥ä¸‹ä½ç½®ï¼š shell å†å²ï¼ˆä¾‹å¦‚ï¼šè¿è¡Œ historyï¼‰ã€‚ä½ å¯èƒ½æƒ³è¦åœ¨åŠ å¯†ï¼ˆencryingï¼‰ä¸Šè¿°å¯†ç ï¼ˆabove passwordï¼‰ä¹‹åæ¸…é™¤ä½ çš„å†å²è®°å½• ç¼–è¾‘å™¨ç¼“å­˜ã€‚ï¼ˆä¾‹å¦‚ï¼š~/.viminfoï¼‰ åŒæ ·æ³¨æ„ï¼ˆnoteï¼‰ï¼ŒåŠ å¯†\båçš„å¯†ç å¯ä»¥è¢«æ‹¥æœ‰ä¸»å¯†ç å’Œè®¾ç½®å®‰å…¨æ–‡ä»¶çš„æŸäº›äººï¼ˆsomeoneï¼‰è§£å¯†ï¼ˆ\bdecrypted by è¢«è§£å¯†ï¼‰ã€‚ä¿æŒè¿™ä¸ªæ–‡ä»¶å®‰å…¨ï¼ˆ\bæˆ–åˆ†åˆ«å­˜å‚¨ï¼‰,å¦‚æœä½ å¸Œæœ›å¯ä»¥ï¼ˆexpect polibility æœŸå¾…å¯èƒ½æ€§\bï¼‰æ£€ç´¢ï¼ˆretriedï¼‰ settings.xml æ–‡ä»¶çš„è¯ã€‚ ä¸åŒå¹³å°çš„å¯†ç è½¬ä¹‰ç¬¦ åœ¨ä¸€äº›å¹³å°ä¸Šï¼Œä½ å¯èƒ½ï¼ˆneccessaryï¼‰éœ€è¦åŸºäºï¼ˆbase onï¼‰ä½ çš„å¯†ç å†…å®¹æ·»åŠ å¼•å·ï¼ˆquoteï¼‰ï¼Œç‰¹åˆ«æ˜¯ï¼ˆin particularï¼‰å«æœ‰ç‰¹æ®Šå­—ç¬¦çš„æ¯”å¦‚ï¼š%,!,$ã€‚ä¾‹å¦‚åœ¨ window ä¸Šä½ éœ€è¦å°å¿ƒæ¯”å¦‚åƒä»¥ä¸‹è¿™ç§ï¼š ä»¥ä¸‹æ¡ˆä¾‹åœ¨ Windows ä¸Š\bå°†ä¸èµ·ä½œç”¨ï¼š 1mvn --encrypt-master-password a!$%^b ç„¶è€Œï¼ˆwhereasï¼‰ï¼Œä»¥ä¸‹å†…å®¹é€‚ç”¨äº Windowsï¼š 1mvn --encrypt-master-password \"a!$%^b\" å¦‚æœä½ åœ¨Linux/Unixå¹³å°ä¸Šï¼Œä½ åº”è¯¥ä½¿ç”¨ä¸Šé¢çš„ä¸»å¯†ç çš„å•å¼•å·ã€‚å¦åˆ™ä½ ä¼šæƒŠè®¶çš„ï¼ˆastonishedï¼‰å‘ç°ä½¿ç”¨ä¸»å¯†ç å°†ä¸èµ·ä½œç”¨ï¼ˆç”±ç¾å…ƒç¬¦å·ï¼ˆdollar signï¼‰å’Œæ„Ÿå¹å·ï¼ˆexclamation markï¼‰å¼•èµ·ï¼‰ã€‚ å¯†ç è¾“å…¥æç¤º åœ¨ maven 3.2.1 ä¹‹å‰ä½ å¿…é¡»åœ¨å‘½ä»¤è¡Œå‚æ•°ä¸Šç»™å®šå¯†ç ï¼Œè¿™æ„å‘³ç€ä½ å¯èƒ½éœ€è¦è½¬ä¹‰ï¼ˆescapeï¼‰ä½ çš„å¯†ç ã€‚æ­¤å¤–ï¼ˆin additionï¼‰ï¼Œé€šå¸¸ shell ä¼šå­˜å‚¨ä½ åœ¨å‘½ä»¤è¡Œè¾“å…¥çš„å®Œæ•´å†å²ã€‚æ‰€ä»¥ï¼ˆthereforeï¼‰\bä»»ä½•äºº\bè®¿é—®ä½ ç”µè„‘çš„äººéƒ½å¯ä»¥é€šè¿‡ shell çš„å†å²\bæ¢å¤ï¼ˆrestoreï¼‰ä½ çš„å¯†ç ã€‚ ä» Maven 3.2.1 å¼€å§‹ï¼Œå¯†ç æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè¿™æ„å‘³ç€å¦‚æœçœç•¥ï¼ˆomitï¼‰å¯†ç ï¼Œç³»ç»Ÿå°†æç¤ºï¼ˆpromptedï¼‰æ‚¨è¾“å…¥å¯†ç ï¼Œè¿™å°†é˜»æ­¢ï¼ˆpreventsï¼‰ä¸Šè¿°ï¼ˆaboveï¼‰æè¿‡ï¼ˆmentionedï¼‰çš„æ‰€æœ‰é—®é¢˜ï¼ˆissuesï¼‰ã€‚ è¯‘æ³¨ï¼šä½¿ç”¨ mvn â€“encrypt-master-password ä¸å¸¦å¯†ç å‚æ•°\bï¼Œä¼šè¦æ±‚è¾“å…¥å¯†ç ã€‚è¿™ä¸ªè¾“å…¥æ˜¯ä¸å¯è§çš„ï¼Œå‘½ä»¤è¡Œæ²¡æœ‰è®°å½•çš„ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®ï¼ˆsrongly recommendï¼‰ä½¿ç”¨ Maven 3.2.1 åŠæ›´é«˜ç‰ˆæœ¬æ¥é˜²æ­¢ï¼ˆpreventï¼‰è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦çš„é—®é¢˜ï¼Œå½“ç„¶ï¼ˆof courseï¼‰è¿˜æœ‰ä¸bashå†å²ç›¸å…³çš„å®‰å…¨é—®é¢˜æˆ–ä¸å¯†ç ç›¸å…³çš„ç¯å¢ƒé—®é¢˜ã€‚","link":"/2019/05/31/[20190531] maven | password encryption/"},{"title":"20190601 spring-boot | overview","text":"OverviewSpring Boot makes it easy to create stand-alone, production-grade Spring based Applications that you can â€œjust runâ€. We take an opinionated view of the Spring platform and third-party libraries so you can get started with minimum fuss. Most Spring Boot applications need very little Spring configuration. Features Create stand-alone Spring applications Embed Tomcat, Jetty or Undertow directly (no need to deploy WAR files) Provide opinionated â€˜starterâ€™ dependencies to simplify your build configuration Automatically configure Spring and 3rd party libraries whenever possible Provide production-ready features such as metrics, health checks and externalized configuration Absolutely no code generation and no requirement for XML configuration You can also join the Spring Boot community on Gitter! æ¦‚è¿°Spring Boot è®©å•ä½“\båº”ç”¨çš„åˆ›å»ºå˜å¾—ç®€å•ï¼ŒåŸºäºç”Ÿäº§çº§åˆ«çš„ \b\bspring åº”ç”¨ä½ å¯ä»¥ â€˜ç›´æ¥è¿è¡Œâ€™ã€‚ æˆ‘ä»¬å¯¹spring\bå¹³å°å’Œç¬¬ä¸‰æ–¹ç±»åº“é‡‡å–ï¼ˆtake onï¼‰è‡ªå·±çš„ï¼ˆopinionatedå›ºæ‰§å·±è§çš„\bï¼‰çœ‹æ³•ï¼ˆview çœ‹æ³•ï¼Œè§‚å¿µï¼‰ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥ä»¥æœ€å°çš„éº»çƒ¦å¿«é€Ÿå¯åŠ¨ã€‚å¤§å¤šæ•°çš„springåº”ç”¨åªéœ€è¦å°‘é‡çš„é…ç½®ã€‚ ç‰¹æ€§ï¼ˆåŠŸèƒ½ï¼‰ åˆ›å»ºsoringå•ä½“åº”ç”¨ å†…åµŒ tomcatï¼Œjettyæˆ–è€…undertow directlyï¼ˆä¸éœ€è¦éƒ¨ç½² war æ–‡ä»¶ï¼‰ æä¾›è‡ªå·±çš„ starer \bä¾èµ–ç®€åŒ–ä½ çš„é…ç½® \bå°½å¯èƒ½åšåˆ°ï¼ˆwhenever possibleï¼‰åŠ¨æ€é…ç½® spring å’Œç¬¬ä¸‰æ–¹å¹³å°ç±»åº“ æä¾›å¯ä¾›ç”Ÿäº§çš„ï¼ˆproduction-ready ï¼‰åŠŸèƒ½å¦‚ metrics, å¥åº·æ£€æŸ¥å’Œå¤–éƒ¨åŒ–ï¼ˆexternalizedï¼‰é…ç½®\bã€‚","link":"/2019/06/01/[20190601] spring-boot | overview/"},{"title":"20190602 spring-boot | part1","text":"Spring Boot Reference Guide2.1.5.RELEASEhttps://docs.spring.io/spring-boot/docs/2.1.5.RELEASE/reference/htmlsingle/ Part I. Spring Boot Documentation Part I. Spring Boot Documentation 1. About the Documentation 2. Getting Help 3. First Steps 4. Working with Spring Boot 5. Learning about Spring Boot Features 6. Moving to Production 7. Advanced Topics ç¬¬ä¸€å•å…ƒï¼šSpring Boot æ–‡æ¡£ 1. å…³äºæ–‡æ¡£ 2. è·å¾—å¸®åŠ© 3. ç¬¬ä¸€æ­¥ 4. ä½¿ç”¨ spring boot å·¥ä½œ 5. å­¦ä¹  spring boot çš„ç‰¹æ€§åŠŸèƒ½ 6. ç§»åŠ¨åˆ°ç”Ÿäº§ 7. é«˜çº§ä¸»é¢˜ Part I. Spring Boot DocumentationThis section provides a brief overview of Spring Boot reference documentation. It serves as a map for the rest of the document. 1. About the DocumentationThe Spring Boot reference guide is available as HTML PDF EPUB The latest copy is available at docs.spring.io/spring-boot/docs/current/reference. Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically. 2. Getting HelpIf you have trouble with Spring Boot, we would like to help. Try the How-to documents. They provide solutions to the most common questions. Learn the Spring basics. Spring Boot builds on many other Spring projects. Check the spring.io web-site for a wealth of reference documentation. If you are starting out with Spring, try one of the guides. Ask a question. We monitor stackoverflow.com for questions tagged with spring-boot. Report bugs with Spring Boot at github.com/spring-projects/spring-boot/issues. All of Spring Boot is open source, including the documentation. If you find problems with the docs or if you want to improve them, please get involved. 3. First StepsIf you are getting started with Spring Boot or â€˜Springâ€™ in general, start with the following topics: From scratch: Overview | Requirements | Installation Tutorial: Part 1 | Part 2 | Running your example: Part 1 | Part 2 4. Working with Spring BootReady to actually start using Spring Boot? We have you covered: Build systems: Maven | Gradle | Ant | Starters Best practices: Code Structure | @Configuration | @EnableAutoConfiguration | Beans and Dependency Injection Running your code: IDE | Packaged | Maven | Gradle Packaging your app: Production jars Spring Boot CLI: Using the CLI 5. Learning about Spring Boot FeaturesNeed more details about Spring Bootâ€™s core features? The following content is for you: Core Features: SpringApplication | External Configuration | Profiles | Logging Web Applications: MVC | Embedded Containers Working with data: SQL | NO-SQL Messaging: Overview | JMS Testing: Overview | Boot Applications | Utils Extending: Auto-configuration | @Conditions 6. Moving to ProductionWhen you are ready to push your Spring Boot application to production, we have some tricks that you might like: Management endpoints: Overview | Customization Connection options: HTTP | JMX Monitoring: Metrics | Auditing | Tracing | Process 7. Advanced TopicsFinally, we have a few topics for more advanced users: Spring Boot Applications Deployment: Cloud Deployment | OS Service Build tool plugins: Maven | Gradle Appendix: Application Properties | Auto-configuration classes | Executable Jars ç¬¬ä¸€å•å…ƒï¼šSpring Boot æ–‡æ¡£è¿™ä¸€ç« èŠ‚æä¾›å¯¹spring bootå‚è€ƒæ–‡æ¡£çš„ç®€è¦æ¦‚è¿°ï¼ˆa brief overviewï¼‰ã€‚å®ƒå¯ä»¥ä½œä¸ºï¼ˆserves asï¼‰æ–‡æ¡£å…¶ä½™éƒ¨åˆ†ï¼ˆrest ofï¼‰çš„æ˜ å°„ã€‚ 1. å…³äºæ–‡æ¡£è¯¥ spring boot å‚è€ƒæ–‡æ¡£å¯ç”¨æœ‰ html pdf EPUB æœ€æ–°çš„å‰¯æœ¬å¯åœ¨ docs.spring.io/spring-boot/docs/current/reference. æ­¤æ–‡æ¡£çš„å‰¯æœ¬ï¼ˆcopies of this documentï¼‰å¯ä»¥\bä¸ºï¼ˆmade forï¼‰ä½ è‡ªå·±ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åˆ†å‘ï¼ˆdistributionï¼‰ç»™åˆ«äººã€‚ä½†éœ€ï¼ˆprovided thatï¼‰è¦ä½ å¯¹è¿™äº›å‰¯æœ¬ï¼ˆsuch copiesï¼‰ä¸æ”¶å–ï¼ˆchargeï¼‰ä»»ä½•è´¹ç”¨ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªå‰¯æœ¬éœ€è¦åŒ…å«ç‰ˆæƒç”³æ˜ï¼Œæ— è®ºï¼ˆwhetherï¼‰æ˜¯å°åˆ·å‘è¡Œè¿˜æ˜¯ç”µå­å‘è¡Œã€‚ 2. è·å¾—å¸®åŠ©å¦‚æœä½ ä½¿ç”¨ spring boot æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬æ„¿æ„ï¼ˆwould likeï¼‰å¸®åŠ©ï¼š å°è¯•ä½¿ç”¨æ“ä½œï¼ˆhow-doï¼‰æ–‡æ¡£ã€‚ä»–ä»¬å¯¹å¤§å¤šæ•°é—®é¢˜æä¾›äº†è§£å†³æ–¹æ¡ˆã€‚ å­¦ä¹  spring åŸºç¡€ï¼Œspring boot å»ºç«‹åœ¨è®¸å¤š spring é¡¹ç›®ä¹‹ä¸Šã€‚æŸ¥çœ‹spring.ioç½‘ç«™è·å–å¤§é‡ï¼ˆa wealth ofï¼‰å‚è€ƒæ–‡æ¡£ã€‚å¦‚æœæ‚¨ä» \bspring å¼€å§‹ï¼Œå°è¯•å…¶ä¸­ä¸€ä¸ªæŒ‡å—ã€‚ è¯¢é—®é—®é¢˜ï¼Œæˆ‘ä»¬ä¼šç›‘è§†ï¼ˆmonitorï¼‰ stackoverflow.com è·å–æ ‡ç­¾ä¸º spring-boot çš„é—®é¢˜ã€‚ åœ¨ github.com/spring-projects/spring-boot/issues. ä¸Šåé¦ˆ spring boot çš„bugã€‚ 1spring boot çš„æ‰€æœ‰éƒ½æ˜¯å¼€æºçš„ï¼ŒåŒ…è£¹å‚è€ƒæ–‡æ¡£ã€‚å¦‚æœä½ åœ¨è¯¥æ–‡æ¡£ä¸­å‘ç°é—®é¢˜å¹¶æƒ³æ”¹å–„ï¼ˆimproveï¼‰ä»–ä»¬ï¼Œè¯·å‚ä¸è¿›æ¥ï¼ˆget \binvolvedï¼‰ã€‚ 3. ç¬¬ä¸€æ­¥å¦‚æœæ‚¨è¦å¼€å§‹ä½¿ç”¨ spring boot æˆ–è€…é€šç”¨çš„ \bspringï¼Œä»\bä»¥ä¸‹ä¸»é¢˜å¼€å§‹ï¼š ä»å¤´å¼€å§‹ï¼ˆFrom scratchï¼‰ï¼šæ¦‚è§ˆ | è¦æ±‚ | å®‰è£… æŒ‡å—ï¼šå•å…ƒ1 | å•å…ƒ2 è¿è¡Œä½ çš„æ¡ˆä¾‹ï¼šå•å…ƒ1 | å•å…ƒ2 4. ä½¿ç”¨ spring boot å·¥ä½œç¡®å®šï¼ˆactuallyï¼‰å‡†å¤‡å¼€å§‹\bä½¿ç”¨ spring bootï¼Ÿæˆ‘ä»¬ä¸ºæ‚¨æ¶µç›–äº†ï¼ˆä»¥ä¸‹å†…å®¹ï¼‰ï¼š æ„å»ºç³»ç»Ÿï¼šmaven | gradle | ant starters æœ€ä½³å®æˆ˜ï¼ˆparcticesï¼‰ï¼šä»£ç ç»“æ„ | @Configuration | @EnableAutoConfiguration | Beans å’Œä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰ è¿è¡Œä½ çš„ä»£ç ï¼š\bIDE | Packaged | Maven | Gradle æ‰“åŒ…ä½ çš„åº”ç”¨ï¼šç”Ÿäº§çš„jar spring boot CLIï¼š ä½¿ç”¨ CLI 5. å­¦ä¹  spring boot çš„ç‰¹æ€§åŠŸèƒ½æƒ³è¦æ›´å¤š spring boot æ ¸å¿ƒåŠŸèƒ½çš„ç»†èŠ‚ï¼Ÿä»¥ä¸‹å†…å®¹ä¾›æ‚¨å‚è€ƒï¼š æ ¸å¿ƒåŠŸèƒ½ï¼šSpringApplication | External Configurationå¤–éƒ¨é…ç½® | Profiles | Logging web å®¹å™¨ï¼šMVC | Embeddedï¼ˆåµŒå…¥å¼ï¼‰ Containers ä½¿ç”¨æ•°æ®ï¼šSQL | NO-SQL æ¶ˆæ¯ï¼šæ¦‚è¿° | JMS æµ‹è¯•ï¼šæ¦‚è¿° | Boot åº”ç”¨ | å•å…ƒæµ‹è¯• æ‹“å±•ï¼ˆExtendingï¼‰ï¼šè‡ªåŠ¨é…ç½® | @Conditions 6. ç§»åŠ¨åˆ°ç”Ÿäº§\bå½“æ‚¨å‡†å¤‡æ¨é€ä½ çš„ spring boot åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œæˆ‘ä»¬æä¾›ä¸€ä¸ª\bä¸€äº›å°çªé—¨ï¼ˆsome tricks ï¼‰ä½ å¯èƒ½å–œæ¬¢ï¼š ç®¡ç†\b\bç«¯ç‚¹ï¼ˆManagement endpointsï¼‰: Overview | Customization é“¾æ¥é€‰é¡¹ï¼ˆConnection optionsï¼‰: HTTP | JMX ç›‘æµ‹ï¼ˆMonitoringï¼‰: Metrics | Auditing | Tracing | Process 7. é«˜çº§ä¸»é¢˜æœ€åï¼Œæˆ‘ä»¬ä¸ºæ›´é«˜çº§ç”¨æˆ·æä¾›äº†ä¸€äº›ï¼ˆa fewï¼‰çš„ä¸»é¢˜ï¼š spring boot åº”ç”¨éƒ¨ç½²ï¼šCloud Deployment | OS Service æ„å»ºå·¥å…·æ’ä»¶ï¼šMaven | Gradle é™„å½•ï¼ˆAppendixï¼‰ï¼šApplication Properties | Auto-configuration classes | Executable Jars å¯æ‰§è¡Œjar","link":"/2019/06/02/[20190602] spring-boot | part1/"},{"title":"20190603 spring-boot | part2(8~10)","text":"Spring Boot Reference Guide2.1.5.RELEASEhttps://docs.spring.io/spring-boot/docs/2.1.5.RELEASE/reference/htmlsingle/#getting-started Part II. Getting Started 8. Introducing Spring Boot 9. System Requirements 9.1 Servlet Containers 10. Installing Spring Boot 10.1 Installation Instructions for the Java Developer 10.1.1 Maven Installation 10.1.2 Gradle Installation 10.2 Installing the Spring Boot CLI 10.2.1 Manual Installation 10.2.2 Installation with SDKMAN! 10.2.3 OSX Homebrew Installation 10.2.4 MacPorts Installation 10.2.5 Command-line Completion 10.2.6 Windows Scoop Installation 10.2.7 Quick-start Spring CLI Example 10.3 Upgrading from an Earlier Version of Spring Boot 8. \bspring boot ä»‹ç» 9. ç³»ç»Ÿè¦æ±‚ 9.1 \bServlet å®¹å™¨ 10. å®‰è£… spring boot 10.1 java å¼€å‘è€…çš„å®‰è£…ä»‹ç» 10.1.1 Maven å®‰è£… 10.1.2 ç»§æ‰¿ Gradle 10.2 å®‰è£… Spring Boot CLIï¼ˆå‘½ä»¤è¡Œå·¥å…·ï¼‰ 10.2.1 æ‰‹åŠ¨å®‰è£… 10.2.2 SDKMAN å®‰è£… 10.2.3 OSX Homebrew å®‰è£… 10.2.4 MacPorts å®‰è£… 10.2.5 å‘½ä»¤è¡Œç¼–è¯‘ 10.2.6 Windows Scoop å®‰è£… 10.2.7 Spring CLI æ¡ˆä¾‹å¿«é€Ÿå¼€å§‹ 10.3 ä» SpringBoot çš„æ—©æœŸï¼ˆEarlierï¼‰ç‰ˆæœ¬å‡çº§ If you are getting started with Spring Boot, or â€œSpringâ€ in general, start by reading this section. It answers the basic â€œwhat?â€, â€œhow?â€ and â€œwhy?â€ questions. It includes an introduction to Spring Boot, along with installation instructions. We then walk you through building your first Spring Boot application, discussing some core principles as we go. 8. Introducing Spring BootSpring Boot makes it easy to create stand-alone, production-grade Spring-based Applications that you can run. We take an opinionated view of the Spring platform and third-party libraries, so that you can get started with minimum fuss. Most Spring Boot applications need very little Spring configuration. You can use Spring Boot to create Java applications that can be started by using java -jar or more traditional war deployments. We also provide a command line tool that runs â€œspring scriptsâ€. Our primary goals are: Provide a radically faster and widely accessible getting-started experience for all Spring development. Be opinionated out of the box but get out of the way quickly as requirements start to diverge from the defaults. Provide a range of non-functional features that are common to large classes of projects (such as embedded servers, security, metrics, health checks, and externalized configuration). Absolutely no code generation and no requirement for XML configuration. 9. System RequirementsSpring Boot 2.1.5.RELEASE requires Java 8 and is compatible up to Java 11 (included). Spring Framework 5.1.7.RELEASE or above is also required. Explicit build support is provided for the following build tools: Build Tool Version Maven 3.3+ Gradle 4.4+ 9.1 Servlet ContainersSpring Boot supports the following embedded servlet containers: Name Servlet Version Tomcat 9.0 4.0 Jetty 9.4 3.1 Undertow 2.0 4.0 You can also deploy Spring Boot applications to any Servlet 3.1+ compatible container. 10. Installing Spring BootSpring Boot can be used with â€œclassicâ€ Java development tools or installed as a command line tool. Either way, you need Java SDK v1.8 or higher. Before you begin, you should check your current Java installation by using the following command: 1$ java -version If you are new to Java development or if you want to experiment with Spring Boot, you might want to try the Spring Boot CLI (Command Line Interface) first. Otherwise, read on for â€œclassicâ€ installation instructions. 10.1 Installation Instructions for the Java DeveloperYou can use Spring Boot in the same way as any standard Java library. To do so, include the appropriate spring-boot-*.jar files on your classpath. Spring Boot does not require any special tools integration, so you can use any IDE or text editor. Also, there is nothing special about a Spring Boot application, so you can run and debug a Spring Boot application as you would any other Java program. Although you could copy Spring Boot jars, we generally recommend that you use a build tool that supports dependency management (such as Maven or Gradle). 10.1.1 Maven InstallationSpring Boot is compatible with Apache Maven 3.3 or above. If you do not already have Maven installed, you can follow the instructions at maven.apache.org. On many operating systems, Maven can be installed with a package manager. If you use OSX Homebrew, try brew install maven. Ubuntu users can run sudo apt-get install maven. Windows users with Chocolatey can run choco install mavenfrom an elevated (administrator) prompt. Spring Boot dependencies use the org.springframework.boot groupId. Typically, your Maven POM file inherits from the spring-boot-starter-parent project and declares dependencies to one or more [â€œStartersâ€]. Spring Boot also provides an optional [Maven plugin] to create executable jars. The following listing shows a typical pom.xml file: 1234567891011121314151617181920212223242526272829303132333435&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.example&lt;/groupId&gt; &lt;artifactId&gt;myproject&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;!-- Inherit defaults from Spring Boot --&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.5.RELEASE&lt;/version&gt; &lt;/parent&gt; &lt;!-- Add typical dependencies for a web application --&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;!-- Package as an executable jar --&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; The spring-boot-starter-parent is a great way to use Spring Boot, but it might not be suitable all of the time. Sometimes you may need to inherit from a different parent POM, or you might not like our default settings. In those cases, see Section 13.2.2, [â€œUsing Spring Boot without the Parent POMâ€] for an alternative solution that uses an import scope. 10.1.2 Gradle InstallationSpring Boot is compatible with Gradle 4.4 and later. If you do not already have Gradle installed, you can follow the instructions at gradle.org. Spring Boot dependencies can be declared by using the org.springframework.boot group. Typically, your project declares dependencies to one or more â€œStartersâ€. Spring Boot provides a useful Gradle plugin that can be used to simplify dependency declarations and to create executable jars. 123Gradle WrapperThe Gradle Wrapper provides a nice way of â€œobtainingâ€ Gradle when you need to build a project. It is a small script and library that you commit alongside your code to bootstrap the build process. See docs.gradle.org/4.2.1/userguide/gradle_wrapper.html for details. More details on getting started with Spring Boot and Gradle can be found in the Getting Started section of the Gradle pluginâ€™s reference guide. 10.2 Installing the Spring Boot CLIThe Spring Boot CLI (Command Line Interface) is a command line tool that you can use to quickly prototype with Spring. It lets you run [Groovy] scripts, which means that you have a familiar Java-like syntax without so much boilerplate code. You do not need to use the CLI to work with Spring Boot, but it is definitely the quickest way to get a Spring application off the ground. 10.2.1 Manual InstallationYou can download the Spring CLI distribution from the Spring software repository: spring-boot-cli-2.1.5.RELEASE-bin.zip spring-boot-cli-2.1.5.RELEASE-bin.tar.gz Cutting edge snapshot distributions are also available. Once downloaded, follow the INSTALL.txt instructions from the unpacked archive. In summary, there is a spring script (spring.bat for Windows) in a bin/ directory in the .zip file. Alternatively, you can use java -jar with the .jar file (the script helps you to be sure that the classpath is set correctly). 10.2.2 Installation with SDKMAN!SDKMAN! (The Software Development Kit Manager) can be used for managing multiple versions of various binary SDKs, including Groovy and the Spring Boot CLI. Get SDKMAN! from sdkman.io and install Spring Boot by using the following commands: 123$ sdk install springboot$ spring --versionSpring Boot v2.1.5.RELEASE If you develop features for the CLI and want easy access to the version you built, use the following commands: 1234$ sdk install springboot dev /path/to/spring-boot/spring-boot-cli/target/spring-boot-cli-2.1.5.RELEASE-bin/spring-2.1.5.RELEASE/$ sdk default springboot dev$ spring --versionSpring CLI v2.1.5.RELEASE The preceding instructions install a local instance of spring called the dev instance. It points at your target build location, so every time you rebuild Spring Boot, spring is up-to-date. You can see it by running the following command: 12345678910111213$ sdk ls springboot================================================================================Available Springboot Versions================================================================================&gt; + dev* 2.1.5.RELEASE================================================================================+ - local version* - installed&gt; - currently in use================================================================================ 10.2.3 OSX Homebrew InstallationIf you are on a Mac and use Homebrew, you can install the Spring Boot CLI by using the following commands: 12$ brew tap pivotal/tap$ brew install springboot Homebrew installs spring to /usr/local/bin. If you do not see the formula, your installation of brew might be out-of-date. In that case, run brew update and try again. 10.2.4 MacPorts InstallationIf you are on a Mac and use MacPorts, you can install the Spring Boot CLI by using the following command: 1$ sudo port install spring-boot-cli 10.2.5 Command-line CompletionThe Spring Boot CLI includes scripts that provide command completion for the BASH and zsh shells. You can source the script (also named spring) in any shell or put it in your personal or system-wide bash completion initialization. On a Debian system, the system-wide scripts are in /shell-completion/bash and all scripts in that directory are executed when a new shell starts. For example, to run the script manually if you have installed by using SDKMAN!, use the following commands: 123$ . ~/.sdkman/candidates/springboot/current/shell-completion/bash/spring$ spring &lt;HIT TAB HERE&gt; grab help jar run test version If you install the Spring Boot CLI by using Homebrew or MacPorts, the command-line completion scripts are automatically registered with your shell. 10.2.6 Windows Scoop InstallationIf you are on a Windows and use Scoop, you can install the Spring Boot CLI by using the following commands: 12&gt; scoop bucket add extras&gt; scoop install springboot Scoop installs spring to ~/scoop/apps/springboot/current/bin. If you do not see the app manifest, your installation of scoop might be out-of-date. In that case, run scoop update and try again. 10.2.7 Quick-start Spring CLI ExampleYou can use the following web application to test your installation. To start, create a file called app.groovy, as follows: 123456789@RestControllerclass ThisWillActuallyRun { @RequestMapping(\"/\") String home() { \"Hello World!\" }} Then run it from a shell, as follows: 1$ spring run app.groovy The first run of your application is slow, as dependencies are downloaded. Subsequent runs are much quicker. Open localhost:8080 in your favorite web browser. You should see the following output: 1Hello World! 10.3 Upgrading from an Earlier Version of Spring BootIf you are upgrading from an earlier release of Spring Boot, check the [â€œmigration guideâ€ on the project wiki] that provides detailed upgrade instructions. Check also the [â€œrelease notesâ€] for a list of â€œnew and noteworthyâ€ features for each release. When upgrading to a new feature release, some properties may have been renamed or removed. Spring Boot provides a way to analyze your applicationâ€™s environment and print diagnostics at startup, but also temporarily migrate properties at runtime for you. To enable that feature, add the following dependency to your project: 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-properties-migrator&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt; Properties that are added late to the environment, such as when using @PropertySource, will not be taken into account. Once youâ€™re done with the migration, please make sure to remove this module from your projectâ€™s dependencies. To upgrade an existing CLI installation, use the appropriate package manager command (for example, brew upgrade) or, if you manually installed the CLI, follow the [standard instructions], remembering to update your PATH environment variable to remove any older references. å¦‚æœæ‚¨é€šè¿‡ spring bootã€é€šç”¨çš„ spring è·å¾—å¿«é€Ÿå¼€å§‹ã€‚é˜…è¯»è¿™ä¸ªç« èŠ‚ï¼Œå®ƒä¼šå›ç­”ä½ \båŸºäº â€œæ˜¯ä»€ä¹ˆï¼Ÿâ€ï¼Œâ€œæ€ä¹ˆæ ·ï¼Ÿâ€ï¼Œâ€œä¸ºä»€ä¹ˆï¼Ÿâ€çš„é—®é¢˜ã€‚å®ƒ\båŒ…å«äº† Spring boot çš„ä»‹ç»ï¼Œä»¥åŠï¼ˆalong withï¼‰å®‰è£…è¯´æ˜ã€‚ç„¶åæˆ‘ä»¬ï¼ˆwe thenï¼‰å¼•å¯¼ä½ ï¼ˆwalk youï¼‰é€šè¿‡æ„å»ºä½ çš„ç¬¬ä¸€ä¸ª spring \bboot åº”ç”¨ï¼Œè®¨è®ºï¼ˆdiscussingï¼‰ä¸€äº›æ ¸å¿ƒåŸåˆ™ï¼ˆprinciplesï¼‰ã€‚ 8. \bspring boot ä»‹ç»spring boot ä½¿å¾—å•ä½“åº”ç”¨åˆ›å»ºå˜å¾—ç®€å•ã€‚ä½ å¯ä»¥è¿è¡Œç”Ÿäº§çº§åˆ«ï¼ˆ\bgrageï¼‰åŸºäº spring çš„åº”ç”¨ã€‚æˆ‘ä»¬å¯¹Springå¹³å°å’Œç¬¬ä¸‰æ–¹åº“æœ‰è‡ªå·±çš„çœ‹æ³•ï¼Œæ‰€ä»¥ä½ å¯ä»¥æœ€å°åŒ–çš„è·å¾—å¼€å§‹ã€‚å¤§å¤šæ•° spring boot åº”ç”¨åªéœ€è¦\b\bå¾ˆå°‘çš„é…ç½®ã€‚ ä½ å¯ä»¥ä½¿ç”¨ spring boot åˆ›å»º java \båº”ç”¨ï¼Œ\bé‚£æ ·ä½ å¯ä»¥ä½¿ç”¨ java -jar æˆ–è€… æ›´å¤šä¼ ç»Ÿï¼ˆtraditionalï¼‰çš„ war åŒ…éƒ¨ç½²ã€‚æˆ‘ä»¬åŒæ ·æä¾›å‘½ä»¤è¡Œå·¥å…·è¿è¡Œâ€œ\bspring è„šæœ¬â€ã€‚ æˆ‘ä»¬ä¸»è¦çš„ç›®æ ‡æ˜¯ï¼š ä¸ºæ‰€æœ‰çš„ spring å¼€å‘æä¾›ä¸€ç§\bæ›´åŠ å¿«é€Ÿï¼ˆpradically fasterï¼‰å’Œå¹¿æ³›è®¿é—®ï¼ˆwidly accessiblwï¼‰çš„å¿«é€Ÿå¼€å§‹ä½“éªŒã€‚ å¼€ç®±å³ç”¨ï¼ˆBe opinionated out of the boxï¼‰ï¼Œä½†éšç€éœ€æ±‚ï¼ˆrequirementsï¼‰å¼€å§‹åç¦»ï¼ˆdivergeï¼‰é»˜è®¤å€¼è€Œè¿…é€Ÿæ‘†è„±å›°å¢ƒã€‚ æä¾›ä¸€äº›ï¼ˆa range ofï¼‰éåŠŸèƒ½æ€§ï¼ˆnon-functionalï¼‰çš„ç‰¹æ€§ï¼Œï¼ˆè¿™äº›ç‰¹æ€§ï¼‰æ˜¯å¤§å‹é¡¹ç›®é€šç”¨çš„ã€‚ä¾‹å¦‚\båµŒå…¥å¼æœåŠ¡å™¨ã€å®‰å…¨ã€æµ‹é‡ã€å¥åº·æ£€æŸ¥å’Œå¤–éƒ¨åŒ–é…ç½®ã€‚ ç¡®å®æ²¡æœ‰æ²¡æœ‰ä»£ç ç”Ÿæˆ\bå’Œ xml \bé…ç½®çš„è¦æ±‚ã€‚ 9. ç³»ç»Ÿè¦æ±‚Spring Boot 2.1.5.RELEASE éœ€è¦ java 8ï¼Œå‘ä¸Šå…¼å®¹ï¼ˆcompatible upï¼‰ java 11ï¼ˆ\båŒ…æ‹¬ï¼‰ã€‚Spring Framework 5.1.7.RELEASE æˆ–\bæ›´é«˜ç‰ˆæœ¬åŒæ ·æ˜¯å¿…é¡»çš„ã€‚ ä¸º\bä»¥ä¸‹æ„å»ºå·¥å…·æä¾›äº†æ˜¾å¼ï¼ˆExplicitï¼‰æ„å»ºæ”¯æŒï¼š Build Tool Version Maven 3.3+ Gradle 4.4+ 9.1 \bServlet å®¹å™¨spring boot æä¾›äº†ä»¥ä¸‹\båµŒå…¥å¼æœåŠ¡å™¨ï¼š Name Servlet Version Tomcat 9.0 4.0 Jetty 9.4 3.1 Undertow 2.0 4.0 ä½ å¯ä»¥åŒæ ·éƒ¨ç½² spring boot åº”ç”¨åˆ°å…¼å®¹ servlet 3.1+ çš„å®¹å™¨ã€‚ 10. å®‰è£… spring bootspring boot å¯ä»¥\bä½¿ç”¨â€œç»å…¸çš„â€çš„javaéƒ¨ç½²å·¥å…·æˆ–è€…å®‰è£…å‘½ä»¤è¡Œå·¥å…·ã€‚æ— è®ºå“ªç§æ–¹å¼ï¼ˆeither wayï¼‰ï¼Œä½ éœ€è¦ jdk 1.8 æˆ–æ›´é«˜çš„ç‰ˆæœ¬ã€‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œä½ éœ€è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ä½ å½“å‰çš„javaå®‰è£…ã€‚ 1java -version å¦‚æœä½ æ˜¯ java \bå¼€å‘æ–°æ‰‹ï¼Œæˆ–è€…ä½ æƒ³å°è¯•ï¼ˆexperimentï¼‰ spring bootã€‚ä½ å¯èƒ½é¦–å…ˆæƒ³è¦å°è¯• Spring Boot CLIï¼ˆå‘½ä»¤è¡Œæ¥å£ï¼‰ã€‚å¦åˆ™ï¼Œè¯·é˜…è¯»ç»å…¸çš„å®‰è£…ä»‹ç»ã€‚ 10.1 java å¼€å‘è€…çš„å®‰è£…ä»‹ç»ä½ å¯ä»¥åƒä½¿ç”¨ä»»æ„æ ‡å‡† java ç±»åº“åŒæ ·çš„æ–¹å¼ï¼ˆin the same way asï¼‰ä¸€æ ·ä½¿ç”¨ spring bootã€‚è¿™æ ·åšï¼ŒåŒ…å«ä¸€ä¸ªåˆé€‚çš„ spring-boot-*.jar çš„æ–‡ä»¶åœ¨ä½ çš„ç±»è·¯å¾„ä¸‹ã€‚spring boot ä¸éœ€è¦ä¸ä»»ä½•ç‰¹å®šå·¥å…·é›†æˆï¼Œæ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨ä»»ä¸€\b IDE æˆ–æ–‡æœ¬ç¼–è¾‘å™¨ã€‚åŒæ ·ï¼ŒSpring boot ä¹Ÿæ²¡æœ‰ç‰¹å®šçš„åº”ç”¨ã€‚å› æ­¤ï¼Œä½ å¯ä»¥åƒ\bä½¿ç”¨å…¶ä»–javaç¨‹åºä¸€æ ·è¿è¡Œæˆ–è°ƒè¯• spring boot \båº”ç”¨ã€‚ è™½ç„¶ï¼ˆalthoughï¼‰ä½ å¯ä»¥æ‹·è´ spring boot çš„jar\bï¼Œæˆ‘ä»¬é€šå¸¸å»ºè®®ï¼ˆgenerally recommendï¼‰æ‚¨ä½¿ç”¨æ”¯æŒä¾èµ–ç®¡ç†çš„æ„å»ºå·¥å…·ã€‚ 10.1.1 Maven å®‰è£…Spring Boot \bå…¼å®¹ Apache Maven 3.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰ï¼ˆnot alreayï¼‰å®‰è£… Mavenï¼Œä½ å¯ä»¥æŒ‰ç…§ maven.apache.org \bæ“ä½œä½¿ç”¨ã€‚ åœ¨ä¸€äº›æ“ä½œç³»ç»Ÿä¸Šï¼Œmaven å¯ä»¥é€šè¿‡åŒ…ç®¡ç†å®‰è£…ã€‚å¦‚æœä½ ä½¿ç”¨ OSX Homebrewï¼Œå°è¯• brew install mavenã€‚Ubuntu ç”¨æˆ·å¯ä»¥è¿è¡Œ sudo apt-get inst6all mavenï¼Œå·§å…‹åŠ› window ç”¨æˆ·å¯ä»¥ä»ç®¡ç†å‘˜æç¤ºç¬¦è¿è¡Œ choco install maven ã€‚ Spring Boot \bä¾èµ–ä½¿ç”¨ org.springframework.boot çš„ groupIdï¼Œé€šå¸¸ï¼ˆtypicallyï¼‰ï¼Œä½ çš„ maven pom æ–‡ä»¶ç»§æ‰¿ spring-boot-starter-parent çˆ¶é¡¹ç›®ï¼Œå‘ä¸€ä¸ª\bæˆ–å¤šä¸ªâ€œå¯åŠ¨å™¨â€å£°æ˜\bä¾èµ–ã€‚Spring Boot æä¾›å¯é€‰çš„ maven æ’ä»¶åˆ›å»ºå¯æ‰§è¡Œjarã€‚ ä»¥ä¸‹åˆ—è¡¨å±•ç¤ºäº†ä¸€ä¸ªå…¸å‹çš„ pom.xml æ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.example&lt;/groupId&gt; &lt;artifactId&gt;myproject&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;!-- é»˜è®¤ç»§æ‰¿ spring boot --&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.5.RELEASE&lt;/version&gt; &lt;/parent&gt; &lt;!-- æ·»åŠ  web åº”ç”¨çš„å…¸å‹ä¾èµ–é¡¹ --&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;!-- æ‰“åŒ…ä¸ºå¯æ‰§è¡Œ jar --&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; spring-boot-starters-parent æ˜¯ä½¿ç”¨ Spring Boot çš„å¥½çš„æ–¹å¼ï¼Œä½†æ˜¯å®ƒä¸å¯èƒ½\bé€‚åˆï¼ˆsuitableï¼‰æ‰€æœ‰æƒ…å†µã€‚æœ‰çš„æ—¶å€™ä½ å¯èƒ½éœ€è¦ç»§æ‰¿ä¸åŒçš„çˆ¶ pomï¼Œæˆ–è€…ä½ \bå¯èƒ½ä¸éœ€è¦æˆ‘ä»¬çš„é»˜è®¤è®¾ç½®ã€‚åœ¨é‚£äº›æƒ…å†µä¸‹ï¼ˆin those casesï¼‰ï¼ŒæŸ¥çœ‹â€œ13.2.2ç« ï¼Œåœ¨æ²¡æœ‰ parent pom ä¸‹ä½¿ç”¨ spring bootï¼Œå¯¹äºä½¿ç”¨ import \båŸŸçš„å¯ä»£æ›¿ï¼ˆalternativeï¼‰æ–¹æ¡ˆã€‚ 10.1.2 ç»§æ‰¿ GradleSpring Boot å…¼å®¹ Gradle 4.4 å’Œæ›´é«˜ç‰ˆæœ¬ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰\bå®‰è£… Gradleï¼Œä½ å¯ä»¥åœ¨ gradle.org æ‰¾åˆ°ä½¿ç”¨\bè¯´æ˜ã€‚ spring boot ä¾èµ–é¡¹å¯ä»¥é€šè¿‡ä½¿ç”¨ org.springframework.boot è¿™ä¸€ group æ¥ç”³æ˜ï¼ˆdeclaredï¼‰ï¼Œé€šå¸¸ï¼Œä½ çš„é¡¹ç›®å£°æ˜\bä¾èµ–å…³ç³»ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªâ€œå¯åŠ¨å™¨â€ã€‚Spring boot æä¾›å¯ç”¨çš„ gradle æ’ä»¶ï¼Œå®ƒå¯ä»¥ç®€åŒ–ä¾èµ–å£°æ˜å’Œåˆ›å»ºå¯æ‰§è¡Œjarã€‚ Gradle Wrapperå½“ä½ éœ€è¦æ„å»ºä¸€ä¸ªé¡¹ç›®æ—¶ Gradle Wrapper æä¾›äº†ä¸€ç§å¥½çš„æ–¹å¼â€œè·å¾—â€Gradleã€‚å®ƒæ˜¯ä¸€ä¸ªå°è„šæœ¬å’Œåº“ï¼Œæ‚¨å¯ä»¥ä¸ä»£ç ä¸€èµ·ï¼ˆalongsideï¼‰æäº¤ä»¥å¼•å¯¼ï¼ˆbootstrapï¼‰æ„å»ºè¿‡ç¨‹ã€‚æ›´å¤šè¯¦æƒ…è¯·æŸ¥çœ‹ https://docs.gradle.org/4.2.1/userguide/gradle_wrapper.html æ›´å¤šè·å¾— spring boot å’Œ Gradle çš„ä¿¡æ¯å¯ä»¥åœ¨ Gradle æ’ä»¶çš„å‚è€ƒæŒ‡å—çš„ \bâ€œå¿«é€Ÿå¼€å§‹ç« èŠ‚â€ æ‰¾åˆ°ã€‚ 10.2 å®‰è£… Spring Boot CLIï¼ˆå‘½ä»¤è¡Œå·¥å…·ï¼‰Spring Boot å‘½ä»¤è¡Œæ¥å£æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œä½ å¯ä»¥\bä½¿ç”¨ Spring å¿«é€ŸåŸå‹ã€‚å®ƒå…è®¸ä½ \bè¿è¡Œ Groovy è„šæœ¬ï¼Œè¿™æ„å‘³ç€ä½ æœ‰ä¸€ä¸ªç†Ÿæ‚‰çš„ç±»ä¼¼ï¼ˆfamiliarï¼‰Javaçš„è¯­æ³•æ²¡æœ‰è¿™ä¹ˆå¤šçš„æ ·æ¿ä»£ç ï¼ˆboilerplate codeï¼‰ã€‚ ä½ ä¸å¿…éè¦ä½¿ç”¨ CLI åœ¨ Spring Boot ä¸­ï¼Œä½†è¿™ç»å¯¹ï¼ˆdifinitelyï¼‰æ˜¯è·å¾— Spring åº”ç”¨ç¨‹åºçš„æœ€å¿«æ–¹æ³•ã€‚ 10.2.1 æ‰‹åŠ¨å®‰è£…ä½ å¯ä»¥ä»springè½¯ä»¶ä»“åº“ä¸‹è½½ Spring CLI å‘è¡Œç‰ˆï¼š spring-boot-cli-2.1.5.RELEASE-bin.zip spring-boot-cli-2.1.5.RELEASE-bin.tar.gz æœ€æ–°çš„ï¼ˆcutting edgeï¼‰å¿«ç…§ç‰ˆæœ¬åŒæ ·å¯ç”¨ã€‚ ä¸‹è½½å®Œæˆåï¼Œ\bæŒ‰ç…§ INSTALL.txt å¼•å¯¼ä»è§£å‹ç¼©å½’æ¡£ã€‚æ€»ä¹‹ï¼Œ.zip æ–‡ä»¶ä¸­çš„ bin/ ç›®å½•ä¸‹æœ‰ä¸€ä¸ª spring è„šæœ¬ã€‚æˆ–è€…ï¼ˆAlternativelyï¼‰ï¼Œä½ å¯ä»¥åœ¨ jar æ–‡ä»¶ä¸­ä½¿ç”¨ java -jarï¼ˆè„šæœ¬å¸®åŠ©æ‚¨ç¡®ä¿æ­£ç¡®è®¾ç½®äº†ç±»è·¯å¾„ï¼‰ 10.2.2 SDKMAN å®‰è£…SDKMAN!ï¼ˆä¸€ä¸ªè½¯ä»¶å¼€å‘å·¥å…·åŒ…ç®¡ç†å™¨ï¼‰å¯ä»¥ç”¨æ¥ç®¡ç†å¤šä¸ªå„ç§ï¼ˆvariousï¼‰ç‰ˆæœ¬çš„ SDKï¼ŒåŒ…å« Groovy å’Œ \bSpring Boot CLIã€‚ä» sdkman.io è·å¾— SDKMAN å¹¶ä»ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š 123$ sdk install springboot$ spring --versionSpring Boot v2.1.5.RELEASE å¦‚æœä½ é€šè¿‡ CLI å¼€å‘åŠŸèƒ½ï¼Œå¹¶ä¸”æƒ³è¦å¿«é€Ÿè®¿é—®ä½ æ„å»ºçš„ç‰ˆæœ¬ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¡Œï¼š 1234$ sdk install springboot dev /path/to/spring-boot/spring-boot-cli/target/spring-boot-cli-2.1.5.RELEASE-bin/spring-2.1.5.RELEASE/$ sdk default springboot dev$ spring --versionSpring CLI v2.1.5.RELEASE å‰é¢çš„æŒ‡ä»¤ï¼ˆpreceding instructionsï¼‰å®‰è£…äº†ä¸€ä¸ªåä¸ºï¼ˆcalledï¼‰ dev çš„æœ¬åœ° spring å®ä¾‹ã€‚å®ƒ\bæŒ‡å‘äº†ä½ çš„æ„å»ºè·¯å¾„ï¼Œæ‰€ä»¥æ¯å½“ä½ é‡æ–°æ„å»º Spring Bootï¼Œspring éƒ½æ˜¯æœ€æ–°çš„ã€‚ é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯ä»¥çœ‹åˆ°å®ƒï¼š12345678910111213$ sdk ls springboot================================================================================Available Springboot Versions================================================================================&gt; + dev* 2.1.5.RELEASE================================================================================+ - local version* - installed&gt; - currently in use================================================================================ 10.2.3 OSX Homebrew å®‰è£…\bå¦‚æœä½ åœ¨ Mac ä¸Šä½¿ç”¨ Homebrewï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£… Spring Boot CLIï¼š 12$ brew tap pivotal/tap$ brew install springboot Homebrew å®‰è£… spring åˆ°äº† /usr/local/bin. å¦‚æœä½ çœ‹ä¸åˆ°å…¬å¼ï¼ˆ\bformulaï¼‰ï¼Œæ‚¨å®‰è£…çš„ brew å¯èƒ½è¿‡æ—¶ã€‚é‚£æ ·çš„è¯ï¼ˆin that caseï¼‰ï¼Œå†æ¬¡è¿è¡Œ run updateã€‚ 10.2.4 MacPorts å®‰è£…å¦‚æœä½ åœ¨ mac ä¸Šä½¿ç”¨ MacPortsï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… Spring Boot CLIï¼š 1$ sudo port install spring-boot-cli 10.2.5 å‘½ä»¤è¡Œç¼–è¯‘Spring Boot CLIåŒ…å«ä¸º BASH å’Œ zsh shell æä¾›å‘½ä»¤å®Œæˆçš„è„šæœ¬ã€‚ä½ å¯ä»¥åœ¨ä»»ä½• shell ä¸­è·å¾—è„šæœ¬ï¼ˆä¹Ÿç§°ä¹‹ä¸º springï¼‰ï¼Œæˆ–è€…å°†å…¶æ”¾å…¥ä¸ªäººæˆ–ç³»ç»ŸèŒƒå›´çš„bashå®Œæˆåˆå§‹åŒ–ã€‚åœ¨ Debian ç³»ç»Ÿä¸Šï¼Œè¯¥ç³»ç»ŸèŒƒå›´å†…çš„è„šæœ¬åœ¨ /shell-completion/bashï¼Œå¹¶ä¸”å½“æ–°shellå¯åŠ¨æ—¶ï¼Œè¯¥ç›®å½•ä¸­çš„æ‰€æœ‰è„šæœ¬éƒ½å°†è¢«æ‰§è¡Œã€‚ä¾‹å¦‚ï¼šå¦‚æœä½ ä½¿ç”¨ SDKMAN å®‰è£…äº†è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ‰‹åŠ¨è¿è¡Œè¯¥è„šæœ¬ï¼š 123$ . ~/.sdkman/candidates/springboot/current/shell-completion/bash/spring$ spring &lt;HIT TAB HERE&gt; grab help jar run test version å¦‚æœä½ ä½¿ç”¨ Homebrew æˆ– MacPorts å®‰è£…çš„ Spring Boot CLIï¼Œè¯¥å‘½ä»¤è¡Œç¼–è¯‘è„šæœ¬å°†è‡ªåŠ¨æ³¨å†Œåˆ°ä½ çš„ shellã€‚ 10.2.6 Windows Scoop å®‰è£…å¦‚æœä½ åœ¨ Windows ä¸Šé¢ä½¿ç”¨ Scoopï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£… Spring Boot CLIï¼š 12scoop bucket add extrasscoop install springboot Scoop å®‰è£… spring åˆ°äº† ~/scoop/apps/springboot/current/bin. å¦‚æœæ‚¨æ²¡æœ‰çœ‹åˆ°åº”ç”¨ç¨‹åºæ¸…å•ï¼ˆapp manifestï¼‰ï¼Œä½ å®‰è£…çš„ scoop å¯èƒ½ä¸æ˜¯æœ€æ–°ç‰ˆã€‚è¿™æ ·çš„è¯ï¼Œè¿è¡Œ scoop update \bç„¶åé‡è¯•ã€‚ 10.2.7 Spring CLI æ¡ˆä¾‹å¿«é€Ÿå¼€å§‹ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ Web åº”ç”¨æµ‹è¯•ä½ çš„å®‰è£…ï¼Œå¼€å§‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º app.groovy çš„æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š 123456789@RestControllerclass ThisWillActuallyRun { @RequestMapping(\"/\") String home() { \"Hello World!\" }} ç„¶åä»è„šæœ¬è¿è¡Œï¼Œå¦‚ä¸‹ï¼š 1spring run app.groovy åœ¨ä¸‹è½½ä¾èµ–é¡¹æ—¶é¦–æ¬¡è¿è¡Œä¼šå¾ˆæ…¢ï¼Œéšåçš„è¿è¡Œä¼šå¾ˆå¿«é€Ÿã€‚ \båœ¨ä½ å–œçˆ±çš„æµè§ˆå™¨ä¸Šæ‰“å¼€ localhost:8080ï¼Œä½ å¯ä»¥çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š 1Hello World! 10.3 ä» SpringBoot çš„æ—©æœŸï¼ˆEarlierï¼‰ç‰ˆæœ¬å‡çº§å¦‚æœä½ ä»\bæ—©æœŸçš„ spring boot å‘è¡Œç‰ˆå‡çº§ï¼Œä»é¡¹ç›®çš„ wiki ä¸Š\bç‚¹å‡» â€œè¿ç§»æŒ‡å—â€ï¼Œå®ƒæä¾›äº†æ›´è¯¦ç»†çš„è¯´æ˜ã€‚\bå¦è¯·æŸ¥çœ‹â€œå‘è¡Œè¯´æ˜â€ï¼Œäº†è§£æ¯ä¸ªç‰ˆæœ¬çš„â€œæ–°çš„å’Œå€¼å¾—æ³¨æ„çš„ï¼ˆnoteworthyï¼‰â€åŠŸèƒ½åˆ—è¡¨ã€‚ å½“å‡çº§åˆ°äº†æœ€æ–°å‘è¡Œç‰ˆï¼Œä¸€äº›å±æ€§å¯èƒ½å·²ç»ï¼ˆhave beenï¼‰é‡å‘½å\bæˆ–è€…åˆ é™¤ã€‚Spring Boot æä¾›ä¸€ç§æ–¹å¼åˆ†æçš„ä½ çš„åº”ç”¨ç¯å¢ƒï¼Œå’Œ\båœ¨å¯åŠ¨æ—¶\bæ‰“å°è¯Šæ–­ï¼ˆdiagnosticsï¼‰ï¼Œè¿˜å¯ä»¥ï¼ˆbut alsoï¼‰åœ¨è¿è¡Œæ—¶ï¼ˆruntimeï¼‰ä¸´æ—¶ï¼ˆtemporarilyï¼‰è¿ç§»ï¼ˆmigrateï¼‰å±æ€§ã€‚\bè¦æ‰“å¼€è¿™ä¸ªåŠŸèƒ½ï¼Œæ·»åŠ ä»¥ä¸‹ä¾èµ–åˆ°ä½ çš„é¡¹ç›®ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-properties-migrator&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt; æ™šåŠ å…¥åˆ°ç¯å¢ƒä¹‹åçš„å±æ€§ï¼Œä¾‹å¦‚ @PropertySourceï¼Œå°†ä¸ä¼šè¢«è€ƒè™‘åœ¨å†…ã€‚ä¸€æ—¦ä½ å®Œæˆäº†è¿ç§»ï¼Œè¯·\bç¡®ä¿ä»é¡¹ç›®ä¸­ç§»é™¤è¯¥æ¨¡å—ã€‚ è¦æ›´æ–°å·²å­˜åœ¨çš„ CLI å®‰è£…ï¼Œä½¿ç”¨é€‚å½“çš„åŒ…ç®¡ç†å™¨å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼šbrew updateï¼‰æˆ–è€…ï¼Œå¦‚æœä½ æ‰‹åŠ¨å®‰è£…CLIï¼Œä»è¯·éµå®ˆï¼ˆfollowï¼‰æ ‡å‡†è¯´æ˜ï¼Œè®°ä½æ›´æ–°PATHç¯å¢ƒå˜é‡ä»¥åˆ é™¤ä»»ä½•æ—§çš„å¼•ç”¨ã€‚","link":"/2019/06/03/[20190603] spring-boot | part2(8~10)/"},{"title":"20190608 spring-boot | part2(11~12)","text":"Spring Boot Reference Guide2.1.5.RELEASEhttps://docs.spring.io/spring-boot/docs/2.1.5.RELEASE/reference/htmlsingle/#getting-started-first-application Part II. Getting Started 11. Developing Your First Spring Boot Application 11.1 Creating the POM 11.2 Adding Classpath Dependencies 11.3 Writing the Code 11.3.1 The @RestController and @RequestMapping Annotations 11.3.2 The @EnableAutoConfiguration Annotation 11.3.3 The â€œmainâ€ Method 11.4 Running the Example 11.5 Creating an Executable Jar 12. What to Read Next 11 å¼€å‘ä½ çš„ç¬¬ä¸€ä¸ª \bSpring Boot åº”ç”¨ 11.1 åˆ›å»º pom 11.2 æ·»åŠ  ClassPath ä¾èµ–é¡¹ 11.3 ç¼–å†™ä»£ç  11.3.1 @RestController å’Œ @RequestMapping æ³¨è§£ 11.3.2 @EnableAutoConfiguration æ³¨è§£ 11.3.3 main æ–¹æ³• 11.4 è¿è¡Œæ¡ˆä¾‹ 11.5 åˆ›å»ºå¯æ‰§è¡Œ jar æ¥ä¸‹æ¥è¦é˜…è¯»çš„å†…å®¹ 11. Developing Your First Spring Boot ApplicationThis section describes how to develop a simple â€œHello World!â€ web application that highlights some of Spring Bootâ€™s key features. We use Maven to build this project, since most IDEs support it. The spring.io web site contains many â€œGetting Startedâ€ [guides] that use Spring Boot. If you need to solve a specific problem, check there first.\\You can shortcut the steps below by going to start.spring.io and choosing the â€œWebâ€ starter from the dependencies searcher. Doing so generates a new project structure so that you can start coding right away. Check the Spring Initializr documentation for more details. Before we begin, open a terminal and run the following commands to ensure that you have valid versions of Java and Maven installed: 1234$ java -versionjava version \"1.8.0_102\"Java(TM) SE Runtime Environment (build 1.8.0_102-b14)Java HotSpot(TM) 64-Bit Server VM (build 25.102-b14, mixed mode) 1234$ mvn -vApache Maven 3.5.4 (1edded0938998edf8bf061f1ceb3cfdeccf443fe; 2018-06-17T14:33:14-04:00)Maven home: /usr/local/Cellar/maven/3.3.9/libexecJava version: 1.8.0_102, vendor: Oracle Corporation This sample needs to be created in its own folder. Subsequent instructions assume that you have created a suitable folder and that it is your current directory. 11.1 Creating the POMWe need to start by creating a Maven pom.xml file. The pom.xml is the recipe that is used to build your project. Open your favorite text editor and add the following: 123456789101112131415161718&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.example&lt;/groupId&gt; &lt;artifactId&gt;myproject&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.5.RELEASE&lt;/version&gt; &lt;/parent&gt; &lt;!-- Additional lines to be added here... --&gt;&lt;/project&gt; The preceding listing should give you a working build. You can test it by running mvn package (for now, you can ignore the â€œjar will be empty - no content was marked for inclusion!â€ warning). At this point, you could import the project into an IDE (most modern Java IDEs include built-in support for Maven). For simplicity, we continue to use a plain text editor for this example. 11.2 Adding Classpath DependenciesSpring Boot provides a number of â€œStartersâ€ that let you add jars to your classpath. Our sample application has already used spring-boot-starter-parent in the parent section of the POM. The spring-boot-starter-parent is a special starter that provides useful Maven defaults. It also provides a [dependency-management] section so that you can omit version tags for â€œblessedâ€ dependencies. Other â€œStartersâ€ provide dependencies that you are likely to need when developing a specific type of application. Since we are developing a web application, we add a spring-boot-starter-web dependency. Before that, we can look at what we currently have by running the following command: 123$ mvn dependency:tree[INFO] com.example:myproject:jar:0.0.1-SNAPSHOT The mvn dependency:tree command prints a tree representation of your project dependencies. You can see that spring-boot-starter-parent provides no dependencies by itself. To add the necessary dependencies, edit your pom.xml and add the spring-boot-starter-web dependency immediately below the parent section: 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; If you run mvn dependency:tree again, you see that there are now a number of additional dependencies, including the Tomcat web server and Spring Boot itself. 11.3 Writing the CodeTo finish our application, we need to create a single Java file. By default, Maven compiles sources from src/main/java, so you need to create that folder structure and then add a file named src/main/java/Example.java to contain the following code: 123456789101112131415161718import org.springframework.boot.*;import org.springframework.boot.autoconfigure.*;import org.springframework.web.bind.annotation.*;@RestController@EnableAutoConfigurationpublic class Example { @RequestMapping(\"/\") String home() { return \"Hello World!\"; } public static void main(String[] args) { SpringApplication.run(Example.class, args); }} Although there is not much code here, quite a lot is going on. We step through the important parts in the next few sections. 11.3.1 The @RestController and @RequestMapping AnnotationsThe first annotation on our Example class is @RestController. This is known as a stereotype annotation. It provides hints for people reading the code and for Spring that the class plays a specific role. In this case, our class is a web @Controller, so Spring considers it when handling incoming web requests. The @RequestMapping annotation provides â€œroutingâ€ information. It tells Spring that any HTTP request with the / path should be mapped to the home method. The @RestController annotation tells Spring to render the resulting string directly back to the caller. The @RestController and @RequestMapping annotations are Spring MVC annotations. (They are not specific to Spring Boot.) See the MVC section in the Spring Reference Documentation for more details. 11.3.2 The @EnableAutoConfiguration AnnotationThe second class-level annotation is @EnableAutoConfiguration. This annotation tells Spring Boot to â€œguessâ€ how you want to configure Spring, based on the jar dependencies that you have added. Since spring-boot-starter-web added Tomcat and Spring MVC, the auto-configuration assumes that you are developing a web application and sets up Spring accordingly. Starters and Auto-configuration\\Auto-configuration is designed to work well with â€œStartersâ€, but the two concepts are not directly tied. You are free to pick and choose jar dependencies outside of the starters. Spring Boot still does its best to auto-configure your application. 11.3.3 The â€œmainâ€ MethodThe final part of our application is the main method. This is just a standard method that follows the Java convention for an application entry point. Our main method delegates to Spring Bootâ€™s SpringApplication class by calling run. SpringApplication bootstraps our application, starting Spring, which, in turn, starts the auto-configured Tomcat web server. We need to pass Example.class as an argument to the run method to tell SpringApplication which is the primary Spring component. The args array is also passed through to expose any command-line arguments. 11.4 Running the ExampleAt this point, your application should work. Since you used the spring-boot-starter-parent POM, you have a useful run goal that you can use to start the application. Type mvn spring-boot:run from the root project directory to start the application. You should see output similar to the following: 12345678910111213$ mvn spring-boot:run . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.1.5.RELEASE)....... . . ........ . . . (log output here)....... . . ......... Started Example in 2.222 seconds (JVM running for 6.514) If you open a web browser to localhost:8080, you should see the following output: 1Hello World! To gracefully exit the application, press ctrl-c. 11.5 Creating an Executable JarWe finish our example by creating a completely self-contained executable jar file that we could run in production. Executable jars (sometimes called â€œfat jarsâ€) are archives containing your compiled classes along with all of the jar dependencies that your code needs to run. Executable jars and Java\\Java does not provide a standard way to load nested jar files (jar files that are themselves contained within a jar). This can be problematic if you are looking to distribute a self-contained application.\\To solve this problem, many developers use â€œuberâ€ jars. An uber jar packages all the classes from all the applicationâ€™s dependencies into a single archive. The problem with this approach is that it becomes hard to see which libraries are in your application. It can also be problematic if the same filename is used (but with different content) in multiple jars.\\Spring Boot takes a different approach and lets you actually nest jars directly. To create an executable jar, we need to add the spring-boot-maven-plugin to our pom.xml. To do so, insert the following lines just below the dependencies section: 12345678&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; The spring-boot-starter-parent POM includes &lt;executions&gt; configuration to bind the repackage goal. If you do not use the parent POM, you need to declare this configuration yourself. See the [plugin documentation] for details. Save your pom.xml and run mvn package from the command line, as follows: 123456789101112131415$ mvn package[INFO] Scanning for projects...[INFO][INFO] ------------------------------------------------------------------------[INFO] Building myproject 0.0.1-SNAPSHOT[INFO] ------------------------------------------------------------------------[INFO] .... ..[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ myproject ---[INFO] Building jar: /Users/developer/example/spring-boot-example/target/myproject-0.0.1-SNAPSHOT.jar[INFO][INFO] --- spring-boot-maven-plugin:2.1.5.RELEASE:repackage (default) @ myproject ---[INFO] ------------------------------------------------------------------------[INFO] BUILD SUCCESS[INFO] ------------------------------------------------------------------------ If you look in the target directory, you should see myproject-0.0.1-SNAPSHOT.jar. The file should be around 10 MB in size. If you want to peek inside, you can use jar tvf, as follows: 1$ jar tvf target/myproject-0.0.1-SNAPSHOT.jar You should also see a much smaller file named myproject-0.0.1-SNAPSHOT.jar.original in the target directory. This is the original jar file that Maven created before it was repackaged by Spring Boot. To run that application, use the java -jar command, as follows: 12345678910111213$ java -jar target/myproject-0.0.1-SNAPSHOT.jar . ____ _ __ _ _ /\\\\ / ___'_ __ _ _(_)_ __ __ _ \\ \\ \\ \\( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) ' |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v2.1.5.RELEASE)....... . . ........ . . . (log output here)....... . . ......... Started Example in 2.536 seconds (JVM running for 2.864) As before, to exit the application, press ctrl-c. 12. What to Read NextHopefully, this section provided some of the Spring Boot basics and got you on your way to writing your own applications. If you are a task-oriented type of developer, you might want to jump over to [spring.io] and check out some of the [getting started] guides that solve specific â€œHow do I do that with Spring?â€ problems. We also have Spring Boot-specific â€œHow-toâ€ reference documentation. The [Spring Boot repository] also has a [bunch of samples] you can run. The samples are independent of the rest of the code (that is, you do not need to build the rest to run or use the samples). Otherwise, the next logical step is to read [Part III, â€œUsing Spring Bootâ€]. If you are really impatient, you could also jump ahead and read about [Spring Boot features.] 11 å¼€å‘ä½ çš„ç¬¬ä¸€ä¸ª \bSpring Boot åº”ç”¨è¿™ä¸€ç« èŠ‚æè¿°äº†å¦‚ä½•å¼€å‘ä¸€ä¸ªç®€å•çš„â€œhello worldï¼â€webåº”ç”¨ï¼Œä»¥é‡ç‚¹ä»‹ç»Spring Bootçš„ä¸€äº›ä¸»è¦åŠŸèƒ½ã€‚æˆ‘ä»¬ä½¿ç”¨ Maven æ„å»ºè¿™ä¸ªé¡¹ç›®ï¼Œå› ä¸ºï¼ˆsinceï¼‰å¤§å¤šæ•° IDE éƒ½æ”¯æŒå®ƒã€‚ è¿™ä¸ª \bspring.io ç«™ç‚¹åŒ…å«äº†ä¸€äº›ä½¿ç”¨ Spring Boot çš„â€œå¿«é€Ÿå¼€å§‹â€æŒ‡å—ã€‚å¦‚æœä½ è¦è§£å†³ï¼ˆsolveï¼‰ä¸€ä¸ªå…·ä½“ï¼ˆspecificï¼‰çš„é—®é¢˜ï¼Œé¦–å…ˆç‚¹å‡»è¿™é‡Œã€‚æ‚¨å¯ä»¥é€šè¿‡è½¬åˆ°start.spring.ioå¹¶ä»ä¾èµ–å…³ç³»æœç´¢å™¨ä¸­é€‰æ‹©â€œWebâ€å¯åŠ¨å™¨æ¥å¿«æ·æ‰§è¡Œï¼ˆshortcut the stepsï¼‰ä»¥ä¸‹æ­¥éª¤ã€‚è¿™æ ·åšä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„é¡¹ç›®ç»“æ„ï¼Œä»¥ä¾¿ï¼ˆso thatï¼‰æ‚¨å¯ä»¥ç«‹å³ï¼ˆright awayï¼‰å¼€å§‹ç¼–ç ã€‚ç‚¹å‡» Spring \bInitializr æ–‡æ¡£æŸ¥çœ‹æ›´å¤šç»†èŠ‚ã€‚ åœ¨å¼€å§‹ä¹‹å‰ï¼Œæ‰“å¼€ç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤ç¡®ä¿ä½ å®‰è£…çš„ Java å’Œ Maven æ˜¯æœ‰æ•ˆçš„ç‰ˆæœ¬ï¼š 1234$ java -versionjava version \"1.8.0_102\"Java(TM) SE Runtime Environment (build 1.8.0_102-b14)Java HotSpot(TM) 64-Bit Server VM (build 25.102-b14, mixed mode) 1234$ mvn -vApache Maven 3.5.4 (1edded0938998edf8bf061f1ceb3cfdeccf443fe; 2018-06-17T14:33:14-04:00)Maven home: /usr/local/Cellar/maven/3.3.9/libexecJava version: 1.8.0_102, vendor: Oracle Corporation è¿™ä¸ªæ¡ˆä¾‹éœ€è¦åœ¨è‡ªå·±çš„\bç›®å½•ä¸­åˆ›å»ºã€‚éšåï¼ˆsubsequentï¼‰çš„\bæŒ‡å—å‡å®šï¼ˆassumeï¼‰ä½ å·²ç»åˆ›å»ºäº†åˆé€‚ï¼ˆsuitableï¼‰çš„ç›®å½•å¹¶ä¸”æ˜¯ä½ çš„å½“å‰\bæ–‡ä»¶å¤¹ã€‚ 11.1 åˆ›å»º pomæˆ‘ä»¬éœ€è¦ä»åˆ›å»º Maven çš„ pom.xml æ–‡ä»¶å¼€å§‹ï¼Œè¿™ä¸ª pom.xml æ˜¯ç”¨äºï¼ˆuse toï¼‰æ„å»ºä½ çš„é¡¹ç›®çš„é…æ–¹ï¼ˆrecipeï¼‰ã€‚æ‰“å¼€ä½ å–œæ¬¢çš„æ–‡æœ¬ç¼–è¾‘å™¨æ·»åŠ \bä»¥ä¸‹ï¼š 123456789101112131415161718&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.example&lt;/groupId&gt; &lt;artifactId&gt;myproject&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.5.RELEASE&lt;/version&gt; &lt;/parent&gt; &lt;!-- è¿™é‡Œè¿˜ä¼šé¢å¤–æ·»åŠ å…¶ä»–è¡Œ... --&gt;&lt;/project&gt; å‰é¢çš„\båˆ—è¡¨åº”è¯¥å¯ä»¥ç»™ä½ æœ‰æ•ˆï¼ˆa workingï¼‰çš„æ„å»ºã€‚ä½ å¯ä»¥é€šè¿‡ mvn package æµ‹è¯•å®ƒï¼ˆç°åœ¨ï¼Œä½ å¯ä»¥\bå¿½ç•¥â€œjar will be empty - no content was marked for inclusion!â€è­¦å‘Šï¼‰ åœ¨æ­¤æ—¶ï¼ˆAt this pointï¼‰ï¼Œä½ å¯ä»¥å¯¼å…¥è¿™ä¸ªé¡¹ç›®åˆ°ä½ çš„ IDEï¼ˆå¤§å¤šæ•°ç°ä»£Java IDEéƒ½åŒ…å«å¯¹Mavençš„å†…ç½®æ”¯æŒï¼‰ã€‚ä¸ºäº†ç®€å•ï¼ˆsimplicyï¼‰èµ·è§ï¼Œæˆ‘ä»¬ç»§ç»­ä¸ºæ­¤ç¤ºä¾‹ä½¿ç”¨çº¯æ–‡æœ¬ç¼–è¾‘å™¨ã€‚ 11.2 æ·»åŠ  ClassPath ä¾èµ–é¡¹Spring Boot æ·»åŠ äº†è®¸å¤šï¼ˆa number ofï¼‰â€œå¯åŠ¨å™¨â€ å…è®¸ä½ æ·»åŠ  jars åˆ°\bä½ çš„ç±»è·¯å¾„ä¸‹ã€‚æˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºå·²ç»åœ¨POMçš„çˆ¶èŠ‚ä¸­ä½¿ç”¨äº†spring-boot-starter-parentã€‚spring-boot-starters-parent æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¯åŠ¨å™¨ï¼Œå®ƒæä¾›äº†å¯ç”¨çš„ maven é»˜è®¤é…ç½®ã€‚å®ƒåŒæ ·æä¾›ä¸€ä¸ª dependency-management èŠ‚ç‚¹\bä»¥ä¾¿ï¼ˆso thatï¼‰ä½ å¯ä»¥çœç•¥ï¼ˆomitï¼‰version â€œblessedâ€ä¾èµ–é¡¹çš„ç‰ˆæœ¬æ ‡ç­¾ã€‚ å…¶ä»–\bâ€œå¯åŠ¨å™¨â€æä¾›äº†ä½ åœ¨å¼€å‘\bç‰¹å®šç±»å‹åº”ç”¨æ—¶æˆ–è®¸ï¼ˆlikelyï¼‰éœ€è¦çš„ä¾èµ–é¡¹ã€‚å½“ï¼ˆsinceï¼‰æˆ‘ä»¬æ­£åœ¨å¼€å‘Webåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬æ·»åŠ  spring-boot-starter-web ä¾èµ–ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹ï¼ˆlook atï¼‰å½“å‰çš„å†…å®¹ï¼š 123$ mvn dependency:tree[INFO] com.example:myproject:jar:0.0.1-SNAPSHOT è¯¥ mvn dependency:tree å‘½ä»¤æ‰“å°\bè¾“æ¥è¡¨ç¤ºï¼ˆrepresentationï¼‰ä½ é¡¹ç›®ä¾èµ–ã€‚æ‚¨å¯ä»¥çœ‹åˆ° spring-boot-starter-parent æœ¬èº«ï¼ˆitselfï¼‰ä¸æä¾›ä¾èµ–å…³ç³»ã€‚è¦æ·»åŠ å¿…è¦ï¼ˆ\bnecessaryï¼‰çš„ä¾èµ–ï¼Œç¼–è¾‘ä½ çš„ pom.xmlï¼Œ æ·»åŠ  spring-boot-starters-web ä¾èµ–ç´§æ¥ï¼ˆimmediatelyï¼‰ä¸ parent \bèŠ‚ç‚¹ä¹‹ä¸‹ï¼ˆbelowï¼‰ã€‚ 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; å¦‚æœä½ å†æ¬¡è¿è¡Œ mvn dependency:treeï¼Œä½ ä¼šçœ‹åˆ°è¿™é‡Œæœ‰\bå¤šä¸ªé¢å¤–çš„ä¾èµ–é¡¹ï¼ŒåŒ…å«æ¥ Tomcat Web æœåŠ¡å™¨å’Œ Spring Boot æœ¬èº«ã€‚ 11.3 ç¼–å†™ä»£ç ä¸ºäº†å®Œæˆæˆ‘ä»¬çš„é¡¹ç›®ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå•ä¸ªjavaæ–‡ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ˆ\bby \bdefaultï¼‰ï¼Œmaven ç¼–è¯‘çš„èµ„æºæ¥æºè‡ª src/main/javaï¼Œæ‰€ä»¥ä½ éœ€è¦åˆ›å»ºè¿™ä¸ª\bç›®å½•ç»“æ„ç„¶åæ·»åŠ åå­—ä¸º src/main/java/Example.java æ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹ä»£ç ï¼š 123456789101112131415161718import org.springframework.boot.*;import org.springframework.boot.autoconfigure.*;import org.springframework.web.bind.annotation.*;@RestController@EnableAutoConfigurationpublic class Example { @RequestMapping(\"/\") String home() { return \"Hello World!\"; } public static void main(String[] args) { SpringApplication.run(Example.class, args); }} è™½ç„¶ï¼ˆAlthoughï¼‰è¿™é‡Œçš„ä»£ç å¹¶ä¸å¤šï¼Œä½†æ˜¯\bå¾ˆå¤šï¼ˆquite a lotï¼‰äº‹æƒ…åœ¨å‘ç”Ÿï¼ˆis going onï¼‰ã€‚æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„ï¼ˆnext fewï¼‰å‡ èŠ‚ä¸­é€æ­¥ä»‹ç»é‡è¦éƒ¨åˆ†ï¼ˆimportant partï¼‰ã€‚ 11.3.1 @RestController å’Œ @RequestMapping æ³¨è§£åœ¨æˆ‘ä»¬çš„ Example \bç±»ä¸Šç¬¬ä¸€æ³¨è§£æ˜¯ @RestControllerï¼Œè¿™è¢«ç§°ä¸ºï¼ˆknown asï¼‰æ„é€ å‹æ³¨è§£ã€‚å®ƒä¸ºé˜…è¯»ä»£ç çš„äººæä¾›äº†æç¤ºï¼ˆhintsï¼‰ï¼Œè€Œä¸ºSpringæä¾›äº†ç‰¹å®šè§’è‰²çš„æç¤ºã€‚åœ¨è¿™ä¸ª\bç”¨ä¾‹ï¼Œæˆ‘ä»¬çš„\bç±»æ˜¯ä¸€ä¸ªweb @Controllerï¼Œæ‰€ä»¥Springåœ¨å¤„ç†ä¼ å…¥çš„Webè¯·æ±‚æ—¶ä¼šè€ƒè™‘ï¼ˆconsidersï¼‰å®ƒã€‚ è¿™ä¸ª @RequestMapping æ³¨è§£æä¾›äº† â€œè·¯ç”±â€ ä¿¡æ¯ï¼Œå®ƒå‘Šè¯‰ Spring ä»»ä½•çš„ / è·¯å¾„çš„ Http è¯·æ±‚éƒ½å°†æ˜ å°„åˆ° home æ–¹æ³•ã€‚è¯¥ @RestController æ³¨è§£å‘Šè¯‰ Spring å°†ç»“æœå­—ç¬¦ä¸²ç›´æ¥ï¼ˆdirectlyï¼‰æ¸²æŸ“å›è°ƒç”¨è€…ã€‚ @RequestMapping å’Œ @RestController æ³¨è§£æ˜¯ \bSpring MVC æ³¨è§£ã€‚ï¼ˆä»–ä»¬ä¸æ˜¯ Spring Boot ç‰¹æœ‰çš„ï¼‰ï¼Œæ›´å¤šè¯¦æƒ…\bè¯·æŸ¥çœ‹ Spring å‚è€ƒæ–‡æ¡£çš„ MVC ç« èŠ‚ 11.3.2 @EnableAutoConfiguration æ³¨è§£ç¬¬äºŒä¸ªç±»çº§åˆ«çš„æ³¨è§£æ˜¯ @EnableAutoConfigurationï¼Œè¯¥æ³¨è§£å‘Šè¯‰ Spring Boot â€œçŒœæµ‹â€ä½ æƒ³å¦‚ä½•é…ç½® Springï¼Œè¿™éƒ½åŸºäºæ‚¨æ·»åŠ çš„jarä¾èµ–é¡¹ã€‚ç”±äº spring-boot-startes-web æ·»åŠ äº† Tomcat å’Œ Spring MVCï¼Œè¿™ä¸ª\bè‡ªåŠ¨é…ç½®\bå‡å®šï¼ˆassumesï¼‰ä½ æ­£åœ¨å¼€å‘webåº”ç”¨ï¼Œäºæ˜¯ï¼ˆaccordinglyï¼‰ç›¸åº”çš„è®¾ç½®å¥½\bSpringã€‚ å¯åŠ¨å™¨å’Œè‡ªåŠ¨é…ç½®è‡ªåŠ¨é…ç½®è¢«è®¾è®¡ä¸ºè®©å¯åŠ¨å™¨æ›´å¥½çš„å·¥ä½œï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ¦‚å¿µï¼ˆconceptï¼‰å¹¶æ²¡æœ‰è”åˆåœ¨ä¸€èµ·ï¼ˆdirectly tiedï¼‰ã€‚ä½ å¯ä»¥æŒ‘é€‰ï¼ˆpickï¼‰å’Œé€‰æ‹©ï¼ˆ\bchooseï¼‰å¯åŠ¨å™¨ä¹‹å¤–çš„ jar ä¾èµ–ã€‚Spring Boot \u001dä»ç„¶å°½åŠ›æœ€å¥½çš„è‡ªåŠ¨é…ç½®ä½ çš„åº”ç”¨ã€‚ 11.3.3 main æ–¹æ³•æœ€åä¸€ä¸ªå•å…ƒæ˜¯æˆ‘ä»¬åº”ç”¨çš„ main æ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªéµå¾ª java \bæƒ¯ä¾‹ï¼ˆconvertionï¼‰çš„æ ‡å‡†æ–¹æ³•ï¼Œæ˜¯\båº”ç”¨çš„å…¥å£ç‚¹ï¼ˆentry pointï¼‰ã€‚æˆ‘ä»¬çš„ä¸»æ–¹æ³•é€šè¿‡è°ƒç”¨ run æ¥å§”æ‰˜ï¼ˆdelegates ä»£è¡¨ã€å§”æ‰˜ï¼‰spring boot çš„ SpringApplicationï¼Œ SpringApplication \bå¼•å¯¼æˆ‘ä»¬çš„åº”ç”¨å¯åŠ¨ S\bpringï¼Œè‡ªåŠ¨é…ç½® Tomcat web æœåŠ¡å™¨ã€‚æˆ‘ä»¬éœ€è¦ä¼ é€’ï¼ˆpassï¼‰ Example.class ä½œä¸ºï¼ˆas anï¼‰ä¸€ä¸ªå‚æ•°ç»™ run æ–¹æ³•ï¼Œä»¥ä¾¿å‘Šè¯‰ SpringApplication è¿™æ˜¯ä¸»è¦çš„Springç»„ä»¶ã€‚è¯¥ args å‚æ•°æ•°ç»„åŒæ ·è¢«ä¼ é€’åˆ°æš´éœ²çš„ä»»ä½•å‘½ä»¤è¡Œå‚æ•°ä¸­ã€‚ 11.4 è¿è¡Œæ¡ˆä¾‹åœ¨æ­¤æ—¶ï¼Œä½ çš„åº”ç”¨å¯ä»¥\bå·¥ä½œã€‚å½“ä½ ä½¿ç”¨ spring-boot-starter-parent POM æ–‡ä»¶æ—¶ï¼Œä½ æœ‰ä¸€ä¸ªå¯ç”¨çš„ run ç›®æ ‡ ï¼ˆgoalsï¼‰ï¼Œå¯ç”¨äºå¯åŠ¨åº”ç”¨ã€‚ä»\bé¡¹ç›®æ ¹ç›®å½•è¾“å…¥ mvn spring-boot:run ä»¥å¯åŠ¨è¯¥\båº”ç”¨ã€‚ä½ å¯ä»¥\bçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š 1234567$ mvn spring-boot:run :: Spring Boot :: (v2.1.5.RELEASE)....... . . ........ . . . (log output here)....... . . ......... Started Example in 2.222 seconds (JVM running for 6.514) å¦‚æœä½ åœ¨æµè§ˆå™¨æ‰“å¼€ localhost:8080ï¼Œä½ å¯ä»¥çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š 1Hello World! è¦ä¼˜é›…çš„ï¼ˆgracefullyï¼‰é€€å‡ºè¯¥åº”ç”¨ï¼ŒæŒ‰ä¸‹ ctrl - c 11.5 åˆ›å»ºå¯æ‰§è¡Œ jaré€šè¿‡åˆ›å»ºä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„å¯æ‰§è¡Œ jar æ–‡ä»¶å®Œæˆæˆ‘ä»¬çš„æ¡ˆä¾‹ï¼Œä»–ä»¬å¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹è¿è¡Œã€‚å¯æ‰§è¡Œ jar æ˜¯ä¸€ä¸ªåŒ…å«ä½ çš„\bæ‰€æœ‰ç¼–è¯‘åçš„ç±»æ–‡ä»¶å’Œæ‰€æœ‰ä»£ç è¿è¡Œæ‰€éœ€è¦çš„ jar ä¾èµ–çš„å½’æ¡£ã€‚ å¯æ‰§è¡Œ jar å’Œ javajava æ²¡æœ‰æä¾›\bæ ‡å‡†çš„æ–¹å¼å»åŠ è½½åµŒå¥—çš„ jar æ–‡ä»¶ï¼ˆjava æ–‡ä»¶æœ¬èº«(themsevles)åœ¨ jar é‡Œé¢(within)ï¼‰ã€‚å¦‚æœä½ è¦åˆ†å‘è‡ªåŒ…å«çš„\båº”ç”¨ï¼Œå°†ä¼šé€ æˆä¸€äº›é—®é¢˜ï¼ˆproblematicï¼‰ã€‚\\è¦è§£å†³ï¼ˆsolveï¼‰è¿™ä¸ªé—®é¢˜ï¼Œå¤§å¤šæ•°å¼€å‘è€…ä½¿ç”¨â€œuberâ€ jarã€‚ä¸€ä¸ª uber jar ä»æ‰€æœ‰åº”ç”¨çš„\bä¾èµ–é¡¹ä¸­çš„æ‰€æœ‰å­—èŠ‚ç æ–‡ä»¶æ‰“åŒ…åˆ°ä¸€ä¸ªå•ç‹¬çš„å½’æ¡£ä¸­ã€‚è¿™ç§æ–¹æ³•ï¼ˆapproachï¼‰çš„é—®é¢˜åœ¨äºï¼šæŸ¥çœ‹å“ªä¸€ä¸ªç±»åº“åœ¨ä½ çš„åº”ç”¨ä¸­å˜å¾—å›°éš¾ï¼ˆbecome hardï¼‰ã€‚å¦‚æœåœ¨å¤šä¸ª jars ä¸­ä½¿ç”¨ç›¸åŒçš„æ–‡ä»¶åï¼ˆä½†æ˜¯å†…å®¹ä¸åŒï¼‰åŒæ ·ä¹Ÿä¼šé€ æˆé—®é¢˜ã€‚\\Spring Boot ç”¨ä¸åŒ\bçš„æ–¹æ³•ï¼Œè®©ä½ ç›´æ¥åµŒå¥— jars \b\bè¦åˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œ jarï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ  spring-boot-maven-plugin åˆ°ä½ çš„ pom.xmlã€‚è¿™æ ·åšï¼Œæ’å…¥ä»¥ä¸‹è¡Œç´§æ¥ç€ denpendency èŠ‚ç‚¹ï¼š 12345678&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; è¯¥ spring-boot-maven-plugin POM åŒ…å«äº† &lt;excutions&gt; é…ç½®ç»‘å®šåˆ° repackage ç›®æ ‡ã€‚å¦‚æœä½ ä¸ä½¿ç”¨çˆ¶ POMï¼Œä½ éœ€è¦å®šä¹‰ä½ è‡ªå·±çš„è¿™ä¸ªé…ç½®é¡¹ã€‚æŸ¥çœ‹ æ’ä»¶æ–‡æ¡£ è·å¾—æ›´å¤šè¯¦æƒ…ã€‚ ä¿å­˜ä½ çš„ pom.xml å¹¶ä»å‘½ä»¤è¡Œè¿è¡Œ mvn packageï¼Œå¦‚ä¸‹ï¼š 123456789101112131415$ mvn package[INFO] Scanning for projects...[INFO][INFO] ------------------------------------------------------------------------[INFO] Building myproject 0.0.1-SNAPSHOT[INFO] ------------------------------------------------------------------------[INFO] .... ..[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ myproject ---[INFO] Building jar: /Users/developer/example/spring-boot-example/target/myproject-0.0.1-SNAPSHOT.jar[INFO][INFO] --- spring-boot-maven-plugin:2.1.5.RELEASE:repackage (default) @ myproject ---[INFO] ------------------------------------------------------------------------[INFO] BUILD SUCCESS[INFO] ------------------------------------------------------------------------ å¦‚æœä½ æŸ¥çœ‹ target ç›®å½•ï¼Œä½ ä¼šçœ‹åˆ° myproject-0.0.1-SNAPSHOT.jarã€‚è¯¥æ–‡ä»¶å¤§å°åº”è¯¥ä¸º 10Mã€‚å¦‚æœä½ æƒ³è¦å·çœ‹é‡Œé¢ï¼ˆpeek insideï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ jar tvfï¼Œå¦‚ä¸‹ï¼š 1jar tvf target/myproject-0.0.1-SNAPSHOT.jar ä½ åŒæ ·ä¼šåœ¨ target ç›®å½•ä¸‹çœ‹åˆ°å¤§é‡ç±»ä¼¼åå­—ä¸º myproject-0.0.1-SNAPSHOT.jar.original çš„æ–‡ä»¶ã€‚è¿™æ˜¯Mavenåœ¨Spring Booté‡æ–°æ‰“åŒ…ä¹‹å‰åˆ›å»ºçš„åŸå§‹jaræ–‡ä»¶ã€‚ è¦è¿è¡Œè¯¥åº”ç”¨ï¼Œä½¿ç”¨ java -jar å‘½ä»¤ï¼Œå¦‚ä¸‹ï¼š 1$ java -jar target/myproject-0.0.1-SNAPSHOT.jar åƒä¸Šæ¬¡ä¸€æ ·ï¼Œé€€å‡ºåº”ç”¨è¯·æŒ‰ ctrl - cã€‚ æ¥ä¸‹æ¥è¦é˜…è¯»çš„å†…å®¹å¸Œæœ›ï¼Œè¿™ä¸ªç« èŠ‚æä¾›äº†ä¸€äº› Spring Boot çš„åŸºç¡€çŸ¥è¯†èƒ½è®©ä½ å¼€å§‹\bç¼–å†™è‡ªå·±çš„åº”ç”¨ã€‚å¦‚æœæ‚¨æ˜¯é¢å‘ä»»åŠ¡çš„å¼€å‘äººå‘˜ï¼Œä½ å¯èƒ½æƒ³è¦è·³åˆ°ï¼ˆjump overï¼‰ spring.ioï¼ŒæŸ¥çœ‹ï¼ˆcheck outï¼‰ä¸€äº›å…¥é—¨æŒ‡å—ï¼Œè§£å†³å…·ä½“çš„â€œå¦‚ä½•ä½¿ç”¨Springï¼Ÿâ€é—®é¢˜ã€‚ æˆ‘ä»¬åŒæ ·æœ‰ Spring Bootå…·ä½“çš„â€œå¦‚ä½•ä½¿ç”¨â€å‚è€ƒæ–‡æ¡£ã€‚ è¿™ä¸ª spring boot å­˜å‚¨åº“åŒæ ·æœ‰ä¸€å †ï¼ˆa bunch ofï¼‰ä½ å¯ä»¥è¿è¡Œçš„æ ·æœ¬ã€‚è¿™äº›æ ·æœ¬ç‹¬ç«‹\bäºï¼ˆindependent ofï¼‰å…¶ä½™ï¼ˆrest ofï¼‰çš„\bä»£ç ã€‚ï¼ˆä½ ä¸éœ€è¦æ„å»ºå…¶ä½™çš„æ¥è¿è¡Œæˆ–ä½¿ç”¨æ ·æœ¬ï¼‰ æ€»ä¹‹ï¼Œä¸‹ä¸€ä¸ªåˆä¹é€»è¾‘çš„æ­¥éª¤ï¼ˆlogical stepï¼‰æ˜¯é˜…è¯»ç¬¬IIIéƒ¨åˆ†â€œä½¿ç”¨Spring Bootâ€ã€‚å¦‚æœä½ çœŸçš„å¾ˆä¸è€çƒ¦ï¼Œä½ ä¹Ÿå¯ä»¥è·³è¿‡å»é˜…è¯» Spring BootåŠŸèƒ½ã€‚","link":"/2019/06/08/[20190608] spring-boot | part2(11~12)/"},{"title":"20190609 spring-boot | part3(13~16)","text":"Spring Boot Reference Guide2.1.5.RELEASEhttps://docs.spring.io/spring-boot/docs/2.1.5.RELEASE/reference/htmlsingle/#using-boot Part III. Using Spring Boot 13. æ„å»ºç³»ç»Ÿ 13.1 ä¾èµ–é¡¹ç®¡ç† 13.2 Maven 13.2.1 ç»§æ‰¿ Starter Parent 13.2.2 æ²¡æœ‰ Parent Pom ä½¿ç”¨ Spring Boot 13.2.3 ä½¿ç”¨ Spring Boot Maven æ’ä»¶ 13.3 Gradle 13.4 Ant 13.5 å¯åŠ¨å™¨ 14. ä»£ç ç»“æ„ 14.1 ä½¿ç”¨â€œé»˜è®¤çš„â€åŒ… 14.2 å®šä½ï¼ˆLocationï¼‰ä¸»åº”ç”¨ç±» 15. é…ç½®ç±» 15.1 å¯¼å…¥é¢å¤–çš„é…ç½®ç±» 15.2 \bå¯¼å…¥ XML é…ç½® 16. è‡ªåŠ¨é…ç½® 16.1 é€æ­¥ï¼ˆgraduallyï¼‰æ›´æ¢ï¼ˆreplacingï¼‰è‡ªåŠ¨é…ç½® 16.2 ç¦ç”¨ç‰¹å®šçš„è‡ªåŠ¨é…ç½®ç±» è¿™ä¸ªç« èŠ‚å°†è¯¦ç»†ä»‹ç»æ›´å¤šç»†èŠ‚å…³äºä½ å¦‚ä½•ä½¿ç”¨Spring Bootã€‚å®ƒæ¶µç›–äº†ä¸€äº›ä¸»é¢˜ï¼ˆcovers topicsï¼‰ï¼Œä¾‹å¦‚æ„å»ºç³»ç»Ÿã€è‡ªåŠ¨é…ç½®ã€å’Œå¦‚ä½•è¿è¡Œä½ çš„åº”ç”¨ã€‚æˆ‘ä»¬åŒæ ·æ¶µç›–äº†ä¸€äº› Spring Boot æœ€ä½³å®æˆ˜ã€‚è™½ç„¶Spring Bootæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼ˆå®ƒåªæ˜¯ä½ å¯ä»¥ä½¿ç”¨çš„å¦ä¸€ä¸ªç±»åº“è€Œå·²ã€‚ï¼‰è¿™é‡Œ\bæœ‰ä¸€äº›å»ºè®®ï¼Œå¦‚æœéµå¾ªï¼ˆwhen allowedï¼‰ï¼Œå°†ä¼šä½¿ä½ çš„åº”ç”¨å¼€å‘è¿›åº¦ç›¸å¯¹å®¹æ˜“\bä¸€äº›ï¼ˆeasierï¼‰ã€‚ å¦‚æœä½ æ˜¯ä» Spring Boot å¼€å§‹çš„ï¼ˆstarting outï¼‰ï¼Œ\bä½ å¯èƒ½ï¼ˆprobablyï¼‰éœ€è¦é˜…è¯»â€œå¿«é€Ÿå¼€å§‹â€æŒ‡å—ï¼Œåœ¨è¿›å…¥ï¼ˆdiving intoï¼‰è¿™ä¸ªç« èŠ‚ä¹‹å‰ã€‚ 13. æ„å»ºç³»ç»Ÿè¿™é‡Œå¼ºçƒˆå»ºè®®ä½ é€‰æ‹©ä¸€ä¸ªæ”¯æŒ ä¾èµ–é¡¹ç®¡ç† å’Œå¯ä»¥ä½¿ç”¨ artifacts å‘å¸ƒåˆ° Maven \bä¸­å¤®ä»“åº“çš„æ„å»ºç³»ç»Ÿã€‚æˆ‘ä»¬å°†å»ºè®®æ‚¨ä½¿ç”¨ Maven æˆ– Gradleã€‚æœ‰å¯èƒ½ä½¿ï¼ˆit is possible toï¼‰S\bpring Boot ä¸å…¶ä»–æ„å»ºå·¥å…·ä¸€èµ·å·¥ä½œï¼Œä½†æ˜¯ä»–ä»¬å¹¶æ²¡æœ‰å¾—åˆ°ä¸“é—¨çš„æ”¯æŒã€‚ 13.1 ä¾èµ–é¡¹ç®¡ç†æ¯ä¸€ä¸ª Spring Boot çš„\bå‘è¡Œç‰ˆéƒ½å¯¹ä¾èµ–é¡¹ç®¡ç†åˆ—è¡¨æä¾›æ”¯æŒï¼Œåœ¨å®è·µå½“ä¸­ï¼ˆin \bpracticeï¼‰ï¼Œä½ ä¸éœ€è¦åœ¨ä½ çš„æ„å»ºé…ç½®ä¸­æ·»åŠ è¿™äº›ä¾èµ–çš„ä»»ä½•ä¸€ä¸ª version èŠ‚ç‚¹ï¼Œspring boot \bå¸®æ‚¨ç®¡ç†ã€‚å½“ä½ å‡çº§ spring boot æœ¬èº«ï¼Œè¿™äº›ä¾èµ–ä»¥åŒæ ·çš„ï¼ˆconsistent wayï¼‰æ–¹å¼å‡çº§ã€‚ å¦‚æœä½ éœ€è¦è¿™æ ·åšä½ å¯ä»¥ä¸€ç›´æŒ‡å®šï¼ˆspecifyï¼‰ version èŠ‚ç‚¹ä»¥è¦†ç›– spring boot çš„å»ºè®®ã€‚ è¯¥åˆ—è¡¨åŒ…å«äº†æ‰€æœ‰ä½ ä½¿ç”¨çš„ Spring Boot çš„æ‰€æœ‰\bæ¨¡å—ä»¥åŠï¼ˆas well asï¼‰ç²¾ç¡®ï¼ˆrefindï¼‰çš„ç¬¬ä¸‰æ–¹ç±»åº“åˆ—è¡¨ã€‚è¯¥åˆ—è¡¨å¯ä½œä¸ºæ ‡å‡†çš„ç‰©æ–™æ¸…å•(spring-boot-dependencies)æä¾›ï¼Œå¯ä¸Mavenå’ŒGradleä¸€èµ·ä½¿ç”¨ã€‚ æ¯ä¸€ä¸ª spring boot çš„å‘è¡Œç‰ˆç‰ˆæœ¬ä¸ Spring æ¡†æ¶çš„åŸºæœ¬ç‰ˆæœ¬ç›¸å…³è”ã€‚æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ä¸è¦å®šåˆ¶è‡ªå·±çš„ç‰ˆæœ¬å·ã€‚ 13.2 MavenMaven ç”¨æˆ·å¯ä»¥ç»§æ‰¿è‡ª spring-boot-starters-parent é¡¹ç›®è·å¾—ï¼ˆobainï¼‰åˆç†ï¼ˆsensibleï¼‰çš„é»˜è®¤å€¼ã€‚è¯¥çˆ¶é¡¹ç›®æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š java8 ä½œä¸ºé»˜è®¤\bçš„ç¼–è¾‘çº§åˆ« UTF-8 èµ„æºç¼–ç  ä¸€ä¸ªä¾èµ–ç®¡ç†èŠ‚ç‚¹ï¼Œç»§æ‰¿è‡ª spring-boot-dependencies pomæ–‡ä»¶ï¼Œç”¨æ¥ç®¡ç†å…¬å…±ä¾èµ–é¡¹çš„ versionã€‚è¯¥ä¾èµ–é¡¹ç®¡ç†å…è®¸ä½ å¿½ç•¥ï¼ˆomitï¼‰version æ ‡ç­¾ä¸ºäº†ä¾èµ–é¡¹å½“ä½ åœ¨ä½ è‡ªå·±çš„ pom æ–‡ä»¶ä¸­ã€‚ ä½¿ç”¨ repackage çš„æ‰§è¡Œ id æ‰§è¡Œ repackge ç›®æ ‡ åˆç†ï¼ˆsensibleï¼‰\bçš„èµ„æºè¿‡æ»¤ åˆç†çš„æ’ä»¶é…ç½®ï¼ˆexec pluginã€git commit ID å’Œ shadeï¼‰ ç”¨äº application.xml å’Œ application.Properties çš„åˆç†è¿‡æ»¤ï¼ŒåŒ…å«ç‰¹æ®Šçš„é…ç½®æ–‡ä»¶ï¼ˆå¦‚ï¼šapplicatino-dev.properties å’Œ application-dev.ymlï¼‰ è¯·æ³¨æ„ï¼ˆnote thatï¼‰ï¼Œä» application.properties å’Œ application.yml æ–‡ä»¶æ”¯æŒ Spring é£æ ¼çš„å ä½ç¬¦(${...})ï¼ŒMaven è¿‡æ»¤\bæ”¹å˜ä¸ºä½¿ç”¨@...@å ä½ç¬¦ã€‚ï¼ˆä½ å¯ä»¥è®¾ç½® maven å±æ€§åä¸º resource.dilimiter å……è¡€è¯¥å±æ€§ï¼‰ 13.2.1 ç»§æ‰¿ Starter Parentç»§æ‰¿ä½ çš„é¡¹ç›®è‡ª spring-boot-starter-parentï¼Œè®¾ç½® parent èŠ‚ç‚¹å¦‚ä¸‹ï¼š 123456&lt;!-- Inherit defaults from Spring Boot --&gt;&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.5.RELEASE&lt;/version&gt;&lt;/parent&gt; ä½ åªéœ€è¦åœ¨è¿™ä¸ªä¾èµ–é¡¹ä¸­æŒ‡å®š Spring Boot çš„ç‰¹å®šç‰ˆæœ¬å·ï¼Œå¦‚æœä½ å¯¼å…¥\bé¢å¤–çš„å¯åŠ¨å™¨ï¼Œä½ å¯ä»¥å®‰å…¨\båœ°ï¼ˆsavelyï¼‰çœç•¥è¯¥ç‰ˆæœ¬å·ã€‚ é€šè¿‡è¯¥é…ç½®ï¼ˆwith setupï¼‰ï¼Œä½ å¯ä»¥åœ¨ä½ é¡¹ç›®ä¸­é€šè¿‡è¦†ç›–\bå±æ€§æ¥è¦†ç›–\bå•ä¸ªä¾èµ–é¡¹ï¼ˆindividual dependencies ï¼‰ã€‚ä¾‹å¦‚ï¼Œå‡çº§å¦å¤–çš„ Spring Data å‘è¡Œç‰ˆï¼Œä½ å¯ä»¥æ·»åŠ ä»¥ä¸‹åˆ°ä½ çš„ pom.xml: 123&lt;properties&gt; &lt;spring-data-releasetrain.version&gt;Fowler-SR2&lt;/spring-data-releasetrain.version&gt;&lt;/properties&gt; ç‚¹å‡»è¿™ä¸ª spring-boot-dependencies pom æ’ä»¶æ”¯æŒçš„\bå±æ€§åˆ—è¡¨ 13.2.2 æ²¡æœ‰ Parent Pom ä½¿ç”¨ Spring Bootä¸æ˜¯æ¯ä¸ªäººéƒ½å–œæ¬¢ç»§æ‰¿è‡ª spring-boot-starters-parent pomï¼Œä½ å¯èƒ½æœ‰ä½ è‡ªå·±çš„ä¼ä¸šçš„ï¼ˆcorporateï¼‰æ ‡å‡† parent è¦ä½¿ç”¨ï¼Œæˆ–è€…ä½ æƒ³æ˜ç¡®çš„ï¼ˆexlictilyï¼‰å®šä¹‰æ‰€æœ‰ä½ çš„ maven é…ç½®ã€‚ å¦‚æœä½ ä¸æƒ³è¦ä½¿ç”¨ spring-boot-starters-parentï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸€ä¸ª scope=import ä¾èµ–ä¸€ç›´ä¿æŒä¾èµ–ç®¡ç†å™¨çš„å¥½å¤„(benefit)ï¼ˆä½†ä¸æ˜¯æ’ä»¶ç®¡ç†ï¼‰ï¼Œå¦‚ä¸‹ï¼š 123456789101112&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;!-- Import dependency management from Spring Boot --&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;2.1.5.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt; ä¸Šé¢çš„ï¼ˆprevedingï¼‰ç¤ºä¾‹è®¾ç½®ä¸å…è®¸é€šè¿‡ä½¿ç”¨å±æ€§è¦†ç›–å„ä¸ªä¾èµ–é¡¹ï¼Œå¦‚ä¸Šæ‰€è¿°ï¼ˆas explained aboveï¼‰ã€‚è¦è¾¾åˆ°ï¼ˆachieveï¼‰åŒæ ·çš„æ•ˆæœï¼Œä½ éœ€è¦åœ¨ä½ çš„é¡¹ç›®ä¸­ï¼Œspring-boot-dependencies ä¹‹å‰ï¼Œ\b\bæ·»åŠ ä¸€ä¸ªæ¡ç›®åˆ° dependencyManagementã€‚ä¾‹å¦‚ï¼šè¦æ›´æ–°å…¶ä»–çš„ Spring data å‘è¡Œç‰ˆï¼Œä½ éœ€è¦æ·»åŠ ä»¥ä¸‹å…ƒç´ åˆ°ä½ çš„ pom.xml: 1234567891011121314151617181920&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;!-- Override Spring Data release train provided by Spring Boot --&gt; &lt;!-- åœ¨ spring-boot-dependencies ä¹‹å‰æŒ‡å®š\bè¿™ä¸ª --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.data&lt;/groupId&gt; &lt;artifactId&gt;spring-data-releasetrain&lt;/artifactId&gt; &lt;version&gt;Fowler-SR2&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;2.1.5.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt; å¦‚ä¸Šé¢ä¾‹å­\bï¼Œæˆ‘ä»¬\bæŒ‡å®šä¸€ä¸ª POMï¼Œä½†æ˜¯ä½†æ˜¯\bä»»ä½•çš„ä¾èµ–é¡¹ç±»å‹ä»¥ç›¸åŒçš„\bæ–¹å¼è¦†ç›–ã€‚ 13.2.3 ä½¿ç”¨ Spring Boot Maven æ’ä»¶Spring Boot åŒ…å«ä¸€ä¸ª Maven æ’ä»¶ï¼Œ\bå¯ä»¥æ‰“åŒ…é¡¹ç›®ä½œä¸ºä¸€ä¸ªå¯æ‰§è¡Œ jarã€‚å¦‚æœ\bä½ æƒ³ä½¿ç”¨å®ƒæ·»åŠ \bä»¥ä¸‹æ’ä»¶åˆ°ä½ çš„ &lt;plugins&gt; èŠ‚ç‚¹ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š 12345678&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; å¦‚æœä½ ä½¿ç”¨ Spring Boot çˆ¶å¯åŠ¨å™¨ pomï¼Œä½ åªéœ€è¦æ·»åŠ æ’ä»¶ã€‚è¿™é‡Œä¸éœ€è¦é…ç½®é™¤éä½ æƒ³è¦æ”¹å˜åœ¨ \bparent ä¸­çš„è®¾ç½®å®šä¹‰ã€‚ 13.3 Gradleè¦å­¦ä¹ ä½¿ç”¨ Spring Boot çš„ \bGradleï¼Œè¯·å‚è€ƒï¼ˆreferï¼‰Spring Boot çš„ Gradle æ’ä»¶æ–‡æ¡£ï¼š å‚è€ƒï¼ˆHTML å’Œ PDFï¼‰ API 13.4 Antå¯ä»¥ä½¿ç”¨ ApacheAnt + Ivy æ„å»º SpringBoot é¡¹ç›®ã€‚è¿™ä¸ª spring-boot-antlibï¼Œâ€œant-libâ€æ¨¡å—åŒæ ·å¯ç”¨äºï¼ˆavailable toï¼‰å¸®åŠ© Ant åˆ›å»ºå¯æ‰§è¡Œjarã€‚ è¦å®šä¹‰è¿™ä¸ªä¾èµ–é¡¹ï¼Œä¸€ä¸ªå…¸å‹çš„ï¼ˆa typicalï¼‰çš„ ivy.xml æ–‡ä»¶\bçœ‹èµ·æ¥åƒä¸‹é¢çš„ä¾‹å­ï¼š 1234567891011&lt;ivy-module version=\"2.0\"&gt; &lt;info organisation=\"org.springframework.boot\" module=\"spring-boot-sample-ant\" /&gt; &lt;configurations&gt; &lt;conf name=\"compile\" description=\"everything needed to compile this module\" /&gt; &lt;conf name=\"runtime\" extends=\"compile\" description=\"everything needed to run this module\" /&gt; &lt;/configurations&gt; &lt;dependencies&gt; &lt;dependency org=\"org.springframework.boot\" name=\"spring-boot-starter\" rev=\"${spring-boot.version}\" conf=\"compile\" /&gt; &lt;/dependencies&gt;&lt;/ivy-module&gt; ä¸€ä¸ªå…¸å‹çš„ build.xml æ–‡ä»¶çœ‹èµ·æ¥åƒä¸‹é¢çš„å®ä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233&lt;project xmlns:ivy=\"antlib:org.apache.ivy.ant\" xmlns:spring-boot=\"antlib:org.springframework.boot.ant\" name=\"myapp\" default=\"build\"&gt; &lt;property name=\"spring-boot.version\" value=\"2.1.5.RELEASE\" /&gt; &lt;target name=\"resolve\" description=\"--&gt; retrieve dependencies with ivy\"&gt; &lt;ivy:retrieve pattern=\"lib/[conf]/[artifact]-[type]-[revision].[ext]\" /&gt; &lt;/target&gt; &lt;target name=\"classpaths\" depends=\"resolve\"&gt; &lt;path id=\"compile.classpath\"&gt; &lt;fileset dir=\"lib/compile\" includes=\"*.jar\" /&gt; &lt;/path&gt; &lt;/target&gt; &lt;target name=\"init\" depends=\"classpaths\"&gt; &lt;mkdir dir=\"build/classes\" /&gt; &lt;/target&gt; &lt;target name=\"compile\" depends=\"init\" description=\"compile\"&gt; &lt;javac srcdir=\"src/main/java\" destdir=\"build/classes\" classpathref=\"compile.classpath\" /&gt; &lt;/target&gt; &lt;target name=\"build\" depends=\"compile\"&gt; &lt;spring-boot:exejar destfile=\"build/myapp.jar\" classes=\"build/classes\"&gt; &lt;spring-boot:lib&gt; &lt;fileset dir=\"lib/runtime\" /&gt; &lt;/spring-boot:lib&gt; &lt;/spring-boot:exejar&gt; &lt;/target&gt;&lt;/project&gt; å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ spring-boot-antlib æ¨¡å—ï¼ŒæŸ¥çœ‹ç« èŠ‚ 91.9ï¼šä¸ä½¿ç”¨ spring-boot-ant ä» Ant æ„å»ºå¯æ‰§è¡Œå½’æ¡£ã€‚ 13.5 å¯åŠ¨å™¨å¯åŠ¨å™¨æ˜¯ä¸€ç»„ï¼ˆset ofï¼‰æ–¹ä¾¿çš„ï¼ˆconvenientï¼‰\bä¾èµ–æè¿°ç¬¦ï¼ˆdescriptorsï¼‰ï¼Œå¯ä»¥åŒ…å«åœ¨ä½ çš„åº”ç”¨ä¸­ã€‚ä½ è·å¾—æ‰€æœ‰ Spring å’Œä¸ä¹‹å…³è”çš„æŠ€æœ¯çš„ä¸€ç«™å¼ï¼ˆone-stopï¼‰æœåŠ¡ï¼Œä½ ä¸éœ€è¦ï¼ˆneed withoutï¼‰å¯»æ‰¾ï¼ˆhunt throughtï¼‰ç›¸ä¼¼ä»£ç å’Œå¤åˆ¶ç²˜è´´å¤§é‡çš„ä¾èµ–æè¿°ç¬¦ã€‚å¦‚ï¼š\bå¦‚æœä½ æƒ³å¼€å§‹è·å¾— Spring å’Œ JPA è®¿é—®æ•°æ®åº“ï¼ŒåŒ…å« spring-data-jpaä¾èµ–åˆ°ä½ çš„é¡¹ç›®ä¸­ã€‚ è¯¥å¯åŠ¨å™¨åŒ…å«äº†å¤§é‡çš„ä¾èµ–é¡¹ï¼Œä½ éœ€è¦è¿™äº›æ‰å¯ä»¥æ–¹ä¾¿çš„è·å¾—é¡¹ç›®ä¸€è‡´æ€§å’Œå¿«é€Ÿè¿è¡Œã€‚æ”¯æŒç®¡ç†ä¼ é€’ï¼ˆtransitiveï¼‰ä¾èµ–ã€‚ åå­—é‡Œæœ‰ä»€ä¹ˆï¼Ÿæ‰€æœ‰å®˜æ–¹çš„å¯åŠ¨å™¨éµå¾ªç›¸ä¼¼çš„å‘½ä»¤è§„èŒƒï¼›spring-boot-starters-*ï¼Œå…¶ä¸­ * æ˜¯ç‰¹å®šï¼ˆparticularï¼‰ç±»å‹çš„\båº”ç”¨ã€‚è¿™ä¸ªå‘½åç»“æ„æ˜¯ä¸ºäº†ï¼ˆintented toï¼‰å¸®åŠ©ä½ å¯»æ‰¾å¯åŠ¨å™¨ã€‚Maven é›†æˆäº†è®¸å¤š IDE \bå…è®¸ä½ é€šè¿‡åå­—æŸ¥æ‰¾ä¾èµ–é¡¹ã€‚ä¾‹å¦‚ï¼šå®‰è£…äº†é€‚å½“çš„ Eclipse æˆ– STS æ’ä»¶ï¼Œä½ å¯ä»¥åœ¨ Pom ç¼–è¾‘å™¨æŒ‰ä¸‹ ctrl + space å¹¶è¾“å…¥ spring-boot-starter ä¸€ä¸ªå®Œæ•´\b\bæ¸…å•ã€‚\b\\å¦‚ â€œåˆ›å»ºä½ è‡ªå·±çš„å¯åŠ¨å™¨â€ \bç« èŠ‚è§£é‡Šï¼ˆexplainedï¼‰çš„ä¸€æ ·ï¼Œç¬¬ä¸‰æ–¹å¯åŠ¨å™¨ä¸éœ€è¦ä»¥ spring-boot å¼€å¤´ï¼Œ\bå› ä¸ºå®ƒæ˜¯ä¸ºå®˜æ–¹çš„ Spring \bBoot \b\b\båˆ¶å“ä¿ç•™çš„ã€‚ç›¸åï¼ˆRatherï¼‰ï¼Œä¸€ä¸ªç¬¬ä¸‰æ–¹å¯åŠ¨å™¨\bå…¸å‹\u001bçš„ä»¥é¡¹ç›®åå­—å¼€å§‹ï¼Œå¦‚ï¼šä¸€ä¸ªç¬¬ä¸‰æ–¹åº”ç”¨å«åš thirdpartyproject å°†\bä¼š\bå‘½åä¸º thirdpartyproject-spring-boot-starter ä»¥ä¸‹åº”ç”¨ç¨‹åºç”± Spring\b Boot åœ¨ org.springframework.boot ç»„ä¸‹æä¾›ï¼š Name Description Pom spring-boot-starter æ ¸å‹å¯åŠ¨å™¨ï¼ŒåŒ…å«è‡ªåŠ¨é…ç½®æ”¯æŒï¼Œæ—¥å¿—å’Œ YAML Pom spring-boot-starter-activemq ä½¿ç”¨ Apache ActiveMQ çš„ JMS æ¶ˆæ¯å¯åŠ¨å™¨ Pom spring-boot-starter-amqp Starter for using Spring AMQP and Rabbit MQ Pom spring-boot-starter-aop ä½¿ç”¨ Spring AOP å’Œ AspectJ é¢å‘ï¼ˆorientedï¼‰åˆ‡é¢ç¼–ç¨‹çš„å¯åŠ¨å™¨ Pom spring-boot-starter-artemis ä½¿ç”¨ Apache Artemis çš„ JMS æ¶ˆæ¯å¯åŠ¨å™¨ Pom spring-boot-starter-batch Starter for using Spring Batch Pom spring-boot-starter-cache Starter for using Spring Frameworkâ€™s caching support Pom spring-boot-starter-cloud-connectors ä½¿ç”¨SpringCloudè¿æ¥å™¨ï¼Œç®€åŒ–äº†ä¸äº‘å¹³å°ä¸­æœåŠ¡ï¼Œå¦‚ Cloud Foundry and Heroku Pom spring-boot-starter-data-cassandra ä½¿ç”¨ Cassandra åˆ†å¸ƒå¼æ•°æ®åº“å’Œ Spring Data Cassandra Pom spring-boot-starter-data-cassandra-reactive ä½¿ç”¨ Cassandra åˆ†å¸ƒå¼æ•°æ®åº“å’Œ Spring Data Cassandra ååº” Pom spring-boot-starter-data-couchbase ä½¿ç”¨ Couchbase é¢å‘æ–‡æ¡£æ•°æ®åº“å’Œ Spring Data Couchbase Pom spring-boot-starter-data-couchbase-reactive ä½¿ç”¨ Couchbase é¢å‘æ–‡æ¡£æ•°æ®åº“å’Œ Spring Data Couchbase ååº” Pom spring-boot-starter-data-elasticsearch ä½¿ç”¨ Elasticsearch æœç´¢å’Œåˆ†è¯å¼•æ“ å’Œ Spring Data Elasticsearch Pom spring-boot-starter-data-jdbc Starter for using Spring Data JDBC Pom spring-boot-starter-data-jpa Starter for using Spring Data JPA with Hibernate Pom spring-boot-starter-data-ldap Starter for using Spring Data LDAP Pom spring-boot-starter-data-mongodb ä½¿ç”¨ MongoDB é¢å‘æ–‡æ¡£æ•°æ®åº“ å’Œ Spring Data MongoDB Pom spring-boot-starter-data-mongodb-reactive ä½¿ç”¨ MongoDB é¢å‘æ–‡æ¡£æ•°æ®åº“ å’Œ Spring Data MongoDB ååº” Pom spring-boot-starter-data-neo4j ä½¿ç”¨ Neo4j å›¾æ•°æ®åº“ å’Œ Spring Data Neo4j Pom spring-boot-starter-data-redis ä½¿ç”¨ Redis é”®å€¼å­˜å‚¨å’Œ Spring Data Redis and the Lettuce client Pom spring-boot-starter-data-redis-reactive ä½¿ç”¨ Redis é”®å€¼å­˜å‚¨å’Œ Spring Data Redis and the Lettuce client Pom spring-boot-starter-data-rest ä½¿ç”¨ Spring Data REST æ›å…‰ Spring Data å­˜å‚¨åº“ä¸º rest Pom spring-boot-starter-data-solr ä½¿ç”¨ Spring Data Solr çš„ Apache Solr æœç´¢å¹³å° Pom spring-boot-starter-freemarker ä½¿ç”¨ FreeMarker è§†å›¾æ„å»º MVC Web åº”ç”¨ Pom spring-boot-starter-groovy-templates ä½¿ç”¨ Groovy æ¨¡ç‰ˆæ„å»º MVC Web åº”ç”¨ Pom spring-boot-starter-hateoas ä½¿ç”¨ Spring MVC å’Œ Spring HATEOAS æ„å»ºåŸºäºè¶…åª’ä½“çš„ RestFul web åº”ç”¨ Pom spring-boot-starter-integration ä½¿ç”¨ Spring æ•´åˆ Pom spring-boot-starter-jdbc ä½¿ç”¨ HikariCP è¿æ¥æ± çš„JDBC Pom spring-boot-starter-jersey ä½¿ç”¨ JAX-RS å’Œ Jersey æ„å»º restfull web åº”ç”¨. å¦ä¸€ç§é€‰æ‹©ï¼ˆAn alternative toï¼‰æ˜¯ spring-boot-starter-web Pom spring-boot-starter-jooq ä½¿ç”¨ jOOQ è®¿é—® SQL æ•°æ®åº“. å¦ä¸€ç§é€‰æ‹©æ˜¯ spring-boot-starter-data-jpa æˆ– spring-boot-starter-jdbc Pom spring-boot-starter-json è¯»å†™ json Pom spring-boot-starter-jta-atomikos ä½¿ç”¨ Atomikos çš„ JTA äº‹åŠ¡ Pom spring-boot-starter-jta-bitronix ä½¿ç”¨ Bitronix çš„ JTA äº‹åŠ¡ Pom spring-boot-starter-mail ä½¿ç”¨ Java Mail å’Œ Spring Frameworkâ€™s é‚®ä»¶å‘é€æ”¯æŒ Pom spring-boot-starter-mustache ä½¿ç”¨ Mustache views æ„å»º web åº”ç”¨ Pom spring-boot-starter-oauth2-client ä½¿ç”¨ Spring Securityâ€™s OAuth2/OpenID è¿æ¥å®¢æˆ·ç«¯ç‰¹æ€§ Pom spring-boot-starter-oauth2-resource-server ä½¿ç”¨ Spring Securityâ€™s OAuth2 èµ„æºæœåŠ¡å™¨ç‰¹æ€§ Pom spring-boot-starter-quartz ä½¿ç”¨ Quartz ä»»åŠ¡è°ƒåº¦ Pom spring-boot-starter-security ä½¿ç”¨ Spring Security Pom spring-boot-starter-test ç”¨åº“æˆ–è€… Junit Hamcrest å’Œ Mockito æµ‹è¯• Spring Boot åº”ç”¨ Pom spring-boot-starter-thymeleaf ä½¿ç”¨ Thymeleaf views æ„å»º web åº”ç”¨ Pom spring-boot-starter-validation åœ¨ Hibernate Validator ä¸­ä½¿ç”¨ Java Bean éªŒè¯ Pom spring-boot-starter-web ä½¿ç”¨ Spring MVC æ„å»º restfull web åº”ç”¨. ä½¿ç”¨ tomcat ä½œä¸ºé»˜è®¤å†…åµŒå®¹å™¨ Pom spring-boot-starter-web-services ä½¿ç”¨ Spring Web æœåŠ¡ Pom spring-boot-starter-webflux ä½¿ç”¨ Spring Frameworkâ€™s å“åº”å¼ web æ”¯æŒæ„å»º WebFlux åº”ç”¨ Pom spring-boot-starter-websocket ä½¿ç”¨ Spring Frameworkâ€™s WebSocket æ”¯æŒæ„å»º WebSocket åº”ç”¨ Pom é™¤äº†ï¼ˆin addition toï¼‰åº”ç”¨å¯åŠ¨å™¨ï¼Œä»¥ä¸‹å¯åŠ¨å™¨å¯ç”¨æ¥æ·»åŠ åˆ°â€œç”Ÿäº§å¯è¯»â€ç‰¹æ€§ï¼š Name Description POM spring-boot-starter-actuator ä½¿ç”¨ Spring Boot çš„ç›‘æ§æä¾›ç”Ÿäº§å¯è¯»çš„ç‰¹æ€§å¸®åŠ©ä½ ç›‘è§†å¹¶ç®¡ç†ä½ çš„åº”ç”¨ POM æœ€ç»ˆï¼Œå¦‚æœä½ æƒ³æ’é™¤ï¼ˆexcludeï¼‰æˆ–æ›¿æ¢ï¼ˆswapï¼‰ç‰¹å®šçš„æŠ€æœ¯æ–¹é¢ï¼ŒSpring Boot åŒæ ·åŒ…å«ä»¥ä¸‹å¯åŠ¨å™¨å¯ä»¥ä½¿ç”¨ï¼š name Description Pom spring-boot-starter-jetty ä½¿ç”¨ Jetty ä½œä¸ºå†…åµŒæœåŠ¡å™¨ï¼Œå¦ä¸€ä¸ªå¯æ›¿ä»£çš„ï¼ˆalternativeï¼‰æ˜¯ï¼šspring-boot-starter-tomcat Pom spring-boot-starter-log4j2 ä½¿ç”¨ Log4j2 ä½œä¸ºæ—¥å¿—è®°å½•ï¼Œå¯æ›¿ä»£çš„æ˜¯ï¼šspring-boot-starter-logging Pom spring-boot-starter-logging ä½¿ç”¨ Logback ä½œä¸ºæ—¥å¿—è®°å½•ï¼Œæ˜¯é»˜è®¤çš„æ—¥å¿—è®°å½•å¯åŠ¨å™¨ Pom spring-boot-starter-reactor-netty ä½¿ç”¨ Reactor Netty ä½œä¸ºå†…åµŒçš„å“åº”å¼ HTTP æœåŠ¡å™¨ Pom spring-boot-starter-tomcat ä½¿ç”¨ Tomcat ä½œä¸ºå†…åµŒçš„ servlet æœåŠ¡å™¨ï¼Œspring-boot-starter-web ä½¿ç”¨çš„é»˜è®¤ servlet æœåŠ¡å™¨ Pom spring-boot-starter-undertow ä½¿ç”¨ Undertow ä½œä¸ºå†…åµŒæœåŠ¡å™¨ï¼Œä¸€ä¸ªå¯æ›¿ä»£çš„æ˜¯ï¼šspring-boot-starter-tomcat Pom æ›´å¤šçš„ç¤¾åŒºè´¡çŒ®çš„å¯åŠ¨å™¨åˆ—è¡¨ï¼Œè¯·åœ¨ GITHUB çš„ spring-boot-starters æ¨¡å—ä¸­æŸ¥çœ‹ README file 14. ä»£ç ç»“æ„Spring Boot ä¸è¦æ±‚ä½ å·¥ä½œæ—¶çš„ä»»æ„ç‰¹å®šçš„ä»£ç ç»“æ„å¸ƒå±€ã€‚ä½†æ˜¯ï¼Œè¿™é‡Œæœ‰æœ€ä½³å®è·µå¯ä»¥å¸®åŠ©ä½ ã€‚ 14.1 ä½¿ç”¨â€œé»˜è®¤çš„â€åŒ…å½“ä¸€ä¸ªç±»æ²¡æœ‰åŒ…å« package å£°æ˜ï¼ˆdeclarationï¼‰ï¼Œå®ƒè¢«è®¤ä¸ºæ˜¯ï¼ˆit is considered toï¼‰åœ¨é»˜è®¤çš„åŒ…ä¸­ã€‚ä½¿ç”¨é»˜è®¤çš„åŒ…é€šå¸¸ï¼ˆgenerallyï¼‰ä¸è¢«é¼“åŠ±ï¼ˆdiscouragedï¼‰åº”è¯¥å°½é‡é¿å…ï¼ˆavoidedï¼‰ã€‚åœ¨ Spring Boot ä½¿ç”¨ @ComponentScan,@EntityScan,@SpringBootApplication æ—¶è¿™ä¼šå¯¼è‡´ä¸€äº›ç‰¹å®šçš„é—®é¢˜ï¼Œå› ä¸ºæ¯ä¸ªç±»æ¯ä¸ª jar éƒ½æ˜¯å¯è¯»çš„ã€‚ æˆ‘ä»¬å»ºè®®ä½ éµå¾ª java æ¨èçš„åŒ…å‘½åçº¦å®šï¼ˆConvertionsï¼‰å¹¶åè½¬åŸŸååå­—ï¼ˆä¾‹å¦‚ï¼šcom.example.projectï¼‰ 14.2 å®šä½ï¼ˆLocationï¼‰ä¸»åº”ç”¨ç±»æˆ‘ä»¬é€šå¸¸å»ºè®®ä½ åœ¨å…¶ä»–ç±»ä¹‹ä¸Šçš„æ ¹åŒ…ä¸­æ”¾ç½®ï¼ˆLocateï¼‰æ‚¨çš„ä¸»åº”ç”¨ç¨‹åºç±»ï¼Œè¯¥ @SpringBootApplication æ³¨è§£ç»å¸¸è¢«æ”¾åœ¨ï¼ˆplaceï¼‰ä½ çš„ä¸»ç±»ï¼Œå®ƒéšå¼ï¼ˆimplicitlyï¼‰å®šä¹‰æŸäº›ï¼ˆcartainï¼‰â€œæŸ¥è¯¢åŒ…â€ã€‚ä¾‹å¦‚ï¼šå¦‚æœä½ è¦å†™ä¸€ä¸ª JPA åº”ç”¨ï¼Œ@SpringBootApplication æ³¨è§£ç±»çš„åŒ…ç”¨äºæœç´¢ @Entity é¡¹ã€‚ä½¿ç”¨æ ¹åŒ…è¿˜å…è®¸æ³¨è§£åªæ‰«æä½ çš„åº”ç”¨ã€‚ å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ @SpringBootApplicationï¼Œ@EnableAutoConfiguration å’Œ @ComponentScan æ³¨è§£å¯¼å…¥äº†å®šä¹‰çš„è¡Œä¸ºï¼Œæ‰€ä»¥ä½ åŒæ ·å¯ä»¥ä½¿ç”¨ä»–ä»¬ã€‚ ä»¥ä¸‹åˆ—è¡¨å±•ç¤ºäº†å…¸å‹çš„å¸ƒå±€ï¼š 12345678910111213141516com +- example +- myapplication +- Application.java | +- customer | +- Customer.java | +- CustomerController.java | +- CustomerService.java | +- CustomerRepository.java | +- order +- Order.java +- OrderController.java +- OrderService.java +- OrderRepository.java ä¸€ä¸ª Application.java æ–‡ä»¶ä¼šå®šä¹‰ä¸€ä¸ª main æ–¹æ³•ï¼Œè¿åŒåŸºç¡€çš„ @SpringBootApplicationï¼Œå¦‚ä¸‹ï¼š 12345678910111213package com.example.myapplication;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class Application { public static void main(String[] args) { SpringApplication.run(Application.class, args); }} 15. é…ç½®ç±»spring boot æ”¯æŒï¼ˆfavorsï¼‰åŸºäº java çš„é…ç½®ï¼Œè™½ç„¶èƒ½å¤Ÿä½¿ç”¨åŸºäº XML èµ„æºçš„ SpringApplicationï¼Œæˆ‘ä»¬\bé€šå¸¸å»ºè®®ä½ ä¸»è¦èµ„æºæ˜¯ä¸€ä¸ªï¼ˆbe aï¼‰å•ä¸ª @Configuration ç±»ã€‚é€šå¸¸å®šä¹‰ main æ–¹æ³•çš„ç±»æ˜¯ @Configuration çš„ä¸»è¦å€™é€‰è€…ã€‚ è®¸å¤š Spring é…ç½®æ ·ä¾‹ä½¿ç”¨ XML é…ç½®åœ¨ç½‘ç»œä¸Šå‘å¸ƒã€‚å¦‚æœå¯èƒ½ï¼Œæ°¸è¿œå°è¯•ä½¿ç”¨ç›¸ç­‰çš„åŸºäº Java çš„é…ç½®ã€‚æœç´¢ Enable* \bæ³¨è§£æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„\bå¼€å§‹ã€‚ 15.1 å¯¼å…¥é¢å¤–çš„é…ç½®ç±»ä½ ä¸éœ€è¦æŠŠæ‰€æœ‰çš„ @\bConfiguration éƒ½æ”¾åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸­ã€‚@Import æ³¨è§£å¯ä»¥è¢«ç”¨æ¥å¯¼å…¥é¢å¤–çš„é…ç½®ç±»ã€‚å¦å¤–ï¼ˆAlternativelyï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ @CompomentScan å»åŠ¨æ€çš„\bè·å–ï¼ˆpick upï¼‰æ‰€æœ‰çš„ Spring ç»„ä»¶ï¼ŒåŒ…å« @Configuration \bç±»ã€‚ 15.2 \bå¯¼å…¥ XML é…ç½®å¦‚æœä½ ç»å¯¹ï¼ˆAbsolutelyï¼‰\bè¦ç”¨åŸºäº XML çš„é…ç½®ï¼Œæˆ‘ä»¬å»ºè®®ä½ ä»ç„¶ï¼ˆstillï¼‰ä» @Configuration ç±»å¼€å§‹ã€‚ä½ å¯ä»¥ä½¿ç”¨ @ImportResource æ³¨è§£\båŠ è½½ XML é…ç½®æ–‡ä»¶ã€‚ 16. è‡ªåŠ¨é…ç½®Spring Boot è‡ªåŠ¨é…ç½®å°è¯•ï¼ˆattemptsï¼‰å»åŠ¨æ€çš„é…ç½®ä½ çš„ Spring åº”ç”¨åŸºäºåœ¨ä½ æ·»åŠ çš„ jar ä¾èµ–é¡¹ä¹‹ä¸Šã€‚ä¾‹å¦‚ï¼šå¦‚æœ HSQLDB åœ¨ä½ çš„ç±»è·¯å¾„ä¸‹ï¼Œå¹¶ä¸”ä½ æ²¡æœ‰æ‰‹åŠ¨ï¼ˆmanuallyï¼‰é…ç½®ä»»ä½•æ•°æ®åº“è¿æ¥ beanï¼Œspring boot ä¼šåœ¨å†…å­˜ä¸­è‡ªåŠ¨é…ç½®æ•°æ®åº“ã€‚ ä½ éœ€è¦æ·»åŠ  @EnableAutoConfiguration æˆ–è€… @SpringBootApplication å…¶ä¸­ä¸€ä¸ªæ³¨è§£åˆ°ä½ çš„ä¸€ä¸ª @Configuration é…ç½®ç±»ä¸Šæ¥é€‰æ‹©è‡ªåŠ¨é…ç½®ã€‚ ä½ åº”è¯¥åªæ·»åŠ ä¸€ä¸ªæ³¨è§£ @EnableAutoConfiguration æˆ–è€… @SpringBootApplicationã€‚æˆ‘ä»¬é€šå¸¸å»ºè®®ä½ åªæ·»åŠ ä¸€ä¸ªæˆ–å¦å¤–ä¸€ä¸ªåˆ°æ‚¨çš„ @Configuration é…ç½®ç±»ä¸Šã€‚ 16.1 é€æ­¥ï¼ˆgraduallyï¼‰æ›´æ¢ï¼ˆreplacingï¼‰è‡ªåŠ¨é…ç½®è‡ªåŠ¨é…ç½®æ˜¯éä¾µå…¥å‹çš„ï¼ˆnon-invasiveï¼‰ã€‚ä»»ä½•æ—¶å€™ï¼Œä½ å¯ä»¥å¼€å§‹å®šä¹‰ä½ è‡ªå·±çš„é…ç½®ç±»æ¥æ›¿æ¢ç‰¹å®šéƒ¨åˆ†çš„è‡ªåŠ¨é…ç½®ã€‚ä¾‹å¦‚ï¼šå¦‚æœä½ æ·»åŠ ä½ è‡ªå·±çš„ DataSource beanï¼Œé»˜è®¤å†…åµŒçš„æ•°æ®åº“å°†ä¸å†\bæ”¯æŒï¼ˆbacks awayï¼‰ã€‚ å¦‚æœä½ æƒ³æ‰¾å‡ºï¼ˆfind outï¼‰å½“å‰ï¼ˆcurrentlyï¼‰æ­£åœ¨åº”ç”¨ï¼ˆbeing appliedï¼‰çš„è‡ªåŠ¨é…ç½®ï¼Œå’Œä¸ºä»€ä¹ˆï¼Œä½¿ç”¨ --debug å¼€å…³ï¼ˆswitchï¼‰å¼€å§‹ä½ çš„åº”ç”¨ã€‚\bè¿™æ ·åšä½¿è°ƒè¯•æ—¥å¿—å¯ä»¥é€‰æ‹©æ ¸å¿ƒæ—¥å¿—è®°å½•å™¨ï¼Œå¹¶å°†æ¡ä»¶æŠ¥å‘Šè®°å½•åˆ°æ§åˆ¶å°ã€‚ 16.2 ç¦ç”¨ç‰¹å®šçš„è‡ªåŠ¨é…ç½®ç±»å¦‚æœä½ \bå‘ç°ä¸€äº›è‡ªåŠ¨é…ç½®ç±»å¹¶ä¸æƒ³å®ƒè¢«åº”ç”¨ï¼Œä½ å¯ä»¥ä¸º @\bEnableAutoConfiguration ä½¿ç”¨ exclude å±æ€§å…³é—­ä»–ä»¬ï¼Œas shown in the following example: 12345678import org.springframework.boot.autoconfigure.*;import org.springframework.boot.autoconfigure.jdbc.*;import org.springframework.context.annotation.*;@Configuration@EnableAutoConfiguration(exclude={DataSourceAutoConfiguration.class})public class MyConfiguration {} å¦‚æœè¯¥ class ä¸åœ¨ç±»è·¯å¾„ä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨æ³¨è§£çš„ \bexcludeName å±æ€§å¹¶æŒ‡å®šå®Œå…¨é™å®šåã€‚æœ€ç»ˆï¼Œä½ åŒæ ·å¯ä»¥æ§åˆ¶è¦æ’é™¤çš„è‡ªåŠ¨é…ç½®åˆ—è¡¨é€šè¿‡ spring.autoconfigure.exclude\b å±æ€§ã€‚ å¯ä»¥åœ¨æ³¨é‡Šçº§åˆ«å’Œä½¿ç”¨å±æ€§å®šä¹‰æ’é™¤ã€‚","link":"/2019/06/09/[20190609] spring-boot | part3(13~16)/"},{"title":"20190622 spring-boot | part3(17~22)","text":"Spring Boot Reference Guide2.1.5.RELEASEhttps://docs.spring.io/spring-boot/docs/2.1.6.RELEASE/reference/html/using-boot-spring-beans-and-dependency-injection.html Part III. Using Spring Boot 17 Spring Bean ä¾èµ–æ³¨å…¥ 18. ä½¿ç”¨ @SpringBootApplication æ³¨è§£ 19. è¿è¡Œä½ çš„åº”ç”¨ 19.1 ä» IDE è¿è¡Œ 19.2 \bä½œä¸ºæ‰“åŒ…åº”ç”¨ç¨‹åºè¿è¡Œ 19.3 ä½¿ç”¨ Maven æ’ä»¶ 19.4 ä½¿ç”¨ Gradle æ’ä»¶ 19.5 çƒ­éƒ¨ç½² 20. å¼€å‘è€…å·¥å…· 20.1 é»˜è®¤å±æ€§ 20.2 è‡ªåŠ¨é‡å¯ 20.2.1. åœ¨çŠ¶æ€è¯„ä¼°ï¼ˆcondition evaluationï¼‰ä¸­è®°å½•\bå˜åŒ– 20.2.2. æ’é™¤èµ„æº 20.2.3. ç›‘è§†é¢å¤–çš„è·¯å¾„ 20.2.4. ç¦ç”¨é‡å¯ 20.2.5. ä½¿ç”¨è§¦å‘æ–‡ä»¶ 20.2.6. å®šåˆ¶é‡å¯ç±»åŠ è½½å™¨ 20.2.7. å·²çŸ¥é™åˆ¶ 20.3 çƒ­åŠ è½½ 20.4 å…¨å±€è®¾ç½® 20.5 è¿œç¨‹åº”ç”¨ 20.5.1 è¿è¡Œè¿œç¨‹åº”ç”¨å®¢æˆ·ç«¯ 20.5.2 è¿œç¨‹æ›´æ–° 21. ä¸ºç”Ÿäº§ç¯å¢ƒæ‰“åŒ…ä½ çš„åº”ç”¨ 22. \bä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆ 17 Spring Bean ä¾èµ–æ³¨å…¥ä½ å¯ä»¥å…è´¹ä½¿ç”¨ä»»æ„æ ‡å‡†çš„ Spring æ¡†æ¶æŠ€æœ¯æ¥å®šä¹‰çš„ä½ çš„ bean å’Œç®¡ç†ä¾èµ–æ³¨å…¥ã€‚ä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬ç»å¸¸å‘ç°ä½¿ç”¨ @ComponentScan ï¼ˆæŸ¥æ‰¾ä½ çš„ beanï¼‰å’Œä½¿ç”¨ @Autowired ï¼ˆåšä¾èµ–æ³¨å…¥ï¼‰æ•ˆæœå¾ˆå¥½ï¼ˆwork wellï¼‰ã€‚å¦‚æœæŒ‰ç…§ä¸Šé¢çš„å»ºè®®æ„é€ ä½ çš„ä»£ç ï¼ˆåœ¨æ ¹åŒ…ä¸­å®šä½åº”ç”¨ç¨‹åºç±»ï¼‰ï¼Œä½ å¯ä»¥\bæ— ç†ç”±çš„ï¼ˆwithout argumentsï¼‰æ·»åŠ  @ComponentScanã€‚ä½ åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶ï¼ˆ@Componentã€@Serviceã€@Repositoryã€@Controllerï¼‰éƒ½ä¼šè‡ªåŠ¨æ³¨å†Œåˆ° Spring beané‡Œã€‚ \bä»¥ä¸‹å®ä¾‹å±•ç¤ºäº†ä¸€ä¸ª @Service beanï¼Œå®ƒä½¿ç”¨æ§åˆ¶å™¨æ³¨å…¥ä»¥è·å¾—å¿…è¦çš„ RiskAssessor beanï¼š 123456789101112131415161718package com.example.service;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;@Servicepublic class DatabaseAccountService implements AccountService { private final RiskAssessor riskAssessor; @Autowired public DatabaseAccountService(RiskAssessor riskAssessor) { this.riskAssessor = riskAssessor; } // ...} å¦‚æœè¿™ä¸ª bean æœ‰ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œä½ å¯ä»¥çœç•¥ @Autowiredï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤º\bï¼š123456789101112@Servicepublic class DatabaseAccountService implements AccountService { private final RiskAssessor riskAssessor; public DatabaseAccountService(RiskAssessor riskAssessor) { this.riskAssessor = riskAssessor; } // ...} æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨æ§åˆ¶å™¨æ³¨å…¥è®© riskAssessor å­—æ®µæ ‡è®°ä¸º finalã€‚è¿™è¡¨æ˜ï¼ˆindicatingï¼‰å®ƒéšåï¼ˆsubsequentlyï¼‰ä¸èƒ½è¢«ä¿®æ”¹ã€‚ 18. ä½¿ç”¨ @SpringBootApplication æ³¨è§£è®¸å¤š Spring Boot çš„å¼€å‘è€…å–œæ¬¢\bä»–ä»¬çš„\båº”ç”¨ä½¿ç”¨è‡ªåŠ¨é…ç½®ï¼Œç»„ä»¶æ‰«æå’Œèƒ½å¤Ÿï¼ˆbe able toï¼‰åœ¨ä»–ä»¬çš„ä¸»ç±»ä¸Šå®šä¹‰é¢å¤–çš„ï¼ˆextraï¼‰çš„é…ç½®ã€‚ä¸€ä¸ªå•ä¸€çš„ @SpringBootApplication æ³¨è§£\bå°±å¯ä»¥è¢«ç”¨äºå¯ç”¨è¿™äº›ä¸‰ä¸ªç‰¹æ€§ï¼Œä»–ä»¬æ˜¯ï¼š @EnableAutoConfigurationï¼šå¼€å¯Spring Boot çš„è‡ªåŠ¨é…ç½®æœºåˆ¶ @ComponentScanï¼šå¯¹åº”ç”¨ç¨‹åºæ‰€åœ¨çš„åŒ…å¯ç”¨ @Component\b æ‰«æï¼ˆæœ€ä½³å®æˆ˜ï¼‰ @Configurationï¼šå…è®¸åœ¨ä¸Šä¸‹\bæ–‡æ³¨å†Œé¢å¤–çš„ bean æˆ–è€…å¯¼å…¥é¢å¤–çš„é…ç½®ç±» è¿™ä¸ª @SpringBootApplication æ³¨è§£ç­‰ä»·äºï¼ˆequivalentï¼‰ä½¿ç”¨ @Configurationï¼Œ@EnableAutoConfigurationï¼Œå’Œ @ComponentScan ä»–ä»¬çš„é»˜è®¤å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345678910111213package com.example.myapplication;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplication // same as @Configuration @EnableAutoConfiguration @ComponentScanpublic class Application { public static void main(String[] args) { SpringApplication.run(Application.class, args); }} @SpringBootApplication åŒæ ·æä¾›åˆ«åå®šä¹‰ @EnableAutoConfigurationï¼Œå’Œ @ComponentScan çš„å±æ€§ è¿™äº›\båŠŸèƒ½éƒ½ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼ˆmandatoryï¼‰ï¼Œä½ å¯ä»¥é€‰æ‹©é€šè¿‡æ‰“å¼€ä»»ä½•çš„ç‰¹æ€§æ¥æ›¿æ¢è¿™ä¸ªå•ä¸ªæ³¨è§£ã€‚ä¾‹å¦‚ï¼š\bä½ å¯èƒ½ä¸æƒ³åœ¨ä½ çš„\båº”ç”¨ä¸­ä½¿ç”¨æ³¨è§£æ‰«æï¼š 1234567891011121314151617package com.example.myapplication;import org.springframework.boot.SpringApplication;import org.springframework.context.annotation.ComponentScan;import org.springframework.context.annotation.Configuration;import org.springframework.context.annotation.Import;@Configuration@EnableAutoConfiguration@Import({ MyConfig.class, MyAnotherConfig.class })public class Application { public static void main(String[] args) { SpringApplication.run(Application.class, args); }} åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒApplication å°±åƒå…¶ä»–çš„ Spring Boot åº”ç”¨ä¸€æ ·é™¤äº† @Component æ³¨è§£ç±»ä¸ä¼šè¢«ç›‘æµ‹åˆ°ï¼Œç”¨æˆ·å®šä¹‰çš„ bean è¢«æ˜¾å¼çš„å¯¼å…¥ï¼ˆè§ @Importï¼‰ã€‚ 19. è¿è¡Œä½ çš„åº”ç”¨æ‰“åŒ…ä½ çš„åº”ç”¨ä½œä¸ºä¸€ä¸ª jar å’Œä½¿ç”¨å†…åµŒçš„ HTTP æœåŠ¡å™¨çš„ä¸€ä¸ªæœ€å¤§çš„ä¼˜åŠ¿æ˜¯ï¼šä½ å¯ä»¥åƒå…¶ä»–åº”ç”¨ç¨‹åºä¸€æ ·è¿è¡Œä½ çš„åº”ç”¨ã€‚Spring Boot çš„è°ƒè¯•ä¹ŸåŒæ ·ç®€å•ï¼Œä½ ä¸éœ€è¦ä»»ä½•ç‰¹å®šçš„ IDE æ’ä»¶æˆ–æ‹“å±•ç¨‹åºã€‚ è¿™ä¸ªç« èŠ‚\båªæ¶µç›–åŸºäºåŒ…çš„ jarï¼Œå¦‚æœä½ é€‰æ‹©æ‰“åŒ…ä½ çš„åº”ç”¨ä½œä¸ºä¸€ä¸ª war åŒ…æ–‡ä»¶ï¼Œä½ å¯ä»¥å‚è€ƒæœåŠ¡å™¨å’Œ IDE æ–‡æ¡£ã€‚ 19.1 ä» IDE è¿è¡Œä½ å¯ä»¥ä»ä½ çš„ IDE ä½œä¸ºä¸€ä¸ªç®€å•çš„ Java åº”ç”¨è¿è¡Œ Spring Bootã€‚ç„¶è€Œï¼Œä½ é¦–å…ˆéœ€è¦å¯¼å…¥ä½ çš„é¡¹ç›®ã€‚å¯¼å…¥çš„æ­¥éª¤çš„ä¸åŒï¼ˆvaryï¼‰ä¾èµ–äºï¼ˆdepending onï¼‰ä½ çš„ IDE å’Œæ„å»ºç³»ç»Ÿã€‚å¤§å¤šæ•°\b IDE å¯ä»¥ç›´æ¥å¯¼å…¥ maven é¡¹ç›®ã€‚ä¾‹å¦‚ï¼šEclipse ç”¨æˆ·å¯ä»¥é€‰æ‹© import -&gt; existing maven projects \bä»æ–‡ä»¶èœå•ã€‚ å¦‚æœä½ ä¸æƒ³ç›´æ¥å¯¼å…¥ä½ çš„é¡¹ç›®åˆ°ä½ çš„ IDEï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨æ„å»ºæ’ä»¶ç”Ÿæˆ IDE å…ƒæ•°æ®ã€‚Maven åŒ…å«äº† IDEA å’Œ Eclipse æ’ä»¶ã€‚gradle ä¸ºå„ç§ï¼ˆvariousï¼‰ ide æä¾›æ’ä»¶ã€‚ å¦‚æœä½ ä¸å°å¿ƒï¼ˆaccidentallyï¼‰è¿è¡Œäº†\bä½ çš„åº”ç”¨ç¨‹åºä¸¤æ¬¡ï¼Œ\bä½ å¯ä»¥æŸ¥çœ‹â€œç«¯å£å·²è¢«ä½¿ç”¨â€é”™è¯¯ã€‚STS ç”¨æˆ·å¯ä»¥ä½¿ç”¨ Relaunch æŒ‰é’®è€Œä¸æ˜¯ï¼ˆrather thanï¼‰Run æŒ‰é’®ä»¥ç¡®ä¿ï¼ˆensureï¼‰ä»»ä½•å­˜åœ¨çš„å®ä¾‹æ˜¯å…³é—­çš„ã€‚ 19.2 \bä½œä¸ºæ‰“åŒ…åº”ç”¨ç¨‹åºè¿è¡Œå¦‚æœä½ ä½¿ç”¨ Spring Boot Maven æˆ– Gradle æ’ä»¶\båˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œ jarï¼Œä½ å¯ä»¥è¿è¡Œä½ çš„åº”ç”¨ä½¿ç”¨ java -jarï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºï¼š 1java -jar target/myapplication-0.0.1-SNAPSHOT.jar è¿˜å¯ä»¥åœ¨å¯ç”¨è¿œç¨‹è°ƒè¯•æ”¯æŒçš„æƒ…å†µä¸‹è¿è¡Œæ‰“åŒ…åº”ç”¨ç¨‹åºã€‚è¿™æ ·\båšå¯ä»¥ä½¿ä½ ä¾é™„ä¸€ä¸ªè°ƒè¯•å™¨åˆ°ä½ çš„\båº”ç”¨ç¨‹åºï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºï¼š 12java -Xdebug -Xrunjdwp:server=y,transport=dt_socket,address=8000,suspend=n \\ -jar target/myapplication-0.0.1-SNAPSHOT.jar 19.3 ä½¿ç”¨ Maven æ’ä»¶Spring Boot Maven æ’ä»¶åŒ…å«ä¸€ä¸ª run ç›®æ ‡å¯ä»¥ä½¿ç”¨å®ƒ\bå¿«é€Ÿå¯åŠ¨ç¼–è¯‘å’Œè¿è¡Œä½ çš„åº”ç”¨ã€‚åº”ç”¨ç¨‹åºä»¥åˆ†è§£å½¢å¼ï¼ˆexplodedï¼‰è¿è¡Œï¼Œå¦‚åœ¨ä½ çš„ IDE ä¸€æ ·ã€‚ä»¥ä¸‹\bçš„ä¸€ä¸ªä¾‹å­å±•ç¤ºäº†ä¸€ä¸ª\b\bå…¸å‹çš„ maven å‘½ä»¤è¿è¡Œä½ çš„ spring boot åº”ç”¨ï¼š mvn spring-boot:run ä½ å¯èƒ½æƒ³è¦ä½¿ç”¨ MAVEN_OPTS æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š export MAVEN_OPTS=-Xmx1024m 19.4 ä½¿ç”¨ Gradle æ’ä»¶Spring Boot Gradle æ’ä»¶åŒæ ·\båŒ…å« bootRun ä»»åŠ¡å¯ä»¥è¢«ä½¿ç”¨æ¥\båˆ†è§£å¼çš„è¿è¡Œä½ çš„åº”ç”¨ã€‚æ¯å½“ä½ \båº”ç”¨ org.springframework.boot å’Œ java æ’ä»¶æ—¶éƒ½ä¼šæ·»åŠ  bootRunï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š gradle bootRun ä½ å¯èƒ½æƒ³è¦ä½¿ç”¨ JAVA_OPTS æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š export JAVA_OPTS=-Xmx1024m 19.5 çƒ­éƒ¨ç½²ç”±äº Spring Boot åº”ç”¨åªæ˜¯ä¸€ä¸ªæ™®é€šçš„ï¼ˆ\bplainï¼‰çš„ Java åº”ç”¨ï¼ŒJVM çƒ­éƒ¨ç½²å¯ä»¥å¼€ç®±å³ç”¨ï¼ˆwork out of the boxï¼‰ã€‚JVM çƒ­éƒ¨ç½²æœ‰ç‚¹å—é™äºï¼ˆ\bsomewhat limited withï¼‰å®ƒå¯ä»¥æ›¿æ¢çš„å­—èŠ‚ç ã€‚æ›´å¤šçš„ç¼–è¯‘è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥ä½¿ç”¨ JRebel spring-boot-devtools æ¨¡å—åŒæ ·åŒ…æ‹¬äº†\bæ”¯æŒåº”ç”¨å¿«é€Ÿé‡å¯ã€‚æŸ¥çœ‹\bæœ¬ç« èŠ‚\båé¢çš„ï¼ˆlater in this chapterï¼‰20 ç«  â€”â€” å¼€å‘\bå·¥å…· å’Œ \bå¦‚ä½•ä½¿ç”¨çƒ­éƒ¨ç½² \b\bè·å¾—æ›´å¤šç»†èŠ‚ã€‚ 20. å¼€å‘è€…å·¥å…·Spring Boot åŒ…å«äº†é¢å¤–çš„\bå·¥å…·é›†ï¼Œå¯ä»¥ä½¿ä½ çš„\båº”ç”¨å¼€å‘ä½“éªŒç¨å¾®æ„‰å¿«ï¼ˆpleasantï¼‰ä¸€ç‚¹ã€‚spring-boot-devtools æ¨¡å—å¯ä»¥è¢«æ·»åŠ åˆ°ä»»æ„é¡¹ç›®ä¸­\bä»¥æä¾›é¢å¤–çš„å¼€å‘æ—¶ç‰¹æ€§ã€‚è¦\båŒ…å«æµ‹è¯•å·¥å…·æ”¯æŒï¼Œæ·»åŠ æ¨¡å—ä¾èµ–åˆ°ä½ çš„\bæ„å»ºä¸­ï¼Œå¦‚ä¸‹å±•ç¤ºäº† Maven å’Œ Gradle çš„\bæ¸…å•ï¼š Mavenï¼š1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt;&lt;/dependencies&gt; Gradle:123456789configurations { developmentOnly runtimeClasspath { extendsFrom developmentOnly }}dependencies { developmentOnly(\"org.springframework.boot:spring-boot-devtools\")} å¼€å‘è€…å·¥å…·åœ¨ä½ è¿è¡Œå®Œæ•´æ‰“åŒ…çš„åº”ç”¨æ—¶è‡ªåŠ¨ç¦ç”¨ã€‚å¦‚æœä½ çš„ç±»ä» java -jar å¯åŠ¨ï¼Œæˆ–è€…å¦‚æœä½ \bä»ç‰¹å®šçš„ç±»åŠ è½½å™¨å¼€å§‹ï¼Œé‚£ä¹ˆè®¤ä¸ºï¼ˆconsideredï¼‰å®ƒæ˜¯ä¸€ä¸ªç”Ÿäº§åº”ç”¨ã€‚\bå¦‚æœä¸æ˜¯è¿™ç§æƒ…å†µï¼ˆå¦‚æœä½ çš„åº”ç”¨æ˜¯ä»å®¹å™¨è¿è¡Œï¼‰ï¼Œè®¤ä¸ºæ’é™¤äº†å¼€å‘è€…å·¥å…·æˆ–è€…è®¾ç½®äº†ç³»ç»Ÿå±æ€§ï¼š-Dspring.devtools.restart.enabled=false åœ¨Mavenä¸­å°†ä¾èµ–é¡¹æ ‡è®°ä¸ºå¯é€‰çš„ï¼Œæˆ–è€…åœ¨Gradleä¸­ä½¿ç”¨å®šåˆ¶çš„â€œåªå¼€å‘â€é…ç½®(å¦‚ä¸Šé¢æ‰€ç¤º)æ˜¯é˜²æ­¢DevToolsè¢«ä¸´æ—¶åº”ç”¨åˆ°ä½¿ç”¨æ‚¨çš„é¡¹ç›®çš„å…¶ä»–æ¨¡å—çš„æœ€ä½³å®è·µã€‚ é»˜è®¤æƒ…å†µä¸‹é‡æ–°æ‰“åŒ…ä¸ä¼šåŒ…å«å¼€å‘è€…å·¥å…·ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨æŸäº›è¿œç¨‹å¼€å‘ç‰¹æ€§ï¼Œä½ éœ€è¦ç¦ç”¨ excludeDevtools å±æ€§ä»¥åŒ…å«å®ƒã€‚è¿™ä¸ªå±æ€§åŒæ—¶æ”¯æŒ Maven å’Œ Gradle æ’ä»¶ã€‚ 20.1 é»˜è®¤å±æ€§ä¸€äº›ç±»åº“é€šè¿‡æ”¯æŒä½¿ç”¨ Spring Boot ä½¿ç”¨ç¼“å­˜æ¥æé«˜æ€§èƒ½ï¼ˆimprove performanceï¼‰ï¼Œä¾‹å¦‚ï¼šæ¨¡ç‰ˆå¼•æ“ç¼“å­˜ç¼–è¯‘çš„æ¨¡ç‰ˆä»¥é¿å…ï¼ˆavoidï¼‰é‡å¤ï¼ˆrepeatedlyï¼‰è§£ææ¨¡ç‰ˆæ–‡ä»¶ã€‚åŒæ ·ï¼Œå½“æœåŠ¡é™æ€èµ„æºæ—¶ Spring MVC å¯ä»¥æ·»åŠ  HTTP ç¼“å­˜å¤´åˆ°å“åº”ä¿¡æ¯ä¸­ã€‚ ç¼“å­˜åœ¨ç”Ÿäº§ä¸­æ˜¯éå¸¸æœ‰ç›Šçš„ï¼ˆbeneficialï¼‰ï¼Œç„¶è€Œå®ƒåœ¨å¼€å‘ç¯å¢ƒåˆ™ä¼šé€‚å¾—å…¶åï¼ˆcounter-productiveï¼‰ï¼Œé˜»æ­¢ï¼ˆpreventingï¼‰ä½ çœ‹åˆ°ä½ åˆšåˆšåœ¨åº”ç”¨ç¨‹åºä¸­äº§ç”Ÿçš„æ›´æ”¹ã€‚ç”±äºè¿™ä¸ªåŸå› ï¼Œspring-boot-devtools é»˜è®¤ç¦ç”¨ç¼“å­˜é€‰é¡¹ã€‚ ç¼“å­˜é€‰é¡¹é€šå¸¸åœ¨ä½ çš„ application.properties æ–‡ä»¶é‡Œé¢è®¾ç½®ã€‚ä¾‹å¦‚ï¼šThymeleaf æä¾›äº† spring.thymeleaf.cache å±æ€§ï¼Œè€Œä¸ç”¨æ‰‹åŠ¨è®¾ç½®è¿™äº›å±æ€§ï¼Œspring-boot-devtools æ¨¡å—è‡ªåŠ¨åˆç†åº”ç”¨å¼€å‘æ—¶é…ç½®ã€‚ å› ä¸ºä½ éœ€è¦æ›´å¤šä¿¡æ¯å…³äº web è¯·æ±‚çš„ä¿¡æ¯åœ¨å¼€å‘ spring mvc å’Œ spring WebFlux åº”ç”¨æ—¶ï¼Œå¼€å‘è€…å·¥å…·å°†ä¼šä¸º web æ—¥å¿—è®°å½•å¼€å¯ debug çš„æ—¥å¿—è®°å½•ã€‚è¿™å°†ä¼šç»™ä½ è¿›æ¥çš„è¯·æ±‚çš„ä¿¡æ¯ï¼Œå¤„ç†ä¸­ç¨‹åºï¼Œè¿”å›ç»“æœç­‰ã€‚å¦‚æœä½ å¸Œæœ›è®°å½•æ‰€æœ‰è¯·æ±‚çš„ç»†èŠ‚ï¼ˆå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼‰ï¼Œä½ å¯ä»¥æ‰“å¼€ spring-http.log-request-detail é…ç½®å±æ€§ã€‚ å¦‚æœä½ ä¸æƒ³åº”ç”¨è¯¥é»˜è®¤å±æ€§ä½ å¯ä»¥åœ¨ä½ çš„ application.properties ä¸­è®¾ç½® spring-http.log-request-detail ä¸º falseã€‚ åº”ç”¨äº devtools çš„æ‰€æœ‰çš„å±æ€§åˆ—è¡¨ï¼ŒæŸ¥çœ‹ DevToolsPropertyDefaultsPostProcessor. 20.2 è‡ªåŠ¨é‡å¯ä½¿ç”¨ spring-boot-devtools çš„åº”ç”¨ä¼šè‡ªåŠ¨é‡å¯ï¼Œæ¯å½“ç±»è·¯å¾„ä¸‹çš„æ–‡ä»¶æ”¹å˜ã€‚åœ¨ IDE å·¥ä½œæ—¶ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ç‰¹æ€§ï¼Œå› ä¸ºå®ƒä¸ºä»£ç æ”¹å˜æä¾›ç±»å¿«é€Ÿçš„åé¦ˆå¾ªç¯ã€‚ä½œä¸ºé»˜è®¤ï¼ŒæŒ‡å‘ï¼ˆpoint toï¼‰ç±»è·¯å¾„ä¸‹çš„æ‰€æœ‰æ¡ç›®éƒ½ä¼šè¢«ç›‘è§†ä¸ºäº†æ›´æ”¹ã€‚æ³¨æ„æŸäº›èµ„æºå¦‚ï¼šé™æ€èµ„æºå’Œè§†å›¾æ¨¡ç‰ˆï¼Œä¸éœ€è¦é‡æ–°å¯åŠ¨åº”ç”¨ã€‚ è§¦å‘é‡å¯å½“ DevTools ç›‘è§†ç±»è·¯å¾„ä¸‹çš„èµ„æºï¼Œè§¦å‘é‡å¯çš„å”¯ä¸€æ–¹å¼æ˜¯æ›´æ–°å…¶ç±»è·¯å¾„ã€‚å¯¼è‡´ï¼ˆcauseï¼‰ç±»è·¯å¾„æ›´æ–°çš„æ–¹å¼ä¾èµ–äºä½ ä½¿ç”¨çš„ IDEã€‚åœ¨ Eclipse ä¸­ï¼Œä¿å­˜å’Œä¿®æ”¹æ–‡ä»¶å¯¼è‡´ç±»è·¯å¾„æ›´æ–°å’Œå‡ºå‘é‡å¯ã€‚åœ¨ IDEAï¼Œç¼–è¯‘é¡¹ç›®æœ‰åŒæ ·çš„æ•ˆæœã€‚ åªè¦æ­¤åˆ†å‰è¢«æ‰“å¼€ï¼Œä½ å¯ä»¥åŒæ ·å¯åŠ¨ä½ çš„åº”ç”¨é€šè¿‡ä½¿ç”¨æ”¯æŒçš„æ„å»ºæ’ä»¶ï¼Œå› ä¸º DevTools éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„åº”ç”¨ç¨‹åºåŠ è½½å™¨æ¥æ­£ç¡®æ“ä½œã€‚ä½œä¸ºé»˜è®¤ï¼ŒGradle å’Œ Maven åœ¨ç±»è·¯å¾„ä¸Šæ£€æµ‹åˆ° DevTools æ—¶ä¼šè¿™æ ·åšã€‚ ä¸ LiveReload å·¥ä½œæ—¶è‡ªåŠ¨é‡å¯å·¥ä½œè‰¯å¥½ï¼ŒæŸ¥çœ‹ LiveReload ç« èŠ‚è·å¾—æ›´å¤šç»†èŠ‚ã€‚å¦‚æœä½ ä½¿ç”¨ JRebleï¼Œè‡ªåŠ¨é‡å¯ä¼šç¦ç”¨ï¼Œæœ‰åˆ©äºï¼ˆin favor ofï¼‰ç±»çš„åŠ¨æ€åŠ è½½ã€‚å…¶ä»– devtools çš„ç‰¹æ€§å¦‚ï¼šLiveReload å’Œ å±æ€§è¦†ç›–å¯ä»¥ä¸€ç›´ä½¿ç”¨ã€‚ DevTools ä¾èµ–äºåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„ shutdown é’©å­æ¥åœ¨é‡å¯æœŸé—´å…³é—­å®ƒã€‚ å¦‚æœç¦ç”¨äº† shutdown æŒ‚é’©ï¼Œåˆ™æ— æ³•æ­£å¸¸å·¥ä½œã€‚ å½“å†³å®šåœ¨ç±»è·¯å¾„ä¸Šçš„æ¡ç›®æ˜¯å¦åº”è¯¥åœ¨æ›´æ”¹æ—¶è§¦å‘é‡æ–°å¯åŠ¨æ—¶ï¼ŒDevztools è‡ªåŠ¨å¿½ç•¥åä¸º spring-boot, spring-boot-devtools, spring-boot-autoconfigure, spring-boot-actuator, spring-boot-starter çš„é¡¹ç›®ã€‚ DevTools éœ€è¦é€šè¿‡ ApplicationContext æ¥å®šåˆ¶ ResourceLoaderã€‚å¦‚æœæ‚¨çš„åº”ç”¨å·²ç»æä¾›æ¥ä¸€ä¸ªï¼Œå®ƒå°†è¢«åŒ…è£¹èµ·æ¥ã€‚ä¸æ”¯æŒç›´æ¥è¦†ç›– ApplicationContext ä¸Šçš„ getResource æ–¹æ³•ã€‚ é‡å¯å’Œé‡æ–°åŠ è½½Spring Boot ç¨‹åºæä¾›çš„é‡æ–°å¯åŠ¨æŠ€æœ¯ä½¿ç”¨äº†ä¸¤ä¸ªç±»åŠ è½½å™¨ã€‚ä¸ä¼šæ”¹å˜çš„ç±»ï¼ˆä¾‹å¦‚ï¼šç¬¬ä¸‰æ–¹jarï¼‰è¢«åŠ è½½åˆ°ï¼ˆloaded intoï¼‰åŸºç±»åŠ è½½å™¨ä¸­ã€‚ä½ æ­£åœ¨ç§¯æå¼€å‘çš„ç±»è¢«åŠ è½½åˆ°é‡å¯ç±»åŠ è½½å™¨ã€‚å½“åº”ç”¨ç¨‹åºé‡å¯ï¼Œè¯¥é‡å¯ç±»åŠ è½½å™¨ä¼šè¢«ä¸¢æ‰ï¼ˆthrown awayï¼‰å¹¶é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„ã€‚è¿™ç§æ–¹æ³•æ„å‘³ç€åº”ç”¨ç¨‹åºé‡å¯é€šå¸¸æ¯”â€œå†·å¯åŠ¨â€å¿«å¾—å¤šï¼Œå› ä¸ºåŸºç±»è£…å…¥å™¨å·²ç»å¯ç”¨å¹¶å·²å¡«å……ã€‚ å¦‚æœå‘ç°é‡æ–°å¯åŠ¨å¯¹åº”ç”¨ç¨‹åºæ¥è¯´ä¸å¤Ÿå¿«ï¼Œæˆ–è€…é‡åˆ°ç±»åŠ è½½é—®é¢˜ã€‚ä½ å¯ä»¥è€ƒè™‘é‡æ–°é€‰æ‹©æŠ€æœ¯å¦‚\bä» ZeroTurnaround è·å¾— JRebleã€‚è¿™äº›å·¥ä½œæ˜¯é€šè¿‡åœ¨åŠ è½½ç±»æ—¶é‡å†™ç±»æ¥å®Œæˆçš„ï¼Œä»¥ä½¿å®ƒä»¬æ›´æ˜“äºé‡æ–°åŠ è½½ã€‚ 20.2.1. åœ¨çŠ¶æ€è¯„ä¼°ï¼ˆcondition evaluationï¼‰ä¸­è®°å½•\bå˜åŒ–ä½œä¸ºé»˜è®¤ï¼Œæ¯å½“ä½ çš„åº”ç”¨é‡å¯ï¼Œå°†è®°å½•æ˜¾ç¤ºçŠ¶æ€è¯„ä¼°å¢é‡çš„æŠ¥è¡¨ã€‚è¯¥æŠ¥å‘Šå±•ç¤ºäº†ä½ çš„åº”ç”¨çš„\bè‡ªåŠ¨é…ç½®çš„æ”¹å˜å¦‚å¢åŠ æˆ–åˆ é™¤beanï¼Œè®¾ç½®é…ç½®å±æ€§ã€‚ è¦ç¦ç”¨æ—¥å¿—è®°å½•æŠ¥å‘Šï¼Œè®¾ç½®ä»¥ä¸‹å±æ€§ï¼š spring.devtools.restart.log-condition-evaluation-delta=false 20.2.2. æ’é™¤èµ„æºæŸäº›èµ„æº\bå½“ä»–ä»¬æ”¹å˜æ—¶æ²¡æœ‰å¿…è¦è§¦å‘é‡å¯ã€‚å¦‚ï¼šThymeleaf æ¨¡ç‰ˆå¯ä»¥å°±åœ°ï¼ˆin-placeï¼‰ç¼–è¾‘ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ”¹å˜ /META-INF/maven, /META-INF/resources, /resources, /static, /public, or /templates ä¸­çš„èµ„æºä¸ä¼šè§¦å‘é‡å¯ä½†ä¼šè§¦å‘ live reloadã€‚ å¦‚æœä½ æƒ³å®šåˆ¶è¿™äº›æ’é™¤é¡¹ï¼Œä½ å¯ä»¥ä½¿ç”¨ spring.devtools.restart.exclude å±æ€§ã€‚å¦‚ï¼šè¦ä»…ä»…æ’é™¤ /static å’Œ /public ä½ éœ€è¦è®¾ç½®ä»¥ä¸‹å‘½ä»¤ï¼š spring.devtools.restart.exclude=static/**,public/** å¦‚æœä½ è¦ä¿æŒé»˜è®¤å€¼å¹¶æ·»åŠ é¢å¤–çš„æ’é™¤é¡¹ï¼Œä½¿ç”¨ spring.devtools.restart.additional-exclude ä½œä¸ºæ›¿æ¢ã€‚ 20.2.3. ç›‘è§†é¢å¤–çš„è·¯å¾„ä½ å¯èƒ½æƒ³è¦ä½ çš„åº”ç”¨ç¨‹åºé‡å¯æˆ–é‡åŠ è½½å½“ä½ \bä¸åœ¨ç±»è·¯å¾„ä¸‹æ”¹å˜æ–‡ä»¶ã€‚è¦è¿™æ ·åšï¼Œä½¿ç”¨ spring.devtools.restart.additional-paths å±æ€§é…ç½®é¢å¤–çš„è·¯å¾„å¹¶ç›‘è§†ã€‚å‰é¢æè¿°çš„æ˜¯æ§åˆ¶åœ¨é¢å¤–è·¯å¾„ä¸‹çš„æ›´æ”¹æ˜¯å¦ä¼šè§¦å‘å®Œå…¨é‡æ–°å¯åŠ¨æˆ–é‡æ–°åŠ è½½ã€‚ 20.2.4. ç¦ç”¨é‡å¯å¦‚æœä½ ä¸æƒ³ä½¿ç”¨é‡å¯ç‰¹æ€§ï¼Œä½ å¯ä»¥é€šè¿‡ spring.devtools.restart.enabled å±æ€§ç¦ç”¨å®ƒã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åœ¨ä½ çš„ application.properties è®¾ç½®è¿™ä¸ªå±æ€§ã€‚ï¼ˆè¿™æ ·åšä»ç„¶åˆå§‹åŒ–æ—¶é‡å¯ç±»åŠ è½½å™¨ï¼Œä½†æ˜¯ä»–ä¸ä¼šç›‘è§†æ–‡ä»¶æ›´æ”¹ï¼‰ å¦‚æœä½ æƒ³è¦å®Œå…¨ç¦ç”¨é‡å¯æ”¯æŒï¼ˆä¾‹å¦‚ï¼šä»–åœ¨ç‰¹å®šçš„ç±»åº“ä¸­ä¸èƒ½å·¥ä½œï¼‰ï¼Œä½ éœ€è¦åœ¨è°ƒç”¨ SpringApplication.run(â€¦â€‹), ä¹‹å‰è®¾ç½® spring.devtools.restart.enabled ç³»ç»Ÿå±æ€§ä¸º falseï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234public static void main(String[] args) { System.setProperty(\"spring.devtools.restart.enabled\", \"false\"); SpringApplication.run(MyApp.class, args);} 20.2.5. ä½¿ç”¨è§¦å‘æ–‡ä»¶å¦‚æœä½ å·¥ä½œçš„\b IDE ä¸æ–­çš„ï¼ˆcontinuousltï¼‰ç¼–è¯‘æ”¹å˜æ–‡ä»¶ï¼Œä½ å¯èƒ½å¸Œæœ›ä»…åœ¨ç‰¹å®šæ—¶é—´å†…è§¦å‘é‡å¯ã€‚è¦è¿™æ ·åšï¼Œä½ å¯ä»¥ä½¿ç”¨â€œè§¦å‘æ–‡ä»¶â€ï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå½“æ‚¨æƒ³è¦å®é™…è§¦å‘é‡æ–°å¯åŠ¨æ£€æŸ¥æ—¶ï¼Œå¿…é¡»ä¿®æ”¹è¯¥æ–‡ä»¶ã€‚æ›´æ”¹æ–‡ä»¶åªä¼šè§¦å‘æ£€æŸ¥ï¼Œåªæœ‰åœ¨ Devtools æ£€æµ‹åˆ°å¿…é¡»æ‰§è¡ŒæŸäº›æ“ä½œæ—¶æ‰ä¼šé‡æ–°å¯åŠ¨ã€‚ ä½¿ç”¨è§¦å‘æ–‡ä»¶ï¼Œè®¾ç½® spring.devtools.restart.trigger-file å±æ€§ä¸ºè§¦å‘æ–‡ä»¶çš„è·¯å¾„ã€‚ ä½ å¯èƒ½æƒ³è¦è®¾ç½® spring.devtools.restart.trigger-file ä½œä¸ºä¸€ä¸ªå…¨å±€è®¾ç½®ï¼Œè¿™æ ·æ‰€æœ‰çš„é¡¹ç›®éƒ½ä»¥åŒæ ·çš„æ–¹å¼è¿ä½œã€‚ 20.2.6. å®šåˆ¶é‡å¯ç±»åŠ è½½å™¨å¦‚åœ¨å‰é¢çš„â€œé‡å¯å’Œé‡åŠ è½½â€ç« èŠ‚æ‰€\bè¿°ï¼Œé‡å¯åŠŸèƒ½æ˜¯ä½¿ç”¨ä¸¤ä¸ª\bç±»åŠ è½½å™¨å®ç°çš„ã€‚å¯¹äºæ›´å¤šçš„åº”ç”¨ï¼Œè¿™ç§æ–¹æ³•ï¼ˆapproackï¼‰å·¥ä½œè‰¯å¥½ã€‚ç„¶è€Œï¼Œå®ƒæœ‰æ—¶ä¼šå¯¼è‡´ä¸€äº›ç±»åŠ è½½é—®é¢˜ã€‚ \bä½œä¸ºé»˜è®¤ï¼Œä½ \bçš„ IDE ä¸­ä»»ä½•æ‰“å¼€çš„é¡¹ç›®éƒ½\båŠ è½½ç±»â€œé‡å¯â€ç±»åŠ è½½å™¨ï¼Œä»»ä½•æ™®é€šçš„ï¼ˆregularï¼‰çš„ jar æ–‡ä»¶éƒ½å¸¦æœ‰â€œåŸºç¡€â€ç±»åŠ è½½å™¨ã€‚å¦‚æœä½ åœ¨\bå¤šæ¨¡å—é¡¹ç›®ä¸­å·¥ä½œï¼Œå¹¶ä¸”ä¸æ˜¯\bæ¯ä¸ªé¡¹ç›®éƒ½å¯¼å…¥åˆ°äº† IDEï¼Œä½ å¯èƒ½éœ€è¦å®šåˆ¶ä¸€äº›ä¸œè¥¿ã€‚è¦è¿™æ ·åšçš„è¯ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª META-INF/spring-devtools.properties æ–‡ä»¶ã€‚ è¯¥ spring-devtools.properties æ–‡ä»¶å¯ä»¥åŒ…å«æœ‰ restart.exclude å’Œ restart.include å‰ç¼€çš„å±æ€§ã€‚include å…ƒç´ ä¸‹çš„é¡¹éƒ½ä¼šè¢«æ‹‰å–ï¼ˆpulled upï¼‰åˆ° â€œé‡å¯â€ ç±»åŠ è½½å™¨ï¼Œexclude å…ƒç´ ä¸‹çš„é¡¹éƒ½è¢«æ¨è¿›åˆ°ï¼ˆpushed downï¼‰\bâ€œåŸºç¡€â€ç±»åŠ è½½å™¨ã€‚è¯¥å±æ€§å€¼æ˜¯åº”ç”¨åœ¨ç±»è·¯å¾„ä¸‹çš„æ­£åˆ™æ¨¡å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12restart.exclude.companycommonlibs=/mycorp-common-[\\\\w\\\\d-\\.]+\\.jarrestart.include.projectcommon=/mycorp-myproj-[\\\\w\\\\d-\\.]+\\.jar æ‰€æœ‰çš„å±æ€§å…³é”®å­—éƒ½æ˜¯å¿…é¡»çš„ã€‚åªè¦ï¼ˆas long asï¼‰å±æ€§ä»¥ restart.include æˆ– resatrt.exclude å¼€å¤´éƒ½è¢«è€ƒè™‘è¿›å»ã€‚ åŠ è½½ç±»è·¯å¾„ä¸­çš„æ‰€æœ‰ META-INF/Spring-devtools.propertiesã€‚æ‚¨å¯ä»¥åœ¨é¡¹ç›®ä¸­æˆ–é¡¹ç›®æ‰€æ¶ˆè€—çš„åº“ä¸­æ‰“åŒ…æ–‡ä»¶ã€‚ 20.2.7. å·²çŸ¥é™åˆ¶é‡å¯åŠŸèƒ½ï¼ˆfunctionalityï¼‰ä¸é€‚ç”¨ä½¿ç”¨æ ‡å‡† ObjectInputStream ååºåˆ—åŒ–çš„å¯¹è±¡ã€‚å¦‚æœä½ éœ€è¦ååºåˆ—åŒ–å¯¹è±¡ï¼Œä½ å¯èƒ½éœ€è¦\bä½¿ç”¨ Spring çš„ ConfigurableObjectInputStream ç»“åˆäºï¼ˆ\bin combination withï¼‰Thread.currentThread().getContextClassLoader()ã€‚\bä¸å¹¸çš„æ˜¯ï¼ˆUnfortunatelyï¼‰ï¼Œä¸€äº›ç¬¬ä¸‰æ–¹ç±»åº“åœ¨ä¸è€ƒè™‘ç±»åŠ è½½å™¨\bä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹ååºåˆ—åŒ–ã€‚å¦‚æœä½ å‘ç°ä¸€äº›é—®é¢˜ï¼Œä½ éœ€è¦è¯·æ±‚åŸä½œè€…è§£å†³ã€‚ 20.3 çƒ­åŠ è½½Spring Boot Devtools æ¨¡å—åŒ…æ‹¬ä¸€ä¸ªå†…åµŒçš„ LiverLoad æœåŠ¡å™¨ï¼Œå½“èµ„æºè¢«æ”¹å˜æ—¶ï¼Œå®ƒå¯ä»¥ç”¨æ¥è§¦å‘æµè§ˆå™¨åˆ·æ–°ã€‚livereload.com å…è´¹æä¾› LiveReload æµè§ˆå™¨æ’ä»¶\b Chromeã€Firefoxï¼ŒSafariç‰ˆã€‚ å¦‚æœä½ æƒ³å½“ä½ çš„åº”ç”¨å¯åŠ¨æ—¶å¯åŠ¨ LiveReloadï¼Œä½ å¯ä»¥è®¾ç½® spring.devtools.livereload.enabled å±æ€§ä¸º falseã€‚ ä¸€æ¬¡ï¼ˆat \ba timeï¼‰åªèƒ½è¿è¡Œä¸€ä¸ªLiveReloadæœåŠ¡å™¨ã€‚åœ¨ä½ çš„åº”ç”¨å¯åŠ¨ä¹‹å‰ï¼Œç¡®ä¿æ²¡æœ‰å…¶ä»–çš„ LiveReload æœåŠ¡å™¨åœ¨è¿è¡Œã€‚å¦‚æœ\bä½ ä»ä½ çš„ IDE å¯åŠ¨äº†å¤šä¸ªåº”ç”¨ç¨‹åºï¼Œåªæœ‰ç¬¬ä¸€ä¸ª LiveReload ä¼šæä¾›æ”¯æŒã€‚ 20.4 å…¨å±€è®¾ç½®\bä½ å¯ä»¥é€šè¿‡åœ¨ä½ çš„ $HOME æ–‡ä»¶å¤¹ä¸‹æ·»åŠ ä¸€ä¸ªåä¸º .spring-boot-devtools.properties çš„æ–‡ä»¶æ¥é…ç½®å¼€å‘å·¥å…·çš„å…¨å±€è®¾ç½®ï¼ˆæ³¨æ„æ–‡ä»¶åä» . å¼€å§‹ï¼‰ã€‚\bæ·»åŠ åˆ°è¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰å±æ€§ä¼šåº”ç”¨åˆ°æ‰€æœ‰çš„ Spring Boot åº”ç”¨ç¨‹åºï¼Œåœ¨ä½ çš„æœºå™¨ä¸Šä½¿ç”¨å¼€å‘å·¥å…·ã€‚å¦‚ï¼šè¦é…ç½®æ°¸è¿œä½¿ç”¨ è§¦å‘æ–‡ä»¶ é‡å¯ï¼Œä½ éœ€è¦æ·»åŠ ä»¥ä¸‹å±æ€§ï¼š ~/.spring-boot-devtools.properties. spring.devtools.reload.trigger-file=.reloadtrigger åœ¨.spring-boot-devtools.propertiesä¸­æ¿€æ´»çš„é…ç½®æ–‡ä»¶ä¸ä¼šå½±å“ï¼ˆaffectï¼‰ç‰¹å®šäºé…ç½®æ–‡ä»¶çš„åŠ è½½ã€‚ 20.5 è¿œç¨‹åº”ç”¨Spring Boot å¼€å‘è€…å·¥å…·æ²¡æœ‰é™åˆ¶äºæœ¬åœ°å¼€å‘ï¼Œä½ åŒæ ·å¯ä»¥åœ¨\bè¿è¡Œçš„è¿œç¨‹åº”ç”¨ä¸Šä½¿ç”¨ä¸€äº›ç‰¹æ€§åŠŸèƒ½ã€‚è¿œç¨‹æ”¯æŒæ˜¯å¯é€‰çš„ï¼Œè¦å¼€å¯å®ƒï¼Œä½ éœ€è¦ç¡®ä¿ devtools \båŒ…å«åœ¨é‡æ–°æ‰“åŒ…åçš„å½’æ¡£æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹åˆ—è¡¨æ‰€ç¤ºï¼š 1234567891011&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;excludeDevtools&gt;false&lt;/excludeDevtools&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; å¦‚æœä½ éœ€è¦è®¾ç½® spring.devtools.remote.secret å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š spring.devtools.remote.secret=mysecret åœ¨è¿œç¨‹åº”ç”¨å¼€å¯ spring-boot-devtools æ˜¯æœ‰å®‰å…¨é£é™©çš„ï¼ˆriskï¼‰ã€‚ä½ åº”è¯¥æ°¸è¿œéƒ½ä¸å¼€å¯\bå¯¹ç”Ÿäº§ç¯å¢ƒçš„æ”¯æŒã€‚ è¿œç¨‹å¼€å‘å·¥å…·æä¾›ä»¥ä¸‹ä¸¤ä¸ªå•å…ƒçš„æ”¯æŒï¼šä¸€ä¸ªæœåŠ¡å™¨æ–­ç‚¹ï¼Œæ¥å—åœ¨ä½ çš„ IDE ä¸­è¿è¡Œçš„åº”ç”¨å’Œè¿æ¥ã€‚å½“ spring.devtools.remote.secret å±æ€§è¢«è®¾ç½®äº†\bè¯¥æœåŠ¡ç»„ä»¶ä¼šè‡ªåŠ¨å¼€å¯ã€‚å®¢æˆ·ç«¯ç»„ä»¶å¿…é¡»æ‰‹åŠ¨è¿è¡Œã€‚ 20.5.1 è¿è¡Œè¿œç¨‹åº”ç”¨å®¢æˆ·ç«¯è¯¥è¿œç¨‹å®¢æˆ·ç«¯åº”ç”¨è¢«è®¾è®¡ä¸ºåœ¨ä½ çš„ IDE ä¸­è¿è¡Œã€‚ä½ éœ€è¦è¿è¡Œ org.springframework.boot.devtools.RemoteSpringApplication ä½¿ç”¨å’Œä½ è¿æ¥çš„è¿œç¨‹ä¸ªé¡¹ç›®ç›¸åŒçš„ç±»è·¯å¾„ã€‚è¯¥åº”ç”¨ç¨‹åºæ‰€éœ€çš„å”¯ä¸€å‚æ•°æ˜¯éœ€è¦è¿æ¥åˆ°çš„è¿œç¨‹æœåŠ¡å™¨çš„ URLã€‚ å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨ Eclipse æˆ– STSï¼Œå¹¶ä¸”ä½ æœ‰ä¸€ä¸ªåä¸º my-app çš„é¡¹ç›®è¢«\béƒ¨ç½²åˆ°äº†äº‘æœåŠ¡å™¨ï¼Œä½ å¯\bè¿™æ ·åšï¼š ä» Run èœå•æ„å»º Run Configurationsâ€¦ åˆ›å»ºä¸€ä¸ªæ–°çš„ Java Application\b å¯åŠ¨é…ç½® æµè§ˆ my-app åº”ç”¨ ä½¿ç”¨ org.springframework.boot.devtools.RemoteSpringApplication ä½œä¸ºä¸»ç±» æ·»åŠ  https://myapp.cfapps.io åˆ° ç¨‹åºå‚æ•°ã€‚ï¼ˆæˆ–è€…ä¸ç®¡æ‚¨çš„è¿œç¨‹URLæ˜¯ä»€ä¹ˆï¼‰ æ­£åœ¨è¿è¡Œçš„è¿œç¨‹å®¢æˆ·ç«¯å¯èƒ½ç±»ä¼¼äºä¸‹åˆ—åˆ—è¡¨ï¼š . ____ _ __ _ _ /\\\\ / ___&apos;_ __ _ _(_)_ __ __ _ ___ _ \\ \\ \\ \\ ( ( )\\___ | &apos;_ | &apos;_| | &apos;_ \\/ _` | | _ \\___ _ __ ___| |_ ___ \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| []::::::[] / -_) &apos; \\/ _ \\ _/ -_) ) ) ) ) &apos; |____| .__|_| |_|_| |_\\__, | |_|_\\___|_|_|_\\___/\\__\\___|/ / / / =========|_|==============|___/===================================/_/_/_/ :: Spring Boot Remote :: 2.1.6.RELEASE 2015-06-10 18:25:06.632 INFO 14938 --- [ main] o.s.b.devtools.RemoteSpringApplication : Starting RemoteSpringApplication on pwmbp with PID 14938 (/Users/pwebb/projects/spring-boot/code/spring-boot-devtools/target/classes started by pwebb in /Users/pwebb/projects/spring-boot/code/spring-boot-samples/spring-boot-sample-devtools) 2015-06-10 18:25:06.671 INFO 14938 --- [ main] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@2a17b7b6: startup date [Wed Jun 10 18:25:06 PDT 2015]; root of context hierarchy 2015-06-10 18:25:07.043 WARN 14938 --- [ main] o.s.b.d.r.c.RemoteClientConfiguration : The connection to http://localhost:8080 is insecure. You should use a URL starting with &apos;https://&apos;. 2015-06-10 18:25:07.074 INFO 14938 --- [ main] o.s.b.d.a.OptionalLiveReloadServer : LiveReload server is running on port 35729 2015-06-10 18:25:07.130 INFO 14938 --- [ main] o.s.b.devtools.RemoteSpringApplication : Started RemoteSpringApplication in 0.74 seconds (JVM running for 1.105) å› ä¸ºè¿œç¨‹å®¢æˆ·ç«¯ä½¿ç”¨ä¸å®é™…åº”ç”¨ç¨‹åºç›¸åŒçš„ç±»è·¯å¾„ï¼Œ\bæ‰€ä»¥å®ƒå¯ä»¥ç›´æ¥çš„è¯»å–ä½ çš„åº”ç”¨é…ç½® ã€‚è¿™æ˜¯Spring.devtools.remote.secretå±æ€§çš„è¯»å–å’Œä¼ é€’åˆ°æœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯çš„æ–¹å¼ã€‚ æ€»æ˜¯å»ºè®®ä½¿ç”¨ https:// ä½œä¸ºè¿æ¥åè®®ï¼Œå› æ­¤ï¼Œé€šä¿¡æ˜¯åŠ å¯†çš„ï¼ˆtraffic is encryptedï¼‰ï¼Œå¯†ç ä¸èƒ½è¢«æˆªè·ï¼ˆinterceptedï¼‰ã€‚ å¦‚æœä½ ä½¿ç”¨\bä»£ç†\bè®¿é—®è¿œç¨‹åº”ç”¨ï¼Œé…ç½® spring.devtools.remote.proxy.host å’Œ spring.devtools.remote.proxy.port å±æ€§ã€‚ 20.5.2 è¿œç¨‹æ›´æ–°è¿œç¨‹å®¢æˆ·ç«¯ä»¥ä¸æœ¬åœ°é‡æ–°å¯åŠ¨ç›¸åŒçš„æ–¹å¼ç›‘è§†åº”ç”¨ç¨‹åºç±»è·¯å¾„ä»¥è¿›è¡Œæ›´æ”¹ã€‚ä»»ä½•æ›´æ–°çš„èµ„æºè¢«æ¨åˆ°è¿œç¨‹åº”ç”¨ç¨‹åºï¼Œï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰è§¦å‘é‡æ–°å¯åŠ¨ã€‚å¦‚æœä½ éœ€è¦è¿­ä»£æœ¬åœ°æ²¡æœ‰çš„äº‘æœåŠ¡åŠŸèƒ½ï¼Œè¿™æ ·ååˆ†æœ‰ç”¨ã€‚è¿œç¨‹æ›´æ–°å’Œé‡æ–°å¯åŠ¨è¦æ¯”å®Œæ•´çš„ï¼ˆfullï¼‰é‡å»ºå’Œéƒ¨ç½²å‘¨æœŸå¿«å¾—å¤šï¼ˆquicker thanï¼‰ã€‚ åªæœ‰å½“\bè¿œç¨‹å®¢æˆ·ç«¯åœ¨è¿è¡Œæ—¶æ‰ä¼šç›‘è§†æ–‡ä»¶ï¼Œå¦‚æœä½ åœ¨è¿œç¨‹å®¢æˆ·ç«¯å…¶ä¸­ä¹‹å‰æ”¹å˜æ–‡ä»¶ï¼Œå®ƒä¸ä¼šæ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨ã€‚ 21. ä¸ºç”Ÿäº§ç¯å¢ƒæ‰“åŒ…ä½ çš„åº”ç”¨å¯æ‰§è¡Œ jar å¯ç”¨äºç”Ÿäº§éƒ¨ç½²ï¼Œå› ä¸ºä»–ä»¬æ˜¯ç‹¬ç«‹çš„ï¼ˆself-containedï¼‰ï¼Œå®ƒä»¬ä¹Ÿéå¸¸é€‚åˆï¼ˆideally \bsuitedï¼‰åŸºäºäº‘çš„éƒ¨ç½²ã€‚ å¦‚éœ€è¦é¢å¤–çš„â€œç”Ÿäº§å‡†å¤‡â€ç‰¹æ€§ï¼Œä¾‹å¦‚å¥åº·ï¼Œå‡çº§ï¼Œå’Œåº¦é‡ Rest æˆ–è€… JMX ç«¯ç‚¹ï¼Œè€ƒè™‘æ·»åŠ  spring-boot-actuatorã€‚æŸ¥çœ‹ ç¬¬å››ç«  Spring Boot ç›‘æ§ï¼š\bç”Ÿäº§å¯è¯»çš„ç‰¹æ€§ è·å¾—æ›´å¤šç»†èŠ‚ã€‚ 22. \bä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆä½ ç°åœ¨åº”è¯¥ç†è§£å¦‚ä½•ä½¿ç”¨ Spring Boot å’Œä¸€äº›éµå¾ªçš„æœ€ä½³å®è·µã€‚ç°åœ¨å¯ä»¥æ·±å…¥å­¦ä¹ ç‰¹å®šçš„ Spring Boot ç‰¹æ€§ï¼Œæˆ–è€…ä½ å¯ä»¥è·³è¿‡å‰é¢ï¼ˆaheadï¼‰ï¼Œé˜…è¯»å…³äº â€œç”Ÿäº§å¯è¯»â€ å„æ–¹é¢çš„ Spring Bootã€‚\b\b","link":"/2019/06/22/[20190622] spring-boot | part3(17~22)/"},{"title":"20190701 spring-boot | part4(1~2)","text":"Spring Boot Reference Guide2.2.0.BUILD-SNAPSHOThttps://docs.spring.io/spring-boot/docs/2.2.0.BUILD-SNAPSHOT/reference/htmlsingle/#boot-features Part 4. Spring Boot Features 4.1 Spring åº”ç”¨ 4.1.1 å¯åŠ¨å¤±è´¥ 4.1.2 æ‡’åŠ è½½ 4.1.3 å®šåˆ¶æ¨ªå¹… 4.1.4 å®šåˆ¶ Spring åº”ç”¨ 4.1.5 Fluent æ„å»º API 4.1.6 åº”ç”¨äº‹ä»¶ä¸ç›‘å¬ 4.1.7 web ç¯å¢ƒ 4.1.8 è®¿é—®åº”ç”¨å‚æ•° 4.1.9 ä½¿ç”¨ ApplicationRunner æˆ–è€… CommandLineRunner 4.1.10 é€€å‡ºåº”ç”¨ 4.1.11 ç®¡ç†ç‰¹æ€§åŠŸèƒ½ 4.2 å¤–éƒ¨åŒ–é…ç½® 4.1 Spring åº”ç”¨SpringApplication ç±»æä¾›æ–¹ä¾¿çš„ï¼ˆconvenientï¼‰æ–¹å¼å¼•å¯¼ Spring åº”ç”¨ä» main() å¯åŠ¨ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥å§”æ‰˜ï¼ˆdelegateï¼‰é™æ€æ–¹æ³• SpringApplication.run()ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123public static void main(String[] args) { SpringApplication.run(MySpringConfiguration.class, args);} å½“ä½ çš„åº”ç”¨å¯åŠ¨åï¼Œä½ å¯ä»¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š . ____ _ __ _ _ /\\\\ / ___&apos;_ __ _ _(_)_ __ __ _ \\ \\ \\ \\ ( ( )\\___ | &apos;_ | &apos;_| | &apos;_ \\/ _` | \\ \\ \\ \\ \\\\/ ___)| |_)| | | | | || (_| | ) ) ) ) &apos; |____| .__|_| |_|_| |_\\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: v2.2.0.BUILD-SNAPSHOT 2013-07-31 00:08:16.117 INFO 56603 --- [ main] o.s.b.s.app.SampleApplication : Starting SampleApplication v0.1.0 on mycomputer with PID 56603 (/apps/myapp.jar started by pwebb) 2013-07-31 00:08:16.166 INFO 56603 --- [ main] ationConfigServletWebServerApplicationContext : Refreshing org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@6e5a8246: startup date [Wed Jul 31 00:08:16 PDT 2013]; root of context hierarchy 2014-03-04 13:09:54.912 INFO 41370 --- [ main] .t.TomcatServletWebServerFactory : Server initialized with port: 8080 2014-03-04 13:09:56.501 INFO 41370 --- [ main] o.s.b.s.app.SampleApplication : Started SampleApplication in 2.992 seconds (JVM running for 3.658) é»˜è®¤æƒ…å†µä¸‹ï¼Œå±•ç¤º INFO çº§åˆ«çš„æ—¥å¿—è®°å½•æ¶ˆæ¯ï¼ŒåŒ…å«ä¸€äº›æœ‰å…³ï¼ˆrelevantï¼‰å¯åŠ¨çš„ç»†èŠ‚ï¼Œä¾‹å¦‚å¯åŠ¨åº”ç”¨ç¨‹åºçš„ç”¨æˆ·ã€‚å¦‚æœä½ ä¸éœ€è¦ INFO çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯ï¼Œä½ å¯ä»¥è®¾ç½®å®ƒï¼Œæœ‰å…³è¿™çš„æè¿°åœ¨ æ—¥å¿—çº§åˆ« 4.1.1 å¯åŠ¨å¤±è´¥å¦‚æœä½ çš„åº”ç”¨å¯åŠ¨å¤±è´¥ï¼Œæ³¨å†Œçš„ FailureAnalyzers è·å¾—æ¿€æ´»æä¾›ä¸€ä¸ªé”™è¯¯æè¿°ä¿¡æ¯å’Œè§£å†³é—®é¢˜çš„å…·ä½“ï¼ˆconcreteï¼‰æ–¹å¼ã€‚ä¾‹å¦‚ï¼šå¦‚æœä½ åœ¨ 8080 ç«¯å£å¯åŠ¨ web ç¨‹åºè¢«å ç”¨ï¼Œä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š *************************** APPLICATION FAILED TO START *************************** Description: Embedded servlet container failed to start. Port 8080 was already in use. Action: Identify and stop the process that&apos;s listening on port 8080 or configure this application to listen on another port. Spring Boot æä¾›è®¸å¤šçš„ï¼ˆnumerousï¼‰FailureAnalyzer å®ç°ï¼Œä½ å¯ä»¥æ·»åŠ ä½ è‡ªå·±çš„ å¦‚æœæ²¡æœ‰æ•…éšœåˆ†æå™¨èƒ½å¤Ÿå¤„ç†å¼‚å¸¸ï¼Œä½ ä»ç„¶å¯ä»¥ä¸€ç›´å±•ç¤ºè¿™ä¸ªæ¡ä»¶æŠ¥å‘Šä»¥ä¾¿äºæ›´å¥½çš„ç†è§£å‘ç”Ÿäº†ä»€ä¹ˆé”™è¯¯ã€‚è¦è¿™æ ·åšï¼Œä½ éœ€è¦å¼€å¯ debug å±æ€§æˆ–è€…ä¸º org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener æ‰“å¼€ DEBUG æ—¥å¿—è®°å½•ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä½ é€šè¿‡ java -jar è¿è¡Œä½ çš„åº”ç”¨ç¨‹åºï¼Œä½ å¯ä»¥å¼€å¯ debug å±æ€§ï¼Œå¦‚ä¸‹ï¼š 1java -jar myproject-0.0.1-SNAPSHOT.jar --debug 4.1.2 æ‡’åŠ è½½SpringApplication å…è®¸åº”ç”¨æ‡’åŠ è½½ã€‚å½“æ‡’åŠ è½½å¼€å¯ï¼ŒBeans æ˜¯æ ¹æ®éœ€è¦åˆ›å»ºçš„ï¼Œè€Œä¸æ˜¯åº”ç”¨å¯åŠ¨æ—¶åˆ›å»ºã€‚å› æ­¤ï¼ˆas a resultï¼‰ï¼Œå¼€å¯æ‡’åŠ è½½å¯ä»¥å‡å°‘ï¼ˆreduce the timeï¼‰åº”ç”¨å¯åŠ¨çš„æ—¶é—´ã€‚åœ¨ Web åº”ç”¨ä¸­ï¼Œå¼€å¯æ‡’åŠ è½½å°†ä¼šå¯¼è‡´ï¼ˆwill result inï¼‰å¤§é‡ä¸ web ç›¸å…³çš„ beans ä¸ä¼šåˆå§‹åŒ–ï¼Œ\bç›´åˆ°ä¸€ä¸ªè¯·æ±‚è¿›æ¥ä¹‹åã€‚ æ‡’åŠ è½½çš„ç¼ºç‚¹ï¼ˆa downside ofï¼‰æ˜¯å®ƒä¼šæ¨è¿Ÿï¼ˆdelayï¼‰å‘ç°åº”ç”¨ç¨‹åºå‡ºç°çš„é—®é¢˜ã€‚å¦‚æœé…ç½®ä¸å½“ï¼ˆmisconfiguredï¼‰çš„ bean è¢«\bæ‡’åŠ è½½ï¼Œå¯åŠ¨æœŸé—´å°†ä¸ä¼šå¤±è´¥ï¼Œåªæœ‰å½“\b bean è¢«åˆå§‹åŒ–æ—¶é—®é¢˜æ‰ä¼šæ˜¾éœ²å‡ºæ¥ã€‚åˆ›å»ºåŒæ ·éœ€è¦ç¡®ä¿ JVM æœ‰å……è¶³çš„ï¼ˆsufficientï¼‰çš„å†…å­˜æ¥å®¹çº³ï¼ˆaccommodateï¼‰æ‰€æœ‰çš„åº”ç”¨ beanï¼Œå¹¶ä¸”ä¸ä»…ä»…æ˜¯å¯åŠ¨æ—¶çš„ beanã€‚ç”±äºè¿™äº›åŸå› ï¼Œæ‡’åŠ è½½é»˜è®¤æƒ…å†µä¸‹æ²¡æœ‰å¼€å¯ï¼Œå»ºè®®åœ¨å¯ç”¨æƒ°æ€§åˆå§‹åŒ–ä¹‹å‰å¯¹ JVM çš„å †å¤§å°è¿›è¡Œå¾®è°ƒã€‚ æ‡’åŠ è½½å¯ä»¥ä½¿ç”¨ SpringApplicationBuilder çš„ lazyInitilization æ–¹æ³•æˆ–è€… SpringApplication çš„ setLazyInitialization æ–¹æ³•ç¼–ç¨‹å¼ï¼ˆprogramaticallyï¼‰çš„æ‰“å¼€ã€‚æˆ–è€…ï¼Œå®ƒä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨ spring.main.lazy-initilization å±æ€§å¼€å¯ï¼Œå¦‚ä¸‹ï¼š 1spring.main.lazy-initialization=true å¦‚æœä½ æƒ³å¯¹åº”ç”¨çš„å…¶ä½™éƒ¨åˆ†\bä½¿ç”¨æ‡’åŠ è½½åˆå§‹åŒ–è€Œç¦ç”¨ç¡®å®šçš„ï¼ˆcertainï¼‰ bean çš„æ‡’åŠ è½½ã€‚ä½ å¯ä»¥ä½¿ç”¨ @Lazt(false) æ³¨è§£æ˜ç¡®çš„ï¼ˆexplicitlyï¼‰è®¾ç½®ä»–ä»¬çš„æ‡’åŠ è½½å±æ€§ä¸º falseã€‚ 4.1.3 å®šåˆ¶æ¨ªå¹…ï¼ˆbannerï¼‰\b\bæ¨ªå¹…å°†ä¼šåœ¨åº”ç”¨å¯åŠ¨æ—¶æ‰“å°ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ ä¸€ä¸ª banner.txt æ–‡ä»¶åˆ°ä½ çš„ç±»è·¯å¾„ä¸‹æˆ–è€…è®¾ç½® spring.banner.location å±æ€§æŒ‡å®šåˆ°ä¸€ä¸ªç±»ä¼¼çš„æ–‡ä»¶æ¥æ”¹å˜\bå®ƒã€‚å¦‚æœè¿™ä¸ªæ–‡ä»¶çš„ç¼–ç ä¸æ˜¯ UTF-8ï¼Œä½ å¯ä»¥è®¾ç½® spring.banner.charsetã€‚é™¤äº†ï¼ˆin addtion toï¼‰æ–‡æœ¬æ–‡ä»¶ï¼Œä½ åŒæ ·å¯ä»¥æ·»åŠ ä¸€ä¸ª banner.gitï¼Œbanner.jpgï¼Œbanner.png å›¾ç‰‡æ–‡ä»¶åˆ°ä½ çš„ç±»è·¯å¾„ä¸‹ï¼Œæˆ–è€…è®¾ç½® spring.banner.location å±æ€§ã€‚å›¾åƒè¢«è½¬æ¢æˆ ASCII è‰ºæœ¯è¡¨ç¤ºæ³•ï¼ˆart representationï¼‰ï¼Œå¹¶æ‰“å°åœ¨ä»»ä½•æ–‡å­—æ¨ªå¹…ä¹‹ä¸Šã€‚ åœ¨ä½ çš„ banner.txt æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»æ„ä»¥ä¸‹çš„\bå ä½ç¬¦ï¼š \bå˜é‡ æè¿° ${application.version} ä½ çš„åº”ç”¨çš„ç‰ˆæœ¬å·ï¼Œåœ¨ MANIFEST.MF ä¸­\bå®šä¹‰ã€‚å¦‚ï¼ŒImplementation-Version: 1.0 is printed as 1.0. ${application.formatted-version} ä½ çš„åº”ç”¨çš„ç‰ˆæœ¬å·ï¼Œåœ¨ MANIFEST.MF ä¸­\bå®šä¹‰å¹¶æ ¼å¼åŒ–å±•ç¤ºï¼ˆç”¨æ‹¬å·æ‹¬èµ·æ¥ï¼Œå¹¶ç”¨vï¼‰ã€‚å¦‚ï¼šï¼ˆv1.0ï¼‰ ${spring-boot.version} ä½ ä½¿ç”¨çš„ Spring Boot çš„ç‰ˆæœ¬å·ã€‚å¦‚\bï¼š2.2.0.BUILD-SNAPSHOT ${spring-boot.formatted-version} ä½ ä½¿ç”¨çš„ Spring Boot ç‰ˆæœ¬å·å¹¶æ ¼å¼åŒ–å±•ç¤ºã€‚å¦‚ï¼š(v2.2.0.BUILD-SNAPSHOT). ${Ansi.NAME} (or ${AnsiColor.NAME},${AnsiBackground.NAME}, ${AnsiStyle.NAME}) å…¶ä¸­ï¼Œåç§°æ˜¯ANSIè½¬ä¹‰ä»£ç çš„åç§°ã€‚æ›´å¤šç»†èŠ‚è¯·çœ‹ AnsiPropertySource ${application.title} ä½ åº”ç”¨çš„æ ‡é¢˜ï¼Œåœ¨ MANIFEST.MF ä¸­\bå®šä¹‰ã€‚å¦‚: MyApp is printed as MyApp. SpringApplication.setBanner(...) æ–¹æ³•å¯ä»¥\bä½¿ç”¨ï¼Œå¦‚æœä½ æƒ³ç¼–ç¨‹å¼ç”Ÿæˆä¸€ä¸ªæ¨ªå¹…ã€‚ä½¿ç”¨ org.springframework.boot.Banner æ¥å£\bå¹¶å®ç°ä½ è‡ªå·±çš„ printBanner() æ–¹æ³•ã€‚ æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ Spring.main.ban-mode å±æ€§æ¥ç¡®å®šï¼ˆdetermineï¼‰æ˜¯å¦å¿…é¡»åœ¨ System.out(æ§åˆ¶å°) ä¸Šæ‰“å°æ¨ªå¹…ï¼Œå‘é€åˆ°å·²é…ç½®çš„è®°å½•å™¨ï¼ˆæ—¥å¿—ï¼‰ï¼Œæˆ–æ ¹æœ¬ä¸äº§ç”Ÿï¼ˆå…³é—­ï¼‰ã€‚ æ‰“å°çš„æ¨ªå¹…è¢«æ³¨å†Œæˆä¸€ä¸ªå•ä¾‹çš„ beanï¼Œå¦‚ä»¥ä¸‹å‘½åï¼š\bspringBannerã€‚ 1234# yml æ˜ å°„ off ä¸º falseï¼Œè¯·ç¡®ä¿æ·»åŠ å¼•å·å¦‚æœä½ è¦åœ¨ä½ \bçš„åº”ç”¨ä¸­ç¦ç”¨æ¨ªå¹…çš„è¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šspring: main: banner-mode: \"off\" 4.1.4 å®šåˆ¶ Spring åº”ç”¨å¦‚æœ SpringApplication é»˜è®¤çš„é…ç½®ä¸ç¬¦åˆä½ çš„å£å‘³ï¼ˆtasteï¼‰ï¼Œä½œä¸ºæ›¿ä»£ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæœ¬åœ°çš„å®ä¾‹å¹¶å®šåˆ¶å®ƒã€‚ä¾‹å¦‚ï¼šè¦å…³é—­ bannerï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼š 12345public static void main(String[] args) { SpringApplication app = new SpringApplication(MySpringConfiguration.class); app.setBannerMode(Banner.Mode.OFF); app.run(args);} è¯¥æ„é€ å‚æ•°ä¼ é€’ç»™ SpringApplication çš„æ˜¯ä¸€ä¸ª Spr\bing Bean çš„é…ç½®èµ„æºã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™äº›æ˜¯å¯¹ @Configuration çš„å¼•ç”¨ï¼Œä½†æ˜¯ä»–ä»¬åŒæ ·å¯ä»¥å¼•ç”¨ XML é…ç½®æˆ–è€…æ‰«æåŒ…ã€‚ åŒæ ·å¯ä»¥é€šè¿‡ä½¿ç”¨ application.properties æ–‡ä»¶é…ç½® SpringApplicationã€‚æ›´å¤šç»†èŠ‚è¯·æŸ¥çœ‹ å¤–éƒ¨é…ç½® å…³äºé…ç½®é¡¹çš„å®Œæ•´ï¼ˆcompleteï¼‰åˆ—è¡¨ï¼Œè¯·æŸ¥çœ‹ SpringApplication æ–‡æ¡£ã€‚ 4.1.5 Fluent æ„å»º APIå¦‚æœä½ æƒ³æ„å»ºå…·æœ‰å±‚æ¬¡ç»“æ„çš„ï¼ˆhierarchyï¼‰çš„ ApplicationContextï¼ˆå¤šä¸ªä¸Šä¸‹æ–‡å…·æœ‰çˆ¶å­å…³ç³»ï¼‰æˆ–è€…ä½ å–œçˆ±ä½¿ç”¨ â€œfluentâ€ æ„å»º APIï¼Œä½ å¯ä»¥ä½¿ç”¨ SpringApplicationBuilderã€‚ SpringApplicationBuilder å…è®¸ä½ å°†å¤šä¸ªæ–¹æ³•è°ƒç”¨è¿æ¥åœ¨ä¸€èµ·ï¼ŒåŒ…æ‹¬å…è®¸ä½ åˆ›å»ºå…·æœ‰å±‚çº§ç»“æ„çš„çˆ¶å­æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤º\b\bï¼š 12345new SpringApplicationBuilder() .sources(Parent.class) .child(Application.class) .bannerMode(Banner.Mode.OFF) .run(args); å½“åˆ›å»ºå…·æœ‰å±‚çº§ç»“æ„çš„ ApplicationContext ä¼šæœ‰ä¸€äº›é™åˆ¶ï¼ˆrestrictionsï¼‰ä¾‹å¦‚ï¼šWEB ç»„ä»¶å¿…é¡»åŒ…å«åœ¨ å­ä¸Šä¸‹æ–‡é‡Œé¢ï¼Œå¹¶ä¸”çˆ¶å’Œå­ä¸Šä¸‹æ–‡éƒ½ä½¿ç”¨ç›¸åŒçš„ç¯å¢ƒã€‚æ›´å¤šç»†èŠ‚è¯·æŸ¥çœ‹ SpringApplicationBuilder æ–‡æ¡£ã€‚ 4.1.6 åº”ç”¨äº‹ä»¶ä¸ç›‘å¬é™¤äº†é€šå¸¸ä½¿ç”¨çš„ Spring æ¡†æ¶äº‹ä»¶ï¼Œä¾‹å¦‚ ContextRefreshedEventã€‚SpringApplication è¿˜ä¼šå‘é€ä¸€äº›é¢å¤–çš„äº‹ä»¶ã€‚ ä¸€äº›äº‹ä»¶å®é™…ä¸Šï¼ˆactuallyï¼‰æ˜¯åœ¨ ApplicationContext åˆ›å»ºä¹‹å‰è§¦å‘çš„ï¼Œæ‰€ä»¥ä½ ä¸èƒ½æ³¨å†Œç›‘å¬å™¨ä¸ºä¸€ä¸ª @Beanã€‚ä½ å¯ä»¥ä½¿ç”¨ \bSpringApplication.addListeners(â€¦â€‹) æ–¹æ³•æˆ–è€… SpringApplicationBuilder.listeners(â€¦â€‹) æ–¹æ³•æ³¨å†Œ\bä»–ä»¬ã€‚ å¦‚æœä½ æƒ³è¿™äº›\bç›‘å¬å™¨å¯ä»¥è‡ªåŠ¨æ³¨å†Œï¼Œ\bä¸ç®¡ï¼ˆregardlessï¼‰åˆ›å»ºåº”ç”¨çš„\bæ˜¯ä»€ä¹ˆæ–¹å¼ï¼Œä½ å¯ä»¥æ·»åŠ ä¸€ä¸ª META-INF/spring.factories æ–‡ä»¶åˆ°ä½ çš„é¡¹ç›®å¹¶ä½¿ç”¨ org.springframework.context.ApplicationListener é”®æ¥å¼•ç”¨ä½ çš„ç›‘å¬å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤º\bï¼š org.springframework.context.ApplicationListener=com.example.project.MyListener å½“åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ï¼ŒApplication Event ä»¥ä»¥ä¸‹é¡ºåºå‘é€ï¼š åº”ç”¨å¯åŠ¨äº‹ä»¶ï¼ˆApplicationStartingEventï¼‰åœ¨å¼•ç”¨\bå¼€å§‹å¯åŠ¨ä½†åœ¨\bä»»ä½•å¤„ç†ä¹‹å‰å‘é€ï¼Œ\bé™¤äº†ï¼ˆexcept forï¼‰æ³¨å†Œç›‘å¬å’Œåˆå§‹åŒ–å™¨ä¹‹å¤–ã€‚ åº”ç”¨ç¯å¢ƒå‡†å¤‡äº‹ä»¶ï¼ˆApplicationEnvironmentPreparedEventï¼‰å‘é€çš„\bæ—¶æœºæ˜¯å½“ \bEnvironment è¢«ä¸€ä¸ªå·²çŸ¥çš„ä¸Šä¸‹\bæ–‡ä½¿ç”¨ä½†æ˜¯è¯¥ä¸Šä¸‹æ–‡åˆ›å»ºä¹‹å‰ã€‚\b\b åº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹åŒ–äº‹ä»¶ï¼ˆApplicationContextInitializedEventï¼‰å½“ ApplicationContext å·²å‡†å¤‡ï¼ŒApplicationContextInitializers è¢«è°ƒç”¨ä½†æ˜¯ä»»ä½•å®šä¹‰çš„ bean åŠ è½½ä¹‹å‰å‘é€ã€‚ åº”ç”¨å‡†å¤‡äº‹ä»¶ï¼ˆApplicationPreparedEventï¼‰åªåœ¨åº”ç”¨åˆ·æ–°å¼€å§‹ä¹‹å‰ä½†å®šä¹‰çš„ bean åŠ è½½ä¹‹åå‘é€ã€‚ åº”ç”¨\bå¼€å§‹äº‹ä»¶ï¼ˆApplicationStartedEventï¼‰åœ¨ä¸Šä¸‹æ–‡åˆ·æ–°ä¹‹åä½†æ˜¯ä»»ä½•åº”ç”¨å’Œå‘½ä»¤è¡Œ\bæ‰§è¡Œå™¨è°ƒç”¨ä¹‹å‰å‘é€ã€‚ åº”ç”¨å‡†å¤‡äº‹ä»¶ï¼ˆApplicationReadyEventï¼‰æ˜¯åœ¨ä»»ä½•åº”ç”¨å’Œå‘½ä»¤è¡Œæ‰§è¡Œå™¨è¢«è°ƒç”¨ä¹‹åå‘é€çš„ã€‚å®ƒè¡¨æ˜ï¼ˆindicatesï¼‰è¯¥åº”ç”¨å·²å‡†å¤‡å¥½æœåŠ¡è¯·æ±‚ã€‚ åº”ç”¨å¤±è´¥äº‹ä»¶ï¼ˆApplicationFailedEventï¼‰åœ¨å¦‚æœå¯åŠ¨å¯åŠ¨å‘ç”Ÿå¼‚å¸¸æ—¶å‘é€ã€‚ ä¸Šé¢çš„åˆ—è¡¨åªåŒ…æ‹¬ SpringApplicationEventsï¼Œå®ƒä¸ â€œSpringApplicationâ€ ç»‘å®šï¼ˆtied toï¼‰åœ¨ä¸€èµ·ã€‚ã€‚é™¤äº†è¿™äº›ï¼Œä»¥ä¸‹äº‹ä»¶åŒæ ·åœ¨ ApplicationPreparedEvent ä¹‹åï¼ŒApplicationStartedEvent ä¹‹å‰å‘å¸ƒï¼š ä¸Šä¸‹æ–‡åˆ·æ–°äº‹ä»¶ï¼ˆContextRefreshedEventï¼‰åœ¨ ApplicationContext è¢«åˆ·æ–°\båå‘é€ã€‚ webæœåŠ¡å™¨\b\båˆå§‹åŒ–äº‹ä»¶ï¼ˆWebServerInitializedEventï¼‰åœ¨ web æœåŠ¡å™¨å·²å‡†å¤‡å¥½ã€‚ServletWebServerInitializedEvent å’Œ ReactiveWebServerInitializedEvent åˆ†åˆ«æ˜¯ï¼ˆrespectivelyï¼‰servlet å’Œ reactive å˜ä½“ã€‚ ä½ é€šå¸¸ä¸éœ€è¦ä½¿ç”¨åº”ç”¨äº‹ä»¶ï¼Œä½†æ˜¯çŸ¥é“å®ƒä»¬çš„å­˜åœ¨æ˜¯å¾ˆæ–¹ä¾¿ï¼ˆhandyï¼‰çš„ã€‚åœ¨å†…éƒ¨ï¼ŒSpringBoot ä½¿ç”¨äº‹ä»¶æ¥å¤„ç†å„ç§ä»»åŠ¡ã€‚ åº”ç”¨äº‹ä»¶é€šè¿‡ä½¿ç”¨ Spring æ¡†æ¶çš„äº‹ä»¶å‘å¸ƒæœºåˆ¶å‘é€ã€‚æ­¤æœºåˆ¶çš„ä¸€éƒ¨åˆ†ï¼ˆpart ofï¼‰ç¡®ä¿äº‹ä»¶\b\bå‘å¸ƒåˆ°å­ä¸Šä¸‹æ–‡çš„äº‹ä»¶æ—¶åŒæ ·ä¹Ÿä¼šå‘é€ç»™ç¥–å…ˆï¼ˆancestorï¼‰ä¸Šçº¿æ–‡çš„ç›‘å¬å™¨ã€‚å› æ­¤ï¼ˆAs a result of thisï¼‰ï¼Œå¦‚æœä½ çš„åº”ç”¨ä½¿ç”¨\bå…·æœ‰\bå±‚æ¬¡ç»“æ„çš„ SpringApplicatoni å®ä¾‹ï¼Œç›‘å¬å™¨å¯ä»¥æ¥å—ç›¸åŒç±»å‹çš„åº”ç”¨äº‹ä»¶çš„å¤šä¸ªå®ä¾‹ã€‚ è‹¥è¦å…è®¸ç›‘å¬å™¨åŒºåˆ†ï¼ˆdistinguishï¼‰ç”¨äºå…¶ä¸Šä¸‹æ–‡çš„äº‹ä»¶å’Œé’ˆå¯¹åä»£ä¸Šä¸‹æ–‡çš„äº‹ä»¶ï¼Œå®ƒåº”è¯¥è¯·æ±‚å®ƒçš„åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡è¢«æ³¨å…¥ï¼Œç„¶åå°†æ³¨å…¥çš„ä¸Šä¸‹æ–‡ä¸äº‹ä»¶çš„ä¸Šä¸‹æ–‡è¿›è¡Œæ¯”è¾ƒã€‚è¯¥ä¸Šä¸‹æ–‡å¯ä»¥é€šè¿‡å®ç° ApplicationContextAware æ³¨å…¥ï¼Œæˆ–è€…å¦‚æœç›‘å¬å™¨æ˜¯ä¸€ä¸ª Beanï¼Œé€šè¿‡ä½¿ç”¨ @Authwiredã€‚ 4.1.7 web ç¯å¢ƒSpringApplication ä¼šå°è¯•ï¼ˆattemptsï¼‰ä¸ºæ‚¨ï¼ˆon your behalfï¼‰åˆ›å»ºæ­£ç¡®ç±»å‹çš„åº”ç”¨ä¸Šä¸‹æ–‡ã€‚ç”¨äºç¡®å®šï¼ˆdetermineï¼‰ Web åº”ç”¨ä¸Šä¸‹æ–‡ç±»å‹çš„ç®—æ³•ç›¸å½“ç®€å•ï¼ˆfairly simpleï¼‰ï¼š å¦‚æœå­˜åœ¨ Spring MVCï¼Œä½¿ç”¨ AnnotationConfigServletWebServerApplicationContextã€‚ å¦‚æœ Spring MVC ä¸å­˜åœ¨ä½† Spring WebFlux å­˜åœ¨ï¼Œä½¿ç”¨ AnnotationConfigReactiveWebServerApplicationContextã€‚ å¦åˆ™ï¼Œä½¿ç”¨ AnnotationConfigApplicationContextã€‚ è¿™æ„å‘³ç€å¦‚æœä½ ä»æ¥è‡ªåŒä¸€ä¸ªï¼ˆsameï¼‰åº”ç”¨çš„ Spring WebFlux ä½¿ç”¨ Spring MVC å’Œæ–°çš„ WebClientï¼Œ\bSpring MVC å°†ä¼šä½œä¸ºé»˜è®¤ä½¿ç”¨ã€‚ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ setWebApplicationType(WebApplicationType) ç®€å•çš„è¦†ç›–å®ƒã€‚ åŒæ ·å¯ä»¥é€šè¿‡è°ƒç”¨ setApplicationContextClass(â€¦â€‹) å®Œæˆå¯¹åº”ç”¨ä¸Šä¸‹æ–‡ç±»å‹çš„æ§åˆ¶ã€‚ å½“åœ¨ JUnitTest ä¸­ä½¿ç”¨ SpringApplication æ—¶é€šå¸¸éœ€è¦è°ƒç”¨ setWebApplicationType(WebApplicationType.NONE) 4.1.8 è®¿é—®åº”ç”¨å‚æ•°å¦‚æœä½ éœ€è¦è®¿é—®ä¼ é€’ç»™ SpringApplication.run(â€¦â€‹) çš„åº”ç”¨å‚æ•°ï¼Œä½ å¯ä»¥æ³¨å†Œä¸€ä¸ª org.springframework.boot.ApplicationArguments beanã€‚ApplicationArguments æ¥å£æä¾›å¯¹åŸå§‹ String[] å‚æ•°ä»¥åŠå¯é€‰ã€\béå¯é€‰å‚æ•°çš„è®¿é—®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123456789101112131415import org.springframework.boot.*;import org.springframework.beans.factory.annotation.*;import org.springframework.stereotype.*;@Componentpublic class MyBean { @Autowired public MyBean(ApplicationArguments args) { boolean debug = args.containsOption(\"debug\"); List&lt;String&gt; files = args.getNonOptionArgs(); // if run with \"--debug logfile.txt\" debug=true, files=[\"logfile.txt\"] }} Spring Boot è¿˜åœ¨ Spring ç¯å¢ƒä¸­æ³¨å†Œäº† CommandLinePropertySourceã€‚è¿™å…è®¸ä½ é€šè¿‡ä½¿ç”¨ @Value æ³¨è§£æ³¨å…¥å•ä¸ªåº”ç”¨å‚æ•°ã€‚ 4.1.9 ä½¿ç”¨ ApplicationRunner æˆ–è€… CommandLineRunnerå¦‚æœä½ éœ€è¦åœ¨ Spring\b åº”ç”¨å¯åŠ¨æ—¶è¿è¡Œ\bä¸€äº›ç‰¹å®šä»£ç ï¼Œä½ å¯ä»¥å®ç° ApplicationRunner æˆ– CommandLineRunner æ¥å£ã€‚\bä¸¤è€…æ¥å£éƒ½ä»¥ç›¸åŒçš„æ–¹å¼å·¥ä½œï¼Œå¹¶ä¸”éƒ½æä¾›äº†ä¸€ä¸ªå•ä¸ªçš„ run æ–¹æ³•ï¼Œåªéœ€è¦åœ¨ SpringApplication.run(â€¦â€‹) å®Œæˆä¹‹å‰è°ƒç”¨ã€‚ CommandLineRunner æ¥å£æä¾›å¯¹åº”ç”¨å‚æ•°çš„è®¿é—®ä½œä¸ºä¸€ä¸ª\bç®€å•å­—ç¬¦ä¸²æ•°ç»„ï¼Œè€Œ ApplicationRunner ä½¿ç”¨å‰é¢è®¨è®ºçš„ ApplicationArguments æ¥å£ã€‚ä»¥ä¸‹æ ·ä¾‹å±•ç¤ºäº†ä¸€ä¸ª CommandLineRunner è¿è¡Œ run æ–¹æ³•ï¼š 1234567891011import org.springframework.boot.*;import org.springframework.stereotype.*;@Componentpublic class MyBean implements CommandLineRunner { public void run(String... args) { // Do something... }} å¦‚æœå®šä¹‰äº†å¤šä¸ª ApplicationRunner å’Œ CommandLineRunner çš„Beanï¼Œä¸”éœ€è¦ä»¥ç‰¹å®šé¡ºåºè°ƒç”¨ã€‚ä½ å¯ä»¥å¦å¤–ï¼ˆadditionallyï¼‰å®ç° org.springframework.core.Ordered æ¥å£æˆ–è€…ä½¿ç”¨ org.springframework.core.annotation.Order æ³¨è§£ã€‚ 4.1.10 é€€å‡ºåº”ç”¨æ¯ä¸€ä¸ª SpringApplication éƒ½æ³¨å†Œäº†ä¸€ä¸ªå®•æœºé’©å­åˆ° JVM ä»¥ç¡®ä¿åœ¨ ApplicationContext å…³é—­æ—¶ä¼˜é›…ï¼ˆgracefullyï¼‰çš„é€€å‡ºã€‚å¯ä»¥ä½¿ç”¨æ‰€æœ‰æ ‡å‡†çš„ Spring ç”Ÿå‘½å‘¨æœŸå›è°ƒï¼ˆä¾‹å¦‚ DisposableBean æ¥å£æˆ– @predestroyï¼‰ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œbeans å¯ä»¥å®ç° org.springframework.boot.ExitCodeGenerator æ¥å£å¦‚æœéœ€è¦å½“ SpringApplication.exit() è¢«è°ƒç”¨åè¿”å›ç‰¹å®š\b é€€å‡ºç ã€‚è¿™ä¸ªé€€å‡ºç å¯ä»¥è¢«ä¼ é€’ç»™ System.Exit() ä½œä¸ºä¸€ä¸ªçŠ¶æ€ç è¿”å›ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345678910111213@SpringBootApplicationpublic class ExitCodeApplication { @Bean public ExitCodeGenerator exitCodeGenerator() { return () -&gt; 42; } public static void main(String[] args) { System.exit(SpringApplication.exit(SpringApplication.run(ExitCodeApplication.class, args))); }} åŒæ ·çš„ï¼ŒExitCodeGenerator æ¥å£å¯ä»¥å®ç°ä¸€ä¸ªå¼‚å¸¸ã€‚å½“é‡åˆ°è¿™æ ·çš„å¼‚å¸¸æ—¶ï¼ŒSpringBoot è¿”å›ç”±å®ç°çš„ getExitCode() æ–¹æ³•æä¾›çš„é€€å‡ºä»£ç ã€‚ 4.1.11 ç®¡ç†åŠŸèƒ½å¯ä»¥é€šè¿‡æŒ‡å®š spring.application.admin.enabled å±æ€§ä¸ºåº”ç”¨å¼€å¯ä¸ç®¡ç†ç›¸å…³çš„åŠŸèƒ½ã€‚è¿™å°†åœ¨ MBeanServer å¹³å°ä¸Šæš´éœ²ä¸€ä¸ª SpringApplicationAdminMXBeanã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½è¿œç¨‹ç®¡ç†æ‚¨çš„ Spring å¯åŠ¨åº”ç”¨ç¨‹åºã€‚è¿™äº›ç‰¹æ€§åœ¨\bä¸€äº›æœåŠ¡åŒ…è£…å®ç°ç±»ä¸­åŒæ ·å¯ç”¨ã€‚ å¦‚æœä½ æƒ³çŸ¥é“åº”ç”¨è¿è¡Œåœ¨å“ªä¸€ä¸ªç«¯å£ä¸Šï¼Œé€šè¿‡ local.server.port å±æ€§å¯ä»¥è·å¾—ã€‚ å¯ç”¨æ­¤ç‰¹æ€§æ—¶è¦å°å¿ƒï¼ˆtake\b careï¼‰ï¼Œå› ä¸ºMBeanå…¬å¼€äº†å…³é—­åº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚ 4.2 å¤–éƒ¨åŒ–é…ç½®","link":"/2019/07/01/[20190701] spring-boot | part4(1~2)/"},{"title":"ç»ˆç«¯èµ°ä»£ç†","text":"æ°¸ä¹…\b\bæ–¹å¼è®¾ç½®ï¼švim .zshrcæ ¹æ®è‡ªå·±ä»£ç†çš„ ip å’Œ ç«¯å£è®¾ç½®ä»¥ä¸‹å†…å®¹ï¼š 12export http_proxy=\"http://127.0.0.1:1087\"export https_proxy=\"http://127.0.0.1:1087\" ç„¶åï¼šsource .zshrc éªŒè¯ï¼šcurl www.google.com","link":"/2019/07/15/ç»ˆç«¯èµ°ä»£ç†/"},{"title":"é…·ç‚«å·¥å…·","text":"\bfiglet1brew install figlet toilet1brew install toilet box1brew install boxes cowsay1brew install cowsay","link":"/2019/07/16/é…·ç‚«å·¥å…·/"},{"title":"é«˜æ€§èƒ½ MySql â€”â€” å­¦ä¹ ç¬”è®°","text":"è¯»ã€Šé«˜æ€§èƒ½ MYSQLã€‹ç¬”è®°ï¼Œä»…ç”¨å›é¡¾å¤ä¹ ä½œç”¨ï¼Œä¸èƒ½å…·å¤‡å‚è€ƒä»·å€¼ã€‚ Table Of Contens ç¬¬ä¸€ç«  æ¶æ„ä¸å†å² Mysql é€»è¾‘æ¶æ„ï¼š å¹¶å‘æ§åˆ¶ è¯»å†™é” é”ç²’åº¦ äº‹åŠ¡ éš”ç¦»çº§åˆ« ç¬¬å››ç«  Schema ä¸ æ•°æ®ç±»å‹ä¼˜åŒ– æ•´æ•°ç±»å‹ \bå®æ•°ç±»å‹ å­—ç¬¦ä¸²ç±»å‹ æ—¶é—´ç±»å‹ ä½ç±»å‹ ç‰¹æ®Šç±»å‹ \b\bSchema è®¾è®¡çš„\bé™·é˜± èŒƒå¼ä¸åèŒƒå¼ ç¬¬äº”ç«  åˆ›å»ºé«˜æ€§èƒ½çš„ç´¢å¼• ç´¢å¼•çš„ç±»å‹ B-Tree ç´¢å¼• å“ˆå¸Œç´¢å¼• ç©ºé—´æ•°æ®ç´¢å¼•ï¼ˆR-Treeï¼‰ å…¨æ–‡ç´¢å¼• ç´¢å¼•çš„ä¼˜ç‚¹ æ­£ç¡®çš„åˆ›å»ºå’Œåˆ©ç”¨ç´¢å¼• ç‹¬ç«‹çš„åˆ— å‰ç¼€ç´¢å¼•å’Œç´¢å¼•é€‰æ‹©æ€§ é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—çš„é¡ºåº èšç°‡ç´¢å¼• è¦†ç›–ç´¢å¼• ç¬¬å…­ç«  \bæŸ¥è¯¢æ€§èƒ½ä¼˜åŒ– æŸ¥è¯¢æ…¢çš„å› ç´  ä¼˜åŒ–æ•°æ®è®¿é—® æ˜¯å¦è¯·æ±‚äº†ä¸éœ€è¦çš„æ•°æ® Mysql æ˜¯å¦åœ¨æ‰«æé¢å¤–çš„è®°å½• é‡æ„æŸ¥è¯¢æ–¹å¼ ä¸€ä¸ªå¤æ‚æŸ¥è¯¢è¿˜æ˜¯å¤šä¸ªç®€å•æŸ¥è¯¢ åˆ‡åˆ†æŸ¥è¯¢ åˆ†è§£å…³è”æŸ¥è¯¢ æŸ¥è¯¢æ‰§è¡Œçš„åŸºç¡€ï¼ˆæŸ¥è¯¢\bçš„å†…éƒ¨æœºåˆ¶ï¼‰ Mysql å®¢æˆ·ç«¯ / æœåŠ¡ç«¯é€šä¿¡åè®® æŸ¥è¯¢ç¼“å­˜ \bæŸ¥è¯¢ä¼˜åŒ–å¤„ç† ç¬¬ä¸€ç«  æ¶æ„ä¸å†å²Mysql é€»è¾‘æ¶æ„ï¼š ç¬¬ä¸€å±‚æ˜¯è¿æ¥å¤„ç†ï¼Œ\bå¹¶éæ˜¯ Mysql ç‹¬æœ‰ï¼Œå¤§å¤šæ•°åº”ç”¨éƒ½æœ‰ç±»ä¼¼çš„æ¶æ„ã€‚æ¯”å¦‚è¿æ¥ã€æˆæƒã€å®‰å…¨ç­‰ã€‚ ç¬¬äºŒå±‚æ˜¯ Mysql æ ¸å¿ƒåŠŸèƒ½\bå±‚ï¼ŒåŒ…æ‹¬è§£æã€åˆ†æã€ä¼˜åŒ–ã€ç¼“å­˜ä»¥åŠå†…ç½®å‡½æ•°ï¼ˆæ—¥æœŸã€æ—¶é—´ã€æ•°å­¦ã€åŠ å¯†ï¼‰ç­‰ã€‚æ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½ä¹Ÿåœ¨è¿™ä¸€å±‚å®ç°å¦‚ï¼šè§¦å‘å™¨ã€è§†å›¾ã€å­˜å‚¨è¿‡ç¨‹ç­‰ã€‚ ç¬¬ä¸‰å±‚åŒ…å«å­˜å‚¨\bå¼•æ“ï¼Œè´Ÿè´£ Mysql ä¸­æ•°æ®çš„å­˜å‚¨ä¸æå–ã€‚æ¯ä¸€ç§\bå­˜å‚¨å¼•æ“éƒ½æœ‰å„è‡ªçš„ä¼˜åŠ¿ä¸åŠ£åŠ¿ï¼Œ\bmysql æœåŠ¡å™¨é€šè¿‡ API ä¸å­˜å‚¨å¼•æ“é€šä¿¡ï¼Œè¿™äº› API å±è”½äº†ä¸åŒå­˜å‚¨å¼•æ“ä¹‹é—´çš„å·®å¼‚ï¼Œä½¿å¾—è¿™äº›å·®å¼‚å¯¹ä¸Šå±‚çš„æŸ¥è¯¢é€æ˜ã€‚å­˜å‚¨å¼•æ“ä¸ä¼šå»è§£æ SQLï¼Œä¸åŒå­˜å‚¨å¼•æ“ä¹‹é—´ä¹Ÿä¸ä¼šäº’ç›¸é€šä¿¡ï¼Œåªæ˜¯å“åº”ä¸Šå±‚ mysql æœåŠ¡å™¨çš„è¯·æ±‚ã€‚ å¹¶å‘æ§åˆ¶åªè¦æœ‰å¤šä¸ªæŸ¥è¯¢åœ¨åŒä¸€æ—¶åˆ»æ“ä½œæ•°æ®ï¼Œå°±æœ‰ä¼šæœ‰\bå¹¶å‘é—®é¢˜ã€‚Mysql å¯ä»¥ä»æœåŠ¡å±‚å’Œå­˜å‚¨å¼•æ“å±‚æ§åˆ¶å¹¶å‘ã€‚ è¯»å†™é”è¯»å†™é”ä¹Ÿç§°ä¸ºå…±äº«é”å’Œæ’å®ƒé”ï¼Œè¯»é”æ˜¯å…±äº«çš„ï¼ˆäº’ä¸é˜»å¡çš„ï¼‰ï¼Œå¤šä¸ªè¿æ¥å¯ä»¥åŒæ—¶è¯»å–åŒä¸€ä»½èµ„æºè€Œä¸äº§ç”Ÿå¹¶å‘é—®é¢˜ï¼›å†™é”æ˜¯æ’å®ƒçš„ï¼ˆä¸€ä¸ªå†™é”ä¼šé˜»å¡å…¶ä»–å†™é”å’Œ\bè¯»é”ï¼‰ï¼Œè¿™æœ‰è¿™æ ·æ‰ä¼šä¿è¯ç»™å®šæ—¶é—´å†…åªæœ‰ä¸€ä¸ªç”¨æˆ·å¯ä»¥\bæ‰§è¡Œæ“ä½œï¼Œå¹¶é˜²æ­¢å…¶ä»–ç”¨æˆ·è¯»å–æ­£åœ¨å†™å…¥çš„æ•°æ®ã€‚ é”ç²’åº¦åŠ é”æ“ä½œï¼ˆå¦‚ï¼šåŠ é”ã€æ£€æŸ¥é”æ˜¯å¦é‡Šæ”¾ã€é‡Šæ”¾é”ç­‰\bï¼‰éƒ½æ˜¯ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºçš„ï¼Œå¦‚æœèŠ±è´¹å¤§é‡çš„æ—¶é—´æ¥ç®¡ç†é”è€Œä¸æ˜¯å­˜å‚¨æ•°æ®ï¼Œé‚£ä¹ˆç³»ç»Ÿæ€§èƒ½ä¹Ÿä¼šå—åˆ°å½±å“ã€‚ å› æ­¤ä¸€ç§æé«˜å¹¶å‘æ€§èƒ½\bçš„æ–¹æ¡ˆæ˜¯è®©é”å®šå¯¹è±¡æ›´æœ‰é€‰æ‹©æ€§ï¼Œå°½é‡é”å®šéƒ¨åˆ†æ•°æ®è€Œä¸æ˜¯å…¨éƒ¨èµ„æºã€‚\bé”å®šçš„èµ„æºè¶Šå°‘ï¼Œå¹¶å‘æ§åˆ¶çš„æ€§èƒ½è¶Šé«˜ã€‚ é”ç­–ç•¥æ˜¯æŒ‡åœ¨é”çš„å¼€é”€å’Œæ•°æ®å®‰å…¨ä¹‹é—´\bå¯»æ±‚\bå¹³è¡¡ã€‚Mysql æä¾›å¤šç§é€‰æ‹©ï¼Œæ¯ä¸€ä¸ªå­˜å‚¨å¼•æ“éƒ½\bå®ç°äº†è‡ªå·±çš„é”ç­–ç•¥å’Œé”ç²’åº¦ã€‚ è¡¨é”Mysql æœ€åŸºæœ¬çš„é”ç­–ç•¥ï¼Œä¹Ÿæ˜¯é”å¼€é”€æœ€å°çš„ç­–ç•¥ï¼Œå¯¹æ•°æ®çš„å†™æ“ä½œï¼ˆæ’å…¥ã€æ›´æ–°ã€åˆ é™¤ï¼‰ä¼šé”å®šæ•´å¼ è¡¨ã€‚å½“æ‹¥æœ‰ä¸€ä¸ªå†™é”æ—¶ï¼Œå°†é˜»å¡å…¶ä»–è¿æ¥å¯¹æ•°æ®çš„è¯»å†™æ“ä½œï¼Œç›´è‡³å†™é”é‡Šæ”¾ã€‚è¯»é”æ˜¯äº’ä¸é˜»å¡çš„ã€‚ è¡Œé”è¡Œé”å¯ä»¥æœ€å¤§ç¨‹åºçš„æ”¯æŒå¹¶å‘ï¼ŒåŒæ—¶ä¹Ÿå¸¦æ¥äº†é”çš„å¼€é”€ã€‚è¡Œçº§é”åªåœ¨å­˜å‚¨å¼•æ“ä¸­å®ç°ï¼Œmysql æœåŠ¡å™¨å±‚æ²¡æœ‰å®ç°ï¼ŒæœåŠ¡å™¨å±‚ä¸äº†è§£å­˜å‚¨å¼•æ“çš„é”å®ç°ã€‚ äº‹åŠ¡äº‹åŠ¡æ˜¯ä¸€ç»„åŸå­æ€§çš„ SQL æŸ¥è¯¢ï¼Œæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œå•å…ƒã€‚äº‹åŠ¡ä¸­çš„ SQL è¯­å¥è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚ ä¸€ä¸ªè‰¯å¥½çš„äº‹åŠ¡å¤„ç†ç³»ç»Ÿå¿…é¡»å…·å¤‡ ACID æ ‡å‡†ï¼Œä¸åŸºäº ACID æ ‡å‡†è°ˆäº‹åŠ¡çš„æ¦‚å¿µæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ ACID å³ï¼šåŸå­æ€§ï¼ˆAtomicityï¼‰ã€ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆIsolationï¼‰ã€æŒä¹…æ€§ï¼ˆDurabilityï¼‰ã€‚ ã€ŒåŸå­æ€§ã€ ä¸€ä¸ªäº‹åŠ¡è¢«è§†ä¸ºä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œå•å…ƒï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆæäº¤æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šï¼Œä¸å¯èƒ½åªæ‰§è¡Œå…¶ä¸­ä¸€éƒ¨åˆ†æ“ä½œã€‚ ã€Œä¸€è‡´æ€§ã€ æ•°æ®åº“æ€»æ˜¯ä»ä¸€ä¸ªçŠ¶æ€åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„å˜åŒ–ã€‚è‹¥äº‹åŠ¡æäº¤æˆåŠŸï¼ŒA çŠ¶æ€åˆ°äº† B çŠ¶æ€ï¼›è‹¥äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œå›åˆ° A çŠ¶æ€ï¼›ä¸å­˜åœ¨ç¬¬ä¸‰ç§çŠ¶æ€ Cã€‚ ã€Œéš”ç¦»å‹ã€ é€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æäº¤æˆåŠŸä¹‹å‰ï¼Œå¯¹å…¶ä»–äº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚éš”ç¦»æ€§æ˜¯å››ä¸ªæ€§è´¨ä¸­æœ€å¤æ‚çš„ä¸€ä¸ªï¼Œå…¶ä¸­ç»†åˆ†äº†è®¸å¤š ã€Œéš”ç¦»çº§åˆ«ã€ã€‚ ã€ŒæŒä¹…æ€§ã€ ä¸€æ—¦äº‹åŠ¡æäº¤äº†ï¼Œæ‰€åšçš„ä¿®æ”¹å°†æ°¸ä¹…ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå³ä½¿ç³»ç»Ÿå´©æºƒï¼Œä¿®æ”¹çš„æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚å½“ç„¶è¿™æ˜¯ç†æƒ³çš„æƒ…å†µï¼Œå¾ˆå¤šæ—¶å€™ä¸èƒ½å¤Ÿä¿è¯ 100% çš„æŒä¹…æ€§ã€‚ éš”ç¦»çº§åˆ«SQL æ ‡å‡†å®šä¹‰äº†å››ç§éš”ç¦»çº§åˆ«ï¼Œæ¯ä¸€ç§çº§åˆ«ä¸­éƒ½è§„å®šäº†ä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹ï¼Œå“ªäº›åœ¨äº‹åŠ¡å†…å’Œäº‹åŠ¡è§æ˜¯å¯è§çš„ï¼Œå“ªäº›æ˜¯ä¸å¯è§çš„ã€‚è¾ƒä½çš„éš”ç¦»é€šå¸¸å¯ä»¥æ‰§è¡Œæ›´é«˜ çš„å¹¶å‘ï¼Œç³»ç»Ÿå¼€é”€ä¹Ÿä¼šæ›´ä½ã€‚ ã€ŒREAD UNCOMMIT æœªæäº¤è¯»ã€äº‹åŠ¡ä¸­çš„ä¿®æ”¹ï¼Œå³ä½¿æ²¡æœ‰æäº¤ï¼Œå¯¹å…¶ä»–äº‹åŠ¡ä¹Ÿæ˜¯å¯è§çš„ã€‚è¿™ä¹Ÿå«åšè„è¯»ï¼ˆdrity readï¼‰ï¼Œè¿™ä¸ªçº§åˆ«ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ï¼Œå¾ˆå°‘ä½¿ç”¨è¿™ä¸ªçº§åˆ«ã€‚å¹¶ä¸”ä»æ€§èƒ½ä¸Šæ¥è¯´ï¼Œread \buncommit ä¸ä¼šæ¯”å…¶ä»–\bçº§åˆ«é«˜å‡ºå¤šå°‘ï¼Œä½†æ˜¯ç¼ºå°‘äº†å…¶ä»–çº§åˆ«çš„å¾ˆå¤š\bä¼˜åŠ¿ã€‚ ã€ŒREAD COMMIT æäº¤è¯»ã€å¤§å¤šæ•°æ•°æ®åº“éš”ç¦»çº§åˆ«éƒ½æ˜¯ read commitï¼Œä½† Mysql ä¸æ˜¯ã€‚ read commit æ»¡è¶³äº‹åŠ¡éš”ç¦»æ€§çš„åŸºæœ¬å®šä¹‰ï¼Œä¸€ä¸ªäº‹åŠ¡\bå¼€å§‹æ—¶åªèƒ½çœ‹åˆ°å·²ç»æäº¤çš„\bäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹ã€‚ read commit ä¹Ÿå«åšã€Œä¸å¯é‡å¤è¯»ã€ï¼Œä¸¤æ¬¡æ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢ï¼Œå¯èƒ½å¾—åˆ°ä¸åŒçš„ç»“æœã€‚ ã€ŒREPEATABLE READ å¯é‡å¤è¯»ã€Mysql çš„é»˜è®¤éš”ç¦»çº§åˆ«ã€‚ è¯¥çº§åˆ«è§£å†³çš„è„è¯»å¹¶ä¸”æ”¯æŒå¯é‡å¤è¯»ï¼ˆåŒä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡è¯»å–åŒæ ·çš„è®°å½•çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼‰ã€‚ä¸è¿‡æ— æ³•è§£å†³ã€Œå¹»è¯»ã€é—®é¢˜ï¼Œå³å½“ä¸€ä¸ªäº‹åŠ¡è¯»å–æŸä¸ªèŒƒå›´çš„è®°å½•æ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æ’å…¥äº†æ–°çš„è®°å½•ï¼Œ\bè¯¥äº‹åŠ¡å†æ¬¡è¯»å–ä¼šå‡ºç°å¹»è¡Œã€‚ ä¸è¿‡ InnDB \bå­˜å‚¨å¼•æ“é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVVCï¼‰è§£å†³äº†å¹»è¯»ã€‚ ã€ŒSERIALIZABLE å¯ä¸²è¡ŒåŒ–ã€æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå¼ºåˆ¶äº‹åŠ¡\b\bä¸²è¡Œæ‰§è¡Œã€‚serializable ä¼šç»™æ¯ä¸€è¡Œæ•°æ®åŠ é”ï¼Œæ‰€ä»¥å¯èƒ½å¯¼è‡´å¤§é‡è¶…æ—¶å’Œé”å ç”¨ã€‚é™¤ééå¸¸éœ€è¦ç¡®ä¿æ•°æ®ä¸€è‡´æ€§å¹¶ä¸”ä¸éœ€è¦å¹¶å‘æƒ…å†µï¼Œå¦åˆ™ä¸è€ƒè™‘ä½¿ç”¨è¯¥çº§åˆ«ã€‚ å„ä¸ªéš”ç¦»çº§åˆ«\bæ¯”è¾ƒï¼š éš”ç¦»çº§åˆ« è„è¯»å¯èƒ½æ€§ ä¸å¯é‡å¤è¯»å¯èƒ½æ€§ å¹»è¯»å¯èƒ½æ€§ åŠ é”è¯» READ UNCOMMIT yes yes yes no READ COMMIT no yes yes no PEREATABLE READ no no yes no SERIALIZABLE no no no yes ç¬¬å››ç«  Schema ä¸ æ•°æ®ç±»å‹ä¼˜åŒ–é€‰æ‹©æ•°æ®ç±»å‹çš„å‡ ç§åŸåˆ™ï¼š 1ï¼‰æ›´å°çš„é€šå¸¸æ›´å¥½æ›´å°çš„æ•°æ®ç±»å‹\b\bé€Ÿåº¦è¶Šå¿«ï¼Œå ç”¨æ›´å°‘çš„ç£ç›˜ã€å†…å­˜å’Œ CPU ç¼“å­˜ã€‚ä½†æœ€å¥½\bç¡®ä¿æ•°æ®ç±»å‹å°†ä¸ä¼šæ‰©å……ï¼Œå› ä¸ºæ‰©å¤§\b\bæ•°æ®ç±»å‹çš„èŒƒå›´æ˜¯ååˆ†è€—æ—¶å’Œæ¶ˆè€—èµ„æºçš„æ“ä½œã€‚ 2ï¼‰ç®€å•å°±å¥½ç®€å•çš„æ•°æ®ç±»å‹é€šå¸¸éœ€è¦æ›´å°‘çš„ CPU å‘¨æœŸã€‚\bæ•´å‹æ¯”å­—ç¬¦å‹çš„æ“ä½œä»£ä»·è¦ä½ï¼Œè¿™æ˜¯ç”±äºå­—ç¬¦å‹çš„æ ¡å¯¹å’Œæ’åºè§„åˆ™æ¯”æ•´å‹æ›´å¤æ‚å¯¼è‡´çš„ã€‚ èƒ½ç”¨ Mysql å†…ç½®çš„æ—¶é—´ç±»å‹å°±ä¸ç”¨å­—ç¬¦ä¸²ï¼Œç”¨æ•´å‹å­˜å‚¨ IP åœ°å€ä¸è¦ç”¨å­—ç¬¦ä¸²ã€‚ 3ï¼‰é¿å…ä½¿ç”¨ \bNULLå¯ä¸º NULL çš„åˆ—ä¼šä½¿å¾—ç´¢å¼•ã€ç´¢å¼•ç»Ÿè®¡ã€æ¯”è¾ƒå˜å¾—å¤æ‚ï¼ŒMysql éœ€è¦\bæ›´å¤šçš„ç©ºé—´å¯¹ NUll åˆ—åš\bç‰¹æ®Šå¤„ç†ã€‚ NULL åˆ—ä¸è¦\bç”¨ä½œç´¢å¼•ã€‚ æ•´æ•°ç±»å‹æ•°å­—ç±»å‹åˆ†ä¸ºæ•´æ•°å’Œå®æ•°ï¼Œæ•´æ•°çš„å‡ ç§ MYSQL ç±»å‹å¦‚ä¸‹ï¼š ç±»å‹ å ç”¨ä½æ•° å­—èŠ‚ TINYINT 8 1 SMALLINT 16 2 MEDIUMINT 24 3 INT 32 4 BIGINT 64 8 æ•´æ•°ç±»å‹åˆ†ä¸ºæœ‰ç¬¦å·å’Œæ— ç¬¦å·ï¼ˆUNSIGNEDï¼‰ï¼Œæ— ç¬¦å·è¡¨ç¤ºä¸æ”¯æŒè´Ÿæ•°ã€‚ä½¿ç”¨æ— ç¬¦å·å¤§çº¦å¯ä»¥ä½¿å­˜å‚¨ç©ºé—´æé«˜ä¸€å€ã€‚ æœ‰ç¬¦å·å’Œæ— ç¬¦å·ä½¿ç”¨ç›¸åŒçš„å­˜å‚¨ç©ºé—´ï¼Œå…·æœ‰ç›¸åŒçš„æ€§èƒ½ï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ã€‚ Mysql ä¸­å¯ä»¥ç»™æ•´æ•°æŒ‡å®šå®½åº¦ï¼Œå¦‚ INT(11)ï¼Œä½†å¯¹å¤§å¤šæ•°åº”ç”¨æ¥è¯´æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚å®ƒæ²¡æœ‰é™åˆ¶æ•°çš„å­˜å‚¨èŒƒå›´ï¼Œè€Œåªæ˜¯è§„å®šåœ¨ä¸€äº› MYSQL å®¢æˆ·ç«¯å·¥å…·ä¸­æ˜¾ç¤ºçš„å­—ç¬¦çš„å®½åº¦ã€‚å¯¹äºå­˜å‚¨å’Œè®¡ç®—æ¥æ”¶ï¼ŒINT(1) å’Œ INT(11) æ˜¯æ²¡æœ‰åŒºåˆ«çš„ã€‚ \bå®æ•°ç±»å‹å®æ•°æ˜¯å¸¦æœ‰å°æ•°çš„æ•°å­—ã€‚MYSQL ä¸­æ”¯æŒçš„ç±»å‹æœ‰ ã€Œæµ®ç‚¹ç±»å‹ï¼ˆfloat / doubleï¼‰ã€ å’Œ ã€ŒDecimal ç±»å‹ã€ã€‚ ç±»å‹ å­—èŠ‚æ•° \bä½æ•° float 4 32 double 8 64 decimal 16 128 æµ®ç‚¹ç±»å‹æ˜¯ä¸ç²¾ç¡®ç±»å‹ï¼Œä¸æ”¯æŒç²¾ç¡®è®¡ç®—ï¼Œå­˜å‚¨åŒæ ·èŒƒå›´çš„å€¼å ç”¨ç©ºé—´è¾ƒ decimal å°‘ï¼› decimal ç±»å‹æ˜¯ç²¾ç¡®ç±»å‹ï¼Œå¯å­˜å‚¨ç²¾ç¡®å°æ•°ï¼Œæ”¯æŒç²¾ç¡®è®¡ç®—ï¼ˆMysql 5.0 å¼€å§‹ï¼‰ï¼Œä½†è®¡ç®—ä»£ä»·è¾ƒé«˜ã€‚ decimal(a,b) a æŒ‡å®šå°æ•°ç‚¹å·¦è¾¹å’Œå³è¾¹å¯ä»¥å­˜å‚¨çš„åè¿›åˆ¶æ•°å­—çš„æœ€å¤§ä¸ªæ•°ï¼Œæœ€å¤§ç²¾åº¦38ã€‚ b æŒ‡å®šå°æ•°ç‚¹å³è¾¹å¯ä»¥å­˜å‚¨çš„åè¿›åˆ¶æ•°å­—çš„æœ€å¤§ä¸ªæ•°ã€‚å°æ•°ä½æ•°å¿…é¡»æ˜¯ä» 0 åˆ° a ä¹‹é—´çš„å€¼ã€‚é»˜è®¤å°æ•°ä½æ•°æ˜¯ 0ã€‚ å»ºè®®ï¼š 1. åªæŒ‡å®š\bæ•°å€¼ç±»å‹ï¼Œä¸æŒ‡å®šç²¾åº¦ã€‚ 2. å°½é‡åœ¨\båªå¯¹å°æ•°è®¡ç®—æ—¶æ‰ä½¿ç”¨ Decimalï¼Œæ•°æ®é‡\bå¤§æƒ…å†µä¸‹æœ€å¥½æ˜¯ä½¿ç”¨ BIGINT ä»£æ›¿ DECIMALã€‚\b å°æ•°æŒ‰å€æ•°ç›¸ä¹˜ä¹‹åå­˜å…¥\bæ•°æ®åº“ï¼Œå–å‡ºæ—¶æŒ‰å€æ•°ç›¸é™¤å³å¯ã€‚ å­—ç¬¦ä¸²ç±»å‹VARCHAR &amp; CHARvarchar æ¯” char æ›´èŠ‚çœç©ºé—´ï¼Œä¸€å®šç¨‹åº¦ä¸Šä¹Ÿæé«˜äº†æ€§èƒ½ï¼Œå› ä¸ºä»…ä½¿ç”¨å¿…è¦çš„ç©ºé—´ã€‚ä½†ç”±äºè¡Œæ˜¯å˜é•¿çš„ï¼Œåšæ›´æ–°æ“ä½œå¯èƒ½æ—¶ä¼šæ¯” vhar å¤šåšä¸€äº›é¢å¤–æ“ä½œã€‚ char æ˜¯å˜é•¿çš„ï¼Œæ ¹æ®å®šä¹‰çš„å­—ç¬¦ä¸²çš„é•¿åº¦åˆ†é…å›ºå®šçš„ç©ºé—´ï¼Œå½“å­˜å‚¨çš„\bå€¼å°‘äºå›ºå®šé•¿åº¦æ—¶ä»¥ç©ºæ ¼å¡«å……ã€‚char ç±»å‹é€‚åˆç”¨äºå­˜å‚¨\bé•¿åº¦çŸ­ã€å€¼çš„é•¿åº¦å›ºå®šçš„å¦‚ MD5 åŠ å¯†åçš„å¯†ç ï¼Œå› ä¸º\bæ˜¯å®šé•¿çš„ï¼Œä¸æ˜“äº§ç”Ÿç¢ç‰‡ï¼Œç‰¹å®šç±»å‹çš„æ•°å€¼å­˜å‚¨æ•ˆç‡æ¯” varchar è¦é«˜ã€‚ BINARY &amp; VARBINARYbinary å’Œ varbinary ä¸ char å’Œ varchar ç±»ä¼¼ï¼Œåªä¸è¿‡ binaryã€varbinary å­˜å‚¨çš„æ˜¯äºŒè¿›åˆ¶å­—ç¬¦\bä¸²ã€‚äºŒè¿›åˆ¶å­—ç¬¦ä¸²ä¸æ™®é€šå­—ç¬¦ä¸²ç±»ä¼¼ï¼Œä¸è¿‡å­˜å‚¨çš„\bæ˜¯\bå­—èŠ‚ç è€Œä¸æ˜¯å­—ç¬¦ã€‚ BLOB &amp; TEXTå­˜å‚¨å¤§æ•°æ®é‡çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œåˆ†åˆ«å­˜å‚¨äºŒè¿›åˆ¶å¤§å­—ç¬¦ä¸²å’Œæ™®é€šæ–‡æœ¬å¤§å­—ç¬¦ä¸²ã€‚ BLOB ç±»å‹æœ‰ï¼šTINYBLOBã€SMALLBLOBã€BLOBã€MEDIUMBLOBã€BIGBLOBã€‚ TEXT ç±»å‹æœ‰ï¼šTINYTEXTã€SMALLTEXTã€TEXTã€MEDIUMTEXTã€BIGTEXTã€‚ æ—¶é—´ç±»å‹DATETIMEèƒ½ä¿å­˜è¾ƒå¤§èŒƒå›´çš„å€¼ï¼Œä» 1001 å¹´åˆ° 9999 å¹´ï¼Œç²¾åº¦ä¸ºç§’ã€‚ä¸æ—¶åŒºæ— å…³ï¼Œ\bä½¿ç”¨ 8 ä¸ªå­—èŠ‚å­˜å‚¨ã€‚ TIMESTAMPè¯¥ç±»å‹ä¿å­˜äº†ä» 1970 \bå¹´ 1 æœˆ 1 æ—¥åˆå¤œä»¥æ¥\bçš„æè¿°ï¼Œè¡¨ç¤ºçš„èŒƒå›´ä¸º 1970 å¹´åˆ° 2038 å¹´ã€‚åªå ç”¨ 4 ä¸ªå­—èŠ‚ã€‚ä¸æ—¶åŒºç›¸å…³ã€‚ é™¤äº†ç‰¹æ®Šæƒ…å†µä¹‹å¤–ï¼Œå°½é‡ä½¿ç”¨ TIMESTAMPï¼Œå› ä¸ºå®ƒæ¯” DATETIME ç©ºé—´åˆ©ç”¨æ•ˆç‡æ›´é«˜ã€‚ ä½ç±»å‹Mysql 5.0 ä¹‹å‰ï¼ŒBIT ä¸ TINYINT æ²¡æœ‰åŒºåˆ«ï¼Œ\bMYSQL 5.0 ä¹‹åè¿™ä¸¤è€…æ˜¯ä¸åŒçš„\bæ•°æ®ç±»å‹ã€‚ BIT æœ€å¤§æ”¯æŒ 64 \bä¸ªä½ï¼ŒMysql å°† BIT è§†ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œå½“æ£€ç´¢ bit(1) æ—¶ï¼Œè¿”å›çš„æ˜¯äºŒè¿›åˆ¶ çš„ 0 æˆ– 1 çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æ•°å­—ã€‚ æ³¨æ„ï¼šåœ¨æ•°å­—ä¸Šä¸‹æ–‡ä¸­æ£€ç´¢æ—¶ï¼Œä¼šå°†\bå­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—ã€‚å¦‚ï¼šå­˜å‚¨å€¼ä¸º bâ€™00111001â€™ï¼ˆäºŒè¿›åˆ¶ç­‰äº57ï¼‰çš„åˆ—æ£€ç´¢æ—¶ä¼šå¾—åˆ° 57 çš„å­—ç¬¦ä¸²ï¼Œç„¶åæ ¹æ® 57 \båœ¨ ASCII ç ä¸­çš„ä½ç½®å¾—å‡ºæ•°å­— 9ã€‚è¿™é€šå¸¸ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚å› æ­¤åº”å°½é‡é¿å…ä½¿ç”¨è¿™ä¸ªç±»å‹ã€‚ ç‰¹æ®Šç±»å‹å¦‚ IP åœ°å€ï¼Œåº”è¯¥ç”¨æ— ç¬¦å·æ•´æ•°æ¥å­˜å‚¨ã€‚IP ä¹‹é—´çš„å°æ•°ç‚¹åªæ˜¯ä¸ºäº†è®©äººä»¬åˆ©äºåŒºåˆ†ï¼ŒMYSQL æä¾› INET_ATON() å’Œ INET_NTOA() å‡½æ•°åœ¨è¿™ä¸¤è€…ä¹‹é—´è½¬æ¢ã€‚ \b\bSchema è®¾è®¡çš„\bé™·é˜± é¿å…è®¾è®¡\bå¤ªå¤šçš„åˆ— é¿å…æ»¥ç”¨æšä¸¾ é¿å…å¤ªå¤šçš„å…³è” å°½é‡é¿å…è®¾è®¡å¯ä¸º NULL çš„åˆ—ï¼Œä½†æœ‰æ—¶å¿…é¡»è¿™æ ·åšã€‚ èŒƒå¼ä¸åèŒƒå¼èŒƒå¼çš„ä¼˜ç‚¹ï¼š èŒƒå¼åŒ–çš„æ›´æ–°æ“ä½œé€šå¸¸æ¯”åèŒƒå¼åŒ–è¦å¿«ã€‚ èŒƒå¼åŒ–å¾ˆå°‘æœ‰é‡å¤æ•°æ®ã€‚ èŒƒå¼åŒ–çš„è¡¨é€šå¸¸æ›´å°ï¼Œå¯ä»¥æ›´å¥½çš„æ”¾åœ¨å†…å­˜é‡Œï¼Œæ‰§è¡Œä¼šæ›´å¿«ã€‚ æœ‰å¾ˆå°‘çš„æ•°æ®æ„å‘³ç€æ£€ç´¢åˆ—æ—¶éœ€è¦æ›´å°‘çš„ DISTINCT æˆ–è€… GROUP BY è¯­å¥ã€‚ èŒƒå¼çš„ç¼ºç‚¹ï¼šé€šå¸¸éœ€è¦å…³è”ï¼Œä»£ä»·\bæ˜‚è´µ ï¼Œå¯èƒ½ä½¿å¾—ç´¢å¼•ç­–ç•¥æ— æ•ˆã€‚ æœ€ä½³çš„è®¾è®¡æ˜¯æ··åˆèŒƒå¼åŒ–ä¸åèŒƒå¼åŒ– ç¬¬äº”ç«  åˆ›å»ºé«˜æ€§èƒ½çš„ç´¢å¼•ç´¢å¼•æ˜¯å­˜å‚¨å¼•æ“ç”¨äºå¿«é€Ÿæ‰¾åˆ°è®°å½•çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œè®¾è®¡è‰¯å¥½çš„ç´¢å¼•æ¯”ä¸å¥½çš„ç´¢å¼•å¯èƒ½è¦å¥½å‡ ä¸ªé‡çº§ã€‚åœ¨ Mysql ä¸­ï¼Œå­˜å‚¨å¼•æ“å…ˆåœ¨ç´¢å¼•ä¸­æœç´¢å¯¹åº”çš„å€¼ï¼Œå†æ ¹æ®åŒ¹é…çš„ç´¢å¼•è®°å½•æ‰¾åˆ°å¯¹åº”çš„æ•°æ®è¡Œã€‚ ç´¢å¼•å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—ï¼Œå¦‚æœåŒ…å«å¤šä¸ªåˆ—ï¼Œé‚£ä¹ˆåˆ—çš„é¡ºåºååˆ†é‡è¦ï¼Œå› ä¸º Mysql åªèƒ½é«˜æ•ˆçš„ä½¿ç”¨ç´¢å¼•æœ€å·¦å‰ç¼€çš„åˆ—ã€‚åˆ›å»ºä¸€ä¸ªåŒ…å«å¤šåˆ—çš„ç´¢å¼•å’Œåˆ›å»ºå¤šä¸ªåªåŒ…å«ä¸€ä¸ªåˆ—çš„ç´¢å¼•æ˜¯å¤§ä¸ç›¸åŒçš„ã€‚ ç´¢å¼•çš„ç±»å‹ç´¢å¼•æœ‰å¾ˆå¤šç±»å‹ï¼Œä¸åŒçš„ç±»å‹å¯ä»¥ä¸ºä¸åŒçš„åœºæ™¯æä¾›æ›´å¥½çš„æ€§èƒ½ã€‚åœ¨ Mysql ä¸­ï¼Œç´¢å¼•æ˜¯å­˜å‚¨åœ¨å­˜å‚¨å¼•æ“å±‚è€Œä¸æ˜¯åœ¨æœåŠ¡å±‚å®ç°çš„ï¼Œæ‰€ä»¥æ²¡æœ‰ç»Ÿä¸€çš„ç´¢å¼•æ ‡å‡†ã€‚ B-Tree ç´¢å¼•B-TREE ç´¢å¼•æ˜¯å¤§å¤šæ•° MYSQL å­˜å‚¨å¼•æ“ä½¿ç”¨çš„ç´¢å¼•ç±»å‹ï¼ŒInnoDB ä½¿ç”¨å°±æ˜¯ B-TREEã€‚è¿™ç±»ç´¢å¼•é€‚ç”¨äºã€Œå…¨é”®å€¼ã€ã€Œé”®å€¼èŒƒå›´ã€ã€Œé”®å‰ç¼€ã€æŸ¥æ‰¾ï¼Œé”®å‰ç¼€æŸ¥æ‰¾åªé€‚ç”¨äºæ ¹æ®æœ€å·¦å‰ç¼€æŸ¥æ‰¾ã€‚B-Tree æ˜¯æœ€å¸¸è§çš„ç´¢å¼•ï¼Œæ”¯æŒæŒ‰é¡ºåºå­˜å‚¨æ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ¥åš GROUP BY å’Œ ORDER BY æ“ä½œã€‚ä»¥ä¸‹æŸ¥è¯¢ç±»å‹ä½¿ç”¨ B-Tree ä¼šååˆ†æœ‰æ•ˆï¼š 1ï¼‰å…¨å€¼åŒ¹é…åˆ©ç”¨ç´¢å¼•ä¸­æ‰€æœ‰çš„åˆ—è¿›è¡ŒåŒ¹é…çš„æŸ¥è¯¢ã€‚ 2ï¼‰åŒ¹é…æœ€å·¦å‰ç¼€å¯¹äºå¤šä¸ªåˆ—ç»„æˆçš„ç´¢å¼•ï¼ŒåŒ¹é…æœ€å·¦åˆ—çš„æŸ¥è¯¢ä½¿ç”¨ b-tree æ•ˆç‡å¾ˆé«˜ã€‚ 3ï¼‰åŒ¹é…åˆ—å‰ç¼€åŒ¹é…æŸä¸ªåˆ—çš„å€¼çš„å¼€å¤´éƒ¨åˆ†ï¼Œå¦‚ first_name æ˜¯æœ€å·¦åˆ—ï¼ŒæŸ¥æ‰¾å§“ä» J å¼€å¤´çš„äººçš„æŸ¥è¯¢ä¼šèµ°ç´¢å¼•ã€‚è¿™é‡Œçš„åŒ¹é…åˆ—å‰ç¼€æ˜¯åœ¨æœ€å·¦å‰ç¼€å‰æä¸‹çš„ã€‚ 4ï¼‰ç²¾ç¡®åŒ¹é…æŸä¸€åˆ—å¹¶èŒƒå›´åŒ¹é…å¦å¤–ä¸€åˆ—è¿™äº›å¿…é¡»éƒ½æ˜¯ç´¢å¼•åˆ—çš„ä¸€éƒ¨åˆ†ã€‚ 5ï¼‰åªè®¿é—®ç´¢å¼•çš„æŸ¥è¯¢æŸ¥è¯¢åªè®¿é—®ç´¢å¼•ï¼Œä¸è®¿é—®å…¶ä»–æ•°æ®è¡Œã€‚ å› ä¸ºç´¢å¼•æ•°çš„èŠ‚ç‚¹éƒ½æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥é™¤äº†æŒ‰å€¼æŸ¥æ‰¾ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç”¨æ¥æŸ¥è¯¢ä¹‹ä¸­çš„ ORDER BY æ“ä½œã€‚å¦‚æœ ORDER BY å­—å¥æ»¡è¶³ä¸Šè¿°æŸ¥è¯¢è¦æ±‚ï¼Œé‚£ä¹ˆç´¢å¼•ä¹Ÿå¯ä»¥æ»¡è¶³å¯¹åº”çš„æ’åºéœ€æ±‚ã€‚ B-Tree çš„é™åˆ¶ï¼š ä¸æ˜¯æŒ‰æœ€å·¦åˆ—çš„æŸ¥è¯¢ä¸ä¼šèµ°ç´¢å¼•ã€‚ ä¸æ˜¯åˆ—å‰ç¼€çš„æŸ¥è¯¢ä¹Ÿä¸ä¼šèµ°ç´¢å¼•ï¼Œå¦‚æŸ¥æ‰¾åå­—ä»¥ J ç»“å°¾çš„ç”¨æˆ·ã€‚ ä¸èƒ½è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—æŸ¥è¯¢ã€‚å³å¦‚æœæŸ¥è¯¢æ¡ä»¶ä¸­åªåŒ…å«ç´¢å¼•çš„ç¬¬ä¸€åˆ—å’Œæœ€åä¸€åˆ—ï¼Œé‚£ä¹ˆç´¢å¼•åªä¼šåˆ©ç”¨ç¬¬ä¸€åˆ—ã€‚ å¦‚æœæŸ¥è¯¢ä¸­æœ‰æŸä¸ªåˆ—çš„èŒƒå›´æŸ¥æ‰¾ï¼Œåˆ™å³è¾¹çš„æ‰€æœ‰åˆ—éƒ½æ— æ³•åˆ©ç”¨ç´¢å¼•ä¼˜åŒ–æŸ¥æ‰¾ã€‚ B-Tree ç´¢å¼•ä¸­ï¼Œç´¢å¼•åˆ—çš„é¡ºåºå¯¹ç´¢å¼•çš„æŸ¥è¯¢æ•ˆç‡ååˆ†é‡è¦ï¼Œæœ‰æ—¶éœ€è¦ç”¨ç›¸åŒçš„åˆ—ä½†ä¸åŒçš„é¡ºåºå»ºç«‹ç´¢å¼•æ¥æ»¡è¶³ä¸åŒçš„æŸ¥è¯¢è¦æ±‚ã€‚ å“ˆå¸Œç´¢å¼•åŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œåªæœ‰ç²¾ç¡®åŒ¹é…æ‰€æœ‰åˆ—çš„æŸ¥è¯¢æ‰ä¼šæœ‰æ•ˆã€‚å¯¹äºæ¯ä¸€è¡Œæ•°æ®ï¼Œå­˜å‚¨å¼•æ“éƒ½ä¼šå¯¹å…¶ä¸­æ‰€æœ‰çš„ç´¢å¼•åˆ—è®¡ç®—ä¸€ä¸ªå“ˆå¸Œç ã€‚å“ˆå¸Œç´¢å¼•å°†æ‰€æœ‰çš„å“ˆå¸Œå—å­˜å‚¨åœ¨ç´¢å¼•ä¸­ï¼ŒåŒæ—¶åœ¨å“ˆå¸Œè¡¨ä¸­ä¿å­˜æŒ‡å‘æ¯ä¸ªæ•°æ®è¡Œçš„æŒ‡é’ˆã€‚ åœ¨ Mysql ä¸­ï¼Œåªæœ‰ Memory å¼•æ“æ˜¾å¼æ”¯æŒå“ˆå¸Œç´¢å¼•ã€‚ ç©ºé—´æ•°æ®ç´¢å¼•ï¼ˆR-Treeï¼‰MyISAM å¼•æ“æ”¯æŒ R-Treeï¼Œå¯ç”¨ä½œåœ°ç†ä½ç½®æ•°æ®å­˜å‚¨ã€‚è¿™ç§ç´¢å¼•æ— éœ€å‰ç¼€æŸ¥è¯¢ï¼Œå¯ä»¥ä»æ‰€æœ‰çº¬åº¦æ¥æ£€ç´¢æ•°æ®ï¼Œä½†å¿…é¡»ä½¿ç”¨ Mysql çš„ GIS ç›¸å…³å‡½æ•°çš„æ”¯æŒï¼ŒMysql å¯¹æ­¤æ”¯æŒå¹¶ä¸å®Œå–„ï¼Œå¤§éƒ¨äººå¾ˆå°‘ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ã€‚ å…¨æ–‡ç´¢å¼•å…¨æ–‡ç´¢å¼•æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„ç´¢å¼•ï¼Œå®ƒæŸ¥æ‰¾çš„æ˜¯æ–‡æœ¬ä¸­çš„å…³é”®å­—è€Œä¸æ˜¯æ¯”è¾ƒç´¢å¼•ä¸­çš„å€¼ã€‚ ç´¢å¼•çš„ä¼˜ç‚¹ç´¢å¼•å¯ä»¥è®©æœåŠ¡å™¨å¿«é€Ÿå®šä½åˆ°è¡¨çš„æŒ‡å®šä½ç½®ï¼Œå¹¶ä¸”æ ¹æ®ç´¢å¼•çš„æ•°æ®ç»“æ„çš„ä¸åŒï¼Œä¹Ÿå­˜åœ¨ä¸€äº›é™„åŠ ä½œç”¨ã€‚ å…¶ä¼˜ç‚¹æœ‰ï¼š å¤§å¤§å‡å°‘æœåŠ¡å™¨éœ€è¦æ‰«æçš„æ•°æ®é‡ å¯ä»¥å¸®åŠ©æœåŠ¡å™¨é¿å…æ’åºå’Œä¸´æ—¶è¡¨ å¯ä»¥å°†éšæœº I/O å˜ä¸ºé¡ºåº I/O æ­£ç¡®çš„åˆ›å»ºå’Œåˆ©ç”¨ç´¢å¼•ç‹¬ç«‹çš„åˆ—å¦‚æœæŸ¥è¯¢çš„åˆ—ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œåˆ™ Mysql ä¸ä¼šä½¿ç”¨ç´¢å¼•ã€‚â€œç‹¬ç«‹çš„åˆ—â€æ˜¯æŒ‡ç´¢å¼•åˆ—ä¸èƒ½æ˜¯è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸èƒ½æ˜¯å‡½æ•°çš„å‚æ•° ã€‚ å‰ç¼€ç´¢å¼•å’Œç´¢å¼•é€‰æ‹©æ€§æœ‰æ—¶å€™ç´¢å¼•åˆ—æ˜¯å¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¼šè®©ç´¢å¼•å˜å¾—å¤§è€Œæ…¢ï¼Œè™½ç„¶ MYSQL å¯èƒ½ä¼šéšå¼çš„è½¬æ¢æˆå“ˆå¸Œç´¢å¼•ï¼Œä½†æœ‰æ—¶å€™ä¸è¶³å¤Ÿï¼Œå¦ä¸€ç§æ–¹æ¡ˆæ˜¯é‡‡ç”¨ã€Œå‰ç¼€ç´¢å¼•ã€ã€‚ é¡¾åæ€ä¹‰ï¼Œå‰ç¼€ç´¢å¼•æ˜¯æŒ‡ ç´¢å¼•åªç´¢å¼•åˆ—çš„å‰é¢éƒ¨åˆ†å€¼ã€‚åˆ›å»ºå‰ç¼€ç´¢å¼•éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯åˆ†é…åˆç†çš„å‰ç¼€å¤§å°ï¼Œå‰ç¼€å¤§å°å†³å®šç€ç´¢å¼•é€‰æ‹©æ€§ã€‚ ç´¢å¼•é€‰æ‹©æ€§æ˜¯æŒ‡é€šè¿‡è¯¥å‰ç¼€ç´¢å¼•èƒ½å¤Ÿè¿‡æ»¤æ‰çš„è¡Œæ•°ï¼Œé€‰æ‹©æ€§è¶Šé«˜ï¼Œè¿‡æ»¤çš„è¡Œæ•°è¶Šå¤šã€‚ä¾‹å¦‚ï¼šå”¯ä¸€ç´¢å¼•çš„é€‰æ‹©æ€§æ˜¯ 1ï¼Œå› ä¸ºé€šè¿‡å”¯ä¸€ç´¢å¼•èƒ½å¤Ÿç²¾ç¡®å®šä½åˆ°æŸä¸€æ¡æ•°æ®ã€‚è¿™æ˜¯æœ€å¥½çš„ç´¢å¼•é€‰æ‹©æ€§ï¼Œæ€§èƒ½ä¹Ÿæ˜¯æœ€å¥½çš„ã€‚ å¯¹ BLOBã€TEXTã€å¾ˆé•¿çš„ varchar å¿…é¡»ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œé•¿æ–‡æœ¬åˆ›å»ºå‰ç¼€ç´¢å¼•å…³é”®ç‚¹åœ¨äºåˆ†é…å¤šå°‘å¤§å°çš„å‰ç¼€ä»¥ä¿è¯è¶³å¤Ÿé«˜çš„é€‰æ‹©æ€§ï¼Œä½†åŒæ—¶åˆä¸èƒ½å¤ªé•¿ï¼ˆä»¥ä¾¿èŠ‚çº¦ç©ºé—´ï¼‰ã€‚ åˆ›å»ºå‰ç¼€ç´¢å¼•çš„è¯­æ³•ï¼š 123- column æ˜¯åˆ—å- n æ˜¯å‰ç¼€ç´¢å¼•å­—ç¬¦å®½åº¦create table ...... add key(column(n)); é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—çš„é¡ºåºå½“ä¸è€ƒè™‘æ’åºå’Œåˆ†ç»„çš„æ—¶å€™ï¼Œå¯ä»¥å°†é€‰æ‹©æ€§æœ€é«˜çš„åˆ—æ”¾åœ¨ç´¢å¼•æœ€å‰åˆ—ã€‚ èšç°‡ç´¢å¼•è¦†ç›–ç´¢å¼•å¦‚æœä¸€ä¸ªç´¢å¼•\båŒ…å«æŸ¥è¯¢ä¸­æ‰€æœ‰çš„åˆ—ï¼Œç§°ä¹‹ä¸ºã€Œè¦†ç›–ç´¢å¼•ã€ã€‚ â€¦â€¦ ç¬¬å…­ç«  \bæŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½çš„ä¼˜åŒ–æ˜¯ä¸ªå¤§å·¥ç¨‹ï¼Œåº“è¡¨ç»“æ„ä¼˜åŒ–ã€ç´¢å¼•ä¼˜åŒ–ã€æŸ¥è¯¢ä¼˜åŒ– \béœ€è¦ä¸€ä¸ªä¸æ¼ã€‚ æŸ¥è¯¢æ…¢çš„å› ç´ å¦‚æœæŠŠæŸ¥è¯¢çœ‹ä½œä¸€ä¸ªä»»åŠ¡ï¼Œé‚£ä¹ˆä¸€ä¸ªæŸ¥è¯¢å®é™…ä¸Šæ˜¯ç”±\bè®¸å¤šä¸ªå­ä»»åŠ¡ç»„æˆã€‚æ¯ä¸ªå­ä»»åŠ¡éƒ½ä¼šæ¶ˆè€—ä¸€å®šçš„æ—¶é—´ã€‚ä¼˜åŒ–æŸ¥è¯¢æ—¶é—´ï¼Œå®é™…ä¸Šæ˜¯\bä¼˜åŒ–å­ä»»åŠ¡çš„æŸ¥è¯¢ï¼Œè¦ä¹ˆæ¶ˆé™¤å…¶ä¸­ä¸€äº›æ²¡æœ‰å¿…è¦çš„å­ä»»åŠ¡ï¼Œè¦ä¹ˆå‡å°‘å­ä»»åŠ¡çš„æŸ¥è¯¢æ—¶é—´\b\bï¼Œè¦ä¹ˆè®©å­ä»»åŠ¡è¿è¡Œçš„æ›´å¿«ã€‚ \bé™¤äº†ä¸€ä¸ªæŸ¥è¯¢å«æœ‰å¤šä¸ªå­ä»»åŠ¡ä¼šå¯¼è‡´æ…¢ä¹‹å¤–ï¼Œç½‘ç»œã€CPUè®¡ç®—ã€æ•°æ®\bç»Ÿè®¡ã€æ‰§è¡Œåˆ†æã€é”ç­‰å¾… ç­‰å› ç´ ä¹Ÿæ˜¯å¯¼è‡´æŸ¥è¯¢æ…¢çš„é‡è¦\båŸå› ã€‚ ä¼˜åŒ–æ•°æ®è®¿é—®æŸ¥è¯¢æ€§èƒ½ä½ä¸‹æœ€åŸºæœ¬çš„åŸå› æ˜¯è®¿é—®çš„\bæ•°æ®å¤ªå¤šï¼Œå¤§éƒ¨åˆ†çš„æ€§èƒ½ä½ä¸‹çš„æŸ¥è¯¢éƒ½å¯ä»¥é€šè¿‡å‡å°‘\bè®¿é—®çš„æ•°æ®é‡æ¥ä¼˜åŒ–ï¼Œä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤å¾ˆæœ‰æ•ˆï¼š ç¡®è®¤\båº”ç”¨ç¨‹åºæ˜¯å¦\båœ¨ æ£€ç´¢\b å¤§é‡è¶…è¿‡\béœ€è¦çš„æ•°æ®ã€‚è¿™é€šå¸¸æ„å‘³ç€è®¿é—®äº†\bå¤§é‡ä¸éœ€è¦çš„è¡Œï¼Œæœ‰æ—¶å€™ä¹Ÿå¯èƒ½æ˜¯è®¿é—®äº†å¤ªå¤šçš„åˆ—ã€‚ ç¡®è®¤ Mysql æœåŠ¡å™¨\bå±‚æ˜¯å¦åœ¨ åˆ†æ å¤§é‡è¶…è¿‡\béœ€è¦çš„æ•°æ®è¡Œã€‚ æ˜¯å¦è¯·æ±‚äº†ä¸éœ€è¦çš„æ•°æ®æœ‰äº›æŸ¥è¯¢ä¼šè¯·æ±‚è¶…è¿‡å®é™…éœ€è¦çš„æ•°æ®ï¼Œç„¶åè¿™äº›å¤šä½™çš„æ•°æ®ä¼šè¢«åº”ç”¨ç¨‹åºä¸¢å¼ƒã€‚è¿™ä¼šç»™ Mysql æœåŠ¡å™¨å¸¦æ¥é¢å¤–çš„è´Ÿæ‹…ï¼Œå¹¶å¢åŠ ç½‘ç»œå¼€é”€ï¼Œä¹Ÿä¼šæ¶ˆè€—åº”ç”¨æœåŠ¡å™¨ CPU å’Œå†…å­˜çš„èµ„æºã€‚åœ¨è®¾è®¡æŸ¥è¯¢ä¸­éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š é¿å…æŸ¥è¯¢ä¸éœ€è¦çš„æ•°æ®ã€‚ æ¨èä½¿ç”¨ LIMITã€‚ å¤šè¡¨å…³è”æŸ¥è¯¢æ—¶è¿”å›å…¨éƒ¨åˆ—ã€‚ åº”è¯¥åªå–éœ€è¦çš„æ•°æ®ã€‚ æ€»æ˜¯å–å‡ºå…¨éƒ¨åˆ—ã€‚ è¿™æ ·åšä¸ä»…ä¼šè®©ä¼˜åŒ–å™¨æ— æ³•ä½¿ç”¨ã€Œè¦†ç›–ç´¢å¼•ã€æ‰«æä¼˜åŒ–ï¼Œ\bè¿˜ä¼šä¸ºæœåŠ¡å™¨å¸¦æ¥é¢å¤–çš„ I/Oã€\bå†…å­˜å’Œ CPUæ¶ˆè€—ã€‚ é‡å¤æ€§çš„æŸ¥è¯¢\bç›¸åŒçš„æ•°æ® è¿™ç±»æƒ…å†µä¸‹è€ƒè™‘ä½¿ç”¨åº”ç”¨å±‚ç¼“å­˜ã€‚ Mysql æ˜¯å¦åœ¨æ‰«æé¢å¤–çš„è®°å½•ç¡®å®šæŸ¥è¯¢åªè¿”å›éœ€è¦çš„æ•°æ®ä»¥åï¼Œ\bä¸‹ä¸€ä¸ªåº”è¯¥æ³¨æ„çš„æ˜¯çœ‹æŸ¥è¯¢\bä¸ºäº†è¿”å›ç»“æœæ˜¯å¦æ‰«æäº†\bè¿‡å¤šçš„æ•°æ®ã€‚å¯¹äº Mysqlï¼Œæœ‰ä»¥ä¸‹\bå‡ ä¸ªç®€å•\bçš„è¡¡é‡æŒ‡æ ‡ï¼š å“åº”æ—¶é—´ æ‰«æçš„è¡Œæ•° è¿”å›çš„è¡Œæ•° å“åº”æ—¶é—´å“åº”æ—¶é—´æ˜¯æœåŠ¡æ—¶é—´å’Œæ’é˜Ÿæ—¶é—´çš„æ€»å’Œã€‚æœåŠ¡æ—¶é—´æ˜¯æŒ‡æ•°æ®åº“çœŸæ­£å¤„ç†è¿™ä¸ªæŸ¥è¯¢èŠ±è´¹çš„æ—¶é—´ï¼Œæ’é˜Ÿæ—¶é—´æ˜¯æŒ‡æœåŠ¡å™¨å› ä¸ºç­‰å¾…æŸäº›èµ„æºè€Œæ²¡æœ‰çœŸæ­£æ‰§è¡ŒæŸ¥è¯¢çš„æ—¶é—´ï¼Œå¯èƒ½æ˜¯ç­‰ I/O æ“ä½œå®Œæˆï¼Œ\bä¹Ÿå¯èƒ½æ˜¯ç­‰è¡Œé”é‡Šæ”¾ç­‰ç­‰ã€‚ æ‰«æçš„è¡Œæ•°è¿”å›çš„è¡Œæ•°ç†æƒ³æƒ…å†µä¸‹æ‰«æçš„è¡Œæ•°å’Œè¿”å›çš„è¡Œæ•°åº”è¯¥æ˜¯ç›¸åŒçš„ï¼Œä½†å®é™…æƒ…å†µæ˜¯å¾ˆå°‘çš„ã€‚ä¸€èˆ¬æ‰«æçš„è¡Œæ•°ä¸è¿”å›çš„è¡Œæ•°çš„æ¯”ç‡å¾ˆå°ï¼Œé€šå¸¸åœ¨ 1:1 å’Œ 10:1 ä¹‹é—´ã€‚ æ‰«æçš„è¡Œæ•°å’Œè®¿é—®ç±»å‹Mysql æœ‰å¥½å‡ ç§æ–¹å¼å¯ä»¥æŸ¥æ‰¾å¹¶è¿”å›åŒä¸€è¡Œç»“æœï¼Œä¸åŒçš„æ–¹å¼æ‰«æçš„è¡Œæ•°ä¸ç»ç›¸åŒï¼Œæœ‰çš„ä¸éœ€è¦æ‰«æã€‚ EXPAIN è¯­å¥ä¸­çš„ type åˆ—è¡¨ç¤ºè®¿é—®ç±»å‹ã€‚è®¿é—®ç±»å‹æœ‰ï¼šå…¨è¡¨æ‰«æã€ç´¢å¼•æ‰«æã€èŒƒå›´æ‰«æã€å”¯ä¸€ç´¢å¼•æ‰«æã€å¸¸æ•°å¼•ç”¨ç­‰ã€‚è¿™äº›è®¿é—®æ–¹å¼é€Ÿåº¦ä»æ…¢åˆ°å¿«ï¼Œæ‰«æçš„è¡Œæ•°ä»å°åˆ°å¤§ã€‚ å¦‚æœå‘ç°æŸ¥è¯¢éœ€è¦æ‰«æå¤§é‡çš„æ•°æ®ä½†åªè¿”å›å°‘æ•°çš„è¡Œï¼Œé€šå¸¸å¯ä»¥å°è¯•é‡‡ç”¨ä»¥ä¸‹æŠ€å·§å»ä¼˜åŒ–ï¼š ä½¿ç”¨ç´¢å¼•è¦†ç›–æ‰«æï¼ŒæŠŠéœ€è¦ç”¨åˆ°çš„åˆ—éƒ½æ”¾åˆ°ç´¢å¼•ä¸­ï¼Œè¿™æ ·å­˜å‚¨å¼•æ“æ— éœ€å›è¡¨è·å–å¯¹åº”çš„è¡Œå°±å¯ä»¥è¿”å›ç»“æœäº†ã€‚ æ”¹å˜åº“è¡¨ç»“æ„ã€‚å¦‚ä½¿ç”¨å•ç‹¬çš„ã€Œæ±‡æ€»è¡¨ã€ é‡å†™è¿™ä¸ªå¤æ‚æŸ¥è¯¢ï¼Œè®© Mysql ä¼˜åŒ–å™¨ä»¥æ›´ä¼˜åŒ–çš„æ–¹å¼æ‰§è¡ŒæŸ¥è¯¢ã€‚ é‡æ„æŸ¥è¯¢æ–¹å¼ä¼˜åŒ–æœ‰é—®é¢˜çš„æŸ¥è¯¢ï¼Œå¹¶ä¸æ˜¯è¯´ä¸€å®šéœ€è¦ä» Mysql è·å–ä¸€æ‘¸ä¸€æ ·çš„ç»“æœé›†ï¼Œè€Œæ˜¯æ‰¾åˆ°ä¸€ä¸ªæ›´ä¼˜çš„æ–¹å¼è·å¾—ç»“æœã€‚æ¯”å¦‚å°†æŸ¥è¯¢è½¬æ¢å¦å¤–ä¸€ç§å†™æ³•ä½¿å¾—æ€§èƒ½æ›´å¥½ï¼Œæˆ–è€…ä¿®æ”¹åº”ç”¨ç¨‹åºä»£ç æ¢ä¸€ç§æ–¹å¼è·å¾—åŒæ ·çš„ç»“æœã€‚ ä¸€ä¸ªå¤æ‚æŸ¥è¯¢è¿˜æ˜¯å¤šä¸ªç®€å•æŸ¥è¯¢å°½é‡ä½¿ç”¨å°‘çš„æŸ¥è¯¢æ˜¯å¥½çš„ï¼Œä½†æ˜¯æœ‰æ—¶å€™å°†ä¸€ä¸ªå¤§çš„æŸ¥è¯¢åˆ†è§£ä¸ºå¤šä¸ªå°æŸ¥è¯¢ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ åˆ‡åˆ†æŸ¥è¯¢å°†ä¸€ä¸ªå¤§çš„æŸ¥è¯¢åˆ†è§£æˆå¤šä¸ªæŸ¥è¯¢åŠŸèƒ½ä¸€æ ·ã€åªå®Œæˆä¸€å°éƒ¨åˆ†çš„å°æŸ¥è¯¢ï¼Œæ¯æ¬¡åªè¿”å›ä¸€å°éƒ¨åˆ†çš„æŸ¥è¯¢ç»“æœã€‚ æ¯”å¦‚åˆ é™¤æ—§æ•°æ®ï¼šå®šæœŸåˆ é™¤å¤§é‡æ•°æ®æ—¶å¦‚æœç”¨ä¸€ä¸ªå¤§çš„è¯­å¥ä¸€æ¬¡æ€§å®Œæˆçš„åŒ–ï¼Œå¯èƒ½éœ€è¦é”ä½å¾ˆå¤šæ•°æ®ã€æ²¾æ»¡æ•´ä¸ªäº‹åŠ¡æ—¥å¿—ã€è€—å°½ç³»ç»Ÿèµ„æºã€é˜»å¡å¾ˆå¤šå°çš„ä½†é‡è¦çš„æŸ¥è¯¢ã€‚å› æ­¤å°†ä¸€ä¸ªå¤§çš„åˆ é™¤è¯­å¥åˆ‡åˆ†æˆå¤šä¸ªå°çš„åˆ é™¤è¯­å¥å¯ä»¥å°½å¯èƒ½å°çš„å½±å“ Mysql çš„æ€§èƒ½ï¼ŒåŒæ—¶è¿˜å¯ä»¥å‡å°‘ Mysql å¤åˆ¶çš„å»¶è¿Ÿã€‚ åˆ†è§£å…³è”æŸ¥è¯¢å°†ä¸€ä¸ªå…³è”æŸ¥è¯¢åˆ†è§£ï¼Œå¯¹æ¯ä¸€ä¸ªè¡¨è¿›è¡Œä¸€æ¬¡å•è¡¨æŸ¥è¯¢ï¼Œç„¶åå°†ç»“æœåœ¨åº”ç”¨ç¨‹åºä¸­åšå…³è”ã€‚ä½¿ç”¨åˆ†è§£å…³è”æŸ¥è¯¢æœ‰å¾ˆå¤šå¥½å¤„ï¼Œå¦‚ï¼š è®©ç¼“å­˜æ•ˆç‡æ›´é«˜ã€‚ å¾ˆå¤šåº”ç”¨ç¨‹åºå¯ä»¥æ–¹ä¾¿çš„ç¼“å­˜å•è¡¨æŸ¥è¯¢å¯¹åº”çš„ç»“æœå¯¹è±¡ï¼ˆå¯¹å¤šè¡¨å…³è”æŸ¥è¯¢çš„ç»“æœåšç¼“å­˜æ˜¯ä¸åˆ‡å®é™…çš„ï¼Œå› ä¸ºå¾€å¾€å¤šè¡¨æŸ¥è¯¢çš„æ¡ä»¶æ˜¯ä¸æ–­å˜åŒ–çš„ã€‚è€Œå¯¹å•è¡¨åšç¼“å­˜å¯ä»¥æœ€å¤§ç¨‹åºä¸Šåˆ©ç”¨ç¼“å­˜ï¼‰ã€‚è€Œå¯¹äº Mysql æœ¬èº«çš„æŸ¥è¯¢ç¼“å­˜æ¥è¯´ï¼Œå¦‚æœå…³è”çš„æŸä¸ªè¡¨å‘ç”Ÿå˜åŒ–å°±æ— æ³•ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜äº†ã€‚ å°†æŸ¥è¯¢æ‹†è§£åï¼Œæ‰§è¡Œå•ä¸ªæŸ¥è¯¢å¯ä»¥å‡å°‘é”çš„ç«äº‰ã€‚ åœ¨åº”ç”¨å±‚åšå…³è”ï¼Œå¯ä»¥æ›´å®¹æ˜“çš„å¯¹æ•°æ®åº“è¿›è¡Œæ‹†åˆ†ï¼Œæ›´å®¹æ˜“åšåˆ°é«˜æ€§èƒ½å’Œå¯æ‹“å±•ã€‚ æŸ¥è¯¢æœ¬èº«æ•ˆç‡ä¹Ÿä¼šæé«˜ã€‚ å¯ä»¥å‡å°‘å†—ä½™è®°å½•çš„æŸ¥è¯¢ã€‚ åœ¨åº”ç”¨å±‚åšå…³è”æŸ¥è¯¢ï¼Œæ„å‘³ç€å¯¹äºæŸæ¡è®°å½•åº”ç”¨åªéœ€è¦æŸ¥è¯¢ä¸€æ¬¡ã€‚è€Œåœ¨æ•°æ®åº“ä¸­åšå…³è”æŸ¥è¯¢ï¼Œåˆ™å¯èƒ½éœ€è¦é‡å¤åœ°è®¿é—®ä¸€éƒ¨åˆ†æ•°æ®ã€‚ä»è¿™ç‚¹çœ‹ï¼Œè¿™æ ·é‡æ„è¿˜å¯èƒ½ä¼šå‡å°‘ç½‘ç»œå’Œå†…å­˜çš„æ¶ˆè€—ã€‚ æ›´æ·±ä¸€æ­¥ï¼Œè¿™æ ·åšç›¸å½“äºåœ¨åº”ç”¨ä¸­å®ç°äº†å“ˆå¸Œå…³è”ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Mysql çš„åµŒå¥—å¾ªç¯å…³è”ã€‚æŸäº›åœºæ™¯å“ˆå¸Œå…³è”æ•ˆç‡è¦é«˜å¾ˆå¤šã€‚ æŸ¥è¯¢æ‰§è¡Œçš„åŸºç¡€ï¼ˆæŸ¥è¯¢\bçš„å†…éƒ¨æœºåˆ¶ï¼‰è¦æƒ³ MYSQL èƒ½å¤Ÿä»¥æ›´é«˜çš„æ€§èƒ½è¿è¡ŒæŸ¥è¯¢ï¼Œå¼„æ¸…æ¥š MYSQL æ˜¯å¦‚ä½•\bä¼˜åŒ–å’Œæ‰§è¡ŒæŸ¥è¯¢æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ å®¢æˆ·ç«¯å‘é€ä¸€æ¡æŸ¥è¯¢è¯­å¥ç»™æœåŠ¡ç«¯ \bæœåŠ¡ç«¯å…ˆ\bæ£€æŸ¥ç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­äº†ç¼“å­˜ï¼Œåˆ™\bç«‹å³è¿”å›å­˜å‚¨åœ¨ç¼“å­˜ä¸­çš„ç»“æœã€‚å¦åˆ™è¿›è¡Œä¸‹ä¸€é˜¶æ®µã€‚ æœåŠ¡ç«¯è¿›è¡Œ SQL è§£æã€é¢„å¤„ç†ã€å†ç”±ä¼˜åŒ–å™¨ç”Ÿæˆ\b\bå¯¹åº”çš„æ‰§è¡Œè®¡åˆ’ã€‚ Mysql æ ¹æ®ä¼˜åŒ–å™¨ç”Ÿæˆçš„æ‰§è¡Œè®¡åˆ’ï¼Œè°ƒç”¨å­˜å‚¨å¼•æ“çš„ API æ‰§è¡ŒæŸ¥è¯¢ã€‚ å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚ æ¯ä¸€æ­¥éƒ½æ¯”æƒ³è±¡çš„è¦å¤æ‚ï¼Œå…¶ä¸­æŸ¥è¯¢ä¼˜åŒ–å™¨æ˜¯æœ€å¤æ‚æœ€éš¾ç†è§£çš„éƒ¨åˆ†ã€‚ Mysql å®¢æˆ·ç«¯ / æœåŠ¡ç«¯é€šä¿¡åè®®mysql å®¢æˆ·ç«¯å’Œ\bæœåŠ¡ç«¯ä¹‹é—´çš„é€šä¿¡åè®®æ˜¯ã€ŒåŠåŒå·¥ã€çš„ï¼Œè¿™æ„å‘³ç€ï¼š\b\bä»»ä¸€æ—¶åˆ»ï¼Œè¦ä¹ˆæ˜¯æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œè¦ä¹ˆæ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€æ•°æ®ï¼Œä¸¤ä¸ªåŠ¨ä½œä¸ä¼šåŒæ—¶å‘ç”Ÿã€‚ è¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªé™åˆ¶\bå°±æ˜¯æ²¡æ³•å¯¹æµé‡è¿›è¡Œæ§åˆ¶ï¼Œå½“å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯è¯·æ±‚ä¸€ä¸ªå¤§çš„æ•°æ®é‡ï¼Œå°±å¿…é¡»ä¸€ç›´ç­‰å¾…æ¥æ”¶å®ŒæœåŠ¡ç«¯çš„å“åº”ï¼Œ\bä¸å¯èƒ½è¯´æ¥æ”¶ä¸€åŠå°±æ–­å¼€\bè¿æ¥ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨ LIMIT çš„åŸå› ä¹‹ä¸€äº†ã€‚ æŸ¥è¯¢ç¼“å­˜è¿™æ˜¯æŸ¥è¯¢çš„ç¬¬ä¸€é˜¶æ®µã€‚åœ¨è§£æä¸€ä¸ªè¯­å¥ä¹‹å‰ï¼Œå¦‚æœæŸ¥è¯¢ç¼“å­˜æ˜¯æ‰“å¼€çš„ï¼Œé‚£ä¹ˆ Mysql ä¼šä¼˜å…ˆæ£€æŸ¥è¿™ä¸ª\bæŸ¥è¯¢æ˜¯å¦å‘½ä¸­æŸ¥è¯¢ç¼“å­˜ä¸­çš„æ•°æ®ã€‚è¯¥æ£€æŸ¥æ˜¯é€šè¿‡ä¸€ä¸ªå¯¹å¤§å°å†™æ•æ„Ÿçš„å“ˆå¸ŒæŸ¥æ‰¾æ¥å®ç°çš„ï¼Œå³ä½¿æŸ¥è¯¢å’Œ\bç¼“å­˜ä¸­çš„æŸ¥è¯¢æœ‰\bä¸€ä¸ªå­—èŠ‚ä¸åŒï¼Œä¹Ÿä¸ä¼šåŒ¹é…ç¼“å­˜ç»“æœï¼Œè¿™ç§æƒ…å†µä¼šè¿›å…¥ä¸€ä¸ªé˜¶æ®µçš„å¤„ç†ã€‚ å¦‚æœæŸ¥è¯¢å‘½ä¸­äº†ç¼“å­˜ï¼ŒMysql åœ¨è¿”å›ç»“æœä¹‹å‰åˆ™ä¼šæ£€æŸ¥\bè¯¥ç”¨æˆ·çš„æƒé™ã€‚æƒé™æ²¡æœ‰é—®é¢˜å°±ä¼šç›´æ¥\bè¿”å›ç»“æœè·³è¿‡å…¶ä»–é˜¶æ®µã€‚ \bæŸ¥è¯¢ä¼˜åŒ–å¤„ç†è¿™æ˜¯æŸ¥è¯¢ç¼“å­˜ä¹‹åçš„ä¸‹ä¸€ä¸ªé˜¶æ®µï¼Œ","link":"/2019/07/01/high-performance-mysql-note/"},{"title":"mysql å‘½ä»¤è¡Œæ–¹å¼æ‰§è¡Œå¤‡ä»½æ¢å¤","text":"å¤‡ä»½ä¸€ä¸ªåº“ PSï¼šåœ¨ mysql å®¢æˆ·ç«¯éè¿æ¥çŠ¶æ€ä¸‹æ‰§è¡Œ mysqldump -h localhost -u root -p &lt;database-name&gt; &gt; ~/Downloads/backup.sql 1å¦‚æœæœ¬æœº mysqldump æ˜¯ 8+ ç‰ˆæœ¬ï¼Œç›®æ ‡æ•°æ®åº“é 8+ ç‰ˆæœ¬ï¼Œéœ€è¦æ·»åŠ å‚æ•°ï¼š--column-statistics=0 è¿˜åŸ PSï¼šéœ€è¦ä¿è¯æœ‰è¿™ä¸ªæ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰éœ€è¦æ‰‹åŠ¨åˆ›å»ºã€‚ æ–¹å¼ä¸€ï¼š mysqldump -h localhost -u root -p &lt;database-name&gt; &lt; ~/Downloads/backup.sql æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯è¡¨æœªæ¢å¤ã€‚åº”è¯¥æ˜¯å¤‡ä»½è„šæœ¬é‡Œé¢æœªæŒ‡å®šæ•°æ®åº“ã€‚ æ–¹å¼äºŒï¼š mysql -h localhost -u root -p use databasename; source ~/Downloads/backup.sql æ‰§è¡ŒæˆåŠŸï¼Œæ¢å¤æˆåŠŸã€‚ å¤‡ä»½æŒ‡å®šè¡¨åªéœ€è¦åœ¨å¤‡ä»½åº“çš„å‘½ä»¤ä¸­å¤šåŠ ä¸€ä¸ªå‚æ•°ï¼šè¡¨åã€‚ mysqldump -h localhost -u root -p databasename table1 table2 table3 &gt; backup.sql","link":"/2019/07/28/mysql å‘½ä»¤è¡Œæ–¹å¼æ‰§è¡Œå¤‡ä»½æ¢å¤/"},{"title":"centos7 ä¸Šæ“ä½œ mysql","text":"æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æ–¹å¼ä¸€ï¼šé€šè¿‡è¿›ç¨‹æŸ¥çœ‹ 1ps aux | grep mysqld æ–¹å¼äºŒï¼šé€šè¿‡ç«¯å£æŸ¥çœ‹ 1netstat -tulnp | gerp 3306 æ–¹å¼ä¸‰ï¼šæŸ¥çœ‹ mysql æœåŠ¡çŠ¶æ€ 1service mysql status å¯åŠ¨service mysqld start åœæ­¢service mysqld stop é‡å¯service restart mysqld æŸ¥çœ‹æœåŠ¡çŠ¶æ€service mysqld status ä½¿ç”¨ systemctl ä»£æ›¿ service å‘½ä»¤å¯åŠ¨ï¼š 1systemctl start mysqld åœæ­¢ï¼š 1systemctl stop mysqld é‡å¯ï¼š 1systemctl restart mysqld æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š 1systemctl status mysqld é…ç½®æ–‡ä»¶è·¯å¾„/etc/my.cnf å¿˜è®°äº† root å¯†ç  éœ€è¦å…ˆä¿è¯æœåŠ¡å™¨ç»å¯¹å®‰å…¨ï¼Œä¿®æ”¹å¯†ç æœŸé—´ mysql å®Œå…¨æ²¡å¯†ç ä¿æŠ¤ã€‚ åœæ­¢ mysql æœåŠ¡ ç¼–è¾‘é…ç½®æ–‡ä»¶ /etc/my.cnfï¼Œæ·»åŠ ä¸€è¡Œï¼šskip-grant-tablesã€‚ å¯ä»¥å…å¯†ç™»é™† mysql äº†ï¼šmysql -u root use mysql; ä¿®æ”¹å¯†ç ï¼šUPDATE user SET Password = password ('harry@admin') WHERE User = 'root';ï¼ˆcentos7 ä¸‹éœ€è¦å°† Password æ”¹ä¸º authentication_stringï¼‰ é€€å‡ºï¼Œåˆ é™¤é…ç½®æ–‡ä»¶ä¸­çš„ skip-grant-tables. é‡å¯æœåŠ¡ï¼šsystemctl restart mysql å¤‡ä»½mysqldump -u root -p [database name] &gt; ~/blog.sql æ¢å¤ è¿æ¥ mysql åˆ›å»ºéœ€è¦å¤‡ä»½çš„æ•°æ®åº“ï¼ˆå¦‚æ²¡æœ‰ï¼‰ use database-name; source æœåŠ¡å™¨ä¸Šçš„å¤‡ä»½æ–‡ä»¶.sql","link":"/2019/08/01/centos7 ä¸Šæ“ä½œ mysql/"}],"tags":[{"name":"docker","slug":"docker","link":"/tags/docker/"},{"name":"maven","slug":"maven","link":"/tags/maven/"},{"name":"æ— å…³ä»£ç ","slug":"æ— å…³ä»£ç ","link":"/tags/æ— å…³ä»£ç /"},{"name":"hexo","slug":"hexo","link":"/tags/hexo/"},{"name":"idea","slug":"idea","link":"/tags/idea/"},{"name":"tomcat","slug":"tomcat","link":"/tags/tomcat/"},{"name":"linux","slug":"linux","link":"/tags/linux/"},{"name":"aliyun","slug":"aliyun","link":"/tags/aliyun/"},{"name":"aop","slug":"aop","link":"/tags/aop/"},{"name":"spring","slug":"spring","link":"/tags/spring/"},{"name":"github","slug":"github","link":"/tags/github/"},{"name":"dockerfile","slug":"dockerfile","link":"/tags/dockerfile/"},{"name":"spring-boot","slug":"spring-boot","link":"/tags/spring-boot/"},{"name":"dubbo","slug":"dubbo","link":"/tags/dubbo/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","link":"/tags/åˆ†å¸ƒå¼/"},{"name":"freeMarker","slug":"freeMarker","link":"/tags/freeMarker/"},{"name":"nginx","slug":"nginx","link":"/tags/nginx/"},{"name":"cokie","slug":"cokie","link":"/tags/cokie/"},{"name":"jsonp","slug":"jsonp","link":"/tags/jsonp/"},{"name":"sso","slug":"sso","link":"/tags/sso/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","link":"/tags/ç®—æ³•/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","link":"/tags/æ•°æ®ç»“æ„/"},{"name":"redis","slug":"redis","link":"/tags/redis/"},{"name":"é›†ç¾¤","slug":"é›†ç¾¤","link":"/tags/é›†ç¾¤/"},{"name":"solr","slug":"solr","link":"/tags/solr/"},{"name":"jms","slug":"jms","link":"/tags/jms/"},{"name":"nio","slug":"nio","link":"/tags/nio/"},{"name":"git","slug":"git","link":"/tags/git/"},{"name":"çº¿ç¨‹","slug":"çº¿ç¨‹","link":"/tags/çº¿ç¨‹/"},{"name":"springboot","slug":"springboot","link":"/tags/springboot/"},{"name":"mysql","slug":"mysql","link":"/tags/mysql/"}],"categories":[{"name":"docker-note","slug":"docker-note","link":"/categories/docker-note/"},{"name":"english-learning","slug":"english-learning","link":"/categories/english-learning/"},{"name":"spring-boot","slug":"english-learning/spring-boot","link":"/categories/english-learning/spring-boot/"},{"name":"interview","slug":"interview","link":"/categories/interview/"},{"name":"bug-fix","slug":"bug-fix","link":"/categories/bug-fix/"},{"name":"linux-note","slug":"linux-note","link":"/categories/linux-note/"},{"name":"spring-boot","slug":"spring-boot","link":"/categories/spring-boot/"},{"name":"maven","slug":"english-learning/maven","link":"/categories/english-learning/maven/"}]}